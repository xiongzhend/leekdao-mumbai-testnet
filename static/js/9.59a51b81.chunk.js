/*! For license information please see 9.59a51b81.chunk.js.LICENSE.txt */
(this["webpackJsonpleekdao-farm"]=this["webpackJsonpleekdao-farm"]||[]).push([[9],Array(662).concat([function(e,t,r){var n=function(e,t){return function(){var r=Array.prototype.slice.call(arguments),n=r.length-1,i=r&&r.length>0?r[n]:null,a="function"===typeof i?i:null;return a?e.apply(t,r):new Promise((function(n,i){r.push((function(e,t){if(e)return i(e);n(t)})),e.apply(t,r)}))}};e.exports=function(e,t){t=t||{};var r=Object.prototype.toString.call(e);if("[object Object]"===r||"[object Array]"===r){var i=t.replace?e:{};for(var a in e)e.hasOwnProperty(a)&&(i[a]=n(e[a]));return i}return n(e,t.context||e)}},,function(e,t,r){"use strict";var n=r(951),i=r(952),a=r(688);e.exports=function(e){var t=n();if("function"===typeof e)return e;if("object"===typeof e)return i(e);if("string"===typeof e){var r=a(e).nodeAddress();return t.host=r.address,t.port=r.port,i(t)}throw new Error("Argument must be a send function or a config object.")}},function(e,t){e.exports={options:{usePureJavaScript:!1}}},,function(e,t,r){(function(t,n,i,a){var o=r(665),s=r(1151),u=e.exports=o.util=o.util||{};function l(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function c(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(u.isArrayBuffer(e)||u.isArrayBufferView(e))if("undefined"!==typeof a&&e instanceof a)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(n){for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof c||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!==typeof t&&t.nextTick&&!t.browser)return u.nextTick=t.nextTick,void(u.setImmediate="function"===typeof n?n:u.nextTick);if("function"===typeof n)return u.setImmediate=function(){return n.apply(void 0,arguments)},void(u.nextTick=function(e){return n(e)});if(u.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",r=[];u.setImmediate=function(t){r.push(t),1===r.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(t){if(t.source===window&&t.data===e){t.stopPropagation();var n=r.slice();r.length=0,n.forEach((function(e){e()}))}}),!0)}if("undefined"!==typeof MutationObserver){var i=Date.now(),a=!0,o=document.createElement("div");r=[];new MutationObserver((function(){var e=r.slice();r.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var s=u.setImmediate;u.setImmediate=function(e){Date.now()-i>15?(i=Date.now(),s(e)):(r.push(e),1===r.length&&o.setAttribute("a",a=!a))}}u.nextTick=u.setImmediate}(),u.isNodejs="undefined"!==typeof t&&t.versions&&t.versions.node,u.globalScope=u.isNodejs?i:"undefined"===typeof self?window:self,u.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},u.isArrayBufferView=function(e){return e&&u.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},u.ByteBuffer=c,u.ByteStringBuffer=c;u.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},u.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},u.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},u.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},u.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this},u.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},u.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(u.encodeUtf8(e))},u.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},u.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},u.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},u.ByteStringBuffer.prototype.putInt=function(e,t){l(t);var r="";do{t-=8,r+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(r)},u.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},u.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},u.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},u.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},u.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},u.ByteStringBuffer.prototype.getInt=function(e){l(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},u.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},u.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},u.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},u.ByteStringBuffer.prototype.copy=function(){var e=u.createBuffer(this.data);return e.read=this.read,e},u.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},u.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},u.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},u.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.ByteStringBuffer.prototype.toString=function(){return u.decodeUtf8(this.bytes())},u.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=u.isArrayBuffer(e),n=u.isArrayBufferView(e);if(r||n)return this.data=r?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},u.DataBuffer.prototype.length=function(){return this.write-this.read},u.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},u.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this},u.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},u.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this},u.DataBuffer.prototype.putBytes=function(e,t){if(u.isArrayBufferView(e)){var r=(n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-n.byteOffset;return this.accommodate(r),new Uint8Array(this.data.buffer,this.write).set(n),this.write+=r,this}if(u.isArrayBuffer(e)){var n=new Uint8Array(e);return this.accommodate(n.byteLength),new Uint8Array(this.data.buffer).set(n,this.write),this.write+=n.byteLength,this}if(e instanceof u.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&u.isArrayBufferView(e.data)){n=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(n.byteLength),new Uint8Array(e.data.byteLength,this.write).set(n),this.write+=n.byteLength,this}if(e instanceof u.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=u.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=u.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},u.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},u.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},u.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},u.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},u.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},u.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},u.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},u.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},u.DataBuffer.prototype.putInt=function(e,t){l(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},u.DataBuffer.prototype.putSignedInt=function(e,t){return l(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},u.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},u.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},u.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},u.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},u.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},u.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},u.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},u.DataBuffer.prototype.getInt=function(e){l(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},u.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t},u.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},u.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},u.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},u.DataBuffer.prototype.copy=function(){return new u.DataBuffer(this)},u.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},u.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},u.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},u.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e},u.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return u.binary.raw.encode(t);if("hex"===e)return u.binary.hex.encode(t);if("base64"===e)return u.binary.base64.encode(t);if("utf8"===e)return u.text.utf8.decode(t);if("utf16"===e)return u.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},u.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=u.encodeUtf8(e)),new u.ByteBuffer(e)},u.fillString=function(e,t){for(var r="";t>0;)1&t&&(r+=e),(t>>>=1)>0&&(e+=e);return r},u.xorBytes=function(e,t,r){for(var n="",i="",a="",o=0,s=0;r>0;--r,++o)i=e.charCodeAt(o)^t.charCodeAt(o),s>=10&&(n+=a,a="",s=0),a+=String.fromCharCode(i),++s;return n+=a},u.hexToBytes=function(e){var t="",r=0;for(!0&e.length&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t},u.bytesToHex=function(e){return u.createBuffer(e).toHex()},u.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";u.encode64=function(e,t){for(var r,n,i,a="",o="",s=0;s<e.length;)r=e.charCodeAt(s++),n=e.charCodeAt(s++),i=e.charCodeAt(s++),a+=h.charAt(r>>2),a+=h.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=h.charAt((15&n)<<2|i>>6),a+=isNaN(i)?"=":h.charAt(63&i)),t&&a.length>t&&(o+=a.substr(0,t)+"\r\n",a=a.substr(t));return o+=a},u.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,r,n,i,a="",o=0;o<e.length;)t=f[e.charCodeAt(o++)-43],r=f[e.charCodeAt(o++)-43],n=f[e.charCodeAt(o++)-43],i=f[e.charCodeAt(o++)-43],a+=String.fromCharCode(t<<2|r>>4),64!==n&&(a+=String.fromCharCode((15&r)<<4|n>>2),64!==i&&(a+=String.fromCharCode((3&n)<<6|i)));return a},u.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},u.decodeUtf8=function(e){return decodeURIComponent(escape(e))},u.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},u.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},u.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n},u.binary.hex.encode=u.bytesToHex,u.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2)));var i=0,a=r=r||0;for(1&e.length&&(i=1,n[a++]=parseInt(e[0],16));i<e.length;i+=2)n[a++]=parseInt(e.substr(i,2),16);return t?a-r:n},u.binary.base64.encode=function(e,t){for(var r,n,i,a="",o="",s=0;s<e.byteLength;)r=e[s++],n=e[s++],i=e[s++],a+=h.charAt(r>>2),a+=h.charAt((3&r)<<4|n>>4),isNaN(n)?a+="==":(a+=h.charAt((15&n)<<2|i>>6),a+=isNaN(i)?"=":h.charAt(63&i)),t&&a.length>t&&(o+=a.substr(0,t)+"\r\n",a=a.substr(t));return o+=a},u.binary.base64.decode=function(e,t,r){var n,i,a,o,s=t;s||(s=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0,l=r=r||0;u<e.length;)n=f[e.charCodeAt(u++)-43],i=f[e.charCodeAt(u++)-43],a=f[e.charCodeAt(u++)-43],o=f[e.charCodeAt(u++)-43],s[l++]=n<<2|i>>4,64!==a&&(s[l++]=(15&i)<<4|a>>2,64!==o&&(s[l++]=(3&a)<<6|o));return t?l-r:s.subarray(0,l)},u.binary.base58.encode=function(e,t){return u.binary.baseN.encode(e,d,t)},u.binary.base58.decode=function(e,t){return u.binary.baseN.decode(e,d,t)},u.text={utf8:{},utf16:{}},u.text.utf8.encode=function(e,t,r){e=u.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length));for(var i=r=r||0,a=0;a<e.length;++a)n[i++]=e.charCodeAt(a);return t?i-r:n},u.text.utf8.decode=function(e){return u.decodeUtf8(String.fromCharCode.apply(null,e))},u.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(2*e.length));for(var i=new Uint16Array(n.buffer),a=r=r||0,o=r,s=0;s<e.length;++s)i[o++]=e.charCodeAt(s),a+=2;return t?a-r:n},u.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},u.deflate=function(e,t,r){if(t=u.decode64(e.deflate(u.encode64(t)).rval),r){var n=2;32&t.charCodeAt(1)&&(n=6),t=t.substring(n,t.length-4)}return t},u.inflate=function(e,t,r){var n=e.inflate(u.encode64(t)).rval;return null===n?null:u.decode64(n)};var p=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(null===r?n=e.removeItem(t):(r=u.encode64(JSON.stringify(r)),n=e.setItem(t,r)),"undefined"!==typeof n&&!0!==n.rval){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},y=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(null===r.rval){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return null!==r&&(r=JSON.parse(u.decode64(r))),r},v=function(e,t,r,n){var i=y(e,t);null===i&&(i={}),i[r]=n,p(e,t,i)},m=function(e,t,r){var n=y(e,t);return null!==n&&(n=r in n?n[r]:null),n},g=function(e,t,r){var n=y(e,t);if(null!==n&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),p(e,t,n)}},_=function(e,t){p(e,t,null)},b=function(e,t,r){var n,i=null;"undefined"===typeof r&&(r=["web","flash"]);var a=!1,o=null;for(var s in r){n=r[s];try{if("flash"===n||"both"===n){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),a="flash"===n}"web"!==n&&"both"!==n||(t[0]=localStorage,i=e.apply(this,t),a=!0)}catch(u){o=u}if(a)break}if(!a)throw o;return i};u.setItem=function(e,t,r,n,i){b(v,arguments,i)},u.getItem=function(e,t,r,n){return b(m,arguments,n)},u.removeItem=function(e,t,r,n){b(g,arguments,n)},u.clearItems=function(e,t,r){b(_,arguments,r)},u.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var r=t.exec(e),n=null===r?null:{full:e,scheme:r[1],host:r[2],port:r[3],path:r[4]};return n&&(n.fullHost=n.host,n.port?(80!==n.port&&"http"===n.scheme||443!==n.port&&"https"===n.scheme)&&(n.fullHost+=":"+n.port):"http"===n.scheme?n.port=80:"https"===n.scheme&&(n.port=443),n.full=n.scheme+"://"+n.fullHost),n};var w=null;u.getQueryVariables=function(e){var t,r=function(e){for(var t={},r=e.split("&"),n=0;n<r.length;n++){var i,a,o=r[n].indexOf("=");o>0?(i=r[n].substring(0,o),a=r[n].substring(o+1)):(i=r[n],a=null),i in t||(t[i]=[]),i in Object.prototype||null===a||t[i].push(unescape(a))}return t};return"undefined"===typeof e?(null===w&&(w="undefined"!==typeof window&&window.location&&window.location.search?r(window.location.search.substring(1)):{}),t=w):t=r(e),t},u.parseFragment=function(e){var t=e,r="",n=e.indexOf("?");n>0&&(t=e.substring(0,n),r=e.substring(n+1));var i=t.split("/");return i.length>0&&""===i[0]&&i.shift(),{pathString:t,queryString:r,path:i,query:""===r?{}:u.getQueryVariables(r)}},u.makeRequest=function(e){var t=u.parseFragment(e),r={path:t.pathString,query:t.queryString,getPath:function(e){return"undefined"===typeof e?t.path:t.path[e]},getQuery:function(e,r){var n;return"undefined"===typeof e?n=t.query:(n=t.query[e])&&"undefined"!==typeof r&&(n=n[r]),n},getQueryLast:function(e,t){var n=r.getQuery(e);return n?n[n.length-1]:t}};return r},u.makeLink=function(e,t,r){e=jQuery.isArray(e)?e.join("/"):e;var n=jQuery.param(t||{});return r=r||"",e+(n.length>0?"?"+n:"")+(r.length>0?"#"+r:"")},u.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},u.format=function(e){for(var t,r,n=/%./g,i=0,a=[],o=0;t=n.exec(e);){(r=e.substring(o,n.lastIndex-2)).length>0&&a.push(r),o=n.lastIndex;var s=t[0][1];switch(s){case"s":case"o":i<arguments.length?a.push(arguments[1+i++]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+s+"?>")}}return a.push(e.substring(o)),a.join("")},u.formatNumber=function(e,t,r,n){var i=e,a=isNaN(t=Math.abs(t))?2:t,o=void 0===r?",":r,s=void 0===n?".":n,u=i<0?"-":"",l=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",c=l.length>3?l.length%3:0;return u+(c?l.substr(0,c)+s:"")+l.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?o+Math.abs(i-l).toFixed(a).slice(2):"")},u.formatSize=function(e){return e=e>=1073741824?u.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?u.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?u.formatNumber(e/1024,0)+" KiB":u.formatNumber(e,0)+" bytes"},u.bytesFromIP=function(e){return-1!==e.indexOf(".")?u.bytesFromIPv4(e):-1!==e.indexOf(":")?u.bytesFromIPv6(e):null},u.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=u.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()},u.bytesFromIPv6=function(e){for(var t=0,r=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),n=u.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var a=u.hexToBytes(e[i]);a.length<2&&n.putByte(0),n.putBytes(a)}else n.fillWithByte(0,r),r=0;return n.getBytes()},u.bytesToIP=function(e){return 4===e.length?u.bytesToIPv4(e):16===e.length?u.bytesToIPv6(e):null},u.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")},u.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var a=u.bytesToHex(e[i]+e[i+1]);"0"===a[0]&&"0"!==a;)a=a.substr(1);if("0"===a){var o=r[r.length-1],s=t.length;o&&s===o.end+1?(o.end=s,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1)):r.push({start:s,end:s})}t.push(a)}if(r.length>0){var l=r[n];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),0===l.start&&t.unshift(""),7===l.end&&t.push(""))}return t.join(":")},u.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in u&&!e.update)return t(null,u.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return u.cores=navigator.hardwareConcurrency,t(null,u.cores);if("undefined"===typeof Worker)return u.cores=1,t(null,u.cores);if("undefined"===typeof Blob)return u.cores=2,t(null,u.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),r=t+4;Date.now()<r;);self.postMessage({st:t,et:r})}))}.toString(),")()"],{type:"application/javascript"}));!function e(n,i,a){if(0===i){var o=Math.floor(n.reduce((function(e,t){return e+t}),0)/n.length);return u.cores=Math.max(1,o),URL.revokeObjectURL(r),t(null,u.cores)}!function(e,t){for(var n=[],i=[],a=0;a<e;++a){var o=new Worker(r);o.addEventListener("message",(function(r){if(i.push(r.data),i.length===e){for(var a=0;a<e;++a)n[a].terminate();t(null,i)}})),n.push(o)}for(a=0;a<e;++a)n[a].postMessage(a)}(a,(function(t,r){n.push(function(e,t){for(var r=[],n=0;n<e;++n)for(var i=t[n],a=r[n]=[],o=0;o<e;++o)if(n!==o){var s=t[o];(i.st>s.st&&i.st<s.et||s.st>i.st&&s.st<i.et)&&a.push(o)}return r.reduce((function(e,t){return Math.max(e,t.length)}),0)}(a,r)),e(n,i-1,a)}))}([],5,16)}}).call(this,r(21),r(173).setImmediate,r(22),r(10).Buffer)},,function(e,t,r){"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,"a",(function(){return n}))},,,function(e,t,r){(t=e.exports=r(905)).Stream=t,t.Readable=t,t.Writable=r(909),t.Duplex=r(706),t.Transform=r(910),t.PassThrough=r(1210),t.finished=r(808),t.pipeline=r(1211)},,,function(e,t,r){(function(t){var n=r(680),i=r(816),a=r(1287),o=function(){},s=/^v?\.0/.test(t.version),u=function(e){return"function"===typeof e},l=function(e,t,r,l){l=n(l);var c=!1;e.on("close",(function(){c=!0})),i(e,{readable:t,writable:r},(function(e){if(e)return l(e);c=!0,l()}));var h=!1;return function(t){if(!c&&!h)return h=!0,function(e){return!!s&&!!a&&(e instanceof(a.ReadStream||o)||e instanceof(a.WriteStream||o))&&u(e.close)}(e)?e.close(o):function(e){return e.setHeader&&u(e.abort)}(e)?e.abort():u(e.destroy)?e.destroy():void l(t||new Error("stream was destroyed"))}},c=function(e){e()},h=function(e,t){return e.pipe(t)};e.exports=function(){var e,t=Array.prototype.slice.call(arguments),r=u(t[t.length-1]||o)&&t.pop()||o;if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new Error("pump requires two streams per minimum");var n=t.map((function(i,a){var o=a<t.length-1;return l(i,o,a>0,(function(t){e||(e=t),t&&n.forEach(c),o||(n.forEach(c),r(e))}))}));return t.reduce(h)}}).call(this,r(21))},,,,function(e,t,r){"use strict";(function(t){var n=r(694),i=r(127),a=r(320),o=r(873),s=r(1128),u=r(168),l=/^https?:\/\/[^/]+\/(ip(f|n)s)\/((\w+).*)/,c=/^\/(ip(f|n)s)\/((\w+).*)/,h=/^https?:\/\/([^/]+)\.(ip(?:f|n)s)\.[^/]+/;function f(e){try{return new u(e),!0}catch(t){return!1}}function d(e){if(!e)return!1;if(o.isMultiaddr(e))return!0;try{return new o(e),!0}catch(t){return!1}}function p(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=m(e);if(!i)return!1;var a=i.match(t);if(!a)return!1;if("ipfs"!==a[r])return!1;var o=a[n];return o&&t===h&&(o=o.toLowerCase()),f(o)}function y(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3?arguments[3]:void 0,i=m(e);if(!i)return!1;var a=i.match(t);if(!a)return!1;if("ipns"!==a[r])return!1;if(n&&t===h){var o=a[n];return f(o=o.toLowerCase())}return!0}function v(e){return"string"===typeof e}function m(e){return t.isBuffer(e)?n.encode(e):!!v(e)&&e}var g=function(e){return p(e,h,2,1)},_=function(e){return y(e,h,2,1)};e.exports={multihash:function(e){var r=m(e);try{var a=t.from(n.decode(r));return i.decode(a),!0}catch(o){return!1}},multiaddr:d,peerMultiaddr:function(e){return d(e)&&s.IPFS.matches(e)},cid:f,base32cid:function(e){return"base32"===function(e){try{return a.isEncoded(e)}catch(t){return!1}}(e)&&f(e)},ipfsSubdomain:g,ipnsSubdomain:_,subdomain:function(e){return g(e)||_(e)},subdomainPattern:h,ipfsUrl:function(e){return p(e,l)},ipnsUrl:function(e){return y(e,l)},url:function(e){return p(e,l)||y(e,l)},urlPattern:l,ipfsPath:function(e){return p(e,c)},ipnsPath:function(e){return y(e,c)},path:function(e){return p(e,c)||y(e,c)},pathPattern:c,urlOrPath:function(e){return p(e,l)||y(e,l)||p(e,c)||y(e,c)},cidPath:function(e){return v(e)&&!f(e)&&p("/ipfs/".concat(e),c)}}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(1212);function i(e){var t=function t(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function a(e){var t=function t(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}e.exports=n(i),e.exports.strict=n(a),i.proto=i((function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return a(this)},configurable:!0})}))},function(e,t,r){"use strict";(function(t){var n=r(168);e.exports=function(e){if(t.isBuffer(e))return new n(e).toString();if(n.isCID(e))return e.toString();if("string"!==typeof e)throw new Error("unexpected cid type: "+typeof e);return new n(e.split("/")[0]),e}}).call(this,r(10).Buffer)},,function(e,t,r){(function(n){r(767);var i=r(1263);function a(e){e.destroy?e.destroy():console.error("warning, stream-to-pull-stream: \nthe wrapped node-stream does not implement `destroy`, \nthis may cause resource leaks.")}function o(e,t,r){var o,s,u=!1;function l(){s||(s=!0,r&&r(!0===o?null:o))}function c(){u||(u=!0,f(),o?l():e(o=!0,l))}function h(t){f(),o||e(o=t,l)}function f(){t.on("finish",c),t.removeListener("close",c),t.removeListener("error",h)}t.on("close",c),t.on("finish",c),t.on("error",h),n.nextTick((function(){i((function(r){e(null,(function(e,n){if(o=o||e,!0===e)return t._isStdio?l():t.end();if(o=o||e)return a(t),l();t._isStdio?t.write(n,(function(){r()})):!1===t.write(n)?t.once("drain",r):r()}))}))}))}function s(e){var t,r=[],n=[],i=!1;function o(){for(;(r.length||t)&&n.length;)n.shift()(r.length?null:t,r.shift());!r.length&&i&&(i=!1,e.resume())}return e.on("data",(function(t){r.push(t),o(),r.length&&e.pause&&(i=!0,e.pause())})),e.on("end",(function(){t=!0,o()})),e.on("close",(function(){t=!0,o()})),e.on("error",(function(e){t=e,o()})),function(r,i){if(!i)throw new Error("*must* provide cb");if(r){function s(){for(;n.length;)n.shift()(r);i(r)}if(t)return s();e.once("close",s),a(e)}else n.push(i),o()}}var u=s,l=function(e,t){return function(r){return o(r,e,t)}},c=function(e){return s(e)};(t=e.exports=function(e,t){return e.writable&&e.write?e.readable?function(r){return o(r,e,t),s(e)}:l(e,t):c(e)}).sink=l,t.source=c,t.read=u,t.read1=s,t.read2=function(e){var t,r=!1,n=!1;function i(){var r=e.read();if(null!==r&&t){var n=t;t=null,n(null,r)}}return e.on("readable",(function(){n=!0,t&&i()})).on("end",(function(){r=!0,t&&t(r)})).on("error",(function(e){r=e,t&&t(r)})),function(e,a){t=a,r?a(r):n&&i()}},t.duplex=function(e,t){return{source:c(e),sink:l(e,t)}},t.transform=function(e){return function(t){var r=c(e);return l(e)(t),r}}}).call(this,r(21))},,,function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,"a",(function(){return n}))},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}r.d(t,"a",(function(){return i}))},function(e,t,r){"use strict";(function(t){var n=r(1129),i=r(796),a=r(91),o=r(694),s=r(313).proto((function(e){if(!(this instanceof s))return new s(e);if(null==e&&(e=""),e instanceof t)this.buffer=n.fromBuffer(e);else if("string"===typeof e||e instanceof String){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));this.buffer=n.fromString(e)}else{if(!(e.buffer&&e.protos&&e.protoCodes))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.buffer=n.fromBuffer(e.buffer)}}),{className:"Multiaddr",symbolName:"@multiformats/js-multiaddr/multiaddr"});s.prototype.toString=function(){return n.bufferToString(this.buffer)},s.prototype.toJSON=s.prototype.toString,s.prototype.toOptions=function(){var e={},t=this.toString().split("/");return e.family="ip4"===t[1]?"ipv4":"ipv6",e.host=t[2],e.transport=t[3],e.port=t[4],e},s.prototype.inspect=function(){return"<Multiaddr "+this.buffer.toString("hex")+" - "+n.bufferToString(this.buffer)+">"},s.prototype.protos=function(){return this.protoCodes().map((function(e){return Object.assign({},i(e))}))},s.prototype.protoCodes=function(){for(var e=[],t=this.buffer,r=0;r<t.length;){var o=a.decode(t,r),s=a.decode.bytes,u=i(o);r+=n.sizeForAddr(u,t.slice(r+s))+s,e.push(o)}return e},s.prototype.protoNames=function(){return this.protos().map((function(e){return e.name}))},s.prototype.tuples=function(){return n.bufferToTuples(this.buffer)},s.prototype.stringTuples=function(){var e=n.bufferToTuples(this.buffer);return n.tuplesToStringTuples(e)},s.prototype.encapsulate=function(e){return e=s(e),s(this.toString()+e.toString())},s.prototype.decapsulate=function(e){e=e.toString();var t=this.toString(),r=t.lastIndexOf(e);if(r<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return s(t.slice(0,r))},s.prototype.getPeerId=function(){var e=null;try{e=this.stringTuples().filter((function(e){if(e[0]===i.names.ipfs.code)return!0})).pop()[1],o.decode(e)}catch(t){e=null}return e},s.prototype.getPath=function(){var e=null;try{e=this.stringTuples().filter((function(e){if(i(e[0]).path)return!0}))[0][1]}catch(t){e=null}return e},s.prototype.equals=function(e){return this.buffer.equals(e.buffer)},s.prototype.nodeAddress=function(){var e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==e[0]&&41!==e[0]&&54!==e[0]&&55!==e[0])throw new Error("no protocol with name: \"'".concat(t[0],'\'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".'));if("tcp"!==r[2]&&"udp"!==r[2])throw new Error("no protocol with name: \"'".concat(t[1],'\'". Must have a valid transport protocol: "{tcp, udp}".'));return{family:41===e[0]||55===e[0]?6:4,address:r[1],port:r[3]}},s.fromNodeAddress=function(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");var r="IPv6"===e.family?"ip6":"ip4";return s("/"+[r,e.address,t,e.port].join("/"))},s.prototype.isThinWaistAddress=function(e){var t=(e||this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))},s.protocols=i,s.isName=function(e){return!!s.isMultiaddr(e)&&e.protos().some((function(e){return e.resolvable}))},s.resolve=function(e,t){return s.isMultiaddr(e)&&s.isName(e)?t(new Error("not implemented yet")):t(new Error("not a valid name"))},e.exports=s}).call(this,r(10).Buffer)},function(e,t,r){t.source=r(942),t.through=r(1289),t.sink=r(943),t.duplex=r(1290)},,,,,function(e,t,r){var n=r(174);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},function(e,t,r){"use strict";(function(n){var i=r(18),a=r(19),o=r(127),s=r(1140),u=r(169),l=r(901),c=r(313)(function(){function e(t,r,a){i(this,e),u(n.isBuffer(t),"invalid id provided"),r&&a&&u(r.public.bytes.equals(a.bytes),"inconsistent arguments"),this._id=t,this._idB58String=o.toB58String(this.id),this._privKey=r,this._pubKey=a}return a(e,[{key:"marshalPubKey",value:function(){if(this.pubKey)return s.marshalPublicKey(this.pubKey)}},{key:"marshalPrivKey",value:function(){if(this.privKey)return s.marshalPrivateKey(this.privKey)}},{key:"toPrint",value:function(){var e=this.toB58String();e.startsWith("Qm")&&(e=e.slice(2));var t=6;return e.length<t&&(t=e.length),"<peer.ID "+e.substr(0,t)+">"}},{key:"toJSON",value:function(){return{id:this.toB58String(),privKey:d(this.marshalPrivKey()),pubKey:d(this.marshalPubKey())}}},{key:"toHexString",value:function(){return o.toHexString(this.id)}},{key:"toBytes",value:function(){return this.id}},{key:"toB58String",value:function(){return this._idB58String}},{key:"isEqual",value:function(e){if(n.isBuffer(e))return this.id.equals(e);if(e.id)return this.id.equals(e.id);throw new Error("not valid Id")}},{key:"isValid",value:function(e){this.privKey&&this.privKey.public&&this.privKey.public.bytes&&n.isBuffer(this.pubKey.bytes)&&this.privKey.public.bytes.equals(this.pubKey.bytes)?e():e(new Error("Keys not match"))}},{key:"id",get:function(){return this._id},set:function(e){throw new Error("Id is immutable")}},{key:"privKey",get:function(){return this._privKey},set:function(e){this._privKey=e}},{key:"pubKey",get:function(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;var e=o.decode(this.id);return"identity"===e.name?(this._pubKey=s.unmarshalPublicKey(e.digest),this._pubKey):void 0},set:function(e){this._pubKey=e}}]),e}(),{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});t=e.exports=c;var h=function(e,t){if(e.bytes.length<=42){var r=o.encode(e.bytes,"identity");t(null,r)}else e.hash((function(e,r){t(e,r)}))},f=function(e,t,r){h(t,(function(n,i){null!=n?r(n):r(null,new c(i,e,t))}))};function d(e){if(e)return e.toString("base64")}t.create=function(e,t){"function"===typeof e&&(t=e,e={}),(e=e||{}).bits=e.bits||2048,e.keyType=e.keyType||"RSA",s.generateKeyPair(e.keyType,e.bits,(function(e,r){null!=e?t(e):f(r,r.public,t)}))},t.createFromHexString=function(e){return new c(o.fromHexString(e))},t.createFromBytes=function(e){return new c(e)},t.createFromB58String=function(e){return new c(o.fromB58String(e))},t.createFromPubKey=function(e,t){if("function"!==typeof t)throw new Error("callback is required");var r;try{var i=e;if("string"===typeof i&&(i=n.from(e,"base64")),!n.isBuffer(i))throw new Error("Supplied key is neither a base64 string nor a buffer");r=s.unmarshalPublicKey(i)}catch(a){return t(a)}f(null,r,t)},t.createFromPrivKey=function(e,t){if("function"!==typeof t)throw new Error("callback is required");var r=e;try{if("string"===typeof r&&(r=n.from(e,"base64")),!n.isBuffer(r))throw new Error("Supplied key is neither a base64 string nor a buffer")}catch(i){return t(i)}s.unmarshalPrivateKey(r,(function(e,r){null!=e?t(e):f(r,r.public,t)}))},t.createFromJSON=function(e,t){if("function"!==typeof t)throw new Error("callback is required");var r,i,a,u;try{r=o.fromB58String(e.id),i=e.privKey&&n.from(e.privKey,"base64"),a=e.pubKey&&n.from(e.pubKey,"base64"),u=a&&s.unmarshalPublicKey(a)}catch(f){return t(f)}i?l([function(e){return s.unmarshalPrivateKey(i,e)},function(e,t){h(e.public,(function(r,n){t(r,n,e)}))},function(e,t,r){u?h(u,(function(n,i){r(n,e,t,i)})):r(null,e,t)}],(function(e,n,i,a){return e?t(e):u&&!n.equals(a)?t(new Error("Public and private key do not match")):r&&!n.equals(r)?t(new Error("Id and private key do not match")):void t(null,new c(r,i,u))})):t(null,new c(r,null,u))},t.isPeerId=function(e){return Boolean("object"===typeof e&&e._id&&e._idB58String)}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(665);r(667),r(703);var i=e.exports=n.asn1=n.asn1||{};function a(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}i.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},i.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},i.create=function(e,t,r,a,o){if(n.util.isArray(a)){for(var s=[],u=0;u<a.length;++u)void 0!==a[u]&&s.push(a[u]);a=s}var l={tagClass:e,type:t,constructed:r,composed:r||n.util.isArray(a),value:a};return o&&"bitStringContents"in o&&(l.bitStringContents=o.bitStringContents,l.original=i.copy(l)),l},i.copy=function(e,t){var r;if(n.util.isArray(e)){r=[];for(var a=0;a<e.length;++a)r.push(i.copy(e[a],t));return r}return"string"===typeof e?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:i.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)},i.equals=function(e,t,r){if(n.util.isArray(e)){if(!n.util.isArray(t))return!1;if(e.length!==t.length)return!1;for(var a=0;a<e.length;++a)if(!i.equals(e[a],t[a]))return!1;return!0}if(typeof e!==typeof t)return!1;if("string"===typeof e)return e===t;var o=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&i.equals(e.value,t.value);return r&&r.includeBitStringContents&&(o=o&&e.bitStringContents===t.bitStringContents),o},i.getBerValueLength=function(e){var t=e.getByte();if(128!==t)return 128&t?e.getInt((127&t)<<3):t};function o(e,t,r,n){var s;a(e,t,2);var u=e.getByte();t--;var l=192&u,c=31&u;s=e.length();var h,f,d=function(e,t){var r=e.getByte();if(t--,128!==r){var n;if(128&r){var i=127&r;a(e,t,i),n=e.getInt(i<<3)}else n=r;if(n<0)throw new Error("Negative length: "+n);return n}}(e,t);if(t-=s-e.length(),void 0!==d&&d>t){if(n.strict){var p=new Error("Too few bytes to read ASN.1 value.");throw p.available=e.length(),p.remaining=t,p.requested=d,p}d=t}var y=32===(32&u);if(y)if(h=[],void 0===d)for(;;){if(a(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}s=e.length(),h.push(o(e,t,r+1,n)),t-=s-e.length()}else for(;d>0;)s=e.length(),h.push(o(e,d,r+1,n)),t-=s-e.length(),d-=s-e.length();if(void 0===h&&l===i.Class.UNIVERSAL&&c===i.Type.BITSTRING&&(f=e.bytes(d)),void 0===h&&n.decodeBitStrings&&l===i.Class.UNIVERSAL&&c===i.Type.BITSTRING&&d>1){var v=e.read,m=t,g=0;if(c===i.Type.BITSTRING&&(a(e,t,1),g=e.getByte(),t--),0===g)try{s=e.length();var _=o(e,t,r+1,{verbose:n.verbose,strict:!0,decodeBitStrings:!0}),b=s-e.length();t-=b,c==i.Type.BITSTRING&&b++;var w=_.tagClass;b!==d||w!==i.Class.UNIVERSAL&&w!==i.Class.CONTEXT_SPECIFIC||(h=[_])}catch(k){}void 0===h&&(e.read=v,t=m)}if(void 0===h){if(void 0===d){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");d=t}if(c===i.Type.BMPSTRING)for(h="";d>0;d-=2)a(e,t,2),h+=String.fromCharCode(e.getInt16()),t-=2;else h=e.getBytes(d)}var x=void 0===f?null:{bitStringContents:f};return i.create(l,c,y,h,x)}i.fromDer=function(e,t){return void 0===t&&(t={strict:!0,decodeBitStrings:!0}),"boolean"===typeof t&&(t={strict:t,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),"string"===typeof e&&(e=n.util.createBuffer(e)),o(e,e.length(),0,t)},i.toDer=function(e){var t=n.util.createBuffer(),r=e.tagClass|e.type,a=n.util.createBuffer(),o=!1;if("bitStringContents"in e&&(o=!0,e.original&&(o=i.equals(e,e.original))),o)a.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:a.putByte(0);for(var s=0;s<e.value.length;++s)void 0!==e.value[s]&&a.putBuffer(i.toDer(e.value[s]))}else if(e.type===i.Type.BMPSTRING)for(s=0;s<e.value.length;++s)a.putInt16(e.value.charCodeAt(s));else e.type===i.Type.INTEGER&&e.value.length>1&&(0===e.value.charCodeAt(0)&&0===(128&e.value.charCodeAt(1))||255===e.value.charCodeAt(0)&&128===(128&e.value.charCodeAt(1)))?a.putBytes(e.value.substr(1)):a.putBytes(e.value);if(t.putByte(r),a.length()<=127)t.putByte(127&a.length());else{var u=a.length(),l="";do{l+=String.fromCharCode(255&u),u>>>=8}while(u>0);t.putByte(128|l.length);for(s=l.length-1;s>=0;--s)t.putByte(l.charCodeAt(s))}return t.putBuffer(a),t},i.oidToDer=function(e){var t,r,i,a,o=e.split("."),s=n.util.createBuffer();s.putByte(40*parseInt(o[0],10)+parseInt(o[1],10));for(var u=2;u<o.length;++u){t=!0,r=[],i=parseInt(o[u],10);do{a=127&i,i>>>=7,t||(a|=128),r.push(a),t=!1}while(i>0);for(var l=r.length-1;l>=0;--l)s.putByte(r[l])}return s},i.derToOid=function(e){var t;"string"===typeof e&&(e=n.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var i=0;e.length()>0;)i<<=7,128&(r=e.getByte())?i+=127&r:(t+="."+(i+r),i=0);return t},i.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),a=parseInt(e.substr(6,2),10),o=parseInt(e.substr(8,2),10),s=0;if(e.length>11){var u=e.charAt(10),l=10;"+"!==u&&"-"!==u&&(s=parseInt(e.substr(10,2),10),l+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(a,o,s,0),l&&("+"===(u=e.charAt(l))||"-"===u)){var c=60*parseInt(e.substr(l+1,2),10)+parseInt(e.substr(l+4,2),10);c*=6e4,"+"===u?t.setTime(+t-c):t.setTime(+t+c)}return t},i.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),u=0,l=0,c=!1;"Z"===e.charAt(e.length-1)&&(c=!0);var h=e.length-5,f=e.charAt(h);"+"!==f&&"-"!==f||(l=60*parseInt(e.substr(h+1,2),10)+parseInt(e.substr(h+4,2),10),l*=6e4,"+"===f&&(l*=-1),c=!0);return"."===e.charAt(14)&&(u=1e3*parseFloat(e.substr(14),10)),c?(t.setUTCFullYear(r,n,i),t.setUTCHours(a,o,s,u),t.setTime(+t+l)):(t.setFullYear(r,n,i),t.setHours(a,o,s,u)),t},i.dateToUtcTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.dateToGeneralizedTime=function(e){if("string"===typeof e)return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z"},i.integerToDer=function(e){var t=n.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r},i.derToInteger=function(e){"string"===typeof e&&(e=n.util.createBuffer(e));var t=8*e.length();if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)},i.validate=function(e,t,r,a){var o=!1;if(e.tagClass!==t.tagClass&&"undefined"!==typeof t.tagClass||e.type!==t.type&&"undefined"!==typeof t.type)a&&(e.tagClass!==t.tagClass&&a.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&a.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));else if(e.constructed===t.constructed||"undefined"===typeof t.constructed){if(o=!0,t.value&&n.util.isArray(t.value))for(var s=0,u=0;o&&u<t.value.length;++u)o=t.value[u].optional||!1,e.value[s]&&((o=i.validate(e.value[s],t.value[u],r,a))?++s:t.value[u].optional&&(o=!0)),!o&&a&&a.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(o&&r)if(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{if(0!==e.bitStringContents.charCodeAt(0))throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else a&&a.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');return o};var s=/[^\\u0000-\\u00ff]/;i.prettyPrint=function(e,t,r){var a="";r=r||2,(t=t||0)>0&&(a+="\n");for(var o="",u=0;u<t*r;++u)o+=" ";switch(a+=o+"Tag: ",e.tagClass){case i.Class.UNIVERSAL:a+="Universal:";break;case i.Class.APPLICATION:a+="Application:";break;case i.Class.CONTEXT_SPECIFIC:a+="Context-Specific:";break;case i.Class.PRIVATE:a+="Private:"}if(e.tagClass===i.Class.UNIVERSAL)switch(a+=e.type,e.type){case i.Type.NONE:a+=" (None)";break;case i.Type.BOOLEAN:a+=" (Boolean)";break;case i.Type.INTEGER:a+=" (Integer)";break;case i.Type.BITSTRING:a+=" (Bit string)";break;case i.Type.OCTETSTRING:a+=" (Octet string)";break;case i.Type.NULL:a+=" (Null)";break;case i.Type.OID:a+=" (Object Identifier)";break;case i.Type.ODESC:a+=" (Object Descriptor)";break;case i.Type.EXTERNAL:a+=" (External or Instance of)";break;case i.Type.REAL:a+=" (Real)";break;case i.Type.ENUMERATED:a+=" (Enumerated)";break;case i.Type.EMBEDDED:a+=" (Embedded PDV)";break;case i.Type.UTF8:a+=" (UTF8)";break;case i.Type.ROID:a+=" (Relative Object Identifier)";break;case i.Type.SEQUENCE:a+=" (Sequence)";break;case i.Type.SET:a+=" (Set)";break;case i.Type.PRINTABLESTRING:a+=" (Printable String)";break;case i.Type.IA5String:a+=" (IA5String (ASCII))";break;case i.Type.UTCTIME:a+=" (UTC time)";break;case i.Type.GENERALIZEDTIME:a+=" (Generalized time)";break;case i.Type.BMPSTRING:a+=" (BMP String)"}else a+=e.type;if(a+="\n",a+=o+"Constructed: "+e.constructed+"\n",e.composed){var l=0,c="";for(u=0;u<e.value.length;++u)void 0!==e.value[u]&&(l+=1,c+=i.prettyPrint(e.value[u],t+1,r),u+1<e.value.length&&(c+=","));a+=o+"Sub values: "+l+c}else{if(a+=o+"Value: ",e.type===i.Type.OID){var h=i.derToOid(e.value);a+=h,n.pki&&n.pki.oids&&h in n.pki.oids&&(a+=" ("+n.pki.oids[h]+") ")}if(e.type===i.Type.INTEGER)try{a+=i.derToInteger(e.value)}catch(d){a+="0x"+n.util.bytesToHex(e.value)}else if(e.type===i.Type.BITSTRING){if(e.value.length>1?a+="0x"+n.util.bytesToHex(e.value.slice(1)):a+="(none)",e.value.length>0){var f=e.value.charCodeAt(0);1==f?a+=" (1 unused bit shown)":f>1&&(a+=" ("+f+" unused bits shown)")}}else e.type===i.Type.OCTETSTRING?(s.test(e.value)||(a+="("+e.value+") "),a+="0x"+n.util.bytesToHex(e.value)):e.type===i.Type.UTF8?a+=n.util.decodeUtf8(e.value):e.type===i.Type.PRINTABLESTRING||e.type===i.Type.IA5String?a+=e.value:s.test(e.value)?a+="0x"+n.util.bytesToHex(e.value):0===e.value.length?a+="[null]":a+=e.value}return a}},function(e,t,r){var n=r(665);e.exports=n.md=n.md||{},n.md.algorithms=n.md.algorithms||{}},function(e,t,r){"use strict";var n=r(675),i=r(744);e.exports=function(e,t){var r;n(e,i((function(e){r=e})),(function(e){return t(e,r)}))}},,,,,function(e,t,r){var n=r(665);n.pki=n.pki||{};var i=e.exports=n.pki.oids=n.oids=n.oids||{};function a(e,t){i[e]=t,i[t]=e}function o(e,t){i[e]=t}a("1.2.840.113549.1.1.1","rsaEncryption"),a("1.2.840.113549.1.1.4","md5WithRSAEncryption"),a("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),a("1.2.840.113549.1.1.7","RSAES-OAEP"),a("1.2.840.113549.1.1.8","mgf1"),a("1.2.840.113549.1.1.9","pSpecified"),a("1.2.840.113549.1.1.10","RSASSA-PSS"),a("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),a("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),a("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),a("1.3.101.112","EdDSA25519"),a("1.2.840.10040.4.3","dsa-with-sha1"),a("1.3.14.3.2.7","desCBC"),a("1.3.14.3.2.26","sha1"),a("2.16.840.1.101.3.4.2.1","sha256"),a("2.16.840.1.101.3.4.2.2","sha384"),a("2.16.840.1.101.3.4.2.3","sha512"),a("1.2.840.113549.2.5","md5"),a("1.2.840.113549.1.7.1","data"),a("1.2.840.113549.1.7.2","signedData"),a("1.2.840.113549.1.7.3","envelopedData"),a("1.2.840.113549.1.7.4","signedAndEnvelopedData"),a("1.2.840.113549.1.7.5","digestedData"),a("1.2.840.113549.1.7.6","encryptedData"),a("1.2.840.113549.1.9.1","emailAddress"),a("1.2.840.113549.1.9.2","unstructuredName"),a("1.2.840.113549.1.9.3","contentType"),a("1.2.840.113549.1.9.4","messageDigest"),a("1.2.840.113549.1.9.5","signingTime"),a("1.2.840.113549.1.9.6","counterSignature"),a("1.2.840.113549.1.9.7","challengePassword"),a("1.2.840.113549.1.9.8","unstructuredAddress"),a("1.2.840.113549.1.9.14","extensionRequest"),a("1.2.840.113549.1.9.20","friendlyName"),a("1.2.840.113549.1.9.21","localKeyId"),a("1.2.840.113549.1.9.22.1","x509Certificate"),a("1.2.840.113549.1.12.10.1.1","keyBag"),a("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),a("1.2.840.113549.1.12.10.1.3","certBag"),a("1.2.840.113549.1.12.10.1.4","crlBag"),a("1.2.840.113549.1.12.10.1.5","secretBag"),a("1.2.840.113549.1.12.10.1.6","safeContentsBag"),a("1.2.840.113549.1.5.13","pkcs5PBES2"),a("1.2.840.113549.1.5.12","pkcs5PBKDF2"),a("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),a("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),a("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),a("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),a("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),a("1.2.840.113549.2.7","hmacWithSHA1"),a("1.2.840.113549.2.8","hmacWithSHA224"),a("1.2.840.113549.2.9","hmacWithSHA256"),a("1.2.840.113549.2.10","hmacWithSHA384"),a("1.2.840.113549.2.11","hmacWithSHA512"),a("1.2.840.113549.3.7","des-EDE3-CBC"),a("2.16.840.1.101.3.4.1.2","aes128-CBC"),a("2.16.840.1.101.3.4.1.22","aes192-CBC"),a("2.16.840.1.101.3.4.1.42","aes256-CBC"),a("2.5.4.3","commonName"),a("2.5.4.5","serialName"),a("2.5.4.6","countryName"),a("2.5.4.7","localityName"),a("2.5.4.8","stateOrProvinceName"),a("2.5.4.9","streetAddress"),a("2.5.4.10","organizationName"),a("2.5.4.11","organizationalUnitName"),a("2.5.4.13","description"),a("2.5.4.15","businessCategory"),a("2.5.4.17","postalCode"),a("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),a("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),a("2.16.840.1.113730.1.1","nsCertType"),a("2.16.840.1.113730.1.13","nsComment"),o("2.5.29.1","authorityKeyIdentifier"),o("2.5.29.2","keyAttributes"),o("2.5.29.3","certificatePolicies"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.5","policyMapping"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.7","subjectAltName"),o("2.5.29.8","issuerAltName"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.10","basicConstraints"),o("2.5.29.11","nameConstraints"),o("2.5.29.12","policyConstraints"),o("2.5.29.13","basicConstraints"),a("2.5.29.14","subjectKeyIdentifier"),a("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),a("2.5.29.17","subjectAltName"),a("2.5.29.18","issuerAltName"),a("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.25","cRLDistributionPoints"),o("2.5.29.26","issuingDistributionPoint"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),a("2.5.29.31","cRLDistributionPoints"),a("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.34","policyConstraints"),a("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),a("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),a("1.3.6.1.4.1.11129.2.4.2","timestampList"),a("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),a("1.3.6.1.5.5.7.3.1","serverAuth"),a("1.3.6.1.5.5.7.3.2","clientAuth"),a("1.3.6.1.5.5.7.3.3","codeSigning"),a("1.3.6.1.5.5.7.3.4","emailProtection"),a("1.3.6.1.5.5.7.3.8","timeStamping")},function(e,t,r){var n=r(665);r(800),r(1153),r(1154),r(667),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},i=new Array(4),a=n.util.createBuffer();function o(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,i,!1),a.putInt32(i[0]),a.putInt32(i[1]),a.putInt32(i[2]),a.putInt32(i[3]),a.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var s=o(),u=null,l=n.util.globalScope,c=l.crypto||l.msCrypto;if(c&&c.getRandomValues&&(u=function(e){return c.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!u){if("undefined"===typeof window||window.document,s.collectInt(+new Date,32),"undefined"!==typeof navigator){var h="";for(var f in navigator)try{"string"==typeof navigator[f]&&(h+=navigator[f])}catch(d){}s.collect(h),h=null}t&&(t().mousemove((function(e){s.collectInt(e.clientX,16),s.collectInt(e.clientY,16)})),t().keypress((function(e){s.collectInt(e.charCode,8)})))}if(n.random)for(var f in s)n.random[f]=s[f];else n.random=s;n.random.createInstance=o,e.exports=n.random}("undefined"!==typeof jQuery?jQuery:null)},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(905),a=r(909);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(23),o=r(24),s=function(e){a(r,e);var t=o(r);function r(e){n(this,r);var i=Object.assign({},e||{},{objectMode:!0});return t.call(this,i)}return i(r,[{key:"_transform",value:function(e,t,r){if(!e.Hash)return r();r(null,{path:e.Name,hash:e.Hash,size:parseInt(e.Size,10)})}}]),r}(r(672).Transform);e.exports=s},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(912),a=r(916);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(919),a=r(923);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(930),a=r(934);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(936),a=r(940);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(944),a=r(948);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(953),a=r(957);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n={};function i(e,t,r){r||(r=Error);var i=function(e){var r,n;function i(r,n,i){return e.call(this,function(e,r,n){return"string"===typeof t?t:t(e,r,n)}(r,n,i))||this}return n=e,(r=i).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n,i}(r);i.prototype.name=r.name,i.prototype.code=e,n[e]=i}function a(e,t){if(Array.isArray(e)){var r=e.length;return e=e.map((function(e){return String(e)})),r>2?"one of ".concat(t," ").concat(e.slice(0,r-1).join(", "),", or ")+e[r-1]:2===r?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}i("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(e,t,r){var n,i,o,s;if("string"===typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,r){return(void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t}(e," argument"))s="The ".concat(e," ").concat(n," ").concat(a(t,"type"));else{var u=function(e,t,r){return"number"!==typeof r&&(r=0),!(r+t.length>e.length)&&-1!==e.indexOf(t,r)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(n," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof r)}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,r){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=l;var i=r(959),a=r(963);r(14)(l,i);for(var o=n(a.prototype),s=0;s<o.length;s++){var u=o[s];l.prototype[u]||(l.prototype[u]=a.prototype[u])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||t.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,r(21))},function(e,t,r){"use strict";var n=r(698);e.exports=function(e,t,r){"function"===typeof e.pipe?n(e,(function(e,n){if(e)return r(e);t(n,r)})):t(e,r)}},function(e,t,r){"use strict";var n=r(812);e.exports=function(e,t){var r=n(e,t);return function(e,t,n){r(e,t,(function(e,t){if(e)return n(e);n(null,t[0])}))}}},function(e,t,r){"use strict";(function(t){var n=r(18),i=r(19),a=r(168),o=r(169),s=r(313),u=r(974),l=function(){function e(t,r,i){n(this,e),o(i,"A link requires a cid to point to"),this._name=t||"",this._nameBuf=null,this._size=r,this._cid=new a(i),u.hidePrivateFields(this),u.addEnumerableGetters(this,["Hash","Name","Tsize"])}return i(e,[{key:"toString",value:function(){return"DAGLink <".concat(this._cid.toBaseEncodedString(),' - name: "').concat(this.Name,'", size: ').concat(this.Tsize,">")}},{key:"toJSON",value:function(){return this._json||(this._json=Object.freeze({name:this.Name,size:this.Tsize,cid:this.Hash.toBaseEncodedString()})),Object.assign({},this._json)}},{key:"Name",get:function(){return this._name},set:function(e){throw new Error("Can't set property: 'name' is immutable")}},{key:"nameAsBuffer",get:function(){return null!==this._nameBuf||(this._nameBuf=t.from(this._name)),this._nameBuf}},{key:"Tsize",get:function(){return this._size},set:function(e){throw new Error("Can't set property: 'size' is immutable")}},{key:"Hash",get:function(){return this._cid},set:function(e){throw new Error("Can't set property: 'cid' is immutable")}}]),e}();(e.exports=s(l,{className:"DAGLink",symbolName:"@ipld/js-ipld-dag-pb/daglink"})).util=r(1398)}).call(this,r(10).Buffer)},,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(665);if(r(696),r(799),r(703),r(1152),r(1155),r(704),r(667),"undefined"===typeof i)var i=n.jsbn.BigInteger;var a=n.util.isNodejs?r(801):null,o=n.asn1,s=n.util;n.pki=n.pki||{},e.exports=n.pki.rsa=n.rsa=n.rsa||{};var u=n.pki,l=[6,4,2,4,2,4,6,2],c={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},h={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},d=n.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},p=function(e){var t;if(!(e.algorithm in u.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=u.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),i=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);a.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),a.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var s=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(a),i.value.push(s),o.toDer(i).getBytes()},y=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var a;t.dP||(t.dP=t.d.mod(t.p.subtract(i.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(i.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{a=new i(n.util.bytesToHex(n.random.getBytes(t.n.bitLength()/8)),16)}while(a.compareTo(t.n)>=0||!a.gcd(t.n).equals(i.ONE));for(var o=(e=e.multiply(a.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);o.compareTo(s)<0;)o=o.add(t.p);var u=o.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return u=u.multiply(a.modInverse(t.n)).mod(t.n)};function v(e,t,r){var i=n.util.createBuffer(),a=Math.ceil(t.n.bitLength()/8);if(e.length>a-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=e.length,o.max=a-11,o}i.putByte(0),i.putByte(r);var s,u=a-3-e.length;if(0===r||1===r){s=0===r?0:255;for(var l=0;l<u;++l)i.putByte(s)}else for(;u>0;){var c=0,h=n.random.getBytes(u);for(l=0;l<u;++l)0===(s=h.charCodeAt(l))?++c:i.putByte(s);u=c}return i.putByte(0),i.putBytes(e),i}function m(e,t,r,i){var a=Math.ceil(t.n.bitLength()/8),o=n.util.createBuffer(e),s=o.getByte(),u=o.getByte();if(0!==s||r&&0!==u&&1!==u||!r&&2!=u||r&&0===u&&"undefined"===typeof i)throw new Error("Encryption block is invalid.");var l=0;if(0===u){l=a-3-i;for(var c=0;c<l;++c)if(0!==o.getByte())throw new Error("Encryption block is invalid.")}else if(1===u)for(l=0;o.length()>1;){if(255!==o.getByte()){--o.read;break}++l}else if(2===u)for(l=0;o.length()>1;){if(0===o.getByte()){--o.read;break}++l}if(0!==o.getByte()||l!==a-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function g(e,t,r){"function"===typeof t&&(r=t,t={});var a={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function o(){s(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?l(t,e.q):void s(e.qBits,l))}))}function s(e,t){n.prime.generateProbablePrime(e,a,t)}function l(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var a=e.p;e.p=e.q,e.q=a}if(0!==e.p.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.p=null,void o();if(0!==e.q.subtract(i.ONE).gcd(e.e).compareTo(i.ONE))return e.q=null,void s(e.qBits,l);if(e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(i.ONE))return e.p=e.q=null,void o();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void s(e.qBits,l);var c=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(a.prng=t.prng),o()}function _(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=n.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0===(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128===(128&r.charCodeAt(1)))?r.substr(1):r}function b(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function w(e){return n.util.isNodejs&&"function"===typeof a[e]}function x(e){return"undefined"!==typeof s.globalScope&&"object"===typeof s.globalScope.crypto&&"object"===typeof s.globalScope.crypto.subtle&&"function"===typeof s.globalScope.crypto.subtle[e]}function k(e){return"undefined"!==typeof s.globalScope&&"object"===typeof s.globalScope.msCrypto&&"object"===typeof s.globalScope.msCrypto.subtle&&"function"===typeof s.globalScope.msCrypto.subtle[e]}function E(e){for(var t=n.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r}u.rsa.encrypt=function(e,t,r){var a,o=r,s=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(o=2===r,a=v(e,t,r)):(a=n.util.createBuffer()).putBytes(e);for(var u=new i(a.toHex(),16),l=y(u,t,o).toString(16),c=n.util.createBuffer(),h=s-Math.ceil(l.length/2);h>0;)c.putByte(0),--h;return c.putBytes(n.util.hexToBytes(l)),c.getBytes()},u.rsa.decrypt=function(e,t,r,a){var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=o,s}var u=new i(n.util.createBuffer(e).toHex(),16);if(u.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=y(u,t,r).toString(16),c=n.util.createBuffer(),h=o-Math.ceil(l.length/2);h>0;)c.putByte(0),--h;return c.putBytes(n.util.hexToBytes(l)),!1!==a?m(c.getBytes(),t,r):c.getBytes()},u.rsa.createKeyPairGenerationState=function(e,t,r){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048;var a,o=(r=r||{}).prng||n.random,s={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},u=r.algorithm||"PRIMEINC";if("PRIMEINC"!==u)throw new Error("Invalid key generation algorithm: "+u);return(a={algorithm:u,state:0,bits:e,rng:s,eInt:t||65537,e:new i(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(a.eInt),a},u.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new i(null);r.fromInt(30);for(var n,a=0,o=function(e,t){return e|t},s=+new Date,c=0;null===e.keys&&(t<=0||c<t);){if(0===e.state){var h=null===e.p?e.pBits:e.qBits,f=h-1;0===e.pqState?(e.num=new i(h,e.rng),e.num.testBit(f)||e.num.bitwiseTo(i.ONE.shiftLeft(f),o,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),a=0,++e.pqState):1===e.pqState?e.num.bitLength()>h?e.pqState=0:e.num.isProbablePrime(b(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(l[a++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(i.ONE).gcd(e.e).compareTo(i.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(i.ONE),e.q1=e.q.subtract(i.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(i.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var d=e.e.modInverse(e.phi);e.keys={privateKey:u.rsa.setPrivateKey(e.n,e.e,d,e.p,e.q,d.mod(e.p1),d.mod(e.q1),e.q.modInverse(e.p)),publicKey:u.rsa.setPublicKey(e.n,e.e)}}c+=(n=+new Date)-s,s=n}return null!==e.keys},u.rsa.generateKeyPair=function(e,t,r,i){if(1===arguments.length?"object"===typeof e?(r=e,e=void 0):"function"===typeof e&&(i=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(i=t,t=void 0):"number"!==typeof t&&(r=t,t=void 0):(r=e,i=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof r&&(i=r,r=void 0):(i=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!n.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(i){if(w("generateKeyPair"))return a.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return i(e);i(null,{privateKey:u.privateKeyFromPem(r),publicKey:u.publicKeyFromPem(t)})}));if(x("generateKey")&&x("exportKey"))return s.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:E(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return s.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){i(e)})).then((function(e){if(e){var t=u.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(e)));i(null,{privateKey:t,publicKey:u.setRsaPublicKey(t.n,t.e)})}}));if(k("generateKey")&&k("exportKey")){var l=s.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:E(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return l.oncomplete=function(e){var t=e.target.result,r=s.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=u.privateKeyFromAsn1(o.fromDer(n.util.createBuffer(t)));i(null,{privateKey:r,publicKey:u.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){i(e)}},void(l.onerror=function(e){i(e)})}}else if(w("generateKeyPairSync")){var c=a.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:u.privateKeyFromPem(c.privateKey),publicKey:u.publicKeyFromPem(c.publicKey)}}var h=u.rsa.createKeyPairGenerationState(e,t,r);if(!i)return u.rsa.stepKeyPairGenerationState(h,0),h.keys;g(h,r,i)},u.setRsaPublicKey=u.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,i){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return v(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return n.pkcs1.encode_rsa_oaep(t,e,i)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var a=t.encode(e,r,!0);return u.rsa.encrypt(a,r,!0)},verify:function(e,t,n){"string"===typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=m(t,r,!0),e===o.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=m(t,r,!0))}});var i=u.rsa.decrypt(t,r,!0,!1);return n.verify(e,i,r.n.bitLength())}};return r},u.setRsaPrivateKey=u.rsa.setPrivateKey=function(e,t,r,i,a,o,s,l){var c={n:e,e:t,d:r,p:i,q:a,dP:o,dQ:s,qInv:l,decrypt:function(e,t,r){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var i=u.rsa.decrypt(e,c,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:m};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return n.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(i,c,!1)},sign:function(e,t){var r=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:p},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,c.n.bitLength());return u.rsa.encrypt(n,c,r)}};return c},u.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},u.privateKeyFromAsn1=function(e){var t,r,a,s,l,f,d,p,y={},v=[];if(o.validate(e,c,y,v)&&(e=o.fromDer(n.util.createBuffer(y.privateKey))),y={},v=[],!o.validate(e,h,y,v)){var m=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw m.errors=v,m}return t=n.util.createBuffer(y.privateKeyModulus).toHex(),r=n.util.createBuffer(y.privateKeyPublicExponent).toHex(),a=n.util.createBuffer(y.privateKeyPrivateExponent).toHex(),s=n.util.createBuffer(y.privateKeyPrime1).toHex(),l=n.util.createBuffer(y.privateKeyPrime2).toHex(),f=n.util.createBuffer(y.privateKeyExponent1).toHex(),d=n.util.createBuffer(y.privateKeyExponent2).toHex(),p=n.util.createBuffer(y.privateKeyCoefficient).toHex(),u.setRsaPrivateKey(new i(t,16),new i(r,16),new i(a,16),new i(s,16),new i(l,16),new i(f,16),new i(d,16),new i(p,16))},u.privateKeyToAsn1=u.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.qInv))])},u.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,d,t,r)){var a,s=o.derToOid(t.publicKeyOid);if(s!==u.oids.rsaEncryption)throw(a=new Error("Cannot read public key. Unknown OID.")).oid=s,a;e=t.rsaPublicKey}if(r=[],!o.validate(e,f,t,r))throw(a=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,a;var l=n.util.createBuffer(t.publicKeyModulus).toHex(),c=n.util.createBuffer(t.publicKeyExponent).toHex();return u.setRsaPublicKey(new i(l,16),new i(c,16))},u.publicKeyToAsn1=u.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(u.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[u.publicKeyToRSAPublicKey(e)])])},u.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,_(e.e))])}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(695),o=r(903).ensureMultiaddr,s=r(1202),u=r(169),l=function(){function e(t){n(this,e),u(t,"Missing peerId. Use Peer.create(cb) to create one"),this.id=t,this.multiaddrs=new s,this.protocols=new Set,this._connectedMultiaddr=void 0}return i(e,[{key:"connect",value:function(e){if(e=o(e),!this.multiaddrs.has(e)&&e.toString()!=="/ipfs/".concat(this.id.toB58String()))throw new Error("can't be connected to missing multiaddr from set");this._connectedMultiaddr=e}},{key:"disconnect",value:function(){this._connectedMultiaddr=void 0}},{key:"isConnected",value:function(){return this._connectedMultiaddr}}]),e}();l.create=function(e,t){if("function"===typeof e)return t=e,e=null,void a.create((function(e,r){if(e)return t(e);t(null,new l(r))}));"function"===typeof e.toJSON?t(null,new l(e)):a.createFromJSON(e,(function(e,r){return t(e,new l(r))}))},l.isPeerInfo=function(e){return Boolean("object"===typeof e&&e.id&&e.multiaddrs)},e.exports=l},function(e,t,r){(function(t){var n=r(672).Writable,i=r(14),a=Uint8Array;function o(e,t){if(!(this instanceof o))return new o(e,t);"function"===typeof e&&(t=e,e={}),e||(e={});var r=e.encoding,i=!1;r?"u8"!==(r=String(r).toLowerCase())&&"uint8"!==r||(r="uint8array"):i=!0,n.call(this,{objectMode:!0}),this.encoding=r,this.shouldInferEncoding=i,t&&this.on("finish",(function(){t(this.getBody())})),this.body=[]}function s(e){return"string"===typeof e||(t=e,/Array\]$/.test(Object.prototype.toString.call(t)))||e&&"function"===typeof e.subarray;var t}e.exports=o,i(o,n),o.prototype._write=function(e,t,r){this.body.push(e),r()},o.prototype.inferEncoding=function(e){var r=void 0===e?this.body[0]:e;return t.isBuffer(r)?"buffer":"undefined"!==typeof Uint8Array&&r instanceof Uint8Array?"uint8array":Array.isArray(r)?"array":"string"===typeof r?"string":"[object Object]"===Object.prototype.toString.call(r)?"object":"buffer"},o.prototype.getBody=function(){return this.encoding||0!==this.body.length?(this.shouldInferEncoding&&(this.encoding=this.inferEncoding()),"array"===this.encoding?function(e){for(var t=[],r=0;r<e.length;r++)t.push.apply(t,e[r]);return t}(this.body):"string"===this.encoding?function(e){for(var r=[],n=0;n<e.length;n++){var i=e[n];"string"===typeof i||t.isBuffer(i)?r.push(i):s(i)?r.push(t.from(i)):r.push(t.from(String(i)))}r=t.isBuffer(e[0])?(r=t.concat(r)).toString("utf8"):r.join("");return r}(this.body):"buffer"===this.encoding?function(e){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.isBuffer(i)?r.push(i):s(i)?r.push(t.from(i)):r.push(t.from(String(i)))}return t.concat(r)}(this.body):"uint8array"===this.encoding?function(e){for(var r=0,n=0;n<e.length;n++)"string"===typeof e[n]&&(e[n]=t.from(e[n])),r+=e[n].length;for(var i=new a(r),o=(n=0,0);n<e.length;n++)for(var s=e[n],u=0;u<s.length;u++)i[o++]=s[u];return i}(this.body):this.body):[]}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(672).Duplex,i=r(1213),a=r(766),o=r(680),s=r(1235),u=r(1258);function l(e,t){var r=e.path?encodeURIComponent(e.path):"",n={"Content-Disposition":'form-data; name="data'.concat(t,'"; filename="').concat(r,'"')};return e.content?e.symlink?n["Content-Type"]="application/symlink":n["Content-Type"]="application/octet-stream":n["Content-Type"]="application/x-directory",n}function c(e,t,r){return t in e?e[t]:r in e?e[r]:void 0}e.exports=function(e,t){return function(r){var h,f=!1,d=!1;r=r?Object.assign({},r,r.qs):{};var p=new u,y=new n({objectMode:!0});y._read=function(e){},y._write=function(e,t,n){var a=o(n);try{var u=s(e,r).map((function(e,t){return Object.assign({headers:l(e,t)},e)}));d=!0,i(u,(function(e,r){return p.write(e,t,r)}),(function(e){if(d=!1,e)return a(e);f&&p.end(),a()}))}catch(c){a(c)}},y.once("finish",(function(){f||(f=!0,d||p.end())}));var v=r.qs||{};v["cid-version"]=c(r,"cid-version","cidVersion"),v["raw-leaves"]=c(r,"raw-leaves","rawLeaves"),v["only-hash"]=c(r,"only-hash","onlyHash"),v["wrap-with-directory"]=c(r,"wrap-with-directory","wrapWithDirectory"),v.hash=c(r,"hash","hashAlg"),("trickle"===r.strategy||r.trickle)&&(v.trickle="true");var m={path:t,qs:v,args:r.args,multipart:!0,multipartBoundary:p._boundary,stream:!0,recursive:!0,progress:r.progress};return p.on("error",(function(e){y.emit("error",e)})),(h=e(m,(function(e,t){if(e)return y.emit("error",e);if(!t)return y.push(null);if(!a(t))return y.push(t),void y.push(null);if(t.on("error",(function(e){return y.emit("error",e)})),r.converter){t.on("data",(function(e){e.Bytes&&r.progress&&r.progress(e.Bytes)}));var n=new(0,r.converter);n.once("end",(function(){return y.push(null)})),n.on("data",(function(e){return y.push(e)})),t.pipe(n)}else t.on("data",(function(e){e.Bytes&&r.progress&&r.progress(e.Bytes),y.push(e)})),t.once("end",(function(){return y.push(null)}))}))).on("drain",(function(){return p.emit("drain")})),p.pipe(h),y}}},function(e,t){e.exports=!1},function(e,t,r){(t=e.exports=r(944)).Stream=t,t.Readable=t,t.Writable=r(948),t.Duplex=r(717),t.Transform=r(949),t.PassThrough=r(1300),t.finished=r(818),t.pipeline=r(1301)},function(e,t){e.exports=function(e){return e&&("string"==typeof e?function(t){return t[e]}:"object"===typeof e&&"function"===typeof e.exec?function(t){var r=e.exec(t);return r&&r[0]}:e)}},function(e,t,r){"use strict";e.exports=function(e,t){var r,n;function i(a){if(r=a,n)return i.abort();!function i(){for(var a=!0,o=!1;a;)if(o=!1,r(null,(function(s,u){if(o=!0,s=s||n){if(a=!1,t)t(!0===s?null:s);else if(s&&!0!==s)throw s}else e&&!1===e(u)||n?(a=!1,r(n||!0,t||function(){})):a||i()})),!o)return void(a=!1)}()}return i.abort=function(e,t){if("function"==typeof e&&(t=e,e=!0),n=e||!0,r)return r(n,t||function(){})},i}},function(e,t,r){"use strict";t.DAGNode=r(769),t.DAGLink=r(724),t.resolver=r(1413),t.util=r(771),t.codec=t.util.codec,t.defaultHashAlg=t.util.defaultHashAlg},,,,,,,,,function(e,t,r){var n=r(794);function i(t,r,a){return"undefined"!==typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,r){var i=n(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(r):a.value}},i(t,r,a||t)}e.exports=i},function(e){e.exports=JSON.parse('{"identity":0,"ip4":4,"tcp":6,"sha1":17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,"dccp":33,"murmur3-128":34,"murmur3-32":35,"ip6":41,"ip6zone":42,"path":47,"multicodec":48,"multihash":49,"multiaddr":50,"multibase":51,"dns":53,"dns4":54,"dns6":55,"dnsaddr":56,"protobuf":80,"cbor":81,"raw":85,"dbl-sha2-256":86,"rlp":96,"bencode":99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,"sctp":132,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"zcash-block":192,"zcash-tx":193,"stellar-block":208,"stellar-tx":209,"md4":212,"md5":213,"bmt":214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,"zeronet":230,"ed25519-pub":237,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,"udp":273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,"udt":301,"utp":302,"unix":400,"p2p":421,"ipfs":421,"https":443,"onion":444,"onion3":445,"garlic64":446,"garlic32":447,"tls":448,"quic":460,"ws":477,"wss":478,"p2p-websocket-star":479,"http":480,"json":512,"messagepack":513,"x11":4352,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46000,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332}')},function(e,t,r){"use strict";var n=r(1141),i=r(10).Buffer,a=r(1145);e.exports=function(e,t){if(t||(t={}),!e)throw new Error("Pass in a .proto string or a protobuf-schema parsed object");var r="object"!==typeof e||i.isBuffer(e)?n.parse(e):e,o=function(){var e=this;a(r,t.encodings||{}).forEach((function(t){e[t.name]=function(e){if(!e)return null;var t={};return Object.keys(e).forEach((function(r){t[r]=e[r].value})),t}(t.values)||t}))};return o.prototype.toString=function(){return n.stringify(r)},o.prototype.toJSON=function(){return r},new o}},function(e,t,r){var n=r(665);if(r(800),r(696),r(881),r(697),r(703),r(882),r(802),r(704),r(1156),r(742),r(667),"undefined"===typeof i)var i=n.jsbn.BigInteger;var a=n.asn1,o=n.pki=n.pki||{};e.exports=o.pbe=n.pbe=n.pbe||{};var s=o.oids,u={name:"EncryptedPrivateKeyInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},l={name:"PBES2Algorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},c={name:"pkcs-12PbeParams",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"iterations"}]};function h(e,t){return e.start().update(t).digest().getBytes()}function f(e){var t;if(e){if(!(t=o.oids[a.derToOid(e)])){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}}else t="hmacWithSHA1";return d(t)}function d(e){var t=n.md;switch(e){case"hmacWithSHA224":t=n.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}o.encryptPrivateKeyInfo=function(e,t,r){(r=r||{}).saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var i,u,l,c=n.random.getBytesSync(r.saltSize),h=r.count,f=a.integerToDer(h);if(0===r.algorithm.indexOf("aes")||"des"===r.algorithm){var p,y,v;switch(r.algorithm){case"aes128":i=16,p=16,y=s["aes128-CBC"],v=n.aes.createEncryptionCipher;break;case"aes192":i=24,p=16,y=s["aes192-CBC"],v=n.aes.createEncryptionCipher;break;case"aes256":i=32,p=16,y=s["aes256-CBC"],v=n.aes.createEncryptionCipher;break;case"des":i=8,p=8,y=s.desCBC,v=n.des.createEncryptionCipher;break;default:throw(x=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,x}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),g=d(m),_=n.pkcs5.pbkdf2(t,c,h,i,g),b=n.random.getBytesSync(p);(k=v(_)).start(b),k.update(a.toDer(e)),k.finish(),l=k.output.getBytes();var w=function(e,t,r,i){var s=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,e),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,t.getBytes())]);"hmacWithSHA1"!==i&&s.value.push(a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,n.util.hexToBytes(r.toString(16))),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(o.oids[i]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]));return s}(c,f,i,m);u=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.pkcs5PBES2).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.pkcs5PBKDF2).getBytes()),w]),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(y).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,b)])])])}else{var x;if("3des"!==r.algorithm)throw(x=new Error("Cannot encrypt private key. Unknown encryption algorithm.")).algorithm=r.algorithm,x;i=24;var k,E=new n.util.ByteBuffer(c);_=o.pbe.generatePkcs12Key(t,E,1,h,i),b=o.pbe.generatePkcs12Key(t,E,2,h,i);(k=n.des.createEncryptionCipher(_)).start(b),k.update(a.toDer(e)),k.finish(),l=k.output.getBytes(),u=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,c),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,f.getBytes())])])}return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[u,a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l)])},o.decryptPrivateKeyInfo=function(e,t){var r=null,i={},s=[];if(!a.validate(e,u,i,s)){var l=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw l.errors=s,l}var c=a.derToOid(i.encryptionOid),h=o.pbe.getCipher(c,i.encryptionParams,t),f=n.util.createBuffer(i.encryptedData);return h.update(f),h.finish()&&(r=a.fromDer(h.output)),r},o.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:a.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})},o.encryptedPrivateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==t.type){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return a.fromDer(t.body)},o.encryptRsaPrivateKey=function(e,t,r){if(!(r=r||{}).legacy){var i=o.wrapRsaPrivateKey(o.privateKeyToAsn1(e));return i=o.encryptPrivateKeyInfo(i,t,r),o.encryptedPrivateKeyToPem(i)}var s,u,l,c;switch(r.algorithm){case"aes128":s="AES-128-CBC",l=16,u=n.random.getBytesSync(16),c=n.aes.createEncryptionCipher;break;case"aes192":s="AES-192-CBC",l=24,u=n.random.getBytesSync(16),c=n.aes.createEncryptionCipher;break;case"aes256":s="AES-256-CBC",l=32,u=n.random.getBytesSync(16),c=n.aes.createEncryptionCipher;break;case"3des":s="DES-EDE3-CBC",l=24,u=n.random.getBytesSync(8),c=n.des.createEncryptionCipher;break;case"des":s="DES-CBC",l=8,u=n.random.getBytesSync(8),c=n.des.createEncryptionCipher;break;default:var h=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw h.algorithm=r.algorithm,h}var f=c(n.pbe.opensslDeriveBytes(t,u.substr(0,8),l));f.start(u),f.update(a.toDer(o.privateKeyToAsn1(e))),f.finish();var d={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:s,parameters:n.util.bytesToHex(u).toUpperCase()},body:f.output.getBytes()};return n.pem.encode(d)},o.decryptRsaPrivateKey=function(e,t){var r=null,i=n.pem.decode(e)[0];if("ENCRYPTED PRIVATE KEY"!==i.type&&"PRIVATE KEY"!==i.type&&"RSA PRIVATE KEY"!==i.type)throw(l=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".')).headerType=l,l;if(i.procType&&"ENCRYPTED"===i.procType.type){var s,u;switch(i.dekInfo.algorithm){case"DES-CBC":s=8,u=n.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,u=n.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,u=n.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,u=n.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,u=n.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,u=function(e){return n.rc2.createDecryptionCipher(e,40)};break;case"RC2-64-CBC":s=8,u=function(e){return n.rc2.createDecryptionCipher(e,64)};break;case"RC2-128-CBC":s=16,u=function(e){return n.rc2.createDecryptionCipher(e,128)};break;default:var l;throw(l=new Error('Could not decrypt private key; unsupported encryption algorithm "'+i.dekInfo.algorithm+'".')).algorithm=i.dekInfo.algorithm,l}var c=n.util.hexToBytes(i.dekInfo.parameters),h=u(n.pbe.opensslDeriveBytes(t,c.substr(0,8),s));if(h.start(c),h.update(n.util.createBuffer(i.body)),!h.finish())return r;r=h.output.getBytes()}else r=i.body;return null!==(r="ENCRYPTED PRIVATE KEY"===i.type?o.decryptPrivateKeyInfo(a.fromDer(r),t):a.fromDer(r))&&(r=o.privateKeyFromAsn1(r)),r},o.pbe.generatePkcs12Key=function(e,t,r,i,a,o){var s,u;if("undefined"===typeof o||null===o){if(!("sha1"in n.md))throw new Error('"sha1" hash algorithm unavailable.');o=n.md.sha1.create()}var l=o.digestLength,c=o.blockLength,h=new n.util.ByteBuffer,f=new n.util.ByteBuffer;if(null!==e&&void 0!==e){for(u=0;u<e.length;u++)f.putInt16(e.charCodeAt(u));f.putInt16(0)}var d=f.length(),p=t.length(),y=new n.util.ByteBuffer;y.fillWithByte(r,c);var v=c*Math.ceil(p/c),m=new n.util.ByteBuffer;for(u=0;u<v;u++)m.putByte(t.at(u%p));var g=c*Math.ceil(d/c),_=new n.util.ByteBuffer;for(u=0;u<g;u++)_.putByte(f.at(u%d));var b=m;b.putBuffer(_);for(var w=Math.ceil(a/l),x=1;x<=w;x++){var k=new n.util.ByteBuffer;k.putBytes(y.bytes()),k.putBytes(b.bytes());for(var E=0;E<i;E++)o.start(),o.update(k.getBytes()),k=o.digest();var S=new n.util.ByteBuffer;for(u=0;u<c;u++)S.putByte(k.at(u%l));var T=Math.ceil(p/c)+Math.ceil(d/c),A=new n.util.ByteBuffer;for(s=0;s<T;s++){var C=new n.util.ByteBuffer(b.getBytes(c)),I=511;for(u=S.length()-1;u>=0;u--)I>>=8,I+=S.at(u)+C.at(u),C.setAt(u,255&I);A.putBuffer(C)}b=A,h.putBuffer(k)}return h.truncate(h.length()-a),h},o.pbe.getCipher=function(e,t,r){switch(e){case o.oids.pkcs5PBES2:return o.pbe.getCipherForPBES2(e,t,r);case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case o.oids["pbewithSHAAnd40BitRC2-CBC"]:return o.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}},o.pbe.getCipherForPBES2=function(e,t,r){var i,s={},u=[];if(!a.validate(t,l,s,u))throw(i=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=u,i;if((e=a.derToOid(s.kdfOid))!==o.oids.pkcs5PBKDF2)throw(i=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.")).oid=e,i.supportedOids=["pkcs5PBKDF2"],i;if((e=a.derToOid(s.encOid))!==o.oids["aes128-CBC"]&&e!==o.oids["aes192-CBC"]&&e!==o.oids["aes256-CBC"]&&e!==o.oids["des-EDE3-CBC"]&&e!==o.oids.desCBC)throw(i=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.")).oid=e,i.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],i;var c,h,d=s.kdfSalt,p=n.util.createBuffer(s.kdfIterationCount);switch(p=p.getInt(p.length()<<3),o.oids[e]){case"aes128-CBC":c=16,h=n.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,h=n.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,h=n.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,h=n.des.createDecryptionCipher;break;case"desCBC":c=8,h=n.des.createDecryptionCipher}var y=f(s.prfOid),v=n.pkcs5.pbkdf2(r,d,p,c,y),m=s.encIv,g=h(v);return g.start(m),g},o.pbe.getCipherForPKCS12PBE=function(e,t,r){var i={},s=[];if(!a.validate(t,c,i,s))throw(y=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.")).errors=s,y;var u,l,h,d=n.util.createBuffer(i.salt),p=n.util.createBuffer(i.iterations);switch(p=p.getInt(p.length()<<3),e){case o.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,l=8,h=n.des.startDecrypting;break;case o.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,l=8,h=function(e,t){var r=n.rc2.createDecryptionCipher(e,40);return r.start(t,null),r};break;default:var y;throw(y=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.")).oid=e,y}var v=f(i.prfOid),m=o.pbe.generatePkcs12Key(r,d,1,p,u,v);return v.start(),h(m,o.pbe.generatePkcs12Key(r,d,2,p,l,v))},o.pbe.opensslDeriveBytes=function(e,t,r,i){if("undefined"===typeof i||null===i){if(!("md5"in n.md))throw new Error('"md5" hash algorithm unavailable.');i=n.md.md5.create()}null===t&&(t="");for(var a=[h(i,e+t)],o=16,s=1;o<r;++s,o+=16)a.push(h(i,a[s-1]+e+t));return a.join("").substr(0,r)}},function(e,t,r){var n=r(1163),i=r(1164);e.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t|=0;for(var r=Math.max(e.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=e[t+i];return n},e.exports=t.default},function(e,t,r){"use strict";var n=r(17).Buffer,i=r(1192);function a(){this.negative=0,this.words=null,this.length=0}a.fromNumber=function(e){var t=new a;return t.words=[67108863&e],t.length=1,t},a.fromBuffer=function(e){var t=new a;return t.words=new Array(10),t.words[0]=(3&e[28])<<24|e[29]<<16|e[30]<<8|e[31],t.words[1]=(15&e[25])<<22|e[26]<<14|e[27]<<6|e[28]>>>2,t.words[2]=(63&e[22])<<20|e[23]<<12|e[24]<<4|e[25]>>>4,t.words[3]=(255&e[19])<<18|e[20]<<10|e[21]<<2|e[22]>>>6,t.words[4]=(3&e[15])<<24|e[16]<<16|e[17]<<8|e[18],t.words[5]=(15&e[12])<<22|e[13]<<14|e[14]<<6|e[15]>>>2,t.words[6]=(63&e[9])<<20|e[10]<<12|e[11]<<4|e[12]>>>4,t.words[7]=(255&e[6])<<18|e[7]<<10|e[8]<<2|e[9]>>>6,t.words[8]=(3&e[2])<<24|e[3]<<16|e[4]<<8|e[5],t.words[9]=e[0]<<14|e[1]<<6|e[2]>>>2,t.length=10,t.strip()},a.prototype.toBuffer=function(){for(var e=this.words,t=this.length;t<10;++t)e[t]=0;return n.from([e[9]>>>14&255,e[9]>>>6&255,(63&e[9])<<2|e[8]>>>24&3,e[8]>>>16&255,e[8]>>>8&255,255&e[8],e[7]>>>18&255,e[7]>>>10&255,e[7]>>>2&255,(3&e[7])<<6|e[6]>>>20&63,e[6]>>>12&255,e[6]>>>4&255,(15&e[6])<<4|e[5]>>>22&15,e[5]>>>14&255,e[5]>>>6&255,(63&e[5])<<2|e[4]>>>24&3,e[4]>>>16&255,e[4]>>>8&255,255&e[4],e[3]>>>18&255,e[3]>>>10&255,e[3]>>>2&255,(3&e[3])<<6|e[2]>>>20&63,e[2]>>>12&255,e[2]>>>4&255,(15&e[2])<<4|e[1]>>>22&15,e[1]>>>14&255,e[1]>>>6&255,(63&e[1])<<2|e[0]>>>24&3,e[0]>>>16&255,e[0]>>>8&255,255&e[0]])},a.prototype.clone=function(){var e=new a;e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];return e.length=this.length,e.negative=this.negative,e},a.prototype.strip=function(){for(;this.length>1&&0===(0|this.words[this.length-1]);)this.length--;return this},a.prototype.normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},a.prototype.isEven=function(){return 0===(1&this.words[0])},a.prototype.isOdd=function(){return 1===(1&this.words[0])},a.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},a.prototype.ucmp=function(e){if(this.length!==e.length)return this.length>e.length?1:-1;for(var t=this.length-1;t>=0;--t)if(this.words[t]!==e.words[t])return this.words[t]>e.words[t]?1:-1;return 0},a.prototype.gtOne=function(){return this.length>1||this.words[0]>1},a.prototype.isOverflow=function(){return this.ucmp(a.n)>=0},a.prototype.isHigh=function(){return 1===this.ucmp(a.nh)},a.prototype.bitLengthGT256=function(){return this.length>10||10===this.length&&this.words[9]>4194303},a.prototype.iuaddn=function(e){this.words[0]+=e;for(var t=0;this.words[t]>67108863&&t<this.length;++t)this.words[t]-=67108864,this.words[t+1]+=1;return t===this.length&&(this.words[t]=1,this.length+=1),this},a.prototype.iadd=function(e){if(this.negative!==e.negative)return 0!==this.negative?(this.negative=0,this.isub(e),this.negative^=1):(e.negative=0,this.isub(e),e.negative=1),this.normSign();var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0,i=0;n<r.length;++n){var a=t.words[n]+r.words[n]+i;this.words[n]=67108863&a,i=a>>>26}for(;0!==i&&n<t.length;++n)a=t.words[n]+i,this.words[n]=67108863&a,i=a>>>26;if(this.length=t.length,0!==i)this.words[this.length++]=i;else if(t!==this)for(;n<t.length;++n)this.words[n]=t.words[n];return this},a.prototype.add=function(e){return this.clone().iadd(e)},a.prototype.isub=function(e){if(this.negative!==e.negative)return 0!==this.negative?(this.negative=0,this.iadd(e),this.negative=1):(e.negative=0,this.iadd(e),e.negative=1),this.normSign();var t,r,n=this.ucmp(e);if(0===n)return this.negative=0,this.words[0]=0,this.length=1,this;n>0?(t=this,r=e):(t=e,r=this);for(var i=0,a=0;i<r.length;++i){var o=t.words[i]-r.words[i]+a;a=o>>26,this.words[i]=67108863&o}for(;0!==a&&i<t.length;++i)a=(o=t.words[i]+a)>>26,this.words[i]=67108863&o;if(0===a&&i<t.length&&t!==this)for(;i<t.length;++i)this.words[i]=t.words[i];return this.length=Math.max(this.length,i),t!==this&&(this.negative^=1),this.strip().normSign()},a.prototype.sub=function(e){return this.clone().isub(e)},a.umulTo=function(e,t,r){r.length=e.length+t.length-1;var n=e.words[0]*t.words[0],i=n/67108864|0;r.words[0]=67108863&n;for(var a=1,o=r.length;a<o;a++){for(var s=i>>>26,u=67108863&i,l=Math.max(0,a-e.length+1),c=Math.min(a,t.length-1);l<=c;l++){var h=a-l,f=e.words[h]*t.words[l]+u;s+=f/67108864|0,u=67108863&f}r.words[a]=u,i=s}return 0!==i&&(r.words[r.length++]=i),r.strip()},a.umulTo10x10=Math.imul?i.umulTo10x10:a.umulTo,a.umulnTo=function(e,t,r){if(0===t)return r.words=[0],r.length=1,r;for(var n=0,i=0;n<e.length;++n){var a=e.words[n]*t+i;r.words[n]=67108863&a,i=a/67108864|0}return i>0?(r.words[n]=i,r.length=e.length+1):r.length=e.length,r},a.prototype.umul=function(e){var t=new a;return t.words=new Array(this.length+e.length),10===this.length&&10===e.length?a.umulTo10x10(this,e,t):1===this.length?a.umulnTo(e,this.words[0],t):1===e.length?a.umulnTo(this,e.words[0],t):a.umulTo(this,e,t)},a.prototype.isplit=function(e){e.length=Math.min(this.length,9);for(var t=0;t<e.length;++t)e.words[t]=this.words[t];if(this.length<=9)return this.words[0]=0,this.length=1,this;var r=this.words[9];for(e.words[e.length++]=4194303&r,t=10;t<this.length;++t){var n=this.words[t];this.words[t-10]=(4194303&n)<<4|r>>>22,r=n}return r>>>=22,this.words[t-10]=r,0===r&&this.length>10?this.length-=10:this.length-=9,this},a.prototype.fireduce=function(){return this.isOverflow()&&this.isub(a.n),this},a.prototype.ureduce=function(){var e=this.clone().isplit(a.tmp).umul(a.nc).iadd(a.tmp);return e.bitLengthGT256()&&(e=e.isplit(a.tmp).umul(a.nc).iadd(a.tmp)).bitLengthGT256()&&(e=e.isplit(a.tmp).umul(a.nc).iadd(a.tmp)),e.fireduce()},a.prototype.ishrn=function(e){for(var t=(1<<e)-1,r=26-e,n=this.length-1,i=0;n>=0;--n){var a=this.words[n];this.words[n]=i<<r|a>>>e,i=a&t}return this.length>1&&0===this.words[this.length-1]&&(this.length-=1),this},a.prototype.uinvm=function(){for(var e=this.clone(),t=a.n.clone(),r=a.fromNumber(1),n=a.fromNumber(0),i=a.fromNumber(0),o=a.fromNumber(1);e.isEven()&&t.isEven();){for(var s=1,u=1;0===(e.words[0]&u)&&0===(t.words[0]&u)&&s<26;++s,u<<=1);e.ishrn(s),t.ishrn(s)}for(var l=t.clone(),c=e.clone();!e.isZero();){for(var h=0,f=1;0===(e.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(e.ishrn(h);h-- >0;)(r.isOdd()||n.isOdd())&&(r.iadd(l),n.isub(c)),r.ishrn(1),n.ishrn(1);for(var d=0,p=1;0===(t.words[0]&p)&&d<26;++d,p<<=1);if(d>0)for(t.ishrn(d);d-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(l),o.isub(c)),i.ishrn(1),o.ishrn(1);e.ucmp(t)>=0?(e.isub(t),r.isub(i),n.isub(o)):(t.isub(e),i.isub(r),o.isub(n))}if(1===i.negative){i.negative=0;var y=i.ureduce();return y.negative^=1,y.normSign().iadd(a.n)}return i.ureduce()},a.prototype.imulK=function(){this.words[this.length]=0,this.words[this.length+1]=0,this.length+=2;for(var e=0,t=0;e<this.length;++e){var r=0|this.words[e];t+=977*r,this.words[e]=67108863&t,t=64*r+(t/67108864|0)}return 0===this.words[this.length-1]&&(this.length-=1,0===this.words[this.length-1]&&(this.length-=1)),this},a.prototype.redIReduce=function(){this.isplit(a.tmp).imulK().iadd(a.tmp),this.bitLengthGT256()&&this.isplit(a.tmp).imulK().iadd(a.tmp);var e=this.ucmp(a.p);return 0===e?(this.words[0]=0,this.length=1):e>0?this.isub(a.p):this.strip(),this},a.prototype.redNeg=function(){return this.isZero()?a.fromNumber(0):a.p.sub(this)},a.prototype.redAdd=function(e){return this.clone().redIAdd(e)},a.prototype.redIAdd=function(e){return this.iadd(e),this.ucmp(a.p)>=0&&this.isub(a.p),this},a.prototype.redIAdd7=function(){return this.iuaddn(7),this.ucmp(a.p)>=0&&this.isub(a.p),this},a.prototype.redSub=function(e){return this.clone().redISub(e)},a.prototype.redISub=function(e){return this.isub(e),0!==this.negative&&this.iadd(a.p),this},a.prototype.redMul=function(e){return this.umul(e).redIReduce()},a.prototype.redSqr=function(){return this.umul(this).redIReduce()},a.prototype.redSqrt=function(){if(this.isZero())return this.clone();for(var e=this.redSqr(),t=e.redSqr(),r=t.redSqr().redMul(t),n=r.redMul(e),i=n.redMul(this),a=i,o=0;o<54;++o)a=a.redSqr().redSqr().redSqr().redSqr().redMul(i);for(a=a.redSqr().redSqr().redSqr().redSqr().redMul(n),o=0;o<5;++o)a=a.redSqr().redSqr().redSqr().redSqr().redMul(i);return 0===(a=(a=a.redSqr().redSqr().redSqr().redSqr().redMul(r)).redSqr().redSqr().redSqr().redSqr().redSqr().redSqr().redMul(r)).redSqr().ucmp(this)?a:null},a.prototype.redInvm=function(){for(var e,t=this.clone(),r=a.p.clone(),n=a.fromNumber(1),i=a.fromNumber(0);t.gtOne()&&r.gtOne();){for(var o=0,s=1;0===(t.words[0]&s)&&o<26;++o,s<<=1);if(o>0)for(t.ishrn(o);o-- >0;)n.isOdd()&&n.iadd(a.p),n.ishrn(1);for(var u=0,l=1;0===(r.words[0]&l)&&u<26;++u,l<<=1);if(u>0)for(r.ishrn(u);u-- >0;)i.isOdd()&&i.iadd(a.p),i.ishrn(1);t.ucmp(r)>=0?(t.isub(r),n.isub(i)):(r.isub(t),i.isub(n))}return 0!==(e=1===t.length&&1===t.words[0]?n:i).negative&&e.iadd(a.p),0!==e.negative?(e.negative=0,e.redIReduce().redNeg()):e.redIReduce()},a.prototype.getNAF=function(e){for(var t=[],r=1<<e+1,n=r-1,i=r>>1,a=this.clone();!a.isZero();){for(var o=0,s=1;0===(a.words[0]&s)&&o<26;++o,s<<=1)t.push(0);if(0!==o)a.ishrn(o);else{var u=a.words[0]&n;if(u>=i)t.push(i-u),a.iuaddn(u-i).ishrn(1);else if(t.push(u),a.words[0]-=u,!a.isZero()){for(o=e-1;o>0;--o)t.push(0);a.ishrn(e)}}}return t},a.prototype.inspect=function(){if(this.isZero())return"0";for(var e=this.toBuffer().toString("hex"),t=0;"0"===e[t];++t);return e.slice(t)},a.n=a.fromBuffer(n.from("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","hex")),a.nh=a.n.clone().ishrn(1),a.nc=a.fromBuffer(n.from("000000000000000000000000000000014551231950B75FC4402DA1732FC9BEBF","hex")),a.p=a.fromBuffer(n.from("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","hex")),a.psn=a.p.sub(a.n),a.tmp=new a,a.tmp.words=new Array(10),a.fromNumber(1).words[3]=0,e.exports=a},function(e,t,r){"use strict";var n=function(e){return null!==e&&"object"===typeof e&&"function"===typeof e.pipe};n.writable=function(e){return n(e)&&!1!==e.writable&&"function"===typeof e._write&&"object"===typeof e._writableState},n.readable=function(e){return n(e)&&!1!==e.readable&&"function"===typeof e._read&&"object"===typeof e._readableState},n.duplex=function(e){return n.writable(e)&&n.readable(e)},n.transform=function(e){return n.duplex(e)&&"function"===typeof e._transform&&"object"===typeof e._transformState},e.exports=n},function(e,t,r){"use strict";e.exports=function e(t){var r=arguments.length;if("function"===typeof t&&1===t.length){for(var n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return function(t){if(null==n)throw new TypeError("partial sink should only be called once!");var i=n;switch(n=null,r){case 1:return e(t,i[0]);case 2:return e(t,i[0],i[1]);case 3:return e(t,i[0],i[1],i[2]);case 4:return e(t,i[0],i[1],i[2],i[3]);default:return i.unshift(t),e.apply(null,i)}}}var a=t;a&&"function"===typeof a.source&&(a=a.source);for(i=1;i<r;i++){var o=arguments[i];"function"===typeof o?a=o(a):o&&"object"===typeof o&&(o.sink(a),a=o.source)}return a}},function(e,t,r){"use strict";var n=r(965);e.exports=function(e,t){if(!e)return function(e,r){return e?n(r,e,t):r(!0)};Array.isArray(e)||(e=Object.keys(e).map((function(t){return e[t]})));var r=0;return function(i,a){if(i)return n(a,i,t);r>=e.length?a(!0):a(null,e[r++])}}},function(e,t,r){"use strict";(function(n){var i=r(18),a=r(19),o=r(169),s=r(313),u=r(1395),l=r(974),c=function(){function e(t,r,a){var s=this;i(this,e),0!==a&&o(a,"A DAGNode requires it's serialized size"),this._data=t||n.alloc(0),this._links=r,this._serializedSize=a,l.hidePrivateFields(this),l.addEnumerableGetters(this,["Data","Links"]),r.forEach((function(e,t){u(s,e.Name,t)}))}return a(e,[{key:"toJSON",value:function(){return this._json||(this._json=Object.freeze({data:this.Data,links:this._links.map((function(e){return e.toJSON()})),size:this.size})),Object.assign({},this._json)}},{key:"toString",value:function(){return'DAGNode <data: "'.concat(this.Data.toString("base64"),'", links: ').concat(this.Links.length,", size: ").concat(this.size,">")}},{key:"size",get:function(){return void 0===this._size&&(this._size=this._links.reduce((function(e,t){return e+t.Tsize}),this._serializedSize)),this._size},set:function(e){throw new Error("Can't set property: 'size' is immutable")}},{key:"Data",get:function(){return this._data},set:function(e){throw new Error("Can't set property: 'Data' is immutable")}},{key:"Links",get:function(){return this._links.map((function(e){return{Name:e.Name,Tsize:e.Tsize,Hash:e.Hash}}))},set:function(e){throw new Error("Can't set property: 'Links' is immutable")}}]),e}();(t=e.exports=s(c,{className:"DAGNode",symbolName:"@ipld/js-ipld-dag-pb/dagnode"})).create=r(770),t.clone=r(1410),t.addLink=r(1411),t.rmLink=r(1412)}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(1396),i=r(771).serialize,a=r(773).linkSort,o=r(769),s=r(724);e.exports=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if("string"===typeof e&&(e=t.from(e)),!t.isBuffer(e))throw new Error("Passed 'data' is not a buffer or a string!");r=r.map((function(e){return s.isDAGLink(e)?e:s.util.createDagLinkFromB58EncodedHash(e)})),r=n(r,a);var u=i({Data:e,Links:r});return new o(e,r,u.length)}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(n){var i=r(4),a=r(125),o=r(168),s=r(761)(r(1397)),u=r(724),l=r(769),c=r(1399),h=r(1404);(t=e.exports).codec=c.DAG_PB,t.defaultHashAlg=c.SHA2_256;var f=function(){var e=a(i.mark((function e(r,n){var a,s,u,l,f;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={cidVersion:1,hashAlg:t.defaultHashAlg},s=Object.assign(a,n),e.next=4,h(r,s.hashAlg);case 4:return u=e.sent,l=c.print[t.codec],f=new o(s.cidVersion,l,u),e.abrupt("return",f);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.serialize=function(e){var t=e.Data,r=e.Links||[];return!l.isDAGNode(e)&&r&&(r=r.map((function(e){return u.isDAGLink(e)?e:u.util.createDagLinkFromB58EncodedHash(e)}))),s.PBNode.encode(function(e){var t={};e.Data&&e.Data.length>0?t.Data=e.Data:t.Data=null;e.Links&&e.Links.length>0?t.Links=e.Links.map((function(e){return{Hash:e.Hash.buffer,Name:e.Name,Tsize:e.Tsize}})):t.Links=null;return t}({Data:t,Links:r}))},t.deserialize=function(e){var t=s.PBNode.decode(e),r=t.Links.map((function(e){return new u(e.Name,e.Tsize,e.Hash)})),i=null==t.Data?n.alloc(0):t.Data;return new l(i,r,e.length)},t.cid=f}).call(this,r(10).Buffer)},function(e){e.exports=JSON.parse('{"identity":0,"ip4":4,"tcp":6,"sha1":17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,"dccp":33,"murmur3-128":34,"murmur3-32":35,"ip6":41,"ip6zone":42,"path":47,"multicodec":48,"multihash":49,"multiaddr":50,"multibase":51,"dns":53,"dns4":54,"dns6":55,"dnsaddr":56,"protobuf":80,"cbor":81,"raw":85,"dbl-sha2-256":86,"rlp":96,"bencode":99,"dag-pb":112,"dag-cbor":113,"libp2p-key":114,"git-raw":120,"torrent-info":123,"torrent-file":124,"leofcoin-block":129,"leofcoin-tx":130,"leofcoin-pr":131,"sctp":132,"eth-block":144,"eth-block-list":145,"eth-tx-trie":146,"eth-tx":147,"eth-tx-receipt-trie":148,"eth-tx-receipt":149,"eth-state-trie":150,"eth-account-snapshot":151,"eth-storage-trie":152,"bitcoin-block":176,"bitcoin-tx":177,"zcash-block":192,"zcash-tx":193,"stellar-block":208,"stellar-tx":209,"md4":212,"md5":213,"bmt":214,"decred-block":224,"decred-tx":225,"ipld-ns":226,"ipfs-ns":227,"swarm-ns":228,"ipns-ns":229,"zeronet":230,"ed25519-pub":237,"dash-block":240,"dash-tx":241,"swarm-manifest":250,"swarm-feed":251,"udp":273,"p2p-webrtc-star":275,"p2p-webrtc-direct":276,"p2p-stardust":277,"p2p-circuit":290,"dag-json":297,"udt":301,"utp":302,"unix":400,"p2p":421,"ipfs":421,"https":443,"onion":444,"onion3":445,"garlic64":446,"garlic32":447,"tls":448,"quic":460,"ws":477,"wss":478,"p2p-websocket-star":479,"http":480,"json":512,"messagepack":513,"x11":4352,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46000,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"holochain-adr-v0":8417572,"holochain-adr-v1":8483108,"holochain-key-v0":9728292,"holochain-key-v1":9793828,"holochain-sig-v0":10645796,"holochain-sig-v1":10711332}')},function(e,t,r){"use strict";(function(n){var i=r(4),a=r(125),o=r(724),s=r(771),u=s.cid,l=s.serialize;t=e.exports;var c=function(){var e=a(i.mark((function e(t){var r,n,a,s=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},n=l(t),e.next=4,u(n);case 4:return a=e.sent,e.abrupt("return",new o(r.name||"",n.length,a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.cloneData=function(e){var t;return e.Data&&e.Data.length>0?(t=n.alloc(e.Data.length),e.Data.copy(t)):t=n.alloc(0),t},t.cloneLinks=function(e){return e.Links.slice()},t.linkSort=function(e,t){return n.compare(e.nameAsBuffer,t.nameAsBuffer)},t.toDAGLink=c}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(12).BigNumber;t.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},t.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},t.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},t.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},t.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},t.SHIFT32=Math.pow(2,32),t.SHIFT16=Math.pow(2,16),t.MAX_SAFE_HIGH=2097151,t.NEG_ONE=new n(-1),t.TEN=new n(10),t.TWO=new n(2),t.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5}},,,,,,,,,,,,,function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},,,,,,function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return n}));"undefined"!==typeof window&&window,"undefined"!==typeof e||window;var n="undefined"!==typeof document?document:{}}).call(this,r(22))},function(e,t,r){var n=r(314);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t,r){"use strict";function n(e){if("number"===typeof e){if(n.codes[e])return n.codes[e];throw new Error("no protocol with code: "+e)}if("string"===typeof e||e instanceof String){if(n.names[e])return n.names[e];throw new Error("no protocol with name: "+e)}throw new Error("invalid protocol id type: "+e)}var i=-1;function a(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}n.lengthPrefixedVarSize=i,n.V=i,n.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,i,"ip6zone"],[53,i,"dns","resolvable"],[54,i,"dns4","resolvable"],[55,i,"dns6","resolvable"],[56,i,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,i,"unix",!1,"path"],[421,i,"ipfs"],[421,i,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,i,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,i,"memory"]],n.names={},n.codes={},n.table.map((function(e){var t=a.apply(null,e);n.codes[t.code]=t,n.names[t.name]=t})),n.object=a,e.exports=n},function(e,t,r){"use strict";function n(e){if("number"===typeof e){if(n.codes[e])return n.codes[e];throw new Error("no protocol with code: "+e)}if("string"===typeof e||e instanceof String){if(n.names[e])return n.names[e];throw new Error("no protocol with name: "+e)}throw new Error("invalid protocol id type: "+e)}var i=-1;function a(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}n.lengthPrefixedVarSize=i,n.V=i,n.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,i,"ip6zone"],[53,i,"dns","resolvable"],[54,i,"dns4","resolvable"],[55,i,"dns6","resolvable"],[56,i,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,i,"unix",!1,"path"],[421,i,"p2p"],[421,i,"ipfs"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,i,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"]],n.names={},n.codes={},n.table.map((function(e){var t=a.apply(null,e);n.codes[t.code]=t,n.names[t.name]=t})),n.object=a,e.exports=n},function(e,t,r){"use strict";t.defined=function(e){return null!==e&&void 0!==e&&("number"!==typeof e||!isNaN(e))}},function(e,t,r){"use strict";e.exports="enum KeyType {\n  RSA = 0;\n  Ed25519 = 1;\n  Secp256k1 = 2;\n}\nmessage PublicKey {\n  required KeyType Type = 1;\n  required bytes Data = 2;\n}\nmessage PrivateKey {\n  required KeyType Type = 1;\n  required bytes Data = 2;\n}"},function(e,t,r){var n,i=r(665);e.exports=i.jsbn=i.jsbn||{};function a(e,t,r){this.data=[],null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function o(){return new a(null)}function s(e,t,r,n,i,a){for(var o=16383&t,s=t>>14;--a>=0;){var u=16383&this.data[e],l=this.data[e++]>>14,c=s*u+l*o;i=((u=o*u+((16383&c)<<14)+r.data[n]+i)>>28)+(c>>14)+s*l,r.data[n++]=268435455&u}return i}i.jsbn.BigInteger=a,"undefined"===typeof navigator?(a.prototype.am=s,n=28):"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=function(e,t,r,n,i,a){for(var o=32767&t,s=t>>15;--a>=0;){var u=32767&this.data[e],l=this.data[e++]>>15,c=s*u+l*o;i=((u=o*u+((32767&c)<<15)+r.data[n]+(1073741823&i))>>>30)+(c>>>15)+s*l+(i>>>30),r.data[n++]=1073741823&u}return i},n=30):"Netscape"!=navigator.appName?(a.prototype.am=function(e,t,r,n,i,a){for(;--a>=0;){var o=t*this.data[e++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=67108863&o}return i},n=26):(a.prototype.am=s,n=28),a.prototype.DB=n,a.prototype.DM=(1<<n)-1,a.prototype.DV=1<<n;a.prototype.FV=Math.pow(2,52),a.prototype.F1=52-n,a.prototype.F2=2*n-52;var u,l,c=new Array;for(u="0".charCodeAt(0),l=0;l<=9;++l)c[u++]=l;for(u="a".charCodeAt(0),l=10;l<36;++l)c[u++]=l;for(u="A".charCodeAt(0),l=10;l<36;++l)c[u++]=l;function h(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function f(e,t){var r=c[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=o();return t.fromInt(e),t}function p(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function y(e){this.m=e}function v(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function m(e,t){return e&t}function g(e,t){return e|t}function _(e,t){return e^t}function b(e,t){return e&~t}function w(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function x(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function k(){}function E(e){return e}function S(e){this.r2=o(),this.q3=o(),a.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}y.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},y.prototype.revert=function(e){return e},y.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},y.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},y.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},v.prototype.convert=function(e){var t=o();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(a.ZERO)>0&&this.m.subTo(t,t),t},v.prototype.revert=function(e){var t=o();return e.copyTo(t),this.reduce(t),t},v.prototype.reduce=function(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e.data[t],n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},v.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},v.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},a.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s},a.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0},a.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var s=8==r?255&e[n]:f(e,n);s<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&a.ZERO.subTo(this,this)},a.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t},a.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s},a.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s},a.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,a=(1<<i)-1,o=Math.floor(e/this.DB),s=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t.data[r+o+1]=this.data[r]>>i|s,s=(this.data[r]&a)<<n;for(r=o-1;r>=0;--r)t.data[r]=0;t.data[o]=s,t.t=this.t+o+1,t.s=this.s,t.clamp()},a.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,a=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)t.data[o-r-1]|=(this.data[o]&a)<<i,t.data[o-r]=this.data[o]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&a)<<i),t.t=this.t-r,t.clamp()}},a.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()},a.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&a.ZERO.subTo(t,t)},a.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()},a.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=o());var s=o(),u=this.s,l=e.s,c=this.DB-p(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var h=s.t,f=s.data[h-1];if(0!=f){var d=f*(1<<this.F1)+(h>1?s.data[h-2]>>this.F2:0),y=this.FV/d,v=(1<<this.F1)/d,m=1<<this.F2,g=r.t,_=g-h,b=null==t?o():t;for(s.dlShiftTo(_,b),r.compareTo(b)>=0&&(r.data[r.t++]=1,r.subTo(b,r)),a.ONE.dlShiftTo(h,b),b.subTo(s,s);s.t<h;)s.data[s.t++]=0;for(;--_>=0;){var w=r.data[--g]==f?this.DM:Math.floor(r.data[g]*y+(r.data[g-1]+m)*v);if((r.data[g]+=s.am(0,w,r,_,0,h))<w)for(s.dlShiftTo(_,b),r.subTo(b,r);r.data[g]<--w;)r.subTo(b,r)}null!=t&&(r.drShiftTo(h,t),u!=l&&a.ZERO.subTo(t,t)),r.t=h,r.clamp(),c>0&&r.rShiftTo(c,r),u<0&&a.ZERO.subTo(r,r)}}},a.prototype.invDigit=function(){if(this.t<1)return 0;var e=this.data[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},a.prototype.isEven=function(){return 0==(this.t>0?1&this.data[0]:this.s)},a.prototype.exp=function(e,t){if(e>4294967295||e<1)return a.ONE;var r=o(),n=o(),i=t.convert(this),s=p(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var u=r;r=n,n=u}return t.revert(r)},a.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,a="",o=this.t,s=this.DB-o*this.DB%t;if(o-- >0)for(s<this.DB&&(r=this.data[o]>>s)>0&&(i=!0,a=h(r));o>=0;)s<t?(r=(this.data[o]&(1<<s)-1)<<t-s,r|=this.data[--o]>>(s+=this.DB-t)):(r=this.data[o]>>(s-=t)&n,s<=0&&(s+=this.DB,--o)),r>0&&(i=!0),i&&(a+=h(r));return i?a:"0"},a.prototype.negate=function(){var e=o();return a.ZERO.subTo(this,e),e},a.prototype.abs=function(){return this.s<0?this.negate():this},a.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this.data[r]-e.data[r]))return t;return 0},a.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+p(this.data[this.t-1]^this.s&this.DM)},a.prototype.mod=function(e){var t=o();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(a.ZERO)>0&&e.subTo(t,t),t},a.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new y(t):new v(t),this.exp(e,r)},a.ZERO=d(0),a.ONE=d(1),k.prototype.convert=E,k.prototype.revert=E,k.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},k.prototype.sqrTo=function(e,t){e.squareTo(t)},S.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=o();return e.copyTo(t),this.reduce(t),t},S.prototype.revert=function(e){return e},S.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},S.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var T=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],A=(1<<26)/T[T.length-1];a.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},a.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),i=o(),a=o(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(e)+s},a.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,s=0,u=0;u<e.length;++u){var l=f(e,u);l<0?"-"==e.charAt(u)&&0==this.signum()&&(i=!0):(s=t*s+l,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(s,0)),i&&a.ZERO.subTo(this,this)},a.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(a.ONE.shiftLeft(e-1),g,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(a.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},a.prototype.bitwiseTo=function(e,t,r){var n,i,a=Math.min(e.t,this.t);for(n=0;n<a;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=a;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},a.prototype.changeBit=function(e,t){var r=a.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},a.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()},a.prototype.dMultiply=function(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},a.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}},a.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r.data[--i]=0;for(n=r.t-this.t;i<n;++i)r.data[i+this.t]=this.am(0,e.data[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e.data[i],r,i,0,t-i);r.clamp()},a.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},a.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r},a.prototype.millerRabin=function(e){var t=this.subtract(a.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n,i=t.shiftRight(r),o={nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(256*Math.random())}},s=0;s<e;++s){do{n=new a(this.bitLength(),o)}while(n.compareTo(a.ONE)<=0||n.compareTo(t)>=0);var u=n.modPow(i,this);if(0!=u.compareTo(a.ONE)&&0!=u.compareTo(t)){for(var l=1;l++<r&&0!=u.compareTo(t);)if(0==(u=u.modPowInt(2,this)).compareTo(a.ONE))return!1;if(0!=u.compareTo(t))return!1}}return!0},a.prototype.clone=function(){var e=o();return this.copyTo(e),e},a.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this.data[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this.data[0];if(0==this.t)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]},a.prototype.byteValue=function(){return 0==this.t?this.s:this.data[0]<<24>>24},a.prototype.shortValue=function(){return 0==this.t?this.s:this.data[0]<<16>>16},a.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this.data[0]<=0?0:1},a.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this.data[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this.data[e]&(1<<n)-1)<<8-n,r|=this.data[--e]>>(n+=this.DB-8)):(r=this.data[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},a.prototype.equals=function(e){return 0==this.compareTo(e)},a.prototype.min=function(e){return this.compareTo(e)<0?this:e},a.prototype.max=function(e){return this.compareTo(e)>0?this:e},a.prototype.and=function(e){var t=o();return this.bitwiseTo(e,m,t),t},a.prototype.or=function(e){var t=o();return this.bitwiseTo(e,g,t),t},a.prototype.xor=function(e){var t=o();return this.bitwiseTo(e,_,t),t},a.prototype.andNot=function(e){var t=o();return this.bitwiseTo(e,b,t),t},a.prototype.not=function(){for(var e=o(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e},a.prototype.shiftLeft=function(e){var t=o();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},a.prototype.shiftRight=function(e){var t=o();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},a.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this.data[e])return e*this.DB+w(this.data[e]);return this.s<0?this.t*this.DB:-1},a.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=x(this.data[r]^t);return e},a.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this.data[t]&1<<e%this.DB)},a.prototype.setBit=function(e){return this.changeBit(e,g)},a.prototype.clearBit=function(e){return this.changeBit(e,b)},a.prototype.flipBit=function(e){return this.changeBit(e,_)},a.prototype.add=function(e){var t=o();return this.addTo(e,t),t},a.prototype.subtract=function(e){var t=o();return this.subTo(e,t),t},a.prototype.multiply=function(e){var t=o();return this.multiplyTo(e,t),t},a.prototype.divide=function(e){var t=o();return this.divRemTo(e,t,null),t},a.prototype.remainder=function(e){var t=o();return this.divRemTo(e,null,t),t},a.prototype.divideAndRemainder=function(e){var t=o(),r=o();return this.divRemTo(e,t,r),new Array(t,r)},a.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),a=d(1);if(i<=0)return a;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new y(t):t.isEven()?new S(t):new v(t);var s=new Array,u=3,l=r-1,c=(1<<r)-1;if(s[1]=n.convert(this),r>1){var h=o();for(n.sqrTo(s[1],h);u<=c;)s[u]=o(),n.mulTo(h,s[u-2],s[u]),u+=2}var f,m,g=e.t-1,_=!0,b=o();for(i=p(e.data[g])-1;g>=0;){for(i>=l?f=e.data[g]>>i-l&c:(f=(e.data[g]&(1<<i+1)-1)<<l-i,g>0&&(f|=e.data[g-1]>>this.DB+i-l)),u=r;0==(1&f);)f>>=1,--u;if((i-=u)<0&&(i+=this.DB,--g),_)s[f].copyTo(a),_=!1;else{for(;u>1;)n.sqrTo(a,b),n.sqrTo(b,a),u-=2;u>0?n.sqrTo(a,b):(m=a,a=b,b=m),n.mulTo(b,s[f],a)}for(;g>=0&&0==(e.data[g]&1<<i);)n.sqrTo(a,b),m=a,a=b,b=m,--i<0&&(i=this.DB-1,--g)}return n.revert(a)},a.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return a.ZERO;for(var r=e.clone(),n=this.clone(),i=d(1),o=d(0),s=d(0),u=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(s.isEven()&&u.isEven()||(s.addTo(this,s),u.subTo(e,u)),s.rShiftTo(1,s)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(s,i),o.subTo(u,o)):(n.subTo(r,n),t&&s.subTo(i,s),u.subTo(o,u))}return 0!=n.compareTo(a.ONE)?a.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u},a.prototype.pow=function(e){return this.exp(e,new k)},a.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return t;for(i<a&&(a=i),a>0&&(t.rShiftTo(a,t),r.rShiftTo(a,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r},a.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r.data[0]<=T[T.length-1]){for(t=0;t<T.length;++t)if(r.data[0]==T[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<T.length;){for(var n=T[t],i=t+1;i<T.length&&n<A;)n*=T[i++];for(n=r.modInt(n);t<i;)if(n%T[t++]==0)return!1}return r.millerRabin(e)}},function(e,t,r){var n=r(665);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.aes.Algorithm(e,t)}))}r(878),r(879),r(667),e.exports=n.aes=n.aes||{},n.aes.startEncrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i},n.aes.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.aes.startDecrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i},n.aes.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.aes.Algorithm=function(e,t){c||h();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(e,t){return d(r._w,e,t,!1)},decrypt:function(e,t){return d(r._w,e,t,!0)}}}),r._init=!1},n.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t,r=e.key;if("string"!==typeof r||16!==r.length&&24!==r.length&&32!==r.length){if(n.util.isArray(r)&&(16===r.length||24===r.length||32===r.length)){t=r,r=n.util.createBuffer();for(var i=0;i<t.length;++i)r.putByte(t[i])}}else r=n.util.createBuffer(r);if(!n.util.isArray(r)){t=r,r=[];var a=t.length();if(16===a||24===a||32===a){a>>>=2;for(i=0;i<a;++i)r.push(t.getInt32())}}if(!n.util.isArray(r)||4!==r.length&&6!==r.length&&8!==r.length)throw new Error("Invalid key parameter.");var o=this.mode.name,s=-1!==["CFB","OFB","CTR","GCM"].indexOf(o);this._w=f(r,e.decrypt&&!s),this._init=!0}},n.aes._expandKey=function(e,t){return c||h(),f(e,t)},n.aes._updateBlock=d,i("AES-ECB",n.cipher.modes.ecb),i("AES-CBC",n.cipher.modes.cbc),i("AES-CFB",n.cipher.modes.cfb),i("AES-OFB",n.cipher.modes.ofb),i("AES-CTR",n.cipher.modes.ctr),i("AES-GCM",n.cipher.modes.gcm);var a,o,s,u,l,c=!1;function h(){c=!0,s=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;a=new Array(256),o=new Array(256),u=new Array(4),l=new Array(4);for(t=0;t<4;++t)u[t]=new Array(256),l[t]=new Array(256);var r,n,i,h,f,d,p,y=0,v=0;for(t=0;t<256;++t){h=(h=v^v<<1^v<<2^v<<3^v<<4)>>8^255&h^99,a[y]=h,o[h]=y,d=(f=e[h])<<24^h<<16^h<<8^h^f,p=((r=e[y])^(n=e[r])^(i=e[n]))<<24^(y^i)<<16^(y^n^i)<<8^y^r^i;for(var m=0;m<4;++m)u[m][y]=d,l[m][h]=p,d=d<<24|d>>>8,p=p<<24|p>>>8;0===y?y=v=1:(y=r^e[e[e[r^i]]],v^=e[e[v]])}}function f(e,t){for(var r,n=e.slice(0),i=1,o=n.length,u=4*(o+6+1),c=o;c<u;++c)r=n[c-1],c%o===0?(r=a[r>>>16&255]<<24^a[r>>>8&255]<<16^a[255&r]<<8^a[r>>>24]^s[i]<<24,i++):o>6&&c%o===4&&(r=a[r>>>24]<<24^a[r>>>16&255]<<16^a[r>>>8&255]<<8^a[255&r]),n[c]=n[c-o]^r;if(t){for(var h,f=l[0],d=l[1],p=l[2],y=l[3],v=n.slice(0),m=(c=0,(u=n.length)-4);c<u;c+=4,m-=4)if(0===c||c===u-4)v[c]=n[m],v[c+1]=n[m+3],v[c+2]=n[m+2],v[c+3]=n[m+1];else for(var g=0;g<4;++g)h=n[m+g],v[c+(3&-g)]=f[a[h>>>24]]^d[a[h>>>16&255]]^p[a[h>>>8&255]]^y[a[255&h]];n=v}return n}function d(e,t,r,n){var i,s,c,h,f,d,p,y,v,m,g,_,b=e.length/4-1;n?(i=l[0],s=l[1],c=l[2],h=l[3],f=o):(i=u[0],s=u[1],c=u[2],h=u[3],f=a),d=t[0]^e[0],p=t[n?3:1]^e[1],y=t[2]^e[2],v=t[n?1:3]^e[3];for(var w=3,x=1;x<b;++x)m=i[d>>>24]^s[p>>>16&255]^c[y>>>8&255]^h[255&v]^e[++w],g=i[p>>>24]^s[y>>>16&255]^c[v>>>8&255]^h[255&d]^e[++w],_=i[y>>>24]^s[v>>>16&255]^c[d>>>8&255]^h[255&p]^e[++w],v=i[v>>>24]^s[d>>>16&255]^c[p>>>8&255]^h[255&y]^e[++w],d=m,p=g,y=_;r[0]=f[d>>>24]<<24^f[p>>>16&255]<<16^f[y>>>8&255]<<8^f[255&v]^e[++w],r[n?3:1]=f[p>>>24]<<24^f[y>>>16&255]<<16^f[v>>>8&255]<<8^f[255&d]^e[++w],r[2]=f[y>>>24]<<24^f[v>>>16&255]<<16^f[d>>>8&255]<<8^f[255&p]^e[++w],r[n?1:3]=f[v>>>24]<<24^f[d>>>16&255]<<16^f[p>>>8&255]<<8^f[255&y]^e[++w]}function p(e){var t,r="AES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof n.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,i.call(t,r)},t}},,function(e,t,r){var n=r(665);r(667);var i=e.exports=n.pem=n.pem||{};function a(e){for(var t=e.name+": ",r=[],n=function(e,t){return" "+t},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+"\r\n";var a=0,o=-1;for(i=0;i<t.length;++i,++a)if(a>65&&-1!==o){var s=t[o];","===s?(++o,t=t.substr(0,o)+"\r\n "+t.substr(o)):t=t.substr(0,o)+"\r\n"+s+t.substr(o+1),a=i-o-1,o=-1,++i}else" "!==t[i]&&"\t"!==t[i]&&","!==t[i]||(o=i);return t}function o(e){return e.replace(/^\s+/,"")}i.encode=function(e,t){t=t||{};var r,i="-----BEGIN "+e.type+"-----\r\n";if(e.procType&&(i+=a(r={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]})),e.contentDomain&&(i+=a(r={name:"Content-Domain",values:[e.contentDomain]})),e.dekInfo&&(r={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&r.values.push(e.dekInfo.parameters),i+=a(r)),e.headers)for(var o=0;o<e.headers.length;++o)i+=a(e.headers[o]);return e.procType&&(i+="\r\n"),i+=n.util.encode64(e.body,t.maxline||64)+"\r\n",i+="-----END "+e.type+"-----\r\n"},i.decode=function(e){for(var t,r=[],i=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,a=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,s=/\r?\n/;t=i.exec(e);){var u={type:t[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:n.util.decode64(t[3])};if(r.push(u),t[2]){for(var l=t[2].split(s),c=0;t&&c<l.length;){for(var h=l[c].replace(/\s+$/,""),f=c+1;f<l.length;++f){var d=l[f];if(!/\s/.test(d[0]))break;h+=d,c=f}if(t=h.match(a)){for(var p={name:t[1],values:[]},y=t[2].split(","),v=0;v<y.length;++v)p.values.push(o(y[v]));if(u.procType)if(u.contentDomain||"Content-Domain"!==p.name)if(u.dekInfo||"DEK-Info"!==p.name)u.headers.push(p);else{if(0===p.values.length)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');u.dekInfo={algorithm:y[0],parameters:y[1]||null}}else u.contentDomain=y[0]||"";else{if("Proc-Type"!==p.name)throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(2!==p.values.length)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');u.procType={version:y[0],type:y[1]}}}++c}if("ENCRYPTED"===u.procType&&!u.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(0===r.length)throw new Error("Invalid PEM formatted message.");return r}},function(e,t,r){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.hasNextTick=t.hasSetImmediate=void 0,t.fallback=c,t.wrap=h;var i,a=r(764),o=(i=a)&&i.__esModule?i:{default:i};var s,u=t.hasSetImmediate="function"===typeof e&&e,l=t.hasNextTick="object"===typeof n&&"function"===typeof n.nextTick;function c(e){setTimeout(e,0)}function h(e){return function(t){var r=(0,o.default)(arguments,1);e((function(){t.apply(null,r)}))}}s=u?e:l?n.nextTick:c,t.default=h(s)}).call(this,r(173).setImmediate,r(21))},function(e,t,r){"use strict";e.exports=function(e,t){return e.then((function(e){t(null,e)}),(function(e){t(e)}))}},function(e,t,r){"use strict";e.exports=self.crypto||self.msCrypto},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){if(null===e)throw new Error("Callback was already called.");var t=e;e=null,t.apply(this,arguments)}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=void 0;var n,i=r(1196),a=(n=i)&&n.__esModule?n:{default:n};var o="function"===typeof Symbol;function s(e){return o&&"AsyncFunction"===e[Symbol.toStringTag]}t.default=function(e){return s(e)?(0,a.default)(e):e},t.isAsync=s},function(e,t,r){"use strict";var n=r(705).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t){function r(e){return"function"===typeof e}function n(e){return r(e)&&2===e.length}function i(e){return r(e)&&1===e.length}t.isDuplex=function(e){return"object"===typeof e&&n(e.source)&&i(e.sink)},t.isSource=n,t.isSink=i},function(e,t,r){"use strict";var n=r(708).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){"use strict";var n=r(710).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){"use strict";var n=r(680),i=r(744),a=r(745);e.exports=function(e,t){var r=a(e,t);return function(e,t,a){var o=n(a),s=r(t),u=i((function(e){return o(null,e)}));s.once("error",o),s.pipe(u),s.write(e),s.end()}}},function(e,t,r){"use strict";var n=r(925),i=n.URLWithLegacySupport,a=n.format,o=n.URLSearchParams,s=n.defaultBase,u=r(1266);e.exports={URL:i,URLSearchParams:o,format:a,relative:u,defaultBase:s}},function(e,t,r){"use strict";var n=r(712).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){"use strict";var n=r(714).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){(function(t){var n=r(680),i=function(){};e.exports=function e(r,a,o){if("function"===typeof a)return e(r,null,a);a||(a={}),o=n(o||i);var s=r._writableState,u=r._readableState,l=a.readable||!1!==a.readable&&r.readable,c=a.writable||!1!==a.writable&&r.writable,h=!1,f=function(){r.writable||d()},d=function(){c=!1,l||o.call(r)},p=function(){l=!1,c||o.call(r)},y=function(e){o.call(r,e?new Error("exited with error code: "+e):null)},v=function(e){o.call(r,e)},m=function(){t.nextTick(g)},g=function(){if(!h)return(!l||u&&u.ended&&!u.destroyed)&&(!c||s&&s.ended&&!s.destroyed)?void 0:o.call(r,new Error("premature close"))},_=function(){r.req.on("finish",d)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(r)?c&&!s&&(r.on("end",f),r.on("close",f)):(r.on("complete",d),r.on("abort",m),r.req?_():r.on("request",_)),function(e){return e.stdio&&Array.isArray(e.stdio)&&3===e.stdio.length}(r)&&r.on("exit",y),r.on("end",p),r.on("finish",d),!1!==a.error&&r.on("error",v),r.on("close",m),function(){h=!0,r.removeListener("complete",d),r.removeListener("abort",m),r.removeListener("request",_),r.req&&r.req.removeListener("finish",d),r.removeListener("end",f),r.removeListener("close",f),r.removeListener("finish",d),r.removeListener("exit",y),r.removeListener("end",p),r.removeListener("error",v),r.removeListener("close",m)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(23),o=r(24),s=r(675),u=r(1292),l=function(e){a(r,e);var t=o(r);function r(e){n(this,r);var i=Object.assign(e||{},{objectMode:!0});return t.call(this,i)}return i(r,[{key:"_read",value:function(){}}]),r}(r(672).Readable);e.exports=function(e,t){var r=new l,n=u.extract();n.on("entry",(function(e,t,n){t.on("end",n),"directory"!==e.type?r.push({path:e.name,content:t}):(r.push({path:e.name}),t.resume())})).on("finish",(function(){return r.push(null)})),s(e,n),t(null,r)}},function(e,t,r){"use strict";var n=r(716).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){(function(t){var n=r(672).Transform,i=r(14);function a(e){n.call(this,e),this._destroyed=!1}function o(e,t,r){r(null,e)}function s(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=o),"function"!=typeof n&&(n=null),e(t,r,n)}}i(a,n),a.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var r=this;t.nextTick((function(){e&&r.emit("error",e),r.emit("close")}))}},e.exports=s((function(e,t,r){var n=new a(e);return n._transform=t,r&&(n._flush=r),n})),e.exports.ctor=s((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=Object.assign({},e,t),a.call(this,this.options)}return i(n,a),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),e.exports.obj=s((function(e,t,r){var n=new a(Object.assign({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this,r(21))},function(e,t,r){"use strict";function n(e){return e}var i=r(748);e.exports=function(e){return e?(e=i(e),function(t){return function(r,n){t(r,(function(r,i){try{i=r?null:e(i)}catch(a){return t(a,(function(){return n(a)}))}n(r,i)}))}}):n}},function(e,t,r){"use strict";var n,i=SyntaxError,a=Function,o=TypeError,s=function(e){try{return Function('"use strict"; return ('+e+").constructor;")()}catch(t){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(I){u=null}var l=function(){throw new o},c=u?function(){try{return l}catch(e){try{return u(arguments,"callee").get}catch(t){return l}}}():l,h=r(1313)(),f=Object.getPrototypeOf||function(e){return e.__proto__},d=s("async function* () {}"),p=d?d.prototype:n,y=p?p.prototype:n,v="undefined"===typeof Uint8Array?n:f(Uint8Array),m={"%AggregateError%":"undefined"===typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":s("async function () {}"),"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":y?f(y):n,"%Atomics%":"undefined"===typeof Atomics?n:Atomics,"%BigInt%":"undefined"===typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":s("function* () {}"),"%Int8Array%":"undefined"===typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?f(f([][Symbol.iterator]())):n,"%JSON%":"object"===typeof JSON?JSON:n,"%Map%":"undefined"===typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&h?f((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?n:Promise,"%Proxy%":"undefined"===typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&h?f((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?f(""[Symbol.iterator]()):n,"%Symbol%":h?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":c,"%TypedArray%":v,"%TypeError%":o,"%Uint8Array%":"undefined"===typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?n:WeakSet},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_=r(822),b=r(1316),w=_.call(Function.call,Array.prototype.concat),x=_.call(Function.apply,Array.prototype.splice),k=_.call(Function.call,String.prototype.replace),E=_.call(Function.call,String.prototype.slice),S=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,A=function(e){var t=E(e,0,1),r=E(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return k(e,S,(function(e,t,r,i){n[n.length]=r?k(i,T,"$1"):t||e})),n},C=function(e,t){var r,n=e;if(b(g,n)&&(n="%"+(r=g[n])[0]+"%"),b(m,n)){var a=m[n];if("undefined"===typeof a&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:a}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!==typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof t)throw new o('"allowMissing" argument must be a boolean');var r=A(e),n=r.length>0?r[0]:"",a=C("%"+n+"%",t),s=a.name,l=a.value,c=!1,h=a.alias;h&&(n=h[0],x(r,w([0,1],h)));for(var f=1,d=!0;f<r.length;f+=1){var p=r[f],y=E(p,0,1),v=E(p,-1);if(('"'===y||"'"===y||"`"===y||'"'===v||"'"===v||"`"===v)&&y!==v)throw new i("property names with quotes must have matching quotes");if("constructor"!==p&&d||(c=!0),b(m,s="%"+(n+="."+p)+"%"))l=m[s];else if(null!=l){if(!(p in l)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&f+1>=r.length){var g=u(l,p);l=(d=!!g)&&"get"in g&&!("originalValue"in g.get)?g.get:l[p]}else d=b(l,p),l=l[p];d&&!c&&(m[s]=l)}}return l}},function(e,t,r){"use strict";var n=r(1315);e.exports=Function.prototype.bind||n},function(e,t,r){"use strict";var n=r(824),i=Object.prototype.hasOwnProperty,a=Array.isArray,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),s=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)"undefined"!==typeof e[n]&&(r[n]=e[n]);return r};e.exports={arrayToObject:s,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var i=t[n],o=i.obj[i.prop],s=Object.keys(o),u=0;u<s.length;++u){var l=s[u],c=o[l];"object"===typeof c&&null!==c&&-1===r.indexOf(c)&&(t.push({obj:o,prop:l}),r.push(c))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(a(r)){for(var n=[],i=0;i<r.length;++i)"undefined"!==typeof r[i]&&n.push(r[i]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(i){return n}},encode:function(e,t,r,i,a){if(0===e.length)return e;var s=e;if("symbol"===typeof e?s=Symbol.prototype.toString.call(e):"string"!==typeof e&&(s=String(e)),"iso-8859-1"===r)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var u="",l=0;l<s.length;++l){var c=s.charCodeAt(l);45===c||46===c||95===c||126===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||a===n.RFC1738&&(40===c||41===c)?u+=s.charAt(l):c<128?u+=o[c]:c<2048?u+=o[192|c>>6]+o[128|63&c]:c<55296||c>=57344?u+=o[224|c>>12]+o[128|c>>6&63]+o[128|63&c]:(l+=1,c=65536+((1023&c)<<10|1023&s.charCodeAt(l)),u+=o[240|c>>18]+o[128|c>>12&63]+o[128|c>>6&63]+o[128|63&c])}return u},isBuffer:function(e){return!(!e||"object"!==typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(a(e)){for(var r=[],n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)},merge:function e(t,r,n){if(!r)return t;if("object"!==typeof r){if(a(t))t.push(r);else{if(!t||"object"!==typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!==typeof t)return[t].concat(r);var o=t;return a(t)&&!a(r)&&(o=s(t,n)),a(t)&&a(r)?(r.forEach((function(r,a){if(i.call(t,a)){var o=t[a];o&&"object"===typeof o&&r&&"object"===typeof r?t[a]=e(o,r,n):t.push(r)}else t[a]=r})),t):Object.keys(r).reduce((function(t,a){var o=r[a];return i.call(t,a)?t[a]=e(t[a],o,n):t[a]=o,t}),o)}}},function(e,t,r){"use strict";var n=String.prototype.replace,i=/%20/g,a="RFC1738",o="RFC3986";e.exports={default:o,formatters:{RFC1738:function(e){return n.call(e,i,"+")},RFC3986:function(e){return String(e)}},RFC1738:a,RFC3986:o}},function(e,t,r){var n=r(1322),i=r(1331),a=r(319).EOL,o=r(1340);function s(e){return(e=e||{}).strict=!1!==e.strict,i((function(t){try{if(t)return JSON.parse(t)}catch(r){e.strict&&this.emit("error",new Error("Could not parse row "+t.slice(0,50)+"..."))}}),e)}e.exports=s,e.exports.serialize=e.exports.stringify=function(e){return n.obj(e,(function(e,t,r){r(null,o(e)+a)}))},e.exports.parse=s},function(e,t,r){"use strict";var n=r(718).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){"use strict";var n=r(720).codes.ERR_STREAM_PREMATURE_CLOSE;function i(){}e.exports=function e(t,r,a){if("function"===typeof r)return e(t,null,r);r||(r={}),a=function(e){var t=!1;return function(){if(!t){t=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];e.apply(this,n)}}}(a||i);var o=r.readable||!1!==r.readable&&t.readable,s=r.writable||!1!==r.writable&&t.writable,u=function(){t.writable||c()},l=t._writableState&&t._writableState.finished,c=function(){s=!1,l=!0,o||a.call(t)},h=t._readableState&&t._readableState.endEmitted,f=function(){o=!1,h=!0,s||a.call(t)},d=function(e){a.call(t,e)},p=function(){var e;return o&&!h?(t._readableState&&t._readableState.ended||(e=new n),a.call(t,e)):s&&!l?(t._writableState&&t._writableState.ended||(e=new n),a.call(t,e)):void 0},y=function(){t.req.on("finish",c)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",c),t.on("abort",p),t.req?y():t.on("request",y)),t.on("end",f),t.on("finish",c),!1!==r.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",c),t.removeListener("abort",p),t.removeListener("request",y),t.req&&t.req.removeListener("finish",c),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",c),t.removeListener("end",f),t.removeListener("error",d),t.removeListener("close",p)}}},function(e,t,r){"use strict";var n=r(67),i=r(679),a=r(662),o=r(722),s=r(664),u=r(681);e.exports=function(t){var n=s(t),i=a((function(t,r,i){"function"===typeof r&&(i=r,r={}),r=e.exports.normalizeOpts(r);try{t=e.exports.checkArgs(t)}catch(s){return i(s)}var a=function(e,t){t(null,e.map((function(e){return{ref:e.Ref,err:e.Err}})))};n({args:t,path:"refs",qs:r},(function(e,t){if(e)return i(e);o(t,a,i)}))}));return i.local=r(1347)(t),i.localReadableStream=r(1348)(t),i.localPullStream=r(1349)(t),i},e.exports.checkArgs=function(e){var t,r=Array.isArray(e),a=[],o=n(e=r?e:[e]);try{for(o.s();!(t=o.n()).done;){var s=t.value;try{s=u(s)}catch(l){if(!i.ipfsPath(s))throw l}a.push(s)}}catch(l){o.e(l)}finally{o.f()}return r?a:a[0]},e.exports.normalizeOpts=function(e){return"number"===typeof(e=e||{}).maxDepth&&(e["max-depth"]=e.maxDepth),e}},function(e,t,r){"use strict";var n=r(749);e.exports=function(e,t,r){r||(r=t,t=null);var i=n((function(r){t=e(t,r)}),(function(e){r(e,t)}));return 2===arguments.length?function(e){e(null,(function(n,a){if(n)return r(!0===n?null:n);t=a,i(e)}))}:i}},function(e,t,r){"use strict";var n=r(968);e.exports=function(e){return e=n(e),function(t){return function r(n,i){for(var a,o=!0;o;)o=!1,a=!0,t(n,(function(t,n){if(!t&&!e(n))return a?o=!0:r(t,i);i(t,n)})),a=!1}}}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(12).BigNumber,a=r(774),o=a.SHIFT32,s=a.SHIFT16;t.parseHalf=function(e){var t,r,n;return n=128&e[0]?-1:1,t=(124&e[0])>>2,r=(3&e[0])<<8|e[1],t?31===t?n*(r?NaN:Infinity):n*Math.pow(2,t-25)*(1024+r):5.960464477539063e-8*n*r},t.arrayBufferToBignumber=function(e){for(var t,r=e.byteLength,n="",a=0;a<r;a++)n+=(t=e[a])<16?"0"+t.toString(16):t.toString(16);return new i(n,16)},t.buildMap=function(e){for(var t=new Map,r=Object.keys(e),n=r.length,i=0;i<n;i++)t.set(r[i],e[r[i]]);return t},t.buildInt32=function(e,t){return e*s+t},t.buildInt64=function(e,r,n,a){var s=t.buildInt32(e,r),u=t.buildInt32(n,a);return s>2097151?new i(s).times(o).plus(u):s*o+u},t.writeHalf=function(e,t){var r=n.allocUnsafe(4);r.writeFloatBE(t,0);var i=r.readUInt32BE(0);if(0!==(8191&i))return!1;var a=i>>16&32768,o=i>>23&255,s=8388607&i;if(o>=113&&o<=142)a+=(o-112<<10)+(s>>13);else{if(!(o>=103&&o<113))return!1;if(s&(1<<126-o)-1)return!1;a+=s+8388608>>126-o}return e.writeUInt16BE(a,0),!0},t.keySorter=function(e,t){var r=e[0].byteLength,n=t[0].byteLength;return r>n?1:n>r?-1:e[0].compare(t[0])},t.isNegativeZero=function(e){return 0===e&&1/e<0},t.nextPowerOf2=function(e){var t=0;if(e&&!(e&e-1))return e;for(;0!==e;)e>>=1,t+=1;return 1<<t}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(1440),o=Symbol("max"),s=Symbol("length"),u=Symbol("lengthCalculator"),l=Symbol("allowStale"),c=Symbol("maxAge"),h=Symbol("dispose"),f=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),y=Symbol("updateAgeOnGet"),v=function(){return 1},m=function(){function e(t){if(n(this,e),"number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[o]=t.max||1/0;var r=t.length||v;if(this[u]="function"!==typeof r?v:r,this[l]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[c]=t.maxAge||0,this[h]=t.dispose,this[f]=t.noDisposeOnSet||!1,this[y]=t.updateAgeOnGet||!1,this.reset()}return i(e,[{key:"rforEach",value:function(e,t){t=t||this;for(var r=this[d].tail;null!==r;){var n=r.prev;k(this,e,r,t),r=n}}},{key:"forEach",value:function(e,t){t=t||this;for(var r=this[d].head;null!==r;){var n=r.next;k(this,e,r,t),r=n}}},{key:"keys",value:function(){return this[d].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[d].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[h]&&this[d]&&this[d].length&&this[d].forEach((function(t){return e[h](t.key,t.value)})),this[p]=new Map,this[d]=new a,this[s]=0}},{key:"dump",value:function(){var e=this;return this[d].map((function(t){return!_(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[d]}},{key:"set",value:function(e,t,r){if((r=r||this[c])&&"number"!==typeof r)throw new TypeError("maxAge must be a number");var n=r?Date.now():0,i=this[u](t,e);if(this[p].has(e)){if(i>this[o])return w(this,this[p].get(e)),!1;var a=this[p].get(e).value;return this[h]&&(this[f]||this[h](e,a.value)),a.now=n,a.maxAge=r,a.value=t,this[s]+=i-a.length,a.length=i,this.get(e),b(this),!0}var l=new x(e,t,i,n,r);return l.length>this[o]?(this[h]&&this[h](e,t),!1):(this[s]+=l.length,this[d].unshift(l),this[p].set(e,this[d].head),b(this),!0)}},{key:"has",value:function(e){if(!this[p].has(e))return!1;var t=this[p].get(e).value;return!_(this,t)}},{key:"get",value:function(e){return g(this,e,!0)}},{key:"peek",value:function(e){return g(this,e,!1)}},{key:"pop",value:function(){var e=this[d].tail;return e?(w(this,e),e.value):null}},{key:"del",value:function(e){w(this,this[p].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),r=e.length-1;r>=0;r--){var n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{var a=i-t;a>0&&this.set(n.k,n.v,a)}}}},{key:"prune",value:function(){var e=this;this[p].forEach((function(t,r){return g(e,r,!1)}))}},{key:"max",set:function(e){if("number"!==typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,b(this)},get:function(){return this[o]}},{key:"allowStale",set:function(e){this[l]=!!e},get:function(){return this[l]}},{key:"maxAge",set:function(e){if("number"!==typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,b(this)},get:function(){return this[c]}},{key:"lengthCalculator",set:function(e){var t=this;"function"!==typeof e&&(e=v),e!==this[u]&&(this[u]=e,this[s]=0,this[d].forEach((function(e){e.length=t[u](e.value,e.key),t[s]+=e.length}))),b(this)},get:function(){return this[u]}},{key:"length",get:function(){return this[s]}},{key:"itemCount",get:function(){return this[d].length}}]),e}(),g=function(e,t,r){var n=e[p].get(t);if(n){var i=n.value;if(_(e,i)){if(w(e,n),!e[l])return}else r&&(e[y]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return i.value}},_=function(e,t){if(!t||!t.maxAge&&!e[c])return!1;var r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[c]&&r>e[c]},b=function(e){if(e[s]>e[o])for(var t=e[d].tail;e[s]>e[o]&&null!==t;){var r=t.prev;w(e,t),t=r}},w=function(e,t){if(t){var r=t.value;e[h]&&e[h](r.key,r.value),e[s]-=r.length,e[p].delete(r.key),e[d].removeNode(t)}},x=function e(t,r,i,a,o){n(this,e),this.key=t,this.value=r,this.length=i,this.now=a,this.maxAge=o||0},k=function(e,t,r,n){var i=r.value;_(e,i)&&(w(e,r),e[l]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=m},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(23),o=r(24),s=r(672).Transform,u=r(1474),l=function(e){a(r,e);var t=o(r);function r(e){n(this,r);var i=Object.assign(e||{},{objectMode:!0});return t.call(this,i)}return i(r,[{key:"_transform",value:function(e,t,r){try{var n=u(e);if(this.push(n),!n.success)throw new Error(n.text)}catch(i){return r(i)}r()}}]),r}(s);e.exports=l},function(e,t,r){"use strict";var n=r(12);e.exports=function(e){return{totalIn:new n(e.TotalIn),totalOut:new n(e.TotalOut),rateIn:new n(e.RateIn),rateOut:new n(e.RateOut)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(321),i=r(176),a=r(322),o=r(759),s=r(314),u=r(333),l=r(1100),c=r(317),h=r(92),f=r(67),d=r(1101),p=r(23),y=r(24),v=r(18),m=r(19);e.exports=function(){"use strict";var e,t,r;function g(n,i){if(e)if(t){var a="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",o={};e(o),r=i(o),"undefined"!==typeof window&&(r.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}else t=i;else e=i}return g(["exports"],(function(e){var t="2.4.0",r=n;function n(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=r,this.p2y=n}n.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},n.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},n.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},n.prototype.solveCurveX=function(e,t){var r,n,i,a,o;for(void 0===t&&(t=1e-6),i=e,o=0;o<8;o++){if(a=this.sampleCurveX(i)-e,Math.abs(a)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=a/s}if((i=e)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(a=this.sampleCurveX(i),Math.abs(a-e)<t)return i;e>a?r=i:n=i,i=.5*(n-r)+r}return i},n.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var g=_;function _(e,t){this.x=e,this.y=t}_.prototype={clone:function(){return new _(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},_.convert=function(e){return e instanceof _?e:Array.isArray(e)?new _(e[0],e[1]):e};var b="undefined"!=typeof self?self:{},w=Math.pow(2,53)-1,x=Math.PI/180,k=180/Math.PI;function E(e){return e*x}var S=[[0,0],[1,0],[1,1],[0,1]];function T(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function A(e,t,n,i){var a=new r(e,t,n,i);return function(e){return a.solve(e)}}var C=A(.25,.1,.25,1);function I(e,t,r){return Math.min(r,Math.max(t,e))}function R(e,t,r){var n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function M(e,t,r){if(!e.length)return r(null,[]);var n=e.length,i=new Array(e.length),a=null;e.forEach((function(e,o){t(e,(function(e,t){e&&(a=e),i[o]=t,0==--n&&r(a,i)}))}))}function P(e){var t=[];for(var r in e)t.push(e[r]);return t}function O(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=a[i];for(var s in o)e[s]=o[s]}return e}var L=1;function D(){return L++}function B(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function N(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function z(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function F(e,t){e.forEach((function(e){t[e]&&(t[e]=t[e].bind(t))}))}function j(e,t){return-1!==e.indexOf(t,e.length-t.length)}function U(e,t,r){var n={};for(var i in e)n[i]=t.call(r||this,e[i],i,e);return n}function V(e,t,r){var n={};for(var i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function q(e){return Array.isArray(e)?e.map(q):"object"==typeof e&&e?U(e,q):e}var G={};function K(e){G[e]||("undefined"!=typeof console&&console.warn(e),G[e]=!0)}function H(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function W(e){for(var t,r,n=0,i=0,a=e.length,o=a-1;i<a;o=i++)t=e[i],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}function Z(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Y(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(e,r,n,i){var a=n||i;return t[r]=!a||a.toLowerCase(),""})),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var X,Q,J,$=null;function ee(e){if(null==$){var t=e.navigator?e.navigator.userAgent:null;$=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return $}function te(e){try{var t=b[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(e){return!1}}var re,ne,ie,ae={now:function(){return void 0!==J?J:b.performance.now()},setNow:function(e){J=e},restoreNow:function(){J=void 0},frame:function(e){var t=b.requestAnimationFrame(e);return{cancel:function(){return b.cancelAnimationFrame(t)}}},getImageData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=b.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,n.drawImage(e,0,0,e.width,e.height),n.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return X||(X=b.document.createElement("a")),X.href=e,X.href},get devicePixelRatio(){return b.devicePixelRatio},get prefersReducedMotion(){return!!b.matchMedia&&(null==Q&&(Q=b.matchMedia("(prefers-reduced-motion: reduce)")),Q.matches)}},oe={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==re){var e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{re=null!=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RECAPTCHA_TOKEN:"6Lest7wbAAAAAPRzQ2ZGU-w_O9v-gbnw3fK1l98u",REACT_APP_MAP_TOKEN:"pk.eyJ1IjoibWljaGFlbDEwIiwiYSI6ImNrcndxejR4ZjA1Nmcydm5vNzM4YTdsdWIifQ.bGHbfUZ1juBxAL55eGMSnA",REACT_APP_API_URL:"https://api.testleekdao.xyz/",REACT_APP_LOTTERY_OWNER:"0xB232D899b39Ee282EC26BBA385497b9FCD150ED3",REACT_APP_API_USERNAME:"leekdao",REACT_APP_NODE_1:"https://rpc-mumbai.maticvigil.com/",REACT_APP_NODE_3:"https://rpc-mumbai.matic.today/",REACT_APP_NODE_2:"https://polygon-mumbai.infura.io/v3/cddf815255c54292a6d96f68893e8034",REACT_APP_CHAIN_ID:"80001",REACT_APP_API_PASSWORD:"LuckyDraw!123"}).API_URL_REGEX?new RegExp(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RECAPTCHA_TOKEN:"6Lest7wbAAAAAPRzQ2ZGU-w_O9v-gbnw3fK1l98u",REACT_APP_MAP_TOKEN:"pk.eyJ1IjoibWljaGFlbDEwIiwiYSI6ImNrcndxejR4ZjA1Nmcydm5vNzM4YTdsdWIifQ.bGHbfUZ1juBxAL55eGMSnA",REACT_APP_API_URL:"https://api.testleekdao.xyz/",REACT_APP_LOTTERY_OWNER:"0xB232D899b39Ee282EC26BBA385497b9FCD150ED3",REACT_APP_API_USERNAME:"leekdao",REACT_APP_NODE_1:"https://rpc-mumbai.maticvigil.com/",REACT_APP_NODE_3:"https://rpc-mumbai.matic.today/",REACT_APP_NODE_2:"https://polygon-mumbai.infura.io/v3/cddf815255c54292a6d96f68893e8034",REACT_APP_CHAIN_ID:"80001",REACT_APP_API_PASSWORD:"LuckyDraw!123"}).API_URL_REGEX):e}catch(t){re=e}}return re},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},se={supported:!1,testSupport:function(e){!ue&&ie&&(le?ce(e):ne=e)}},ue=!1,le=!1;function ce(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ie),e.isContextLost())return;se.supported=!0}catch(e){}e.deleteTexture(t),ue=!0}b.document&&((ie=b.document.createElement("img")).onload=function(){ne&&ce(ne),ne=null,le=!0},ie.onerror=function(){ue=!0,ne=null},ie.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var he="01",fe="NO_ACCESS_TOKEN";function de(e){return 0===e.indexOf("mapbox:")}function pe(e){return oe.API_URL_REGEX.test(e)}var ye=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ve(e){var t=e.match(ye);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function me(e){var t=e.params.length?"?".concat(e.params.join("&")):"";return"".concat(e.protocol,"://").concat(e.authority).concat(e.path).concat(t)}function ge(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(b.atob(t[1]).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(e){return null}}var _e,be,we=function(){function e(t){v(this,e),this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}return m(e,[{key:"getStorageKey",value:function(e){var t=ge(oe.ACCESS_TOKEN),r="";return r=t&&t.u?b.btoa(encodeURIComponent(t.u).replace(/%([0-9A-F]{2})/g,(function(e,t){return String.fromCharCode(Number("0x"+t))}))):oe.ACCESS_TOKEN||"",e?"mapbox.eventData.".concat(e,":").concat(r):"mapbox.eventData:".concat(r)}},{key:"fetchEventData",value:function(){var e=te("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var n=b.localStorage.getItem(t);n&&(this.eventData=JSON.parse(n));var i=b.localStorage.getItem(r);i&&(this.anonId=i)}catch(e){K("Unable to read from LocalStorage")}}},{key:"saveEventData",value:function(){var e=te("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{b.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&b.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(e){K("Unable to write to LocalStorage")}}},{key:"processRequests",value:function(e){}},{key:"postEvent",value:function(e,r,n,i){var a=this;if(oe.EVENTS_URL){var o=ve(oe.EVENTS_URL);o.params.push("access_token=".concat(i||oe.ACCESS_TOKEN||""));var s={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:t,skuId:he,userId:this.anonId},u=r?O(s,r):s,l={url:me(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([u])};this.pendingRequest=je(l,(function(e){a.pendingRequest=null,n(e),a.saveEventData(),a.processRequests(i)}))}}},{key:"queueRequest",value:function(e,t){this.queue.push(e),this.processRequests(t)}}]),e}(),xe=new(function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,"appUserTurnstile"))._customAccessToken=e,n}return m(r,[{key:"postTurnstileEvent",value:function(e,t){oe.EVENTS_URL&&oe.ACCESS_TOKEN&&Array.isArray(e)&&e.some((function(e){return de(e)||pe(e)}))&&this.queueRequest(Date.now(),t)}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var r=ge(oe.ACCESS_TOKEN),n=r?r.u:oe.ACCESS_TOKEN,i=n!==this.eventData.tokenU;z(this.anonId)||(this.anonId=B(),i=!0);var a=this.queue.shift();if(this.eventData.lastSuccess){var o=new Date(this.eventData.lastSuccess),s=new Date(a),u=(a-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||o.getDate()!==s.getDate()}else i=!0;if(!i)return this.processRequests();this.postEvent(a,{"enabled.telemetry":!1},(function(e){e||(t.eventData.lastSuccess=a,t.eventData.tokenU=n)}),e)}}}]),r}(we)),ke=xe.postTurnstileEvent.bind(xe),Ee=new(function(e){p(r,e);var t=y(r);function r(){var e;return v(this,r),(e=t.call(this,"map.load")).success={},e.skuToken="",e}return m(r,[{key:"postMapLoadEvent",value:function(e,t,r,n){this.skuToken=t,this.errorCb=n,oe.EVENTS_URL&&(r||oe.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(fe)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),n=r.id,i=r.timestamp;n&&this.success[n]||(this.anonId||this.fetchEventData(),z(this.anonId)||(this.anonId=B()),this.postEvent(i,{skuToken:this.skuToken},(function(e){e?t.errorCb(e):n&&(t.success[n]=!0)}),e))}}}]),r}(we)),Se=Ee.postMapLoadEvent.bind(Ee),Te=new(function(e){p(r,e);var t=y(r);function r(){var e;return v(this,r),(e=t.call(this,"map.auth")).success={},e.skuToken="",e}return m(r,[{key:"getSession",value:function(e,t,r,n){var i=this;if(oe.API_URL&&oe.SESSION_PATH){var a=ve(oe.API_URL+oe.SESSION_PATH);a.params.push("sku=".concat(t||"")),a.params.push("access_token=".concat(n||oe.ACCESS_TOKEN||""));var o={url:me(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ue(o,(function(e){i.pendingRequest=null,r(e),i.saveEventData(),i.processRequests(n)}))}}},{key:"getSessionAPI",value:function(e,t,r,n){this.skuToken=t,this.errorCb=n,oe.SESSION_PATH&&oe.API_URL&&(r||oe.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(fe)))}},{key:"processRequests",value:function(e){var t=this;if(!this.pendingRequest&&0!==this.queue.length){var r=this.queue.shift(),n=r.id,i=r.timestamp;n&&this.success[n]||this.getSession(i,this.skuToken,(function(e){e?t.errorCb(e):n&&(t.success[n]=!0)}),e)}}}]),r}(we)),Ae=Te.getSessionAPI.bind(Te),Ce=new Set,Ie="mapbox-tiles",Re=500,Me=50;function Pe(){b.caches&&!_e&&(_e=b.caches.open(Ie))}function Oe(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Le=1/0,De={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(De);var Be=function(e){p(r,e);var t=y(r);function r(e,n,i){var a;return v(this,r),401===n&&pe(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),(a=t.call(this,e)).status=n,a.url=i,a}return m(r,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),r}(d(Error)),Ne=Z()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===b.location.protocol?b.parent:b).location.href},ze=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(Ne())&&!/^\w+:/.test(r))){if(b.fetch&&b.Request&&b.AbortController&&b.Request.prototype.hasOwnProperty("signal"))return function(e,t){var r,n=new b.AbortController,i=new b.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:Ne(),signal:n.signal}),a=!1,o=!1,s=(r=i.url).indexOf("sku=")>0&&pe(r);"json"===e.type&&i.headers.set("Accept","application/json");var u=function(r,n,a){if(!o){if(r&&"SecurityError"!==r.message&&K(r),n&&a)return l(n);var u=Date.now();b.fetch(i).then((function(r){if(r.ok){var n=s?r.clone():null;return l(r,n,u)}return t(new Be(r.statusText,r.status,e.url))})).catch((function(e){20!==e.code&&t(new Error(e.message))}))}},l=function(r,n,s){("arrayBuffer"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text()).then((function(e){o||(n&&s&&function(e,t,r){if(Pe(),_e){var n={status:t.status,statusText:t.statusText,headers:new b.Headers};t.headers.forEach((function(e,t){return n.headers.set(t,e)}));var i=Y(t.headers.get("Cache-Control")||"");i["no-store"]||(i["max-age"]&&n.headers.set("Expires",new Date(r+1e3*i["max-age"]).toUTCString()),new Date(n.headers.get("Expires")).getTime()-r<42e4||function(e,t){if(void 0===be)try{new Response(new ReadableStream),be=!0}catch(e){be=!1}be?t(e.body):e.blob().then(t)}(t,(function(t){var r=new b.Response(t,n);Pe(),_e&&_e.then((function(t){return t.put(Oe(e.url),r)})).catch((function(e){return K(e.message)}))})))}}(i,n,s),a=!0,t(null,e,r.headers.get("Cache-Control"),r.headers.get("Expires")))})).catch((function(e){o||t(new Error(e.message))}))};return s?function(e,t){if(Pe(),!_e)return t(null);var r=Oe(e.url);_e.then((function(e){e.match(r).then((function(n){var i=function(e){if(!e)return!1;var t=new Date(e.headers.get("Expires")||0),r=Y(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}(n);e.delete(r),i&&e.put(r,n.clone()),t(null,n,i)})).catch(t)})).catch(t)}(i,u):u(null,null),{cancel:function(){o=!0,a||n.abort()}}}(e,t);if(Z()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(e,t){var r=new b.XMLHttpRequest;for(var n in r.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(r.responseType="arraybuffer"),e.headers)r.setRequestHeader(n,e.headers[n]);return"json"===e.type&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials="include"===e.credentials,r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if((r.status>=200&&r.status<300||0===r.status)&&null!==r.response){var n=r.response;if("json"===e.type)try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"))}else t(new Be(r.statusText,r.status,e.url))},r.send(e.body),{cancel:function(){return r.abort()}}}(e,t)},Fe=function(e,t){return ze(O(e,{type:"arrayBuffer"}),t)},je=function(e,t){return ze(O(e,{method:"POST"}),t)},Ue=function(e,t){return ze(O(e,{method:"GET"}),t)};function Ve(e){var t=b.document.createElement("a");return t.href=e,t.protocol===b.document.location.protocol&&t.host===b.document.location.host}var qe,Ge,Ke="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";qe=[],Ge=0;var He=function e(t,r){if(se.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Ge>=oe.MAX_PARALLEL_IMAGE_REQUESTS){var n={requestParameters:t,callback:r,cancelled:!1,cancel:function(){this.cancelled=!0}};return qe.push(n),n}Ge++;var i=!1,a=function(){if(!i)for(i=!0,Ge--;qe.length&&Ge<oe.MAX_PARALLEL_IMAGE_REQUESTS;){var t=qe.shift(),r=t.requestParameters,n=t.callback;t.cancelled||(t.cancel=e(r,n).cancel)}},o=Fe(t,(function(e,t,n,i){a(),e?r(e):t&&(b.createImageBitmap?function(e,t){var r=new b.Blob([new Uint8Array(e)],{type:"image/png"});b.createImageBitmap(r).then((function(e){t(null,e)})).catch((function(e){t(new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))}))}(t,(function(e,t){return r(e,t,n,i)})):function(e,t){var r=new b.Image,n=b.URL;r.onload=function(){t(null,r),n.revokeObjectURL(r.src),r.onload=null,b.requestAnimationFrame((function(){r.src=Ke}))},r.onerror=function(){return t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var i=new b.Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):Ke}(t,(function(e,t){return r(e,t,n,i)})))}));return{cancel:function(){o.cancel(),a()}}};function We(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function Ze(e,t,r){if(r&&r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}var Ye=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,e),O(this,r),this.type=t},Xe=function(e){p(r,e);var t=y(r);function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return v(this,r),t.call(this,"error",O({error:e},n))}return r}(Ye),Qe=function(){function e(){v(this,e)}return m(e,[{key:"on",value:function(e,t){return this._listeners=this._listeners||{},We(e,t,this._listeners),this}},{key:"off",value:function(e,t){return Ze(e,t,this._listeners),Ze(e,t,this._oneTimeListeners),this}},{key:"once",value:function(e,t){var r=this;return t?(this._oneTimeListeners=this._oneTimeListeners||{},We(e,t,this._oneTimeListeners),this):new Promise((function(t){return r.once(e,t)}))}},{key:"fire",value:function(e,t){"string"==typeof e&&(e=new Ye(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;var n,i=this._listeners&&this._listeners[r]?this._listeners[r].slice():[],a=f(i);try{for(a.s();!(n=a.n()).done;)n.value.call(this,e)}catch(h){a.e(h)}finally{a.f()}var o,s=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[],u=f(s);try{for(u.s();!(o=u.n()).done;){var l=o.value;Ze(r,l,this._oneTimeListeners),l.call(this,e)}}catch(h){u.e(h)}finally{u.f()}var c=this._eventedParent;c&&(O(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),c.fire(e))}else e instanceof Xe&&console.error(e.error);return this}},{key:"listens",value:function(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}},{key:"setEventedParent",value:function(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}]),e}(),Je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},$e=function e(t,r,n,i){v(this,e),this.message=(t?"".concat(t,": "):"")+n,i&&(this.identifier=i),null!=r&&r.__line__&&(this.line=r.__line__)};function et(e){var t=e.value;return t?[new $e(e.key,t,"constants have been deprecated as of v8")]:[]}function tt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=0,a=r;i<a.length;i++){var o=a[i];for(var s in o)e[s]=o[s]}return e}function rt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function nt(e){if(Array.isArray(e))return e.map(nt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=nt(e[r]);return t}return rt(e)}var it=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,n)).message=n,i.key=e,i}return r}(d(Error)),at=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];v(this,e),this.parent=t,this.bindings={};var n,i=f(r);try{for(i.s();!(n=i.n()).done;){var a=h(n.value,2),o=a[0],s=a[1];this.bindings[o]=s}}catch(u){i.e(u)}finally{i.f()}}return m(e,[{key:"concat",value:function(t){return new e(this,t)}},{key:"get",value:function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}},{key:"has",value:function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}]),e}(),ot={kind:"null"},st={kind:"number"},ut={kind:"string"},lt={kind:"boolean"},ct={kind:"color"},ht={kind:"object"},ft={kind:"value"},dt={kind:"collator"},pt={kind:"formatted"},yt={kind:"resolvedImage"};function vt(e,t){return{kind:"array",itemType:e,N:t}}function mt(e){if("array"===e.kind){var t=mt(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}var gt=[ot,st,ut,lt,ct,pt,ht,vt(ft),yt];function _t(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_t(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind){var r,n=f(gt);try{for(n.s();!(r=n.n()).done;)if(!_t(r.value,t))return null}catch(i){n.e(i)}finally{n.f()}}}return"Expected ".concat(mt(e)," but found ").concat(mt(t)," instead.")}function bt(e,t){return t.some((function(t){return t.kind===e.kind}))}function wt(e,t){return t.some((function(t){return"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e}))}function xt(e){var t={exports:{}};return e(t,t.exports),t.exports}var kt=xt((function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(e){return(e=Math.round(e))<0?0:e>255?255:e}function i(e){return n("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function a(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function o(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,s=e.replace(/ /g,"").toLowerCase();if(s in r)return r[s].slice();if("#"===s[0])return 4===s.length?(t=parseInt(s.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===s.length&&(t=parseInt(s.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var u=s.indexOf("("),l=s.indexOf(")");if(-1!==u&&l+1===s.length){var c=s.substr(0,u),h=s.substr(u+1,l-(u+1)).split(","),f=1;switch(c){case"rgba":if(4!==h.length)return null;f=a(h.pop());case"rgb":return 3!==h.length?null:[i(h[0]),i(h[1]),i(h[2]),f];case"hsla":if(4!==h.length)return null;f=a(h.pop());case"hsl":if(3!==h.length)return null;var d=(parseFloat(h[0])%360+360)%360/360,p=a(h[1]),y=a(h[2]),v=y<=.5?y*(p+1):y+p-y*p,m=2*y-v;return[n(255*o(m,v,d+1/3)),n(255*o(m,v,d)),n(255*o(m,v,d-1/3)),f];default:return null}}return null}}catch(e){}})),Et=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;v(this,e),this.r=t,this.g=r,this.b=n,this.a=i}return m(e,[{key:"toString",value:function(){var e=this.toArray(),t=h(e,4),r=t[0],n=t[1],i=t[2],a=t[3];return"rgba(".concat(Math.round(r),",").concat(Math.round(n),",").concat(Math.round(i),",").concat(a,")")}},{key:"toArray",value:function(){var e=this.r,t=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]}}],[{key:"parse",value:function(t){if(t){if(t instanceof e)return t;if("string"==typeof t){var r=kt.parseCSSColor(t);return r?new e(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}}}}]),e}();Et.black=new Et(0,0,0,1),Et.white=new Et(1,1,1,1),Et.transparent=new Et(0,0,0,0),Et.red=new Et(1,0,0,1),Et.blue=new Et(0,0,1,1);var St=function(){function e(t,r,n){v(this,e),this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}return m(e,[{key:"compare",value:function(e,t){return this.collator.compare(e,t)}},{key:"resolvedLocale",value:function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}]),e}(),Tt=function e(t,r,n,i,a){v(this,e),this.text=t,this.image=r,this.scale=n,this.fontStack=i,this.textColor=a},At=function(){function e(t){v(this,e),this.sections=t}return m(e,[{key:"isEmpty",value:function(){return 0===this.sections.length||!this.sections.some((function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length}))}},{key:"toString",value:function(){return 0===this.sections.length?"":this.sections.map((function(e){return e.text})).join("")}},{key:"serialize",value:function(){var e,t=["format"],r=f(this.sections);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.image)t.push(["image",n.image.name]);else{t.push(n.text);var i={};n.fontStack&&(i["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(i["font-scale"]=n.scale),n.textColor&&(i["text-color"]=["rgba"].concat(n.textColor.toArray())),t.push(i)}}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"fromString",value:function(t){return new e([new Tt(t,null,null,null,null)])}},{key:"factory",value:function(t){return t instanceof e?t:e.fromString(t)}}]),e}(),Ct=function(){function e(t){v(this,e),this.name=t.name,this.available=t.available}return m(e,[{key:"toString",value:function(){return this.name}},{key:"serialize",value:function(){return["image",this.name]}}],[{key:"fromString",value:function(t){return t?new e({name:t,available:!1}):null}}]),e}();function It(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value [".concat([e,t,r,n].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function Rt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Et)return!0;if(e instanceof St)return!0;if(e instanceof At)return!0;if(e instanceof Ct)return!0;if(Array.isArray(e)){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)if(!Rt(t.value))return!1}catch(i){r.e(i)}finally{r.f()}return!0}if("object"==typeof e){for(var n in e)if(!Rt(e[n]))return!1;return!0}return!1}function Mt(e){if(null===e)return ot;if("string"==typeof e)return ut;if("boolean"==typeof e)return lt;if("number"==typeof e)return st;if(e instanceof Et)return ct;if(e instanceof St)return dt;if(e instanceof At)return pt;if(e instanceof Ct)return yt;if(Array.isArray(e)){var t,r,n=e.length,i=f(e);try{for(i.s();!(r=i.n()).done;){var a=Mt(r.value);if(t){if(t===a)continue;t=ft;break}t=a}}catch(o){i.e(o)}finally{i.f()}return vt(t||ft,n)}return ht}function Pt(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Et||e instanceof At||e instanceof Ct?e.toString():JSON.stringify(e)}var Ot=function(){function e(t,r){v(this,e),this.type=t,this.value=r}return m(e,[{key:"evaluate",value:function(){return this.value}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Et?["rgba"].concat(this.value.toArray()):this.value instanceof At?this.value.serialize():this.value}}],[{key:"parse",value:function(t,r){if(2!==t.length)return r.error("'literal' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(!Rt(t[1]))return r.error("invalid value");var n=t[1],i=Mt(n),a=r.expectedType;return"array"!==i.kind||0!==i.N||!a||"array"!==a.kind||"number"==typeof a.N&&0!==a.N||(i=a),new e(i,n)}}]),e}(),Lt=function(){function e(t){v(this,e),this.name="ExpressionEvaluationError",this.message=t}return m(e,[{key:"toJSON",value:function(){return this.message}}]),e}(),Dt={string:ut,number:st,boolean:lt,object:ht},Bt=function(){function e(t,r){v(this,e),this.type=t,this.args=r}return m(e,[{key:"evaluate",value:function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!_t(this.type,Mt(r)))return r;if(t===this.args.length-1)throw new Lt("Expected value to be of type ".concat(mt(this.type),", but found ").concat(mt(Mt(r))," instead."))}return null}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var n,i=1,a=t[0];if("array"===a){var o,s;if(t.length>2){var u=t[1];if("string"!=typeof u||!(u in Dt)||"object"===u)return r.error('The item type argument of "array" must be one of string, number, boolean',1);o=Dt[u],i++}else o=ft;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);s=t[2],i++}n=vt(o,s)}else n=Dt[a];for(var l=[];i<t.length;i++){var c=r.parse(t[i],i,ft);if(!c)return null;l.push(c)}return new e(n,l)}}]),e}(),Nt=function(){function e(t){v(this,e),this.type=pt,this.sections=t}return m(e,[{key:"evaluate",value:function(e){return new At(this.sections.map((function(t){var r=t.content.evaluate(e);return Mt(r)===yt?new Tt("",r,null,null,null):new Tt(Pt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}},{key:"eachChild",value:function(e){var t,r=f(this.sections);try{for(r.s();!(t=r.n()).done;){var n=t.value;e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}}catch(i){r.e(i)}finally{r.f()}}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e,t=["format"],r=f(this.sections);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push(n.content.serialize());var i={};n.scale&&(i["font-scale"]=n.scale.serialize()),n.font&&(i["text-font"]=n.font.serialize()),n.textColor&&(i["text-color"]=n.textColor.serialize()),t.push(i)}}catch(a){r.e(a)}finally{r.f()}return t}}],[{key:"parse",value:function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return r.error("First argument must be an image or text section.");for(var i=[],a=!1,o=1;o<=t.length-1;++o){var s=t[o];if(a&&"object"==typeof s&&!Array.isArray(s)){a=!1;var u=null;if(s["font-scale"]&&!(u=r.parse(s["font-scale"],1,st)))return null;var l=null;if(s["text-font"]&&!(l=r.parse(s["text-font"],1,vt(ut))))return null;var c=null;if(s["text-color"]&&!(c=r.parse(s["text-color"],1,ct)))return null;var h=i[i.length-1];h.scale=u,h.font=l,h.textColor=c}else{var f=r.parse(t[o],1,ft);if(!f)return null;var d=f.type.kind;if("string"!==d&&"value"!==d&&"null"!==d&&"resolvedImage"!==d)return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,i.push({content:f,scale:null,font:null,textColor:null})}}return new e(i)}}]),e}(),zt=function(){function e(t){v(this,e),this.type=yt,this.input=t}return m(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),r=Ct.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["image",this.input.serialize()]}}],[{key:"parse",value:function(t,r){if(2!==t.length)return r.error("Expected two arguments.");var n=r.parse(t[1],1,ut);return n?new e(n):r.error("No image name provided.")}}]),e}(),Ft={"to-boolean":lt,"to-color":ct,"to-number":st,"to-string":ut},jt=function(){function e(t,r){v(this,e),this.type=t,this.args=r}return m(e,[{key:"evaluate",value:function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){var t,r,n,i=f(this.args);try{for(i.s();!(n=i.n()).done;){if(t=n.value.evaluate(e),r=null,t instanceof Et)return t;if("string"==typeof t){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):It(t[0],t[1],t[2],t[3])))return new Et(t[0]/255,t[1]/255,t[2]/255,t[3])}}catch(c){i.e(c)}finally{i.f()}throw new Lt(r||"Could not parse color from value '".concat("string"==typeof t?t:String(JSON.stringify(t)),"'"))}if("number"===this.type.kind){var o,s=null,u=f(this.args);try{for(u.s();!(o=u.n()).done;){if(null===(s=o.value.evaluate(e)))return 0;var l=Number(s);if(!isNaN(l))return l}}catch(c){u.e(c)}finally{u.f()}throw new Lt("Could not convert ".concat(JSON.stringify(s)," to number."))}return"formatted"===this.type.kind?At.fromString(Pt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Ct.fromString(Pt(this.args[0].evaluate(e))):Pt(this.args[0].evaluate(e))}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){if("formatted"===this.type.kind)return new Nt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new zt(this.args[0]).serialize();var e=["to-".concat(this.type.kind)];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,r){if(t.length<2)return r.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return r.error("Expected one argument.");for(var i=Ft[n],a=[],o=1;o<t.length;o++){var s=r.parse(t[o],o,ft);if(!s)return null;a.push(s)}return new e(i,a)}}]),e}(),Ut=["Unknown","Point","LineString","Polygon"],Vt=function(){function e(){v(this,e),this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}return m(e,[{key:"id",value:function(){return this.feature&&"id"in this.feature?this.feature.id:null}},{key:"geometryType",value:function(){return this.feature?"number"==typeof this.feature.type?Ut[this.feature.type]:this.feature.type:null}},{key:"geometry",value:function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}},{key:"canonicalID",value:function(){return this.canonical}},{key:"properties",value:function(){return this.feature&&this.feature.properties||{}}},{key:"parseColor",value:function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Et.parse(e)),t}}]),e}(),qt=function(){function e(t,r,n,i){v(this,e),this.name=t,this.type=r,this._evaluate=n,this.args=i}return m(e,[{key:"evaluate",value:function(e){return this._evaluate(e,this.args)}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return[this.name].concat(this.args.map((function(e){return e.serialize()})))}}],[{key:"parse",value:function(t,r){var n,i=t[0],a=e.definitions[i];if(!a)return r.error('Unknown expression "'.concat(i,'". If you wanted a literal array, use ["literal", [...]].'),0);var o,s=Array.isArray(a)?a[0]:a.type,u=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,l=u.filter((function(e){var r=h(e,1)[0];return!Array.isArray(r)||r.length===t.length-1})),d=null,p=f(l);try{for(p.s();!(o=p.n()).done;){var y=h(o.value,2),v=y[0],m=y[1];d=new fr(r.registry,r.path,null,r.scope);for(var g=[],_=!1,b=1;b<t.length;b++){var w=t[b],x=Array.isArray(v)?v[b-1]:v.type,k=d.parse(w,1+g.length,x);if(!k){_=!0;break}g.push(k)}if(!_)if(Array.isArray(v)&&v.length!==g.length)d.error("Expected ".concat(v.length," arguments, but found ").concat(g.length," instead."));else{for(var E=0;E<g.length;E++){var S=Array.isArray(v)?v[E]:v.type,T=g[E];d.concat(E+1).checkSubtype(S,T.type)}if(0===d.errors.length)return new e(i,s,m,g)}}}catch(M){p.e(M)}finally{p.f()}if(1===l.length)(n=r.errors).push.apply(n,c(d.errors));else{for(var A=(l.length?l:u).map((function(e){var t;return t=h(e,1)[0],Array.isArray(t)?"(".concat(t.map(mt).join(", "),")"):"(".concat(mt(t.type),"...)")})).join(" | "),C=[],I=1;I<t.length;I++){var R=r.parse(t[I],1+C.length);if(!R)return null;C.push(mt(R.type))}r.error("Expected arguments of type ".concat(A,", but found (").concat(C.join(", "),") instead."))}return null}},{key:"register",value:function(t,r){for(var n in e.definitions=r,r)t[n]=e}}]),e}(),Gt=function(){function e(t,r,n){v(this,e),this.type=dt,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=r}return m(e,[{key:"evaluate",value:function(e){return new St(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}},{key:"eachChild",value:function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}],[{key:"parse",value:function(t,r){if(2!==t.length)return r.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return r.error("Collator options argument must be an object.");var i=r.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,lt);if(!i)return null;var a=r.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,lt);if(!a)return null;var o=null;return n.locale&&!(o=r.parse(n.locale,1,ut))?null:new e(i,a,o)}}]),e}(),Kt=8192;function Ht(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Wt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Zt(e,t){var r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*Kt),Math.round(n*i*Kt)]}function Yt(e,t,r){var n=e[0]-t[0],i=e[1]-t[1],a=e[0]-r[0],o=e[1]-r[1];return n*o-a*i==0&&n*a<=0&&i*o<=0}function Xt(e,t){for(var r,n,i,a=!1,o=0,s=t.length;o<s;o++)for(var u=t[o],l=0,c=u.length;l<c-1;l++){if(Yt(e,u[l],u[l+1]))return!1;(n=u[l])[1]>(r=e)[1]!=(i=u[l+1])[1]>r[1]&&r[0]<(i[0]-n[0])*(r[1]-n[1])/(i[1]-n[1])+n[0]&&(a=!a)}return a}function Qt(e,t){for(var r=0;r<t.length;r++)if(Xt(e,t[r]))return!0;return!1}function Jt(e,t,r,n){var i=n[0]-r[0],a=n[1]-r[1],o=(e[0]-r[0])*a-i*(e[1]-r[1]),s=(t[0]-r[0])*a-i*(t[1]-r[1]);return o>0&&s<0||o<0&&s>0}function $t(e,t,r){var n,i,a,o,s,u,l,c=f(r);try{for(c.s();!(n=c.n()).done;)for(var h=n.value,d=0;d<h.length-1;++d)if(0!=(u=[(s=h[d+1])[0]-(o=h[d])[0],s[1]-o[1]])[0]*(l=[(a=t)[0]-(i=e)[0],a[1]-i[1]])[1]-u[1]*l[0]&&Jt(i,a,o,s)&&Jt(o,s,i,a))return!0}catch(p){c.e(p)}finally{c.f()}return!1}function er(e,t){for(var r=0;r<e.length;++r)if(!Xt(e[r],t))return!1;for(var n=0;n<e.length-1;++n)if($t(e[n],e[n+1],t))return!1;return!0}function tr(e,t){for(var r=0;r<t.length;r++)if(er(e,t[r]))return!0;return!1}function rr(e,t,r){for(var n=[],i=0;i<e.length;i++){for(var a=[],o=0;o<e[i].length;o++){var s=Zt(e[i][o],r);Ht(t,s),a.push(s)}n.push(a)}return n}function nr(e,t,r){for(var n=[],i=0;i<e.length;i++){var a=rr(e[i],t,r);n.push(a)}return n}function ir(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){var i=.5*n,a=e[0]-r[0]>i?-n:r[0]-e[0]>i?n:0;0===a&&(a=e[0]-r[2]>i?-n:r[2]-e[0]>i?n:0),e[0]+=a}Ht(t,e)}function ar(e,t,r,n){var i,a=Math.pow(2,n.z)*Kt,o=[n.x*Kt,n.y*Kt],s=[],u=f(e);try{for(u.s();!(i=u.n()).done;){var l,c=i.value,h=f(c);try{for(h.s();!(l=h.n()).done;){var d=l.value,p=[d.x+o[0],d.y+o[1]];ir(p,t,r,a),s.push(p)}}catch(y){h.e(y)}finally{h.f()}}}catch(y){u.e(y)}finally{u.f()}return s}function or(e,t,r,n){var i,a,o=Math.pow(2,n.z)*Kt,s=[n.x*Kt,n.y*Kt],u=[],l=f(e);try{for(l.s();!(i=l.n()).done;){var c,h=i.value,d=[],p=f(h);try{for(p.s();!(c=p.n()).done;){var y=c.value,v=[y.x+s[0],y.y+s[1]];Ht(t,v),d.push(v)}}catch(x){p.e(x)}finally{p.f()}u.push(d)}}catch(x){l.e(x)}finally{l.f()}if(t[2]-t[0]<=o/2){(a=t)[0]=a[1]=1/0,a[2]=a[3]=-1/0;var m,g=f(u);try{for(g.s();!(m=g.n()).done;){var _,b=m.value,w=f(b);try{for(w.s();!(_=w.n()).done;)ir(_.value,t,r,o)}catch(x){w.e(x)}finally{w.f()}}}catch(x){g.e(x)}finally{g.f()}}return u}var sr=function(){function e(t,r){v(this,e),this.type=lt,this.geojson=t,this.geometries=r}return m(e,[{key:"evaluate",value:function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){var a=rr(t.coordinates,n,i),o=ar(e.geometry(),r,n,i);if(!Wt(r,n))return!1;var s,u=f(o);try{for(u.s();!(s=u.n()).done;)if(!Xt(s.value,a))return!1}catch(p){u.e(p)}finally{u.f()}}if("MultiPolygon"===t.type){var l=nr(t.coordinates,n,i),c=ar(e.geometry(),r,n,i);if(!Wt(r,n))return!1;var h,d=f(c);try{for(d.s();!(h=d.n()).done;)if(!Qt(h.value,l))return!1}catch(p){d.e(p)}finally{d.f()}}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){var r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){var a=rr(t.coordinates,n,i),o=or(e.geometry(),r,n,i);if(!Wt(r,n))return!1;var s,u=f(o);try{for(u.s();!(s=u.n()).done;)if(!er(s.value,a))return!1}catch(p){u.e(p)}finally{u.f()}}if("MultiPolygon"===t.type){var l=nr(t.coordinates,n,i),c=or(e.geometry(),r,n,i);if(!Wt(r,n))return!1;var h,d=f(c);try{for(d.s();!(h=d.n()).done;)if(!tr(h.value,l))return!1}catch(p){d.e(p)}finally{d.f()}}return!0}(e,this.geometries)}return!1}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["within",this.geojson]}}],[{key:"parse",value:function(t,r){if(2!==t.length)return r.error("'within' expression requires exactly one argument, but found ".concat(t.length-1," instead."));if(Rt(t[1])){var n=t[1];if("FeatureCollection"===n.type)for(var i=0;i<n.features.length;++i){var a=n.features[i].geometry.type;if("Polygon"===a||"MultiPolygon"===a)return new e(n,n.features[i].geometry)}else if("Feature"===n.type){var o=n.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new e(n,n.geometry)}else if("Polygon"===n.type||"MultiPolygon"===n.type)return new e(n,n)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}}]),e}();function ur(e){if(e instanceof qt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof sr)return!1;var t=!0;return e.eachChild((function(e){t&&!ur(e)&&(t=!1)})),t}function lr(e){if(e instanceof qt&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild((function(e){t&&!lr(e)&&(t=!1)})),t}function cr(e,t){if(e instanceof qt&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild((function(e){r&&!cr(e,t)&&(r=!1)})),r}var hr=function(){function e(t,r){v(this,e),this.type=r.type,this.name=t,this.boundExpression=r}return m(e,[{key:"evaluate",value:function(e){return this.boundExpression.evaluate(e)}},{key:"eachChild",value:function(){}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["var",this.name]}}],[{key:"parse",value:function(t,r){if(2!==t.length||"string"!=typeof t[1])return r.error("'var' expression requires exactly one string literal argument.");var n=t[1];return r.scope.has(n)?new e(n,r.scope.get(n)):r.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}}]),e}(),fr=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new at,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];v(this,e),this.registry=t,this.path=r,this.key=r.map((function(e){return"[".concat(e,"]")})).join(""),this.scope=i,this.errors=a,this.expectedType=n}return m(e,[{key:"parse",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}},{key:"_parse",value:function(e,t){function r(e,t,r){return"assert"===r?new Bt(t,[e]):"coerce"===r?new jt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var n=e[0];if("string"!=typeof n)return this.error("Expression name must be a string, but found ".concat(typeof n,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;var i=this.registry[n];if(i){var a=i.parse(e,this);if(!a)return null;if(this.expectedType){var o=this.expectedType,s=a.type;if("string"!==o.kind&&"number"!==o.kind&&"boolean"!==o.kind&&"object"!==o.kind&&"array"!==o.kind||"value"!==s.kind)if("color"!==o.kind&&"formatted"!==o.kind&&"resolvedImage"!==o.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(o,s))return null}else a=r(a,o,t.typeAnnotation||"coerce");else a=r(a,o,t.typeAnnotation||"assert")}if(!(a instanceof Ot)&&"resolvedImage"!==a.type.kind&&dr(a)){var u=new Vt;try{a=new Ot(a.type,a.evaluate(u))}catch(e){return this.error(e.message),null}}return a}return this.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}},{key:"concat",value:function(t,r,n){var i="number"==typeof t?this.path.concat(t):this.path,a=n?this.scope.concat(n):this.scope;return new e(this.registry,i,r||null,a,this.errors)}},{key:"error",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i="".concat(this.key).concat(r.map((function(e){return"[".concat(e,"]")})).join(""));this.errors.push(new it(i,e))}},{key:"checkSubtype",value:function(e,t){var r=_t(e,t);return r&&this.error(r),r}}]),e}();function dr(e){if(e instanceof hr)return dr(e.boundExpression);if(e instanceof qt&&"error"===e.name)return!1;if(e instanceof Gt)return!1;if(e instanceof sr)return!1;var t=e instanceof jt||e instanceof Bt,r=!0;return e.eachChild((function(e){r=t?r&&dr(e):r&&e instanceof Ot})),!!r&&ur(e)&&cr(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function pr(e,t){for(var r,n,i=e.length-1,a=0,o=i,s=0;a<=o;)if(r=e[s=Math.floor((a+o)/2)],n=e[s+1],r<=t){if(s===i||t<n)return s;a=s+1}else{if(!(r>t))throw new Lt("Input is not a number.");o=s-1}return 0}var yr=function(){function e(t,r,n){v(this,e),this.type=t,this.input=r,this.labels=[],this.outputs=[];var i,a=f(n);try{for(a.s();!(i=a.n()).done;){var o=h(i.value,2),s=o[0],u=o[1];this.labels.push(s),this.outputs.push(u)}}catch(l){a.e(l)}finally{a.f()}}return m(e,[{key:"evaluate",value:function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[pr(t,n)].evaluate(e)}},{key:"eachChild",value:function(e){e(this.input);var t,r=f(this.outputs);try{for(r.s();!(t=r.n()).done;)e(t.value)}catch(n){r.e(n)}finally{r.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}],[{key:"parse",value:function(t,r){if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");var n=r.parse(t[1],1,st);if(!n)return null;var i=[],a=null;r.expectedType&&"value"!==r.expectedType.kind&&(a=r.expectedType);for(var o=1;o<t.length;o+=2){var s=1===o?-1/0:t[o],u=t[o+1],l=o,c=o+1;if("number"!=typeof s)return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',l);if(i.length&&i[i.length-1][0]>=s)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',l);var h=r.parse(u,c,a);if(!h)return null;a=a||h.type,i.push([s,h])}return new e(a,n,i)}}]),e}();function vr(e,t,r){return e*(1-r)+t*r}var mr=Object.freeze({__proto__:null,number:vr,color:function(e,t,r){return new Et(vr(e.r,t.r,r),vr(e.g,t.g,r),vr(e.b,t.b,r),vr(e.a,t.a,r))},array:function(e,t,r){return e.map((function(e,n){return vr(e,t[n],r)}))}}),gr=.95047,_r=1.08883,br=4/29,wr=6/29,xr=3*wr*wr,kr=Math.PI/180,Er=180/Math.PI;function Sr(e){return e>.008856451679035631?Math.pow(e,1/3):e/xr+br}function Tr(e){return e>wr?e*e*e:xr*(e-br)}function Ar(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Cr(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Ir(e){var t=Cr(e.r),r=Cr(e.g),n=Cr(e.b),i=Sr((.4124564*t+.3575761*r+.1804375*n)/gr),a=Sr((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*a-16,a:500*(i-a),b:200*(a-Sr((.0193339*t+.119192*r+.9503041*n)/_r)),alpha:e.a}}function Rr(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*Tr(t),r=gr*Tr(r),n=_r*Tr(n),new Et(Ar(3.2404542*r-1.5371385*t-.4985314*n),Ar(-.969266*r+1.8760108*t+.041556*n),Ar(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function Mr(e,t,r){var n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}var Pr={forward:Ir,reverse:Rr,interpolate:function(e,t,r){return{l:vr(e.l,t.l,r),a:vr(e.a,t.a,r),b:vr(e.b,t.b,r),alpha:vr(e.alpha,t.alpha,r)}}},Or={forward:function(e){var t=Ir(e),r=t.l,n=t.a,i=t.b,a=Math.atan2(i,n)*Er;return{h:a<0?a+360:a,c:Math.sqrt(n*n+i*i),l:r,alpha:e.a}},reverse:function(e){var t=e.h*kr,r=e.c;return Rr({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Mr(e.h,t.h,r),c:vr(e.c,t.c,r),l:vr(e.l,t.l,r),alpha:vr(e.alpha,t.alpha,r)}}},Lr=Object.freeze({__proto__:null,lab:Pr,hcl:Or}),Dr=function(){function e(t,r,n,i,a){v(this,e),this.type=t,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];var o,s=f(a);try{for(s.s();!(o=s.n()).done;){var u=h(o.value,2),l=u[0],c=u[1];this.labels.push(l),this.outputs.push(c)}}catch(d){s.e(d)}finally{s.f()}}return m(e,[{key:"evaluate",value:function(t){var r=this.labels,n=this.outputs;if(1===r.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);var a=r.length;if(i>=r[a-1])return n[a-1].evaluate(t);var o=pr(r,i),s=e.interpolationFactor(this.interpolation,i,r[o],r[o+1]),u=n[o].evaluate(t),l=n[o+1].evaluate(t);return"interpolate"===this.operator?mr[this.type.kind.toLowerCase()](u,l,s):"interpolate-hcl"===this.operator?Or.reverse(Or.interpolate(Or.forward(u),Or.forward(l),s)):Pr.reverse(Pr.interpolate(Pr.forward(u),Pr.forward(l),s))}},{key:"eachChild",value:function(e){e(this.input);var t,r=f(this.outputs);try{for(r.s();!(t=r.n()).done;)e(t.value)}catch(n){r.e(n)}finally{r.f()}}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t}}],[{key:"interpolationFactor",value:function(e,t,n,i){var a=0;if("exponential"===e.name)a=Br(t,e.base,n,i);else if("linear"===e.name)a=Br(t,1,n,i);else if("cubic-bezier"===e.name){var o=e.controlPoints;a=new r(o[0],o[1],o[2],o[3]).solve(Br(t,1,n,i))}return a}},{key:"parse",value:function(t,r){var n=l(t),i=n[0],a=n[1],o=n[2],s=n.slice(3);if(!Array.isArray(a)||0===a.length)return r.error("Expected an interpolation type expression.",1);if("linear"===a[0])a={name:"linear"};else if("exponential"===a[0]){var u=a[1];if("number"!=typeof u)return r.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:u}}else{if("cubic-bezier"!==a[0])return r.error("Unknown interpolation type ".concat(String(a[0])),1,0);var c=a.slice(1);if(4!==c.length||c.some((function(e){return"number"!=typeof e||e<0||e>1})))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:c}}if(t.length-1<4)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(!(o=r.parse(o,2,st)))return null;var h=[],f=null;"interpolate-hcl"===i||"interpolate-lab"===i?f=ct:r.expectedType&&"value"!==r.expectedType.kind&&(f=r.expectedType);for(var d=0;d<s.length;d+=2){var p=s[d],y=s[d+1],v=d+3,m=d+4;if("number"!=typeof p)return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(h.length&&h[h.length-1][0]>=p)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',v);var g=r.parse(y,m,f);if(!g)return null;f=f||g.type,h.push([p,g])}return"number"===f.kind||"color"===f.kind||"array"===f.kind&&"number"===f.itemType.kind&&"number"==typeof f.N?new e(f,i,a,o,h):r.error("Type ".concat(mt(f)," is not interpolatable."))}}]),e}();function Br(e,t,r,n){var i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}var Nr=function(){function e(t,r){v(this,e),this.type=t,this.args=r}return m(e,[{key:"evaluate",value:function(e){var t,r,n=null,i=0,a=f(this.args);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(i++,(n=o.evaluate(e))&&n instanceof Ct&&!n.available&&(t||(t=n.name),n=null,i===this.args.length&&(n=t)),null!==n)break}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"eachChild",value:function(e){this.args.forEach(e)}},{key:"outputDefined",value:function(){return this.args.every((function(e){return e.outputDefined()}))}},{key:"serialize",value:function(){var e=["coalesce"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,r){if(t.length<2)return r.error("Expectected at least one argument.");var n=null,i=r.expectedType;i&&"value"!==i.kind&&(n=i);var a,o=[],s=f(t.slice(1));try{for(s.s();!(a=s.n()).done;){var u=a.value,l=r.parse(u,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}}catch(c){s.e(c)}finally{s.f()}return new e(i&&o.some((function(e){return _t(i,e.type)}))?ft:n,o)}}]),e}(),zr=function(){function e(t,r){v(this,e),this.type=r.type,this.bindings=[].concat(t),this.result=r}return m(e,[{key:"evaluate",value:function(e){return this.result.evaluate(e)}},{key:"eachChild",value:function(e){var t,r=f(this.bindings);try{for(r.s();!(t=r.n()).done;)e(t.value[1])}catch(n){r.e(n)}finally{r.f()}e(this.result)}},{key:"outputDefined",value:function(){return this.result.outputDefined()}},{key:"serialize",value:function(){var e,t=["let"],r=f(this.bindings);try{for(r.s();!(e=r.n()).done;){var n=h(e.value,2),i=n[0],a=n[1];t.push(i,a.serialize())}}catch(o){r.e(o)}finally{r.f()}return t.push(this.result.serialize()),t}}],[{key:"parse",value:function(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found ".concat(t.length-1," instead."));for(var n=[],i=1;i<t.length-1;i+=2){var a=t[i];if("string"!=typeof a)return r.error("Expected string, but found ".concat(typeof a," instead."),i);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=r.parse(t[i+1],i+1);if(!o)return null;n.push([a,o])}var s=r.parse(t[t.length-1],t.length-1,r.expectedType,n);return s?new e(n,s):null}}]),e}(),Fr=function(){function e(t,r,n){v(this,e),this.type=t,this.index=r,this.input=n}return m(e,[{key:"evaluate",value:function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Lt("Array index out of bounds: ".concat(t," < 0."));if(t>=r.length)throw new Lt("Array index out of bounds: ".concat(t," > ").concat(r.length-1,"."));if(t!==Math.floor(t))throw new Lt("Array index must be an integer, but found ".concat(t," instead."));return r[t]}},{key:"eachChild",value:function(e){e(this.index),e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return["at",this.index.serialize(),this.input.serialize()]}}],[{key:"parse",value:function(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var n=r.parse(t[1],1,st),i=r.parse(t[2],2,vt(r.expectedType||ft));return n&&i?new e(i.type.itemType,n,i):null}}]),e}(),jr=function(){function e(t,r){v(this,e),this.type=lt,this.needle=t,this.haystack=r}return m(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!wt(t,["boolean","string","number","null"]))throw new Lt("Expected first argument to be of type boolean, string, number or null, but found ".concat(mt(Mt(t))," instead."));if(!wt(r,["string","array"]))throw new Lt("Expected second argument to be of type array or string, but found ".concat(mt(Mt(r))," instead."));return r.indexOf(t)>=0}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){return["in",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,r){if(3!==t.length)return r.error("Expected 2 arguments, but found ".concat(t.length-1," instead."));var n=r.parse(t[1],1,ft),i=r.parse(t[2],2,ft);return n&&i?bt(n.type,[lt,ut,st,ot,ft])?new e(n,i):r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(mt(n.type)," instead")):null}}]),e}(),Ur=function(){function e(t,r,n){v(this,e),this.type=st,this.needle=t,this.haystack=r,this.fromIndex=n}return m(e,[{key:"evaluate",value:function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!wt(t,["boolean","string","number","null"]))throw new Lt("Expected first argument to be of type boolean, string, number or null, but found ".concat(mt(Mt(t))," instead."));if(!wt(r,["string","array"]))throw new Lt("Expected second argument to be of type array or string, but found ".concat(mt(Mt(r))," instead."));if(this.fromIndex){var n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}},{key:"eachChild",value:function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}],[{key:"parse",value:function(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var n=r.parse(t[1],1,ft),i=r.parse(t[2],2,ft);if(!n||!i)return null;if(!bt(n.type,[lt,ut,st,ot,ft]))return r.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(mt(n.type)," instead"));if(4===t.length){var a=r.parse(t[3],3,st);return a?new e(n,i,a):null}return new e(n,i)}}]),e}(),Vr=function(){function e(t,r,n,i,a,o){v(this,e),this.inputType=t,this.type=r,this.input=n,this.cases=i,this.outputs=a,this.otherwise=o}return m(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);return(Mt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}},{key:"eachChild",value:function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}},{key:"outputDefined",value:function(){return this.outputs.every((function(e){return e.outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e,t=this,r=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),i=[],a={},o=f(n);try{for(o.s();!(e=o.n()).done;){var s=e.value,u=a[this.cases[s]];void 0===u?(a[this.cases[s]]=i.length,i.push([this.cases[s],[s]])):i[u][1].push(s)}}catch(m){o.e(m)}finally{o.f()}for(var l=function(e){return"number"===t.inputType.kind?Number(e):e},c=0,d=i;c<d.length;c++){var p=h(d[c],2),y=p[0],v=p[1];r.push(1===v.length?l(v[0]):v.map(l)),r.push(this.outputs[y].serialize())}return r.push(this.otherwise.serialize()),r}}],[{key:"parse",value:function(t,r){if(t.length<5)return r.error("Expected at least 4 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=1)return r.error("Expected an even number of arguments.");var n,i;r.expectedType&&"value"!==r.expectedType.kind&&(i=r.expectedType);for(var a={},o=[],s=2;s<t.length-1;s+=2){var u=t[s],l=t[s+1];Array.isArray(u)||(u=[u]);var c=r.concat(s);if(0===u.length)return c.error("Expected at least one branch label.");var h,d=f(u);try{for(d.s();!(h=d.n()).done;){var p=h.value;if("number"!=typeof p&&"string"!=typeof p)return c.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return c.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof p&&Math.floor(p)!==p)return c.error("Numeric branch labels must be integer values.");if(n){if(c.checkSubtype(n,Mt(p)))return null}else n=Mt(p);if(void 0!==a[String(p)])return c.error("Branch labels must be unique.");a[String(p)]=o.length}}catch(g){d.e(g)}finally{d.f()}var y=r.parse(l,s,i);if(!y)return null;i=i||y.type,o.push(y)}var v=r.parse(t[1],1,ft);if(!v)return null;var m=r.parse(t[t.length-1],t.length-1,i);return m?"value"!==v.type.kind&&r.concat(1).checkSubtype(n,v.type)?null:new e(n,i,v,a,o,m):null}}]),e}(),qr=function(){function e(t,r,n){v(this,e),this.type=t,this.branches=r,this.otherwise=n}return m(e,[{key:"evaluate",value:function(e){var t,r=f(this.branches);try{for(r.s();!(t=r.n()).done;){var n=h(t.value,2),i=n[0],a=n[1];if(i.evaluate(e))return a.evaluate(e)}}catch(o){r.e(o)}finally{r.f()}return this.otherwise.evaluate(e)}},{key:"eachChild",value:function(e){var t,r=f(this.branches);try{for(r.s();!(t=r.n()).done;){var n=h(t.value,2),i=n[0],a=n[1];e(i),e(a)}}catch(o){r.e(o)}finally{r.f()}e(this.otherwise)}},{key:"outputDefined",value:function(){return this.branches.every((function(e){var t=h(e,2);return t[0],t[1].outputDefined()}))&&this.otherwise.outputDefined()}},{key:"serialize",value:function(){var e=["case"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,r){if(t.length<4)return r.error("Expected at least 3 arguments, but found only ".concat(t.length-1,"."));if(t.length%2!=0)return r.error("Expected an odd number of arguments.");var n;r.expectedType&&"value"!==r.expectedType.kind&&(n=r.expectedType);for(var i=[],a=1;a<t.length-1;a+=2){var o=r.parse(t[a],a,lt);if(!o)return null;var s=r.parse(t[a+1],a+1,n);if(!s)return null;i.push([o,s]),n=n||s.type}var u=r.parse(t[t.length-1],t.length-1,n);return u?new e(n,i,u):null}}]),e}(),Gr=function(){function e(t,r,n,i){v(this,e),this.type=t,this.input=r,this.beginIndex=n,this.endIndex=i}return m(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!wt(t,["string","array"]))throw new Lt("Expected first argument to be of type array or string, but found ".concat(mt(Mt(t))," instead."));if(this.endIndex){var n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}},{key:"eachChild",value:function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}],[{key:"parse",value:function(t,r){if(t.length<=2||t.length>=5)return r.error("Expected 3 or 4 arguments, but found ".concat(t.length-1," instead."));var n=r.parse(t[1],1,ft),i=r.parse(t[2],2,st);if(!n||!i)return null;if(!bt(n.type,[vt(ft),ut,ft]))return r.error("Expected first argument to be of type array or string, but found ".concat(mt(n.type)," instead"));if(4===t.length){var a=r.parse(t[3],3,st);return a?new e(n.type,n,i,a):null}return new e(n.type,n,i)}}]),e}();function Kr(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Hr(e,t,r,n){return 0===n.compare(t,r)}function Wr(e,t,r){var n="=="!==e&&"!="!==e;return function(){function i(e,t,r){v(this,i),this.type=lt,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}return m(i,[{key:"evaluate",value:function(i){var a=this.lhs.evaluate(i),o=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){var s=Mt(a),u=Mt(o);if(s.kind!==u.kind||"string"!==s.kind&&"number"!==s.kind)throw new Lt('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(s.kind,", ").concat(u.kind,") instead."))}if(this.collator&&!n&&this.hasUntypedArgument){var l=Mt(a),c=Mt(o);if("string"!==l.kind||"string"!==c.kind)return t(i,a,o)}return this.collator?r(i,a,o,this.collator.evaluate(i)):t(i,a,o)}},{key:"eachChild",value:function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}},{key:"outputDefined",value:function(){return!0}},{key:"serialize",value:function(){var t=[e];return this.eachChild((function(e){t.push(e.serialize())})),t}}],[{key:"parse",value:function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var r=e[0],a=t.parse(e[1],1,ft);if(!a)return null;if(!Kr(r,a.type))return t.concat(1).error('"'.concat(r,"\" comparisons are not supported for type '").concat(mt(a.type),"'."));var o=t.parse(e[2],2,ft);if(!o)return null;if(!Kr(r,o.type))return t.concat(2).error('"'.concat(r,"\" comparisons are not supported for type '").concat(mt(o.type),"'."));if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '".concat(mt(a.type),"' and '").concat(mt(o.type),"'."));n&&("value"===a.type.kind&&"value"!==o.type.kind?a=new Bt(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new Bt(a.type,[o])));var s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(s=t.parse(e[3],3,dt)))return null}return new i(a,o,s)}}]),i}()}var Zr=Wr("==",(function(e,t,r){return t===r}),Hr),Yr=Wr("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!Hr(0,t,r,n)})),Xr=Wr("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),Qr=Wr(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),Jr=Wr("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),$r=Wr(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0})),en=function(){function e(t,r,n,i,a){v(this,e),this.type=ut,this.number=t,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=a}return m(e,[{key:"evaluate",value:function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}},{key:"eachChild",value:function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}],[{key:"parse",value:function(t,r){if(3!==t.length)return r.error("Expected two arguments.");var n=r.parse(t[1],1,st);if(!n)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");var a=null;if(i.locale&&!(a=r.parse(i.locale,1,ut)))return null;var o=null;if(i.currency&&!(o=r.parse(i.currency,1,ut)))return null;var s=null;if(i["min-fraction-digits"]&&!(s=r.parse(i["min-fraction-digits"],1,st)))return null;var u=null;return i["max-fraction-digits"]&&!(u=r.parse(i["max-fraction-digits"],1,st))?null:new e(n,a,o,s,u)}}]),e}(),tn={"==":Zr,"!=":Yr,">":Qr,"<":Xr,">=":$r,"<=":Jr,array:Bt,at:Fr,boolean:Bt,case:qr,coalesce:Nr,collator:Gt,format:Nt,image:zt,in:jr,"index-of":Ur,interpolate:Dr,"interpolate-hcl":Dr,"interpolate-lab":Dr,length:function(){function e(t){v(this,e),this.type=st,this.input=t}return m(e,[{key:"evaluate",value:function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Lt("Expected value to be of type string or array, but found ".concat(mt(Mt(t))," instead."))}},{key:"eachChild",value:function(e){e(this.input)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){var e=["length"];return this.eachChild((function(t){e.push(t.serialize())})),e}}],[{key:"parse",value:function(t,r){if(2!==t.length)return r.error("Expected 1 argument, but found ".concat(t.length-1," instead."));var n=r.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?r.error("Expected argument of type string or array, but found ".concat(mt(n.type)," instead.")):new e(n):null}}]),e}(),let:zr,literal:Ot,match:Vr,number:Bt,"number-format":en,object:Bt,slice:Gr,step:yr,string:Bt,"to-boolean":jt,"to-color":jt,"to-number":jt,"to-string":jt,var:hr,within:sr};function rn(e,t){var r=h(t,4),n=r[0],i=r[1],a=r[2],o=r[3];n=n.evaluate(e),i=i.evaluate(e),a=a.evaluate(e);var s=o?o.evaluate(e):1,u=It(n,i,a,s);if(u)throw new Lt(u);return new Et(n/255*s,i/255*s,a/255*s,s)}function nn(e,t){return e in t}function an(e,t){var r=t[e];return void 0===r?null:r}function on(e){return{type:e}}function sn(e){return{result:"success",value:e}}function un(e){return{result:"error",value:e}}function ln(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function cn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function hn(e){return!!e.expression&&e.expression.interpolated}function fn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function dn(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function pn(e){return e}function yn(e,t){var r,n,i,a="color"===t.type,o=e.stops&&"object"==typeof e.stops[0][0],s=o||!(o||void 0!==e.property),u=e.type||(hn(t)?"exponential":"interval");if(a&&((e=tt({},e)).stops&&(e.stops=e.stops.map((function(e){return[e[0],Et.parse(e[1])]}))),e.default=Et.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Lr[e.colorSpace])throw new Error("Unknown color space: ".concat(e.colorSpace));if("exponential"===u)r=_n;else if("interval"===u)r=gn;else if("categorical"===u){r=mn,n=Object.create(null);var l,c=f(e.stops);try{for(c.s();!(l=c.n()).done;){var h=l.value;n[h[0]]=h[1]}}catch(E){c.e(E)}finally{c.f()}i=typeof e.stops[0][0]}else{if("identity"!==u)throw new Error('Unknown function type "'.concat(u,'"'));r=bn}if(o){for(var d={},p=[],y=0;y<e.stops.length;y++){var v=e.stops[y],m=v[0].zoom;void 0===d[m]&&(d[m]={zoom:m,type:e.type,property:e.property,default:e.default,stops:[]},p.push(m)),d[m].stops.push([v[0].value,v[1]])}for(var g=[],_=0,b=p;_<b.length;_++){var w=b[_];g.push([d[w].zoom,yn(d[w],t)])}var x={name:"linear"};return{kind:"composite",interpolationType:x,interpolationFactor:Dr.interpolationFactor.bind(void 0,x),zoomStops:g.map((function(e){return e[0]})),evaluate:function(r,n){var i=r.zoom;return _n({stops:g,base:e.base},t,i).evaluate(i,n)}}}if(s){var k="exponential"===u?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Dr.interpolationFactor.bind(void 0,k),zoomStops:e.stops.map((function(e){return e[0]})),evaluate:function(a){var o=a.zoom;return r(e,t,o,n,i)}}}return{kind:"source",evaluate:function(a,o){var s=o&&o.properties?o.properties[e.property]:void 0;return void 0===s?vn(e.default,t.default):r(e,t,s,n,i)}}}function vn(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function mn(e,t,r,n,i){return vn(typeof r===i?n[r]:void 0,e.default,t.default)}function gn(e,t,r){if("number"!==fn(r))return vn(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];var i=pr(e.stops.map((function(e){return e[0]})),r);return e.stops[i][1]}function _n(e,t,r){var n=void 0!==e.base?e.base:1;if("number"!==fn(r))return vn(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];var a=pr(e.stops.map((function(e){return e[0]})),r),o=function(e,t,r,n){var i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],u=e.stops[a+1][1],l=mr[t.type]||pn;if(e.colorSpace&&"rgb"!==e.colorSpace){var c=Lr[e.colorSpace];l=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=s.evaluate.apply(void 0,t),i=u.evaluate.apply(void 0,t);if(void 0!==n&&void 0!==i)return l(n,i,o)}}:l(s,u,o)}function bn(e,t,r){return"color"===t.type?r=Et.parse(r):"formatted"===t.type?r=At.fromString(r.toString()):"resolvedImage"===t.type?r=Ct.fromString(r.toString()):fn(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),vn(r,e.default,t.default)}qt.register(tn,{error:[{kind:"error"},[ut],function(e,t){var r=h(t,1)[0];throw new Lt(r.evaluate(e))}],typeof:[ut,[ft],function(e,t){return mt(Mt(h(t,1)[0].evaluate(e)))}],"to-rgba":[vt(st,4),[ct],function(e,t){return h(t,1)[0].evaluate(e).toArray()}],rgb:[ct,[st,st,st],rn],rgba:[ct,[st,st,st,st],rn],has:{type:lt,overloads:[[[ut],function(e,t){return nn(h(t,1)[0].evaluate(e),e.properties())}],[[ut,ht],function(e,t){var r=h(t,2),n=r[0],i=r[1];return nn(n.evaluate(e),i.evaluate(e))}]]},get:{type:ft,overloads:[[[ut],function(e,t){return an(h(t,1)[0].evaluate(e),e.properties())}],[[ut,ht],function(e,t){var r=h(t,2),n=r[0],i=r[1];return an(n.evaluate(e),i.evaluate(e))}]]},"feature-state":[ft,[ut],function(e,t){return an(h(t,1)[0].evaluate(e),e.featureState||{})}],properties:[ht,[],function(e){return e.properties()}],"geometry-type":[ut,[],function(e){return e.geometryType()}],id:[ft,[],function(e){return e.id()}],zoom:[st,[],function(e){return e.globals.zoom}],"heatmap-density":[st,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[st,[],function(e){return e.globals.lineProgress||0}],"sky-radial-progress":[st,[],function(e){return e.globals.skyRadialProgress||0}],accumulated:[ft,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[st,on(st),function(e,t){var r,n=0,i=f(t);try{for(i.s();!(r=i.n()).done;)n+=r.value.evaluate(e)}catch(a){i.e(a)}finally{i.f()}return n}],"*":[st,on(st),function(e,t){var r,n=1,i=f(t);try{for(i.s();!(r=i.n()).done;)n*=r.value.evaluate(e)}catch(a){i.e(a)}finally{i.f()}return n}],"-":{type:st,overloads:[[[st,st],function(e,t){var r=h(t,2),n=r[0],i=r[1];return n.evaluate(e)-i.evaluate(e)}],[[st],function(e,t){return-h(t,1)[0].evaluate(e)}]]},"/":[st,[st,st],function(e,t){var r=h(t,2),n=r[0],i=r[1];return n.evaluate(e)/i.evaluate(e)}],"%":[st,[st,st],function(e,t){var r=h(t,2),n=r[0],i=r[1];return n.evaluate(e)%i.evaluate(e)}],ln2:[st,[],function(){return Math.LN2}],pi:[st,[],function(){return Math.PI}],e:[st,[],function(){return Math.E}],"^":[st,[st,st],function(e,t){var r=h(t,2),n=r[0],i=r[1];return Math.pow(n.evaluate(e),i.evaluate(e))}],sqrt:[st,[st],function(e,t){var r=h(t,1)[0];return Math.sqrt(r.evaluate(e))}],log10:[st,[st],function(e,t){var r=h(t,1)[0];return Math.log(r.evaluate(e))/Math.LN10}],ln:[st,[st],function(e,t){var r=h(t,1)[0];return Math.log(r.evaluate(e))}],log2:[st,[st],function(e,t){var r=h(t,1)[0];return Math.log(r.evaluate(e))/Math.LN2}],sin:[st,[st],function(e,t){var r=h(t,1)[0];return Math.sin(r.evaluate(e))}],cos:[st,[st],function(e,t){var r=h(t,1)[0];return Math.cos(r.evaluate(e))}],tan:[st,[st],function(e,t){var r=h(t,1)[0];return Math.tan(r.evaluate(e))}],asin:[st,[st],function(e,t){var r=h(t,1)[0];return Math.asin(r.evaluate(e))}],acos:[st,[st],function(e,t){var r=h(t,1)[0];return Math.acos(r.evaluate(e))}],atan:[st,[st],function(e,t){var r=h(t,1)[0];return Math.atan(r.evaluate(e))}],min:[st,on(st),function(e,t){return Math.min.apply(Math,c(t.map((function(t){return t.evaluate(e)}))))}],max:[st,on(st),function(e,t){return Math.max.apply(Math,c(t.map((function(t){return t.evaluate(e)}))))}],abs:[st,[st],function(e,t){var r=h(t,1)[0];return Math.abs(r.evaluate(e))}],round:[st,[st],function(e,t){var r=h(t,1)[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[st,[st],function(e,t){var r=h(t,1)[0];return Math.floor(r.evaluate(e))}],ceil:[st,[st],function(e,t){var r=h(t,1)[0];return Math.ceil(r.evaluate(e))}],"filter-==":[lt,[ut,ft],function(e,t){var r=h(t,2),n=r[0],i=r[1];return e.properties()[n.value]===i.value}],"filter-id-==":[lt,[ft],function(e,t){var r=h(t,1)[0];return e.id()===r.value}],"filter-type-==":[lt,[ut],function(e,t){var r=h(t,1)[0];return e.geometryType()===r.value}],"filter-<":[lt,[ut,ft],function(e,t){var r=h(t,2),n=r[0],i=r[1],a=e.properties()[n.value],o=i.value;return typeof a==typeof o&&a<o}],"filter-id-<":[lt,[ft],function(e,t){var r=h(t,1)[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[lt,[ut,ft],function(e,t){var r=h(t,2),n=r[0],i=r[1],a=e.properties()[n.value],o=i.value;return typeof a==typeof o&&a>o}],"filter-id->":[lt,[ft],function(e,t){var r=h(t,1)[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[lt,[ut,ft],function(e,t){var r=h(t,2),n=r[0],i=r[1],a=e.properties()[n.value],o=i.value;return typeof a==typeof o&&a<=o}],"filter-id-<=":[lt,[ft],function(e,t){var r=h(t,1)[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[lt,[ut,ft],function(e,t){var r=h(t,2),n=r[0],i=r[1],a=e.properties()[n.value],o=i.value;return typeof a==typeof o&&a>=o}],"filter-id->=":[lt,[ft],function(e,t){var r=h(t,1)[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[lt,[ft],function(e,t){return h(t,1)[0].value in e.properties()}],"filter-has-id":[lt,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[lt,[vt(ut)],function(e,t){return h(t,1)[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[lt,[vt(ft)],function(e,t){return h(t,1)[0].value.indexOf(e.id())>=0}],"filter-in-small":[lt,[ut,vt(ft)],function(e,t){var r=h(t,2),n=r[0];return r[1].value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[lt,[ut,vt(ft)],function(e,t){var r=h(t,2),n=r[0],i=r[1];return function(e,t,r,n){for(;r<=n;){var i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:lt,overloads:[[[lt,lt],function(e,t){var r=h(t,2),n=r[0],i=r[1];return n.evaluate(e)&&i.evaluate(e)}],[on(lt),function(e,t){var r,n=f(t);try{for(n.s();!(r=n.n()).done;)if(!r.value.evaluate(e))return!1}catch(i){n.e(i)}finally{n.f()}return!0}]]},any:{type:lt,overloads:[[[lt,lt],function(e,t){var r=h(t,2),n=r[0],i=r[1];return n.evaluate(e)||i.evaluate(e)}],[on(lt),function(e,t){var r,n=f(t);try{for(n.s();!(r=n.n()).done;)if(r.value.evaluate(e))return!0}catch(i){n.e(i)}finally{n.f()}return!1}]]},"!":[lt,[lt],function(e,t){return!h(t,1)[0].evaluate(e)}],"is-supported-script":[lt,[ut],function(e,t){var r=h(t,1)[0],n=e.globals&&e.globals.isSupportedScript;return!n||n(r.evaluate(e))}],upcase:[ut,[ut],function(e,t){return h(t,1)[0].evaluate(e).toUpperCase()}],downcase:[ut,[ut],function(e,t){return h(t,1)[0].evaluate(e).toLowerCase()}],concat:[ut,on(ft),function(e,t){return t.map((function(t){return Pt(t.evaluate(e))})).join("")}],"resolved-locale":[ut,[dt],function(e,t){return h(t,1)[0].evaluate(e).resolvedLocale()}]});var wn=function(){function e(t,r){v(this,e),this.expression=t,this._warningHistory={},this._evaluator=new Vt,this._defaultValue=r?function(e){return"color"===e.type&&dn(e.default)?new Et(0,0,0,0):"color"===e.type?Et.parse(e.default)||null:void 0===e.default?null:e.default}(r):null,this._enumValues=r&&"enum"===r.type?r.values:null}return m(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,r,n,i,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}},{key:"evaluate",value:function(e,t,r,n,i,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{var o=this.expression.evaluate(this._evaluator);if(null==o||"number"==typeof o&&o!=o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new Lt("Expected value to be one of ".concat(Object.keys(this._enumValues).map((function(e){return JSON.stringify(e)})).join(", "),", but found ").concat(JSON.stringify(o)," instead."));return o}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}]),e}();function xn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in tn}function kn(e,t){var r=new fr(tn,[],t?function(e){var t={color:ct,string:ut,number:st,enum:ut,boolean:lt,formatted:pt,resolvedImage:yt};return"array"===e.type?vt(t[e.value]||ft,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?sn(new wn(n,t)):un(r.errors)}var En=function(){function e(t,r){v(this,e),this.kind=t,this._styleExpression=r,this.isStateDependent="constant"!==t&&!lr(r.expression)}return m(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}},{key:"evaluate",value:function(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)}}]),e}(),Sn=function(){function e(t,r,n,i){v(this,e),this.kind=t,this.zoomStops=n,this._styleExpression=r,this.isStateDependent="camera"!==t&&!lr(r.expression),this.interpolationType=i}return m(e,[{key:"evaluateWithoutErrorHandling",value:function(e,t,r,n,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,a)}},{key:"evaluate",value:function(e,t,r,n,i,a){return this._styleExpression.evaluate(e,t,r,n,i,a)}},{key:"interpolationFactor",value:function(e,t,r){return this.interpolationType?Dr.interpolationFactor(this.interpolationType,e,t,r):0}}]),e}();function Tn(e,t){if("error"===(e=kn(e,t)).result)return e;var r=e.value.expression,n=ur(r);if(!n&&!ln(t))return un([new it("","data expressions not supported")]);var i=cr(r,["zoom"]);if(!i&&!cn(t))return un([new it("","zoom expressions not supported")]);var a=Cn(r);return a||i?a instanceof it?un([a]):a instanceof Dr&&!hn(t)?un([new it("",'"interpolate" expressions cannot be used with this property')]):sn(a?new Sn(n?"camera":"composite",e.value,a.labels,a instanceof Dr?a.interpolation:void 0):new En(n?"constant":"source",e.value)):un([new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}var An=function(){function e(t,r){v(this,e),this._parameters=t,this._specification=r,tt(this,yn(this._parameters,this._specification))}return m(e,null,[{key:"deserialize",value:function(t){return new e(t._parameters,t._specification)}},{key:"serialize",value:function(e){return{_parameters:e._parameters,_specification:e._specification}}}]),e}();function Cn(e){var t=null;if(e instanceof zr)t=Cn(e.result);else if(e instanceof Nr){var r,n=f(e.args);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(t=Cn(i))break}}catch(a){n.e(a)}finally{n.f()}}else(e instanceof yr||e instanceof Dr)&&e.input instanceof qt&&"zoom"===e.input.name&&(t=e);return t instanceof it||e.eachChild((function(e){var r=Cn(e);r instanceof it?t=r:!t&&r?t=new it("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new it("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function In(e){var t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=[],u=fn(r);if("object"!==u)return[new $e(t,r,"object expected, ".concat(u," found"))];for(var l in r){var c=l.split(".")[0],h=n[c]||n["*"],f=void 0;if(i[c])f=i[c];else if(n[c])f=ii;else if(i["*"])f=i["*"];else{if(!n["*"]){s.push(new $e(t,r[l],'unknown property "'.concat(l,'"')));continue}f=ii}s=s.concat(f({key:(t?"".concat(t,"."):t)+l,value:r[l],valueSpec:h,style:a,styleSpec:o,object:r,objectKey:l},r))}for(var d in n)i[d]||n[d].required&&void 0===n[d].default&&void 0===r[d]&&s.push(new $e(t,r,'missing required property "'.concat(d,'"')));return s}function Rn(e){var t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,a=e.key,o=e.arrayElementValidator||ii;if("array"!==fn(t))return[new $e(a,t,"array expected, ".concat(fn(t)," found"))];if(r.length&&t.length!==r.length)return[new $e(a,t,"array length ".concat(r.length," expected, length ").concat(t.length," found"))];if(r["min-length"]&&t.length<r["min-length"])return[new $e(a,t,"array length at least ".concat(r["min-length"]," expected, length ").concat(t.length," found"))];var s={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum};i.$version<7&&(s.function=r.function),"object"===fn(r.value)&&(s=r.value);for(var u=[],l=0;l<t.length;l++)u=u.concat(o({array:t,arrayIndex:l,value:t[l],valueSpec:s,style:n,styleSpec:i,key:"".concat(a,"[").concat(l,"]")}));return u}function Mn(e){var t=e.key,r=e.value,n=e.valueSpec,i=fn(r);if("number"===i&&r!=r&&(i="NaN"),"number"!==i)return[new $e(t,r,"number expected, ".concat(i," found"))];if("minimum"in n){var a=n.minimum;if("array"===fn(n.minimum)&&(a=n.minimum[e.arrayIndex]),r<a)return[new $e(t,r,"".concat(r," is less than the minimum value ").concat(a))]}if("maximum"in n){var o=n.maximum;if("array"===fn(n.maximum)&&(o=n.maximum[e.arrayIndex]),r>o)return[new $e(t,r,"".concat(r," is greater than the maximum value ").concat(o))]}return[]}function Pn(e){var t,r,n,i=e.valueSpec,a=rt(e.value.type),o={},s="categorical"!==a&&void 0===e.value.property,u=!s,l="array"===fn(e.value.stops)&&"array"===fn(e.value.stops[0])&&"object"===fn(e.value.stops[0][0]),c=In({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===a)return[new $e(e.key,e.value,'identity function may not have a "stops" property')];var t=[],r=e.value;return t=t.concat(Rn({key:e.key,value:r,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===fn(r)&&0===r.length&&t.push(new $e(e.key,r,"array must have at least one stop")),t},default:function(e){return ii({key:e.key,value:e.value,valueSpec:i,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===a&&s&&c.push(new $e(e.key,e.value,'missing required property "property"')),"identity"===a||e.value.stops||c.push(new $e(e.key,e.value,'missing required property "stops"')),"exponential"===a&&e.valueSpec.expression&&!hn(e.valueSpec)&&c.push(new $e(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(u&&!ln(e.valueSpec)?c.push(new $e(e.key,e.value,"property functions not supported")):s&&!cn(e.valueSpec)&&c.push(new $e(e.key,e.value,"zoom functions not supported"))),"categorical"!==a&&!l||void 0!==e.value.property||c.push(new $e(e.key,e.value,'"property" property is required')),c;function h(e){var t=[],a=e.value,s=e.key;if("array"!==fn(a))return[new $e(s,a,"array expected, ".concat(fn(a)," found"))];if(2!==a.length)return[new $e(s,a,"array length 2 expected, length ".concat(a.length," found"))];if(l){if("object"!==fn(a[0]))return[new $e(s,a,"object expected, ".concat(fn(a[0])," found"))];if(void 0===a[0].zoom)return[new $e(s,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new $e(s,a,"object stop key must have value")];if(n&&n>rt(a[0].zoom))return[new $e(s,a[0].zoom,"stop zoom values must appear in ascending order")];rt(a[0].zoom)!==n&&(n=rt(a[0].zoom),r=void 0,o={}),t=t.concat(In({key:"".concat(s,"[0]"),value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Mn,value:f}}))}else t=t.concat(f({key:"".concat(s,"[0]"),value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a));return xn(nt(a[1]))?t.concat([new $e("".concat(s,"[1]"),a[1],"expressions are not allowed in function stops.")]):t.concat(ii({key:"".concat(s,"[1]"),value:a[1],valueSpec:i,style:e.style,styleSpec:e.styleSpec}))}function f(e,n){var s=fn(e.value),u=rt(e.value),l=null!==e.value?e.value:n;if(t){if(s!==t)return[new $e(e.key,l,"".concat(s," stop domain type must match previous stop domain type ").concat(t))]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new $e(e.key,l,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==a){var c="number expected, ".concat(s," found");return ln(i)&&void 0===a&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new $e(e.key,l,c)]}return"categorical"!==a||"number"!==s||isFinite(u)&&Math.floor(u)===u?"categorical"!==a&&"number"===s&&void 0!==r&&u<r?[new $e(e.key,l,"stop domain values must appear in ascending order")]:(r=u,"categorical"===a&&u in o?[new $e(e.key,l,"stop domain values must be unique")]:(o[u]=!0,[])):[new $e(e.key,l,"integer expected, found ".concat(u))]}}function On(e){var t=("property"===e.expressionContext?Tn:kn)(nt(e.value),e.valueSpec);if("error"===t.result)return t.value.map((function(t){return new $e("".concat(e.key).concat(t.key),e.value,t.message)}));var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new $e(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!lr(r))return[new $e(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!lr(r))return[new $e(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!cr(r,["zoom","feature-state"]))return[new $e(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!ur(r))return[new $e(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ln(e){var t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(rt(r))&&i.push(new $e(t,r,"expected one of [".concat(n.values.join(", "),"], ").concat(JSON.stringify(r)," found"))):-1===Object.keys(n.values).indexOf(rt(r))&&i.push(new $e(t,r,"expected one of [".concat(Object.keys(n.values).join(", "),"], ").concat(JSON.stringify(r)," found"))),i}function Dn(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":var t,r=f(e.slice(1));try{for(r.s();!(t=r.n()).done;){var n=t.value;if(!Dn(n)&&"boolean"!=typeof n)return!1}}catch(i){r.e(i)}finally{r.f()}return!0;default:return!0}}var Bn={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nn(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};Dn(e)||(e=jn(e));var t=kn(e,Bn);if("error"===t.result)throw new Error(t.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));return{filter:function(e,r,n){return t.value.evaluate(e,r,{},n)},needGeometry:Fn(e)}}function zn(e,t){return e<t?-1:e>t?1:0}function Fn(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(var t=1;t<e.length;t++)if(Fn(e[t]))return!0;return!1}function jn(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?Un(e[1],e[2],"=="):"!="===r?Gn(Un(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Un(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(jn))):"all"===r?["all"].concat(e.slice(1).map(jn)):"none"===r?["all"].concat(e.slice(1).map(jn).map(Gn)):"in"===r?Vn(e[1],e.slice(2)):"!in"===r?Gn(Vn(e[1],e.slice(2))):"has"===r?qn(e[1]):"!has"===r?Gn(qn(e[1])):"within"!==r||e}function Un(e,t,r){switch(e){case"$type":return["filter-type-".concat(r),t];case"$id":return["filter-id-".concat(r),t];default:return["filter-".concat(r),e,t]}}function Vn(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((function(e){return typeof e!=typeof t[0]}))?["filter-in-large",e,["literal",t.sort(zn)]]:["filter-in-small",e,["literal",t]]}}function qn(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Gn(e){return["!",e]}function Kn(e){return Dn(nt(e.value))?On(tt({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Hn(e)}function Hn(e){var t=e.value,r=e.key;if("array"!==fn(t))return[new $e(r,t,"array expected, ".concat(fn(t)," found"))];var n,i=e.styleSpec,a=[];if(t.length<1)return[new $e(r,t,"filter array must have at least 1 element")];switch(a=a.concat(Ln({key:"".concat(r,"[0]"),value:t[0],valueSpec:i.filter_operator,style:e.style,styleSpec:e.styleSpec})),rt(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===rt(t[1])&&a.push(new $e(r,t,'"$type" cannot be use with operator "'.concat(t[0],'"')));case"==":case"!=":3!==t.length&&a.push(new $e(r,t,'filter array for operator "'.concat(t[0],'" must have 3 elements')));case"in":case"!in":t.length>=2&&"string"!==(n=fn(t[1]))&&a.push(new $e("".concat(r,"[1]"),t[1],"string expected, ".concat(n," found")));for(var o=2;o<t.length;o++)n=fn(t[o]),"$type"===rt(t[1])?a=a.concat(Ln({key:"".concat(r,"[").concat(o,"]"),value:t[o],valueSpec:i.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==n&&"number"!==n&&"boolean"!==n&&a.push(new $e("".concat(r,"[").concat(o,"]"),t[o],"string, number, or boolean expected, ".concat(n," found")));break;case"any":case"all":case"none":for(var s=1;s<t.length;s++)a=a.concat(Hn({key:"".concat(r,"[").concat(s,"]"),value:t[s],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":n=fn(t[1]),2!==t.length?a.push(new $e(r,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"string"!==n&&a.push(new $e("".concat(r,"[1]"),t[1],"string expected, ".concat(n," found")));break;case"within":n=fn(t[1]),2!==t.length?a.push(new $e(r,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"object"!==n&&a.push(new $e("".concat(r,"[1]"),t[1],"object expected, ".concat(n," found")))}return a}function Wn(e,t){var r=e.key,n=e.style,i=e.styleSpec,a=e.value,o=e.objectKey,s=i["".concat(t,"_").concat(e.layerType)];if(!s)return[];var u=o.match(/^(.*)-transition$/);if("paint"===t&&u&&s[u[1]]&&s[u[1]].transition)return ii({key:r,value:a,valueSpec:i.transition,style:n,styleSpec:i});var l,c=e.valueSpec||s[o];if(!c)return[new $e(r,a,'unknown property "'.concat(o,'"'))];if("string"===fn(a)&&ln(c)&&!c.tokens&&(l=/^{([^}]+)}$/.exec(a)))return[new $e(r,a,'"'.concat(o,'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ').concat(JSON.stringify(l[1])," }`."))];var h=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&h.push(new $e(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&dn(nt(a))&&"identity"===rt(a.type)&&h.push(new $e(r,a,'"text-font" does not support identity functions'))),h.concat(ii({key:e.key,value:a,valueSpec:c,style:n,styleSpec:i,expressionContext:"property",propertyType:t,propertyKey:o}))}function Zn(e){return Wn(e,"paint")}function Yn(e){return Wn(e,"layout")}function Xn(e){var t=[],r=e.value,n=e.key,i=e.style,a=e.styleSpec;r.type||r.ref||t.push(new $e(n,r,'either "type" or "ref" is required'));var o,s=rt(r.type),u=rt(r.ref);if(r.id)for(var l=rt(r.id),c=0;c<e.arrayIndex;c++){var h=i.layers[c];rt(h.id)===l&&t.push(new $e(n,r.id,'duplicate layer id "'.concat(r.id,'", previously used at line ').concat(h.id.__line__)))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach((function(e){e in r&&t.push(new $e(n,r[e],'"'.concat(e,'" is prohibited for ref layers')))})),i.layers.forEach((function(e){rt(e.id)===u&&(o=e)})),o?o.ref?t.push(new $e(n,r.ref,"ref cannot reference another ref layer")):s=rt(o.type):t.push(new $e(n,r.ref,'ref layer "'.concat(u,'" not found')));else if("background"!==s&&"sky"!==s)if(r.source){var f=i.sources&&i.sources[r.source],d=f&&rt(f.type);f?"vector"===d&&"raster"===s?t.push(new $e(n,r.source,'layer "'.concat(r.id,'" requires a raster source'))):"raster"===d&&"raster"!==s?t.push(new $e(n,r.source,'layer "'.concat(r.id,'" requires a vector source'))):"vector"!==d||r["source-layer"]?"raster-dem"===d&&"hillshade"!==s?t.push(new $e(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===d&&f.lineMetrics||t.push(new $e(n,r,'layer "'.concat(r.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new $e(n,r,'layer "'.concat(r.id,'" must specify a "source-layer"'))):t.push(new $e(n,r.source,'source "'.concat(r.source,'" not found')))}else t.push(new $e(n,r,'missing required property "source"'));return t=t.concat(In({key:n,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return ii({key:"".concat(n,".type"),value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Kn,layout:function(e){return In({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Yn(tt({layerType:s},e))}}})},paint:function(e){return In({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Zn(tt({layerType:s},e))}}})}}}))}function Qn(e){var t=e.value,r=e.key,n=fn(t);return"string"!==n?[new $e(r,t,"string expected, ".concat(n," found"))]:[]}var Jn={promoteId:function(e){var t=e.key,r=e.value;if("string"===fn(r))return Qn({key:t,value:r});var n=[];for(var i in r)n.push.apply(n,c(Qn({key:"".concat(t,".").concat(i),value:r[i]})));return n}};function $n(e){var t=e.value,r=e.key,n=e.styleSpec,i=e.style;if(!t.type)return[new $e(r,t,'"type" is required')];var a,o=rt(t.type);switch(o){case"vector":case"raster":case"raster-dem":return a=In({key:r,value:t,valueSpec:n["source_".concat(o.replace("-","_"))],style:e.style,styleSpec:n,objectElementValidators:Jn});case"geojson":if(a=In({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,objectElementValidators:Jn}),t.cluster)for(var s in t.clusterProperties){var u,l,f=h(t.clusterProperties[s],2),d=f[0],p=f[1],y="string"==typeof d?[d,["accumulated"],["get",s]]:d;(u=a).push.apply(u,c(On({key:"".concat(r,".").concat(s,".map"),value:p,expressionContext:"cluster-map"}))),(l=a).push.apply(l,c(On({key:"".concat(r,".").concat(s,".reduce"),value:y,expressionContext:"cluster-reduce"})))}return a;case"video":return In({key:r,value:t,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return In({key:r,value:t,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return[new $e(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ln({key:"".concat(r,".type"),value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function ei(e){var t=e.value,r=e.styleSpec,n=r.light,i=e.style,a=[],o=fn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new $e("light",t,"object expected, ".concat(o," found"))]);for(var s in t){var u=s.match(/^(.*)-transition$/);a=a.concat(u&&n[u[1]]&&n[u[1]].transition?ii({key:s,value:t[s],valueSpec:r.transition,style:i,styleSpec:r}):n[s]?ii({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r}):[new $e(s,t[s],'unknown property "'.concat(s,'"'))])}return a}function ti(e){var t=e.value,r=e.key,n=e.style,i=e.styleSpec,a=i.terrain,o=[],s=fn(t);if(void 0===t)return o;if("object"!==s)return o=o.concat([new $e("terrain",t,"object expected, ".concat(s," found"))]);for(var u in t){var l=u.match(/^(.*)-transition$/);o=o.concat(l&&a[l[1]]&&a[l[1]].transition?ii({key:u,value:t[u],valueSpec:i.transition,style:n,styleSpec:i}):a[u]?ii({key:u,value:t[u],valueSpec:a[u],style:n,styleSpec:i}):[new $e(u,t[u],'unknown property "'.concat(u,'"'))])}if(t.source){var c=n.sources&&n.sources[t.source],h=c&&rt(c.type);c?"raster-dem"!==h&&o.push(new $e(r,t.source,"terrain cannot be used with a source of type ".concat(h,', it only be used with a "raster-dem" source type'))):o.push(new $e(r,t.source,'source "'.concat(t.source,'" not found')))}else o.push(new $e(r,t,'terrain is missing required property "source"'));return o}function ri(e){var t=e.value,r=e.style,n=e.styleSpec,i=n.fog,a=[],o=fn(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new $e("fog",t,"object expected, ".concat(o," found"))]);for(var s in t){var u=s.match(/^(.*)-transition$/);a=a.concat(u&&i[u[1]]&&i[u[1]].transition?ii({key:s,value:t[s],valueSpec:n.transition,style:r,styleSpec:n}):i[s]?ii({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}):[new $e(s,t[s],'unknown property "'.concat(s,'"'))])}return a}var ni={"*":function(){return[]},array:Rn,boolean:function(e){var t=e.value,r=e.key,n=fn(t);return"boolean"!==n?[new $e(r,t,"boolean expected, ".concat(n," found"))]:[]},number:Mn,color:function(e){var t=e.key,r=e.value,n=fn(r);return"string"!==n?[new $e(t,r,"color expected, ".concat(n," found"))]:null===kt.parseCSSColor(r)?[new $e(t,r,'color expected, "'.concat(r,'" found'))]:[]},constants:et,enum:Ln,filter:Kn,function:Pn,layer:Xn,object:In,source:$n,light:ei,terrain:ti,fog:ri,string:Qn,formatted:function(e){return 0===Qn(e).length?[]:On(e)},resolvedImage:function(e){return 0===Qn(e).length?[]:On(e)}};function ii(e){var t=e.value,r=e.valueSpec,n=e.styleSpec;return r.expression&&dn(rt(t))?Pn(e):r.expression&&xn(nt(t))?On(e):r.type&&ni[r.type]?ni[r.type](e):In(tt({},e,{valueSpec:r.type?n[r.type]:r}))}function ai(e){var t=e.value,r=e.key,n=Qn(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new $e(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new $e(r,t,'"glyphs" url must include a "{range}" token'))),n}function oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Je,r=[];return r=r.concat(ii({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ai,"*":function(){return[]}}})),e.constants&&(r=r.concat(et({key:"constants",value:e.constants,style:e,styleSpec:t}))),si(r)}function si(e){return[].concat(e).sort((function(e,t){return e.line-t.line}))}function ui(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return si(e.apply(this,r))}}oi.source=ui($n),oi.light=ui(ei),oi.terrain=ui(ti),oi.fog=ui(ri),oi.layer=ui(Xn),oi.filter=ui(Kn),oi.paintProperty=ui(Zn),oi.layoutProperty=ui(Yn);var li=oi,ci=li.light,hi=li.fog,fi=li.paintProperty,di=li.layoutProperty;function pi(e,t){var r=!1;if(t&&t.length){var n,i=f(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.fire(new Xe(new Error(a.message))),r=!0}}catch(o){i.e(o)}finally{i.f()}}return r}var yi=vi;function vi(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(var a=0;a<this.d*this.d;a++){var o=i[3+a],s=i[3+a+1];n.push(o===s?null:i.subarray(o,s))}var u=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var l=0;l<this.d*this.d;l++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var c=r/t*e;this.min=-c,this.max=e+c}vi.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},vi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},vi.prototype._insertCell=function(e,t,r,n,i,a){this.cells[i].push(a)},vi.prototype.query=function(e,t,r,n,i){var a=this.min,o=this.max;if(e<=a&&t<=a&&o<=r&&o<=n&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,n,this._queryCell,s,{},i),s},vi.prototype._queryCell=function(e,t,r,n,i,a,o,s){var u=this.cells[i];if(null!==u)for(var l=this.keys,c=this.bboxes,h=0;h<u.length;h++){var f=u[h];if(void 0===o[f]){var d=4*f;(s?s(c[d+0],c[d+1],c[d+2],c[d+3]):e<=c[d+2]&&t<=c[d+3]&&r>=c[d+0]&&n>=c[d+1])?(o[f]=!0,a.push(l[f])):o[f]=!1}}},vi.prototype._forEachCell=function(e,t,r,n,i,a,o,s){for(var u=this._convertToCellCoord(e),l=this._convertToCellCoord(t),c=this._convertToCellCoord(r),h=this._convertToCellCoord(n),f=u;f<=c;f++)for(var d=l;d<=h;d++){var p=this.d*d+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(d),this._convertFromCellCoord(f+1),this._convertFromCellCoord(d+1)))&&i.call(this,e,t,r,n,p,a,o,s))return}},vi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},vi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},vi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var a=t,o=0;o<e.length;o++){var s=e[o];i[3+o]=a,i.set(s,a),a+=s.length}return i[3+e.length]=a,i.set(this.keys,a),i[3+e.length+1]=a+=this.keys.length,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer};var mi=b.ImageData,gi=b.ImageBitmap,_i={};function bi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),_i[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var wi in bi("Object",Object),yi.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},yi.deserialize=function(e){return new yi(e.buffer)},bi("Grid",yi),bi("Color",Et),bi("Error",Error),bi("ResolvedImage",Ct),bi("StylePropertyFunction",An),bi("StyleExpression",wn,{omit:["_evaluator"]}),bi("ZoomDependentExpression",Sn),bi("ZoomConstantExpression",En),bi("CompoundExpression",qt,{omit:["_evaluate"]}),tn)tn[wi]._classRegistryKey||bi("Expression_".concat(wi),tn[wi]);function xi(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function ki(e){return gi&&e instanceof gi}function Ei(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(xi(e)||ki(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof mi)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){var n,i=[],a=f(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.push(Ei(o,t))}}catch(d){a.e(d)}finally{a.f()}return i}if("object"==typeof e){var s=e.constructor,u=s._classRegistryKey;if(!u)throw new Error("can't serialize object of unregistered class");var l=s.serialize?s.serialize(e,t):{};if(!s.serialize){for(var c in e)if(e.hasOwnProperty(c)&&!(_i[u].omit.indexOf(c)>=0)){var h=e[c];l[c]=_i[u].shallow.indexOf(c)>=0?h:Ei(h,t)}e instanceof Error&&(l.message=e.message)}if(l.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(l.$name=u),l}throw new Error("can't serialize object of type "+typeof e)}function Si(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||xi(e)||ki(e)||ArrayBuffer.isView(e)||e instanceof mi)return e;if(Array.isArray(e))return e.map(Si);if("object"==typeof e){var t=e.$name||"Object",r=_i[t].klass;if(!r)throw new Error("can't deserialize unregistered class ".concat(t));if(r.deserialize)return r.deserialize(e);for(var n=Object.create(r.prototype),i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];if("$name"!==o){var s=e[o];n[o]=_i[t].shallow.indexOf(o)>=0?s:Si(s)}}return n}throw new Error("can't deserialize object of type "+typeof e)}var Ti=function(){function e(){v(this,e),this.first=!0}return m(e,[{key:"update",value:function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))}}]),e}(),Ai=function(e){return e>=1536&&e<=1791},Ci=function(e){return e>=1872&&e<=1919},Ii=function(e){return e>=2208&&e<=2303},Ri=function(e){return e>=11904&&e<=12031},Mi=function(e){return e>=12032&&e<=12255},Pi=function(e){return e>=12272&&e<=12287},Oi=function(e){return e>=12288&&e<=12351},Li=function(e){return e>=12352&&e<=12447},Di=function(e){return e>=12448&&e<=12543},Bi=function(e){return e>=12544&&e<=12591},Ni=function(e){return e>=12704&&e<=12735},zi=function(e){return e>=12736&&e<=12783},Fi=function(e){return e>=12784&&e<=12799},ji=function(e){return e>=12800&&e<=13055},Ui=function(e){return e>=13056&&e<=13311},Vi=function(e){return e>=13312&&e<=19903},qi=function(e){return e>=19968&&e<=40959},Gi=function(e){return e>=40960&&e<=42127},Ki=function(e){return e>=42128&&e<=42191},Hi=function(e){return e>=44032&&e<=55215},Wi=function(e){return e>=63744&&e<=64255},Zi=function(e){return e>=64336&&e<=65023},Yi=function(e){return e>=65040&&e<=65055},Xi=function(e){return e>=65072&&e<=65103},Qi=function(e){return e>=65104&&e<=65135},Ji=function(e){return e>=65136&&e<=65279},$i=function(e){return e>=65280&&e<=65519};function ea(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)if(na(t.value.charCodeAt(0)))return!0}catch(n){r.e(n)}finally{r.f()}return!1}function ta(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)if(!ra(t.value.charCodeAt(0)))return!1}catch(n){r.e(n)}finally{r.f()}return!0}function ra(e){return!(Ai(e)||Ci(e)||Ii(e)||Zi(e)||Ji(e))}function na(e){return!(746!==e&&747!==e&&(e<4352||!(Ni(e)||Bi(e)||Xi(e)&&!(e>=65097&&e<=65103)||Wi(e)||Ui(e)||Ri(e)||zi(e)||!(!Oi(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Vi(e)||qi(e)||ji(e)||function(e){return e>=12592&&e<=12687}(e)||function(e){return e>=43360&&e<=43391}(e)||function(e){return e>=55216&&e<=55295}(e)||function(e){return e>=4352&&e<=4607}(e)||Hi(e)||Li(e)||Pi(e)||function(e){return e>=12688&&e<=12703}(e)||Mi(e)||Fi(e)||Di(e)&&12540!==e||!(!$i(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Qi(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||function(e){return e>=5120&&e<=5759}(e)||function(e){return e>=6320&&e<=6399}(e)||Yi(e)||function(e){return e>=19904&&e<=19967}(e)||Gi(e)||Ki(e))))}function ia(e){return!(na(e)||function(e){return!!(function(e){return e>=128&&e<=255}(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||function(e){return e>=8192&&e<=8303}(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||function(e){return e>=8448&&e<=8527}(e)||function(e){return e>=8528&&e<=8591}(e)||function(e){return e>=8960&&e<=9215}(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||function(e){return e>=9216&&e<=9279}(e)&&9251!==e||function(e){return e>=9280&&e<=9311}(e)||function(e){return e>=9312&&e<=9471}(e)||function(e){return e>=9632&&e<=9727}(e)||function(e){return e>=9728&&e<=9983}(e)&&!(e>=9754&&e<=9759)||function(e){return e>=11008&&e<=11263}(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Oi(e)||Di(e)||function(e){return e>=57344&&e<=63743}(e)||Xi(e)||Qi(e)||$i(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function aa(e){return e>=1424&&e<=2303||Zi(e)||Ji(e)}function oa(e,t){return!(!t&&aa(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||function(e){return e>=6016&&e<=6143}(e))}function sa(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)if(aa(t.value.charCodeAt(0)))return!0}catch(n){r.e(n)}finally{r.f()}return!1}var ua="deferred",la="loading",ca="loaded",ha=null,fa="unavailable",da=null,pa=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(fa="error"),ha&&ha(e)};function ya(){va.fire(new Ye("pluginStateChange",{pluginStatus:fa,pluginURL:da}))}var va=new Qe,ma=function(){return fa},ga=function(){if(fa!==ua||!da)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");fa=la,ya(),da&&Fe({url:da},(function(e){e?pa(e):(fa=ca,ya())}))},_a={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return fa===ca||null!=_a.applyArabicShaping},isLoading:function(){return fa===la},setState:function(e){fa=e.pluginStatus,da=e.pluginURL},isParsed:function(){return null!=_a.applyArabicShaping&&null!=_a.processBidirectionalText&&null!=_a.processStyledBidirectionalText},getPluginURL:function(){return da}},ba=function(){function e(t,r){v(this,e),this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ti,this.transition={})}return m(e,[{key:"isSupportedScript",value:function(e){return function(e,t){var r,n=f(e);try{for(n.s();!(r=n.n()).done;)if(!oa(r.value.charCodeAt(0),t))return!1}catch(i){n.e(i)}finally{n.f()}return!0}(e,_a.isLoaded())}},{key:"crossFadingFactor",value:function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}},{key:"getCrossfadeParameters",value:function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}}]),e}(),wa=function(){function e(t,r){v(this,e),this.property=t,this.value=r,this.expression=function(e,t){if(dn(e))return new An(e,t);if(xn(e)){var r=Tn(e,t);if("error"===r.result)throw new Error(r.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));return r.value}var n=e;return"string"==typeof e&&"color"===t.type&&(n=Et.parse(e)),{kind:"constant",evaluate:function(){return n}}}(void 0===r?t.specification.default:r,t.specification)}return m(e,[{key:"isDataDriven",value:function(){return"source"===this.expression.kind||"composite"===this.expression.kind}},{key:"possiblyEvaluate",value:function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}]),e}(),xa=function(){function e(t){v(this,e),this.property=t,this.value=new wa(t,void 0)}return m(e,[{key:"transitioned",value:function(e,t){return new Ea(this.property,this.value,t,O({},e.transition,this.transition),e.now)}},{key:"untransitioned",value:function(){return new Ea(this.property,this.value,null,{},0)}}]),e}(),ka=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}return m(e,[{key:"getValue",value:function(e){return q(this._values[e].value.value)}},{key:"setValue",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new xa(this._values[e].property)),this._values[e].value=new wa(this._values[e].property,null===t?void 0:q(t))}},{key:"getTransition",value:function(e){return q(this._values[e].transition)}},{key:"setTransition",value:function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new xa(this._values[e].property)),this._values[e].transition=q(t)||void 0}},{key:"serialize",value:function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t++){var n=r[t],i=this.getValue(n);void 0!==i&&(e[n]=i);var a=this.getTransition(n);void 0!==a&&(e["".concat(n,"-transition")]=a)}return e}},{key:"transitioned",value:function(e,t){for(var r=new Sa(this._properties),n=0,i=Object.keys(this._values);n<i.length;n++){var a=i[n];r._values[a]=this._values[a].transitioned(e,t._values[a])}return r}},{key:"untransitioned",value:function(){for(var e=new Sa(this._properties),t=0,r=Object.keys(this._values);t<r.length;t++){var n=r[t];e._values[n]=this._values[n].untransitioned()}return e}}]),e}(),Ea=function(){function e(t,r,n,i,a){v(this,e);var o=i.delay||0,s=i.duration||0;a=a||0,this.property=t,this.value=r,this.begin=a+o,this.end=this.begin+s,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}return m(e,[{key:"possiblyEvaluate",value:function(e,t,r){var n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),a=this.prior;if(a){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return a.possiblyEvaluate(e,t,r);var o=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,r),i,T(o))}return i}}]),e}(),Sa=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}return m(e,[{key:"possiblyEvaluate",value:function(e,t,r){for(var n=new Ca(this._properties),i=0,a=Object.keys(this._values);i<a.length;i++){var o=a[i];n._values[o]=this._values[o].possiblyEvaluate(e,t,r)}return n}},{key:"hasTransition",value:function(){for(var e=0,t=Object.keys(this._values);e<t.length;e++){var r=t[e];if(this._values[r].prior)return!0}return!1}}]),e}(),Ta=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultPropertyValues)}return m(e,[{key:"getValue",value:function(e){return q(this._values[e].value)}},{key:"setValue",value:function(e,t){this._values[e]=new wa(this._values[e].property,null===t?void 0:q(t))}},{key:"serialize",value:function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t++){var n=r[t],i=this.getValue(n);void 0!==i&&(e[n]=i)}return e}},{key:"possiblyEvaluate",value:function(e,t,r){for(var n=new Ca(this._properties),i=0,a=Object.keys(this._values);i<a.length;i++){var o=a[i];n._values[o]=this._values[o].possiblyEvaluate(e,t,r)}return n}}]),e}(),Aa=function(){function e(t,r,n){v(this,e),this.property=t,this.value=r,this.parameters=n}return m(e,[{key:"isConstant",value:function(){return"constant"===this.value.kind}},{key:"constantOr",value:function(e){return"constant"===this.value.kind?this.value.value:e}},{key:"evaluate",value:function(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}]),e}(),Ca=function(){function e(t){v(this,e),this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}return m(e,[{key:"get",value:function(e){return this._values[e]}}]),e}(),Ia=function(){function e(t){v(this,e),this.specification=t}return m(e,[{key:"possiblyEvaluate",value:function(e,t){return e.expression.evaluate(t)}},{key:"interpolate",value:function(e,t,r){var n=mr[this.specification.type];return n?n(e,t,r):e}}]),e}(),Ra=function(){function e(t,r){v(this,e),this.specification=t,this.overrides=r}return m(e,[{key:"possiblyEvaluate",value:function(e,t,r,n){return new Aa(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}},{key:"interpolate",value:function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Aa(this,{kind:"constant",value:void 0},e.parameters);var n=mr[this.specification.type];return n?new Aa(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e}},{key:"evaluate",value:function(e,t,r,n,i,a){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,a)}}]),e}(),Ma=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"possiblyEvaluate",value:function(e,t,r,n){if(void 0===e.value)return new Aa(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){var i=e.expression.evaluate(t,null,{},r,n),a="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(a,a,a,t);return new Aa(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){var s=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new Aa(this,{kind:"constant",value:s},t)}return new Aa(this,e.expression,t)}},{key:"evaluate",value:function(e,t,r,n,i,a){if("source"===e.kind){var o=e.evaluate(t,r,n,i,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}},{key:"_calculate",value:function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t,other:r}:{from:r,to:t,other:e}}},{key:"interpolate",value:function(e){return e}}]),r}(Ra),Pa=function(){function e(t){v(this,e),this.specification=t}return m(e,[{key:"possiblyEvaluate",value:function(e,t,r,n){if(void 0!==e.value){if("constant"===e.expression.kind){var i=e.expression.evaluate(t,null,{},r,n);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new ba(Math.floor(t.zoom-1),t)),e.expression.evaluate(new ba(Math.floor(t.zoom),t)),e.expression.evaluate(new ba(Math.floor(t.zoom+1),t)),t)}}},{key:"_calculate",value:function(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}},{key:"interpolate",value:function(e){return e}}]),e}(),Oa=function(){function e(t){v(this,e),this.specification=t}return m(e,[{key:"possiblyEvaluate",value:function(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}},{key:"interpolate",value:function(){return!1}}]),e}(),La=function e(t){for(var r in v(this,e),this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var n=t[r];n.specification.overridable&&this.overridableProperties.push(r);var i=this.defaultPropertyValues[r]=new wa(n,void 0),a=this.defaultTransitionablePropertyValues[r]=new xa(n);this.defaultTransitioningPropertyValues[r]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}};function Da(e,t){return 256*(e=I(Math.floor(e),0,255))+I(Math.floor(t),0,255)}bi("DataDrivenProperty",Ra),bi("DataConstantProperty",Ia),bi("CrossFadedDataDrivenProperty",Ma),bi("CrossFadedProperty",Pa),bi("ColorRampProperty",Oa);var Ba={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Na=function e(t,r){v(this,e),this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},za=function(){function e(){v(this,e),this.isTransferred=!1,this.capacity=-1,this.resize(0)}return m(e,[{key:"_trim",value:function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}},{key:"clear",value:function(){this.length=0}},{key:"resize",value:function(e){this.reserve(e),this.length=e}},{key:"reserve",value:function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}},{key:"_refreshViews",value:function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}],[{key:"serialize",value:function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}},{key:"deserialize",value:function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}}]),e}();function Fa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=0,n=0;return{members:e.map((function(e){var i=Ba[e.type].BYTES_PER_ELEMENT,a=r=ja(r,Math.max(t,i)),o=e.components||1;return n=Math.max(n,i),r+=i*o,{name:e.name,type:e.type,components:o,offset:a}})),size:ja(r,Math.max(n,t)),alignment:t}}function ja(e,t){return Math.ceil(e/t)*t}var Ua=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}},{key:"emplace",value:function(e,t,r){var n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}]),r}(za);Ua.prototype.bytesPerElement=4,bi("StructArrayLayout2i4",Ua);var Va=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}},{key:"emplace",value:function(e,t,r,n,i){var a=4*e;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,this.int16[a+3]=i,e}}]),r}(za);Va.prototype.bytesPerElement=8,bi("StructArrayLayout4i8",Va);var qa=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o){var s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,a,o)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s){var u=6*e,l=12*e,c=3*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.uint8[l+4]=n,this.uint8[l+5]=i,this.uint8[l+6]=a,this.uint8[l+7]=o,this.float32[c+2]=s,e}}]),r}(za);qa.prototype.bytesPerElement=12,bi("StructArrayLayout2i4ub1f12",qa);var Ga=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}},{key:"emplace",value:function(e,t,r){var n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}]),r}(za);Ga.prototype.bytesPerElement=8,bi("StructArrayLayout2f8",Ga);var Ka=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s,u,l){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,a,o,s,u,l)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u,l,c){var h=10*e;return this.uint16[h+0]=t,this.uint16[h+1]=r,this.uint16[h+2]=n,this.uint16[h+3]=i,this.uint16[h+4]=a,this.uint16[h+5]=o,this.uint16[h+6]=s,this.uint16[h+7]=u,this.uint16[h+8]=l,this.uint16[h+9]=c,e}}]),r}(za);Ka.prototype.bytesPerElement=20,bi("StructArrayLayout10ui20",Ka);var Ha=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s){var u=this.length;return this.resize(u+1),this.emplace(u,e,t,r,n,i,a,o,s)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u){var l=8*e;return this.uint16[l+0]=t,this.uint16[l+1]=r,this.uint16[l+2]=n,this.uint16[l+3]=i,this.uint16[l+4]=a,this.uint16[l+5]=o,this.uint16[l+6]=s,this.uint16[l+7]=u,e}}]),r}(za);Ha.prototype.bytesPerElement=16,bi("StructArrayLayout8ui16",Ha);var Wa=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s,u,l,c,h){var f=this.length;return this.resize(f+1),this.emplace(f,e,t,r,n,i,a,o,s,u,l,c,h)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f){var d=12*e;return this.int16[d+0]=t,this.int16[d+1]=r,this.int16[d+2]=n,this.int16[d+3]=i,this.uint16[d+4]=a,this.uint16[d+5]=o,this.uint16[d+6]=s,this.uint16[d+7]=u,this.int16[d+8]=l,this.int16[d+9]=c,this.int16[d+10]=h,this.int16[d+11]=f,e}}]),r}(za);Wa.prototype.bytesPerElement=24,bi("StructArrayLayout4i4ui4i24",Wa);var Za=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}},{key:"emplace",value:function(e,t,r,n){var i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}]),r}(za);Za.prototype.bytesPerElement=12,bi("StructArrayLayout3f12",Za);var Ya=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint32[1*e+0]=t,e}}]),r}(za);Ya.prototype.bytesPerElement=4,bi("StructArrayLayout1ul4",Ya);var Xa=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s,u,l){var c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,i,a,o,s,u,l)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u,l,c){var h=16*e,f=8*e;return this.int16[h+0]=t,this.int16[h+1]=r,this.float32[f+1]=n,this.float32[f+2]=i,this.float32[f+3]=a,this.float32[f+4]=o,this.int16[h+10]=s,this.uint32[f+6]=u,this.uint16[h+14]=l,this.uint16[h+15]=c,e}}]),r}(za);Xa.prototype.bytesPerElement=32,bi("StructArrayLayout2i4f1i1ul2ui32",Xa);var Qa=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a){var o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i,a)}},{key:"emplace",value:function(e,t,r,n,i,a,o){var s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}]),r}(za);Qa.prototype.bytesPerElement=12,bi("StructArrayLayout2i2i2i12",Qa);var Ja=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i){var a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i)}},{key:"emplace",value:function(e,t,r,n,i,a){var o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.int16[s+6]=i,this.int16[s+7]=a,e}}]),r}(za);Ja.prototype.bytesPerElement=16,bi("StructArrayLayout2f1f2i16",Ja);var $a=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}},{key:"emplace",value:function(e,t,r,n,i){var a=12*e,o=3*e;return this.uint8[a+0]=t,this.uint8[a+1]=r,this.float32[o+1]=n,this.float32[o+2]=i,e}}]),r}(za);$a.prototype.bytesPerElement=12,bi("StructArrayLayout2ub2f12",$a);var eo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}},{key:"emplace",value:function(e,t,r,n){var i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}]),r}(za);eo.prototype.bytesPerElement=6,bi("StructArrayLayout3ui6",eo);var to=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m){var g=this.length;return this.resize(g+1),this.emplace(g,e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m,g){var _=13*e,b=26*e,w=52*e;return this.float32[_+0]=t,this.float32[_+1]=r,this.uint16[b+4]=n,this.uint16[b+5]=i,this.uint32[_+3]=a,this.uint32[_+4]=o,this.uint32[_+5]=s,this.uint16[b+12]=u,this.uint16[b+13]=l,this.uint16[b+14]=c,this.float32[_+8]=h,this.float32[_+9]=f,this.uint8[w+40]=d,this.uint8[w+41]=p,this.uint8[w+42]=y,this.uint32[_+11]=v,this.int16[b+24]=m,this.uint8[w+50]=g,e}}]),r}(za);to.prototype.bytesPerElement=52,bi("StructArrayLayout2f2ui3ul3ui2f3ub1ul1i1ub52",to);var ro=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m,g,_,b,w,x,k,E,S,T){var A=this.length;return this.resize(A+1),this.emplace(A,e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m,g,_,b,w,x,k,E,S,T)}},{key:"emplace",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m,g,_,b,w,x,k,E,S,T,A){var C=17*e,I=34*e;return this.float32[C+0]=t,this.float32[C+1]=r,this.int16[I+4]=n,this.int16[I+5]=i,this.int16[I+6]=a,this.int16[I+7]=o,this.int16[I+8]=s,this.int16[I+9]=u,this.uint16[I+10]=l,this.uint16[I+11]=c,this.uint16[I+12]=h,this.uint16[I+13]=f,this.uint16[I+14]=d,this.uint16[I+15]=p,this.uint16[I+16]=y,this.uint16[I+17]=v,this.uint16[I+18]=m,this.uint16[I+19]=g,this.uint16[I+20]=_,this.uint16[I+21]=b,this.uint16[I+22]=w,this.uint16[I+23]=x,this.uint16[I+24]=k,this.uint32[C+13]=E,this.float32[C+14]=S,this.float32[C+15]=T,this.float32[C+16]=A,e}}]),r}(za);ro.prototype.bytesPerElement=68,bi("StructArrayLayout2f6i15ui1ul3f68",ro);var no=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.float32[1*e+0]=t,e}}]),r}(za);no.prototype.bytesPerElement=4,bi("StructArrayLayout1f4",no);var io=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r){var n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}},{key:"emplace",value:function(e,t,r,n){var i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}]),r}(za);io.prototype.bytesPerElement=6,bi("StructArrayLayout3i6",io);var ao=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}},{key:"emplace",value:function(e,t,r,n,i){var a=6*e;return this.uint32[3*e+0]=t,this.uint16[a+2]=r,this.uint16[a+3]=n,this.uint16[a+4]=i,e}}]),r}(za);ao.prototype.bytesPerElement=12,bi("StructArrayLayout1ul3ui12",ao);var oo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t){var r=this.length;return this.resize(r+1),this.emplace(r,e,t)}},{key:"emplace",value:function(e,t,r){var n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}]),r}(za);oo.prototype.bytesPerElement=4,bi("StructArrayLayout2ui4",oo);var so=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e){var t=this.length;return this.resize(t+1),this.emplace(t,e)}},{key:"emplace",value:function(e,t){return this.uint16[1*e+0]=t,e}}]),r}(za);so.prototype.bytesPerElement=2,bi("StructArrayLayout1ui2",so);var uo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_refreshViews",value:function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}},{key:"emplaceBack",value:function(e,t,r,n){var i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}},{key:"emplace",value:function(e,t,r,n,i){var a=4*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.float32[a+3]=i,e}}]),r}(za);uo.prototype.bytesPerElement=16,bi("StructArrayLayout4f16",uo);var lo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"anchorPointX",get:function(){return this._structArray.int16[this._pos2+0]}},{key:"anchorPointY",get:function(){return this._structArray.int16[this._pos2+1]}},{key:"x1",get:function(){return this._structArray.float32[this._pos4+1]}},{key:"y1",get:function(){return this._structArray.float32[this._pos4+2]}},{key:"x2",get:function(){return this._structArray.float32[this._pos4+3]}},{key:"y2",get:function(){return this._structArray.float32[this._pos4+4]}},{key:"padding",get:function(){return this._structArray.int16[this._pos2+10]}},{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+6]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+15]}},{key:"anchorPoint",get:function(){return new g(this.anchorPointX,this.anchorPointY)}}]),r}(Na);lo.prototype.size=32;var co=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"get",value:function(e){return new lo(this,e)}}]),r}(Xa);bi("CollisionBoxArray",co);var ho=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"anchorX",get:function(){return this._structArray.float32[this._pos4+0]}},{key:"anchorY",get:function(){return this._structArray.float32[this._pos4+1]}},{key:"glyphStartIndex",get:function(){return this._structArray.uint16[this._pos2+4]}},{key:"numGlyphs",get:function(){return this._structArray.uint16[this._pos2+5]}},{key:"vertexStartIndex",get:function(){return this._structArray.uint32[this._pos4+3]}},{key:"lineStartIndex",get:function(){return this._structArray.uint32[this._pos4+4]}},{key:"lineLength",get:function(){return this._structArray.uint32[this._pos4+5]}},{key:"segment",get:function(){return this._structArray.uint16[this._pos2+12]}},{key:"lowerSize",get:function(){return this._structArray.uint16[this._pos2+13]}},{key:"upperSize",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"lineOffsetX",get:function(){return this._structArray.float32[this._pos4+8]}},{key:"lineOffsetY",get:function(){return this._structArray.float32[this._pos4+9]}},{key:"writingMode",get:function(){return this._structArray.uint8[this._pos1+40]}},{key:"placedOrientation",get:function(){return this._structArray.uint8[this._pos1+41]},set:function(e){this._structArray.uint8[this._pos1+41]=e}},{key:"hidden",get:function(){return this._structArray.uint8[this._pos1+42]},set:function(e){this._structArray.uint8[this._pos1+42]=e}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+11]},set:function(e){this._structArray.uint32[this._pos4+11]=e}},{key:"associatedIconIndex",get:function(){return this._structArray.int16[this._pos2+24]}},{key:"flipState",get:function(){return this._structArray.uint8[this._pos1+50]},set:function(e){this._structArray.uint8[this._pos1+50]=e}}]),r}(Na);ho.prototype.size=52;var fo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"get",value:function(e){return new ho(this,e)}}]),r}(to);bi("PlacedSymbolArray",fo);var po=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"anchorX",get:function(){return this._structArray.float32[this._pos4+0]}},{key:"anchorY",get:function(){return this._structArray.float32[this._pos4+1]}},{key:"rightJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+4]}},{key:"centerJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+5]}},{key:"leftJustifiedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+6]}},{key:"verticalPlacedTextSymbolIndex",get:function(){return this._structArray.int16[this._pos2+7]}},{key:"placedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+8]}},{key:"verticalPlacedIconSymbolIndex",get:function(){return this._structArray.int16[this._pos2+9]}},{key:"key",get:function(){return this._structArray.uint16[this._pos2+10]}},{key:"textBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+11]}},{key:"textBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+12]}},{key:"verticalTextBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+13]}},{key:"verticalTextBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+14]}},{key:"iconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+15]}},{key:"iconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+16]}},{key:"verticalIconBoxStartIndex",get:function(){return this._structArray.uint16[this._pos2+17]}},{key:"verticalIconBoxEndIndex",get:function(){return this._structArray.uint16[this._pos2+18]}},{key:"featureIndex",get:function(){return this._structArray.uint16[this._pos2+19]}},{key:"numHorizontalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+20]}},{key:"numVerticalGlyphVertices",get:function(){return this._structArray.uint16[this._pos2+21]}},{key:"numIconVertices",get:function(){return this._structArray.uint16[this._pos2+22]}},{key:"numVerticalIconVertices",get:function(){return this._structArray.uint16[this._pos2+23]}},{key:"useRuntimeCollisionCircles",get:function(){return this._structArray.uint16[this._pos2+24]}},{key:"crossTileID",get:function(){return this._structArray.uint32[this._pos4+13]},set:function(e){this._structArray.uint32[this._pos4+13]=e}},{key:"textOffset0",get:function(){return this._structArray.float32[this._pos4+14]}},{key:"textOffset1",get:function(){return this._structArray.float32[this._pos4+15]}},{key:"collisionCircleDiameter",get:function(){return this._structArray.float32[this._pos4+16]}}]),r}(Na);po.prototype.size=68;var yo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"get",value:function(e){return new po(this,e)}}]),r}(ro);bi("SymbolInstanceArray",yo);var vo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getoffsetX",value:function(e){return this.float32[1*e+0]}}]),r}(no);bi("GlyphOffsetArray",vo);var mo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getx",value:function(e){return this.int16[3*e+0]}},{key:"gety",value:function(e){return this.int16[3*e+1]}},{key:"gettileUnitDistanceFromAnchor",value:function(e){return this.int16[3*e+2]}}]),r}(io);bi("SymbolLineVertexArray",mo);var go=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"featureIndex",get:function(){return this._structArray.uint32[this._pos4+0]}},{key:"sourceLayerIndex",get:function(){return this._structArray.uint16[this._pos2+2]}},{key:"bucketIndex",get:function(){return this._structArray.uint16[this._pos2+3]}},{key:"layoutVertexArrayOffset",get:function(){return this._structArray.uint16[this._pos2+4]}}]),r}(Na);go.prototype.size=12;var _o=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"get",value:function(e){return new go(this,e)}}]),r}(ao);bi("FeatureIndexArray",_o);var bo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"a_centroid_pos0",get:function(){return this._structArray.uint16[this._pos2+0]}},{key:"a_centroid_pos1",get:function(){return this._structArray.uint16[this._pos2+1]}}]),r}(Na);bo.prototype.size=4;var wo=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"get",value:function(e){return new bo(this,e)}}]),r}(oo);bi("FillExtrusionCentroidArray",wo);var xo=Fa([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),ko=Fa([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]),Eo=xt((function(e){e.exports=function(e,t){var r,n,i,a,o,s,u,l;for(n=e.length-(r=3&e.length),i=t,o=3432918353,s=461845907,l=0;l<n;)u=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,i=27492+(65535&(a=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*o+(((u>>>16)*o&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(l+2))<<16;case 2:u^=(255&e.charCodeAt(l+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(l)))*o+(((u>>>16)*o&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}})),So=xt((function(e){e.exports=function(e,t){for(var r,n=e.length,i=t^n,a=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0}})),To=Eo,Ao=So;To.murmur3=Eo,To.murmur2=Ao;var Co=function(){function e(){v(this,e),this.ids=[],this.positions=[],this.indexed=!1}return m(e,[{key:"add",value:function(e,t,r,n){this.ids.push(Io(e)),this.positions.push(t,r,n)}},{key:"getPositions",value:function(e){for(var t=Io(e),r=0,n=this.ids.length-1;r<n;){var i=r+n>>1;this.ids[i]>=t?n=i:r=i+1}for(var a=[];this.ids[r]===t;)a.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return a}}],[{key:"serialize",value:function(e,t){var r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return Ro(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}},{key:"deserialize",value:function(t){var r=new e;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}]),e}();function Io(e){var t=+e;return!isNaN(t)&&t<=w?t:To(String(e))}function Ro(e,t,r,n){for(;r<n;){for(var i=e[r+n>>1],a=r-1,o=n+1;;){do{a++}while(e[a]<i);do{o--}while(e[o]>i);if(a>=o)break;Mo(e,a,o),Mo(t,3*a,3*o),Mo(t,3*a+1,3*o+1),Mo(t,3*a+2,3*o+2)}o-r<n-o?(Ro(e,t,r,o),r=o+1):(Ro(e,t,o+1,n),n=o)}}function Mo(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}bi("FeaturePositionMap",Co);var Po=function e(t,r){v(this,e),this.gl=t.gl,this.location=r},Oo=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=0,i}return m(r,[{key:"set",value:function(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}]),r}(Po),Lo=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=[0,0,0,0],i}return m(r,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}]),r}(Po),Do=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=Et.transparent,i}return m(r,[{key:"set",value:function(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}]),r}(Po),Bo=new Float32Array(16),No=new Float32Array(9);function zo(e){return[Da(255*e.r,255*e.g),Da(255*e.b,255*e.a)]}var Fo=function(){function e(t,r,n){v(this,e),this.value=t,this.uniformNames=r.map((function(e){return"u_".concat(e)})),this.type=n}return m(e,[{key:"setUniform",value:function(e,t,r){e.set(r.constantOr(this.value))}},{key:"getBinding",value:function(e,t,r){return"color"===this.type?new Do(e,t):new Oo(e,t)}}]),e}(),jo=function(){function e(t,r){v(this,e),this.uniformNames=r.map((function(e){return"u_".concat(e)})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}return m(e,[{key:"setConstantPatternPositions",value:function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tl.concat(t.br),this.patternTo=e.tl.concat(e.br)}},{key:"setUniform",value:function(e,t,r,n){var i="u_pattern_to"===n||"u_dash_to"===n?this.patternTo:"u_pattern_from"===n||"u_dash_from"===n?this.patternFrom:"u_pixel_ratio_to"===n?this.pixelRatioTo:"u_pixel_ratio_from"===n?this.pixelRatioFrom:null;i&&e.set(i)}},{key:"getBinding",value:function(e,t,r){return"u_pattern_from"===r||"u_pattern_to"===r||"u_dash_from"===r||"u_dash_to"===r?new Lo(e,t):new Oo(e,t)}}]),e}(),Uo=function(){function e(t,r,n,i){v(this,e),this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map((function(e){return{name:"a_".concat(e),type:"Float32",components:"color"===n?2:1,offset:0}})),this.paintVertexArray=new i}return m(e,[{key:"populatePaintArray",value:function(e,t,r,n,i){var a=this.paintVertexArray.length,o=this.expression.evaluate(new ba(0),t,{},n,[],i);this.paintVertexArray.resize(e),this._setPaintValue(a,e,o)}},{key:"updatePaintArray",value:function(e,t,r,n){var i=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,i)}},{key:"_setPaintValue",value:function(e,t,r){if("color"===this.type)for(var n=zo(r),i=e;i<t;i++)this.paintVertexArray.emplace(i,n[0],n[1]);else{for(var a=e;a<t;a++)this.paintVertexArray.emplace(a,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}]),e}(),Vo=function(){function e(t,r,n,i,a,o){v(this,e),this.expression=t,this.uniformNames=r.map((function(e){return"u_".concat(e,"_t")})),this.type=n,this.useIntegerZoom=i,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=r.map((function(e){return{name:"a_".concat(e),type:"Float32",components:"color"===n?4:2,offset:0}})),this.paintVertexArray=new o}return m(e,[{key:"populatePaintArray",value:function(e,t,r,n,i){var a=this.expression.evaluate(new ba(this.zoom),t,{},n,[],i),o=this.expression.evaluate(new ba(this.zoom+1),t,{},n,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,a,o)}},{key:"updatePaintArray",value:function(e,t,r,n){var i=this.expression.evaluate({zoom:this.zoom},r,n),a=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,i,a)}},{key:"_setPaintValue",value:function(e,t,r,n){if("color"===this.type)for(var i=zo(r),a=zo(n),o=e;o<t;o++)this.paintVertexArray.emplace(o,i[0],i[1],a[0],a[1]);else{for(var s=e;s<t;s++)this.paintVertexArray.emplace(s,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}},{key:"upload",value:function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},{key:"setUniform",value:function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=I(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}},{key:"getBinding",value:function(e,t,r){return new Oo(e,t)}}]),e}(),qo=function(){function e(t,r,n,i,a,o,s){v(this,e),this.expression=t,this.type=n,this.useIntegerZoom=i,this.zoom=a,this.layerId=s,this.paintVertexAttributes=("array"===n?ko:xo).members;for(var u=0;u<r.length;++u);this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}return m(e,[{key:"populatePaintArray",value:function(e,t,r){var n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}},{key:"updatePaintArray",value:function(e,t,r,n,i){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],i)}},{key:"_setPaintValues",value:function(e,t,r,n){if(n&&r){var i=r.min,a=r.mid,o=r.max,s=n[i],u=n[a],l=n[o];if(s&&u&&l)for(var c=e;c<t;c++)this._setPaintValue(this.zoomInPaintVertexArray,c,u,s),this._setPaintValue(this.zoomOutPaintVertexArray,c,u,l)}}},{key:"_setPaintValue",value:function(e,t,r,n){e.emplace(t,r.tl[0],r.tl[1],r.br[0],r.br[1],n.tl[0],n.tl[1],n.br[0],n.br[1],r.pixelRatio,n.pixelRatio)}},{key:"upload",value:function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}},{key:"destroy",value:function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}]),e}(),Go=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};v(this,e),this.binders={},this._buffers=[];var i=[];for(var a in t.paint._values)if(n(a)){var o=t.paint.get(a);if(o instanceof Aa&&ln(o.property.specification)){var s=Wo(a,t.type),u=o.value,l=o.property.specification.type,c=o.property.useIntegerZoom,h=o.property.specification["property-type"],f="cross-faded"===h||"cross-faded-data-driven"===h,d="line-dasharray"===String(a)&&"constant"!==t.layout.get("line-cap").value.kind;if("constant"!==u.kind||d)if("source"===u.kind||d||f){var p=Xo(a,l,"source");this.binders[a]=f?new qo(u,s,l,c,r,p,t.id):new Uo(u,s,l,p),i.push("/a_".concat(a))}else{var y=Xo(a,l,"composite");this.binders[a]=new Vo(u,s,l,c,r,y),i.push("/z_".concat(a))}else this.binders[a]=f?new jo(u.value,s):new Fo(u.value,s,l),i.push("/u_".concat(a))}}this.cacheKey=i.sort().join("")}return m(e,[{key:"getMaxValue",value:function(e){var t=this.binders[e];return t instanceof Uo||t instanceof Vo?t.maxValue:0}},{key:"populatePaintArrays",value:function(e,t,r,n,i){for(var a in this.binders){var o=this.binders[a];(o instanceof Uo||o instanceof Vo||o instanceof qo)&&o.populatePaintArray(e,t,r,n,i)}}},{key:"setConstantPatternPositions",value:function(e,t){for(var r in this.binders){var n=this.binders[r];n instanceof jo&&n.setConstantPatternPositions(e,t)}}},{key:"updatePaintArrays",value:function(e,t,r,n,i){var a=!1;for(var o in e){var s,u=t.getPositions(o),l=f(u);try{for(l.s();!(s=l.n()).done;){var c=s.value,h=r.feature(c.index);for(var d in this.binders){var p=this.binders[d];if((p instanceof Uo||p instanceof Vo||p instanceof qo)&&!0===p.expression.isStateDependent){var y=n.paint.get(d);p.expression=y.value,p.updatePaintArray(c.start,c.end,h,e[o],i),a=!0}}}}catch(v){l.e(v)}finally{l.f()}}return a}},{key:"defines",value:function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Fo||r instanceof jo)&&e.push.apply(e,c(r.uniformNames.map((function(e){return"#define HAS_UNIFORM_".concat(e)}))))}return e}},{key:"getBinderAttributes",value:function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Uo||r instanceof Vo||r instanceof qo)for(var n=0;n<r.paintVertexAttributes.length;n++)e.push(r.paintVertexAttributes[n].name)}return e}},{key:"getBinderUniforms",value:function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Fo||r instanceof jo||r instanceof Vo){var n,i=f(r.uniformNames);try{for(i.s();!(n=i.n()).done;){var a=n.value;e.push(a)}}catch(o){i.e(o)}finally{i.f()}}}return e}},{key:"getPaintVertexBuffers",value:function(){return this._buffers}},{key:"getUniforms",value:function(e,t){var r=[];for(var n in this.binders){var i=this.binders[n];if(i instanceof Fo||i instanceof jo||i instanceof Vo){var a,o=f(i.uniformNames);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t[s]){var u=i.getBinding(e,t[s],s);r.push({name:s,property:n,binding:u})}}}catch(l){o.e(l)}finally{o.f()}}}return r}},{key:"setUniforms",value:function(e,t,r,n){var i,a=f(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=o.name,u=o.property,l=o.binding;this.binders[u].setUniform(l,n,r.get(u),s)}}catch(c){a.e(c)}finally{a.f()}}},{key:"updatePaintBuffers",value:function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof qo){var n=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(r instanceof Uo||r instanceof Vo)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}},{key:"upload",value:function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Uo||r instanceof Vo||r instanceof qo)&&r.upload(e)}this.updatePaintBuffers()}},{key:"destroy",value:function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Uo||t instanceof Vo||t instanceof qo)&&t.destroy()}}}]),e}(),Ko=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};v(this,e),this.programConfigurations={};var i,a=f(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.programConfigurations[o.id]=new Go(o,r,n)}}catch(s){a.e(s)}finally{a.f()}this.needsUpload=!1,this._featureMap=new Co,this._bufferOffset=0}return m(e,[{key:"populatePaintArrays",value:function(e,t,r,n,i,a){for(var o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(e,t,n,i,a);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}},{key:"updatePaintArrays",value:function(e,t,r,n){var i,a=f(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,n)||this.needsUpload}}catch(s){a.e(s)}finally{a.f()}}},{key:"get",value:function(e){return this.programConfigurations[e]}},{key:"upload",value:function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}},{key:"destroy",value:function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()}}]),e}(),Ho={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Wo(e,t){return Ho[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}var Zo={"line-pattern":{source:Ka,composite:Ka},"fill-pattern":{source:Ka,composite:Ka},"fill-extrusion-pattern":{source:Ka,composite:Ka},"line-dasharray":{source:Ha,composite:Ha}},Yo={color:{source:Ga,composite:uo},number:{source:no,composite:Ga}};function Xo(e,t,r){var n=Zo[e];return n&&n[r]||Yo[t][r]}bi("ConstantBinder",Fo),bi("CrossFadedConstantBinder",jo),bi("SourceExpressionBinder",Uo),bi("CrossFadedCompositeBinder",qo),bi("CompositeExpressionBinder",Vo),bi("ProgramConfiguration",Go,{omit:["_buffers"]}),bi("ProgramConfigurationSet",Ko);var Qo="-transition",Jo=function(e){p(r,e);var t=y(r);function r(e,n){var i;if(v(this,r),(i=t.call(this)).id=e.id,i.type=e.type,i._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==e.type&&(i.metadata=(e=e).metadata,i.minzoom=e.minzoom,i.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(i.source=e.source,i.sourceLayer=e["source-layer"],i.filter=e.filter),n.layout&&(i._unevaluatedLayout=new Ta(n.layout)),n.paint)){for(var a in i._transitionablePaint=new ka(n.paint),e.paint)i.setPaintProperty(a,e.paint[a],{validate:!1});for(var o in e.layout)i.setLayoutProperty(o,e.layout[o],{validate:!1});i._transitioningPaint=i._transitionablePaint.untransitioned(),i.paint=new Ca(n.paint)}return u(i)}return m(r,[{key:"getCrossfadeParameters",value:function(){return this._crossfadeParameters}},{key:"getLayoutProperty",value:function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}},{key:"setLayoutProperty",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(di,"layers.".concat(this.id,".layout.").concat(e),e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}},{key:"getPaintProperty",value:function(e){return j(e,Qo)?this._transitionablePaint.getTransition(e.slice(0,-Qo.length)):this._transitionablePaint.getValue(e)}},{key:"setPaintProperty",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(fi,"layers.".concat(this.id,".paint.").concat(e),e,t,r))return!1;if(j(e,Qo))return this._transitionablePaint.setTransition(e.slice(0,-Qo.length),t||void 0),!1;var n=this._transitionablePaint._values[e],i="cross-faded-data-driven"===n.property.specification["property-type"],a=n.value.isDataDriven(),o=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);var s=this._transitionablePaint._values[e].value;return s.isDataDriven()||a||i||this._handleOverridablePaintPropertyUpdate(e,o,s)}},{key:"_handleSpecialPaintPropertyUpdate",value:function(e){}},{key:"getProgramIds",value:function(){return null}},{key:"getProgramConfiguration",value:function(e){return null}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,t,r){return!1}},{key:"isHidden",value:function(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}},{key:"updateTransitions",value:function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}},{key:"hasTransition",value:function(){return this._transitioningPaint.hasTransition()}},{key:"recalculate",value:function(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}},{key:"serialize",value:function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),V(e,(function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)}))}},{key:"_validate",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&pi(this,e.call(li,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Je,style:{glyphs:!0,sprite:!0}}))}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!1}},{key:"isTileClipped",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return!1}},{key:"resize",value:function(){}},{key:"isStateDependent",value:function(){for(var e in this.paint._values){var t=this.paint.get(e);if(t instanceof Aa&&ln(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}]),r}(Qe),$o=Fa([{name:"a_pos",components:2,type:"Int16"}],4).members,es=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];v(this,e),this.segments=t}return m(e,[{key:"prepareSegment",value:function(t,r,n,i){var a=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&K("Max vertices per segment is ".concat(e.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(t)),(!a||a.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==i)&&(a={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==i&&(a.sortKey=i),this.segments.push(a)),a}},{key:"get",value:function(){return this.segments}},{key:"destroy",value:function(){var e,t=f(this.segments);try{for(t.s();!(e=t.n()).done;){var r=e.value;for(var n in r.vaos)r.vaos[n].destroy()}}catch(i){t.e(i)}finally{t.f()}}}],[{key:"simpleSegment",value:function(t,r,n,i){return new e([{vertexOffset:t,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}}]),e}();es.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bi("SegmentVector",es);var ts=8192,rs=Math.pow(2,14)-1,ns=-rs-1;function is(e){for(var t=ts/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var i=r[n],a=0;a<i.length;a++){var o=i[a],s=Math.round(o.x*t),u=Math.round(o.y*t);o.x=I(s,ns,rs),o.y=I(u,ns,rs),(s<o.x||s>o.x+1||u<o.y||u>o.y+1)&&K("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function as(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?is(e):[]}}function os(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}var ss=function(){function e(t){v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ua,this.indexArray=new eo,this.segments=new es,this.programConfigurations=new Ko(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return m(e,[{key:"populate",value:function(e,t,r){var n=this.layers[0],i=[],a=null;"circle"===n.type&&(a=n.layout.get("circle-sort-key"));var o,s=f(e);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=u.feature,c=u.id,h=u.index,d=u.sourceLayerIndex,p=this.layers[0]._featureFilter.needGeometry,y=as(l,p);if(this.layers[0]._featureFilter.filter(new ba(this.zoom),y,r)){var v=a?a.evaluate(y,{},r):void 0,m={id:c,properties:l.properties,type:l.type,sourceLayerIndex:d,index:h,geometry:p?y.geometry:is(l),patterns:{},sortKey:v};i.push(m)}}}catch(S){s.e(S)}finally{s.f()}a&&i.sort((function(e,t){return e.sortKey-t.sortKey}));for(var g=0,_=i;g<_.length;g++){var b=_[g],w=b.geometry,x=b.index,k=b.sourceLayerIndex,E=e[x].feature;this.addFeature(b,w,x,r),t.featureIndex.insert(E,w,x,k,this.index)}}},{key:"update",value:function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$o),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"addFeature",value:function(e,t,r,n){var i,a=f(t);try{for(a.s();!(i=a.n()).done;){var o,s=i.value,u=f(s);try{for(u.s();!(o=u.n()).done;){var l=o.value,c=l.x,h=l.y;if(!(c<0||c>=ts||h<0||h>=ts)){var d=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),p=d.vertexLength;os(this.layoutVertexArray,c,h,-1,-1),os(this.layoutVertexArray,c,h,1,-1),os(this.layoutVertexArray,c,h,1,1),os(this.layoutVertexArray,c,h,-1,1),this.indexArray.emplaceBack(p,p+1,p+2),this.indexArray.emplaceBack(p,p+3,p+2),d.vertexLength+=4,d.primitiveLength+=2}}}catch(y){u.e(y)}finally{u.f()}}}catch(y){a.e(y)}finally{a.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}}]),e}();function us(e,t){for(var r=0;r<e.length;r++)if(ms(t,e[r]))return!0;for(var n=0;n<t.length;n++)if(ms(e,t[n]))return!0;return!!fs(e,t)}function ls(e,t,r){return!!ms(e,t)||!!ps(t,e,r)}function cs(e,t){if(1===e.length)return vs(t,e[0]);for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;i++)if(ms(e,n[i]))return!0;for(var a=0;a<e.length;a++)if(vs(t,e[a]))return!0;for(var o=0;o<t.length;o++)if(fs(e,t[o]))return!0;return!1}function hs(e,t,r){if(e.length>1){if(fs(e,t))return!0;for(var n=0;n<t.length;n++)if(ps(t[n],e,r))return!0}for(var i=0;i<e.length;i++)if(ps(e[i],t,r))return!0;return!1}function fs(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var n=e[r],i=e[r+1],a=0;a<t.length-1;a++)if(ds(n,i,t[a],t[a+1]))return!0;return!1}function ds(e,t,r,n){return H(e,r,n)!==H(t,r,n)&&H(e,t,r)!==H(e,t,n)}function ps(e,t,r){var n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(var i=1;i<t.length;i++)if(ys(e,t[i-1],t[i])<n)return!0;return!1}function ys(e,t,r){var n=t.distSqr(r);if(0===n)return e.distSqr(t);var i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function vs(e,t){for(var r,n,i,a=!1,o=0;o<e.length;o++)for(var s=0,u=(r=e[o]).length-1;s<r.length;u=s++)n=r[s],i=r[u],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(a=!a);return a}function ms(e,t){for(var r=!1,n=0,i=e.length-1;n<e.length;i=n++){var a=e[n],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}function gs(e,t,r,n,i){var a,o=f(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(t<=s.x&&r<=s.y&&n>=s.x&&i>=s.y)return!0}}catch(d){o.e(d)}finally{o.f()}var u=[new g(t,r),new g(t,i),new g(n,i),new g(n,r)];if(e.length>2){var l,c=f(u);try{for(c.s();!(l=c.n()).done;)if(ms(e,l.value))return!0}catch(d){c.e(d)}finally{c.f()}}for(var h=0;h<e.length-1;h++)if(_s(e[h],e[h+1],u))return!0;return!1}function _s(e,t,r){var n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;var a=H(e,t,r[0]);return a!==H(e,t,r[1])||a!==H(e,t,r[2])||a!==H(e,t,r[3])}function bs(e,t,r){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ws(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function xs(e,t,r,n,i){if(!t[0]&&!t[1])return e;var a=g.convert(t)._mult(i);"viewport"===r&&a._rotate(-n);for(var o=[],s=0;s<e.length;s++)o.push(e[s].sub(a));return o}function ks(e,t,r,n){var i=g.convert(e)._mult(n);return"viewport"===t&&i._rotate(-r),i}bi("CircleBucket",ss,{omit:["layers"]});var Es=new La({"circle-sort-key":new Ra(Je.layout_circle["circle-sort-key"])}),Ss={paint:new La({"circle-radius":new Ra(Je.paint_circle["circle-radius"]),"circle-color":new Ra(Je.paint_circle["circle-color"]),"circle-blur":new Ra(Je.paint_circle["circle-blur"]),"circle-opacity":new Ra(Je.paint_circle["circle-opacity"]),"circle-translate":new Ia(Je.paint_circle["circle-translate"]),"circle-translate-anchor":new Ia(Je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ia(Je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ia(Je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ra(Je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ra(Je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ra(Je.paint_circle["circle-stroke-opacity"])}),layout:Es},Ts="undefined"!=typeof Float32Array?Float32Array:Array;function As(){var e=new Ts(9);return Ts!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Cs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Is(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],y=t[12],v=t[13],m=t[14],g=t[15],_=r[0],b=r[1],w=r[2],x=r[3];return e[0]=_*n+b*s+w*h+x*y,e[1]=_*i+b*u+w*f+x*v,e[2]=_*a+b*l+w*d+x*m,e[3]=_*o+b*c+w*p+x*g,e[4]=(_=r[4])*n+(b=r[5])*s+(w=r[6])*h+(x=r[7])*y,e[5]=_*i+b*u+w*f+x*v,e[6]=_*a+b*l+w*d+x*m,e[7]=_*o+b*c+w*p+x*g,e[8]=(_=r[8])*n+(b=r[9])*s+(w=r[10])*h+(x=r[11])*y,e[9]=_*i+b*u+w*f+x*v,e[10]=_*a+b*l+w*d+x*m,e[11]=_*o+b*c+w*p+x*g,e[12]=(_=r[12])*n+(b=r[13])*s+(w=r[14])*h+(x=r[15])*y,e[13]=_*i+b*u+w*f+x*v,e[14]=_*a+b*l+w*d+x*m,e[15]=_*o+b*c+w*p+x*g,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Rs=Is;function Ms(){var e=new Ts(3);return Ts!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ps(e){return Math.hypot(e[0],e[1],e[2])}function Os(e,t,r){var n=new Ts(3);return n[0]=e,n[1]=t,n[2]=r,n}function Ls(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Ds(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Bs(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function Ns(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function zs(e,t,r){var n=r[0],i=r[1],a=r[2],o=t[0],s=t[1],u=t[2],l=i*u-a*s,c=a*o-n*u,h=n*s-i*o,f=i*h-a*c,d=a*l-n*h,p=n*c-i*l,y=2*r[3];return c*=y,h*=y,d*=2,p*=2,e[0]=o+(l*=y)+(f*=2),e[1]=s+c+d,e[2]=u+h+p,e}var Fs,js=Ls,Us=Ds,Vs=Ps;function qs(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function Gs(){var e=new Ts(4);return Ts!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Ks(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Hs(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=a*u-i*s,e[3]=o*u-n*s,e}function Ws(e,t,r){var n=qs([],[e.x,e.y,t,1],r);return new g(n[0]/n[3],n[1]/n[3])}Ms(),Fs=new Ts(4),Ts!=Float32Array&&(Fs[0]=0,Fs[1]=0,Fs[2]=0,Fs[3]=0),Ms(),Os(1,0,0),Os(0,1,0),Gs(),Gs(),As();var Zs=Os(0,0,0),Ys=Os(0,0,1);function Xs(e,t){var r=Ms();return Zs[2]=t,e.intersectsPlane(Zs,Ys,r),new g(r[0],r[1])}var Qs=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return r}(ss);function Js(e,t,r,n){var i=t.width,a=t.height;if(n){if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==i*a*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*a*r);return e.width=i,e.height=a,e.data=n,e}function $s(e,t,r){var n=t.width,i=t.height;if(n!==e.width||i!==e.height){var a=Js({},{width:n,height:i},r);eu(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=a.data}}function eu(e,t,r,n,i,a){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,u=0;u<i.height;u++)for(var l=((r.y+u)*e.width+r.x)*a,c=((n.y+u)*t.width+n.x)*a,h=0;h<i.width*a;h++)s[c+h]=o[l+h];return t}bi("HeatmapBucket",Qs,{omit:["layers"]});var tu=function(){function e(t,r){v(this,e),Js(this,t,1,r)}return m(e,[{key:"resize",value:function(e){$s(this,e,1)}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,r,n,i){eu(e,t,r,n,i,1)}}]),e}(),ru=function(){function e(t,r){v(this,e),Js(this,t,4,r)}return m(e,[{key:"resize",value:function(e){$s(this,e,4)}},{key:"replace",value:function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}},{key:"clone",value:function(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}}],[{key:"copy",value:function(e,t,r,n,i){eu(e,t,r,n,i,4)}}]),e}();bi("AlphaImage",tu),bi("RGBAImage",ru);var nu={paint:new La({"heatmap-radius":new Ra(Je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ra(Je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ia(Je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Oa(Je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ia(Je.paint_heatmap["heatmap-opacity"])})};function iu(e){var t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new ru({width:r,height:n}),a=function(r,n,a){t[e.evaluationKey]=a;var o=e.expression.evaluate(t);i.data[r+n+0]=Math.floor(255*o.r/o.a),i.data[r+n+1]=Math.floor(255*o.g/o.a),i.data[r+n+2]=Math.floor(255*o.b/o.a),i.data[r+n+3]=Math.floor(255*o.a)};if(e.clips)for(var o=0,s=0;o<n;++o,s+=4*r)for(var u=0,l=0;u<r;u++,l+=4){var c=u/(r-1),h=e.clips[o];a(s,l,h.start*(1-c)+h.end*c)}else for(var f=0,d=0;f<r;f++,d+=4)a(0,d,f/(r-1));return i}var au={paint:new La({"hillshade-illumination-direction":new Ia(Je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ia(Je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ia(Je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ia(Je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ia(Je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ia(Je.paint_hillshade["hillshade-accent-color"])})},ou=Fa([{name:"a_pos",components:2,type:"Int16"}],4).members,su=lu,uu=lu;function lu(e,t,r){r=r||2;var n,i,a,o,s,u,l,c=t&&t.length,h=c?t[0]*r:e.length,f=cu(e,0,h,r,!0),d=[];if(!f||f.next===f.prev)return d;if(c&&(f=function(e,t,r,n){var i,a,o,s=[];for(i=0,a=t.length;i<a;i++)(o=cu(e,t[i]*n,i<a-1?t[i+1]*n:e.length,n,!1))===o.next&&(o.steiner=!0),s.push(wu(o));for(s.sort(mu),i=0;i<s.length;i++)gu(s[i],r),r=hu(r,r.next);return r}(e,t,f,r)),e.length>80*r){n=a=e[0],i=o=e[1];for(var p=r;p<h;p+=r)(s=e[p])<n&&(n=s),(u=e[p+1])<i&&(i=u),s>a&&(a=s),u>o&&(o=u);l=0!==(l=Math.max(a-n,o-i))?1/l:0}return fu(f,d,r,n,i,l),d}function cu(e,t,r,n,i){var a,o;if(i===Lu(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Mu(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Mu(a,e[a],e[a+1],o);return o&&Su(o,o.next)&&(Pu(o),o=o.next),o}function hu(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Su(n,n.next)&&0!==Eu(n.prev,n,n.next))n=n.next;else{if(Pu(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function fu(e,t,r,n,i,a,o){if(e){!o&&a&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=bu(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,u,l=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(u=l;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,l*=2}while(o>1)}(i)}(e,n,i,a);for(var s,u,l=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?pu(e,n,i,a):du(e))t.push(s.i/r),t.push(e.i/r),t.push(u.i/r),Pu(e),e=u.next,l=u.next;else if((e=u)===l){o?1===o?fu(e=yu(hu(e),t,r),t,r,n,i,a,2):2===o&&vu(e,t,r,n,i,a):fu(hu(e),t,r,n,i,a,1);break}}}function du(e){var t=e.prev,r=e,n=e.next;if(Eu(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(xu(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Eu(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function pu(e,t,r,n){var i=e.prev,a=e,o=e.next;if(Eu(i,a,o)>=0)return!1;for(var s=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,u=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,l=bu(i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,t,r,n),c=bu(s,u,t,r,n),h=e.prevZ,f=e.nextZ;h&&h.z>=l&&f&&f.z<=c;){if(h!==e.prev&&h!==e.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&Eu(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,f!==e.prev&&f!==e.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Eu(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;h&&h.z>=l;){if(h!==e.prev&&h!==e.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&Eu(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;f&&f.z<=c;){if(f!==e.prev&&f!==e.next&&xu(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Eu(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function yu(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!Su(i,a)&&Tu(i,n,n.next,a)&&Iu(i,a)&&Iu(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),Pu(n),Pu(n.next),n=e=a),n=n.next}while(n!==e);return hu(n)}function vu(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&ku(o,s)){var u=Ru(o,s);return o=hu(o,o.next),u=hu(u,u.next),fu(o,t,r,n,i,a),void fu(u,t,r,n,i,a)}s=s.next}o=o.next}while(o!==e)}function mu(e,t){return e.x-t.x}function gu(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r;var u,l=r,c=r.x,h=r.y,f=1/0;n=r;do{i>=n.x&&n.x>=c&&i!==n.x&&xu(a<h?i:o,a,c,h,a<h?o:i,a,n.x,n.y)&&(u=Math.abs(a-n.y)/(i-n.x),Iu(n,e)&&(u<f||u===f&&(n.x>r.x||n.x===r.x&&_u(r,n)))&&(r=n,f=u)),n=n.next}while(n!==l);return r}(e,t)){var r=Ru(t,e);hu(t,t.next),hu(r,r.next)}}function _u(e,t){return Eu(e.prev,e,t.prev)<0&&Eu(t.next,e,e.next)<0}function bu(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function wu(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function xu(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function ku(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Tu(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Iu(e,t)&&Iu(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(Eu(e.prev,e,t.prev)||Eu(e,t.prev,t))||Su(e,t)&&Eu(e.prev,e,e.next)>0&&Eu(t.prev,t,t.next)>0)}function Eu(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Su(e,t){return e.x===t.x&&e.y===t.y}function Tu(e,t,r,n){var i=Cu(Eu(e,t,r)),a=Cu(Eu(e,t,n)),o=Cu(Eu(r,n,e)),s=Cu(Eu(r,n,t));return i!==a&&o!==s||!(0!==i||!Au(e,r,t))||!(0!==a||!Au(e,n,t))||!(0!==o||!Au(r,e,n))||!(0!==s||!Au(r,t,n))}function Au(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Cu(e){return e>0?1:e<0?-1:0}function Iu(e,t){return Eu(e.prev,e,e.next)<0?Eu(e,t,e.next)>=0&&Eu(e,e.prev,t)>=0:Eu(e,t,e.prev)<0||Eu(e,e.next,t)<0}function Ru(e,t){var r=new Ou(e.i,e.x,e.y),n=new Ou(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Mu(e,t,r,n){var i=new Ou(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Pu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ou(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lu(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}function Du(e,t,r,n,i){Bu(e,t,r||0,n||e.length-1,i||zu)}function Bu(e,t,r,n,i){for(;n>r;){if(n-r>600){var a=n-r+1,o=t-r+1,s=Math.log(a),u=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*u*(a-u)/a)*(o-a/2<0?-1:1);Bu(e,t,Math.max(r,Math.floor(t-o*u/a+l)),Math.min(n,Math.floor(t+(a-o)*u/a+l)),i)}var c=e[t],h=r,f=n;for(Nu(e,r,t),i(e[n],c)>0&&Nu(e,r,n);h<f;){for(Nu(e,h,f),h++,f--;i(e[h],c)<0;)h++;for(;i(e[f],c)>0;)f--}0===i(e[r],c)?Nu(e,r,f):Nu(e,++f,n),f<=t&&(r=f+1),t<=f&&(n=f-1)}}function Nu(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function zu(e,t){return e<t?-1:e>t?1:0}function Fu(e,t){var r=e.length;if(r<=1)return[e];for(var n,i,a=[],o=0;o<r;o++){var s=W(e[o]);0!==s&&(e[o].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(n&&a.push(n),n=[e[o]]):n.push(e[o]))}if(n&&a.push(n),t>1)for(var u=0;u<a.length;u++)a[u].length<=t||(Du(a[u],t,1,a[u].length-1,ju),a[u]=a[u].slice(0,t));return a}function ju(e,t){return t.area-e.area}function Uu(e,t,r){var n,i=r.patternDependencies,a=!1,o=f(t);try{for(o.s();!(n=o.n()).done;){var s=n.value.paint.get("".concat(e,"-pattern"));s.isConstant()||(a=!0);var u=s.constantOr(null);u&&(a=!0,i[u.to]=!0,i[u.from]=!0)}}catch(l){o.e(l)}finally{o.f()}return a}function Vu(e,t,r,n,i){var a,o=i.patternDependencies,s=f(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,l=u.paint.get("".concat(e,"-pattern")).value;if("constant"!==l.kind){var c=l.evaluate({zoom:n-1},r,{},i.availableImages),h=l.evaluate({zoom:n},r,{},i.availableImages),d=l.evaluate({zoom:n+1},r,{},i.availableImages);c=c&&c.name?c.name:c,h=h&&h.name?h.name:h,d=d&&d.name?d.name:d,o[c]=!0,o[h]=!0,o[d]=!0,r.patterns[u.id]={min:c,mid:h,max:d}}}}catch(p){s.e(p)}finally{s.f()}return r}lu.deviation=function(e,t,r,n){var i=t&&t.length,a=Math.abs(Lu(e,0,i?t[0]*r:e.length,r));if(i)for(var o=0,s=t.length;o<s;o++)a-=Math.abs(Lu(e,t[o]*r,o<s-1?t[o+1]*r:e.length,r));var u=0;for(o=0;o<n.length;o+=3){var l=n[o]*r,c=n[o+1]*r,h=n[o+2]*r;u+=Math.abs((e[l]-e[h])*(e[c+1]-e[l+1])-(e[l]-e[c])*(e[h+1]-e[l+1]))}return 0===a&&0===u?0:Math.abs((u-a)/a)},lu.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&r.holes.push(n+=e[i-1].length)}return r},su.default=uu;var qu=function(){function e(t){v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ua,this.indexArray=new eo,this.indexArray2=new oo,this.programConfigurations=new Ko(t.layers,t.zoom),this.segments=new es,this.segments2=new es,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return m(e,[{key:"populate",value:function(e,t,r){this.hasPattern=Uu("fill",this.layers,t);var n,i=this.layers[0].layout.get("fill-sort-key"),a=[],o=f(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=s.feature,l=s.id,c=s.index,h=s.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,p=as(u,d);if(this.layers[0]._featureFilter.filter(new ba(this.zoom),p,r)){var y=i?i.evaluate(p,{},r,t.availableImages):void 0,v={id:l,properties:u.properties,type:u.type,sourceLayerIndex:h,index:c,geometry:d?p.geometry:is(u),patterns:{},sortKey:y};a.push(v)}}}catch(E){o.e(E)}finally{o.f()}i&&a.sort((function(e,t){return e.sortKey-t.sortKey}));for(var m=0,g=a;m<g.length;m++){var _=g[m],b=_.geometry,w=_.index,x=_.sourceLayerIndex;if(this.hasPattern){var k=Vu("fill",this.layers,_,this.zoom,t);this.patternFeatures.push(k)}else this.addFeature(_,b,w,r,{});t.featureIndex.insert(e[w].feature,b,w,x,this.index)}}},{key:"update",value:function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}},{key:"addFeatures",value:function(e,t,r){var n,i=f(this.patternFeatures);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.addFeature(a,a.geometry,a.index,t,r)}}catch(o){i.e(o)}finally{i.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ou),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}},{key:"addFeature",value:function(e,t,r,n,i){var a,o=f(Fu(t,500));try{for(o.s();!(a=o.n()).done;){var s,u=a.value,l=0,c=f(u);try{for(c.s();!(s=c.n()).done;)l+=s.value.length}catch(E){c.e(E)}finally{c.f()}var h,d=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray),p=d.vertexLength,y=[],v=[],m=f(u);try{for(m.s();!(h=m.n()).done;){var g=h.value;if(0!==g.length){g!==u[0]&&v.push(y.length/2);var _=this.segments2.prepareSegment(g.length,this.layoutVertexArray,this.indexArray2),b=_.vertexLength;this.layoutVertexArray.emplaceBack(g[0].x,g[0].y),this.indexArray2.emplaceBack(b+g.length-1,b),y.push(g[0].x),y.push(g[0].y);for(var w=1;w<g.length;w++)this.layoutVertexArray.emplaceBack(g[w].x,g[w].y),this.indexArray2.emplaceBack(b+w-1,b+w),y.push(g[w].x),y.push(g[w].y);_.vertexLength+=g.length,_.primitiveLength+=g.length}}}catch(E){m.e(E)}finally{m.f()}for(var x=su(y,v),k=0;k<x.length;k+=3)this.indexArray.emplaceBack(p+x[k],p+x[k+1],p+x[k+2]);d.vertexLength+=l,d.primitiveLength+=x.length/3}}catch(E){o.e(E)}finally{o.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}}]),e}();bi("FillBucket",qu,{omit:["layers","patternFeatures"]});var Gu=new La({"fill-sort-key":new Ra(Je.layout_fill["fill-sort-key"])}),Ku={paint:new La({"fill-antialias":new Ia(Je.paint_fill["fill-antialias"]),"fill-opacity":new Ra(Je.paint_fill["fill-opacity"]),"fill-color":new Ra(Je.paint_fill["fill-color"]),"fill-outline-color":new Ra(Je.paint_fill["fill-outline-color"]),"fill-translate":new Ia(Je.paint_fill["fill-translate"]),"fill-translate-anchor":new Ia(Je.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ma(Je.paint_fill["fill-pattern"])}),layout:Gu},Hu=Fa([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Wu=Fa([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Zu=Hu.members,Yu=Xu;function Xu(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(Qu,this,t)}function Qu(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function Ju(e){for(var t,r,n=0,i=0,a=e.length,o=a-1;i<a;o=i++)n+=((r=e[o]).x-(t=e[i]).x)*(t.y+r.y);return n}Xu.types=["Unknown","Point","LineString","Polygon"],Xu.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,a=0,o=0,s=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)a+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new g(a,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},Xu.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,s=-1/0,u=1/0,l=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(a+=e.readSVarint())<u&&(u=a),a>l&&(l=a);else if(7!==r)throw new Error("unknown command "+r)}return[o,u,s,l]},Xu.prototype.toGeoJSON=function(e,t,r){var n,i,a=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,u=this.loadGeometry(),l=Xu.types[this.type];function c(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<u.length;n++)h[n]=u[n][0];c(u=h);break;case 2:for(n=0;n<u.length;n++)c(u[n]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],a=0;a<t;a++){var o=Ju(e[a]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&i.push(r),r=[e[a]]):r.push(e[a]))}return r&&i.push(r),i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)c(u[n][i])}1===u.length?u=u[0]:l="Multi"+l;var f={type:"Feature",geometry:{type:l,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var $u=el;function el(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(tl,this,t),this.length=this._features.length}function tl(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}function rl(e,t,r){if(3===e){var n=new $u(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}el.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Yu(this._pbf,t,this.extent,this._keys,this._values)};var nl={VectorTile:function(e,t){this.layers=e.readFields(rl,{},t)},VectorTileFeature:Yu,VectorTileLayer:$u},il=nl.VectorTileFeature.types,al=Math.pow(2,13);function ol(e,t,r,n,i,a,o,s){e.emplaceBack((t<<1)+o,(r<<1)+a,(Math.floor(n*al)<<1)+i,Math.round(s))}var sl=function(){function e(){v(this,e),this.acc=new g(0,0),this.polyCount=[]}return m(e,[{key:"startRing",value:function(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new g(e.x,e.y),this.max=new g(e.x,e.y))}},{key:"append",value:function(e,t){this.currentPolyCount.edges++,this.acc._add(e);var r=!!this.borders,n=this.min,i=this.max;e.x<n.x?(n.x=e.x,r=!0):e.x>i.x&&(i.x=e.x,r=!0),e.y<n.y?(n.y=e.y,r=!0):e.y>i.y&&(i.y=e.y,r=!0),((0===e.x||e.x===ts)&&e.x===t.x)!=((0===e.y||e.y===ts)&&e.y===t.y)&&this.processBorderOverlap(e,t),r&&this.checkBorderIntersection(e,t)}},{key:"checkBorderIntersection",value:function(e,t){t.x<0!=e.x<0&&this.addBorderIntersection(0,vr(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>ts!=e.x>ts&&this.addBorderIntersection(1,vr(t.y,e.y,(ts-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,vr(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>ts!=e.y>ts&&this.addBorderIntersection(3,vr(t.x,e.x,(ts-t.y)/(e.y-t.y)))}},{key:"addBorderIntersection",value:function(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);var r=this.borders[e];t<r[0]&&(r[0]=t),t>r[1]&&(r[1]=t)}},{key:"processBorderOverlap",value:function(e,t){if(e.x===t.x){if(e.y===t.y)return;var r=0===e.x?0:1;this.addBorderIntersection(r,t.y),this.addBorderIntersection(r,e.y)}else{var n=0===e.y?2:3;this.addBorderIntersection(n,t.x),this.addBorderIntersection(n,e.x)}}},{key:"centroid",value:function(){var e=this.polyCount.reduce((function(e,t){return e+t.edges}),0);return 0!==e?this.acc.div(e)._round():new g(0,0)}},{key:"span",value:function(){return new g(this.max.x-this.min.x,this.max.y-this.min.y)}},{key:"intersectsCount",value:function(){return this.borders.reduce((function(e,t){return e+ +(t[0]!==Number.MAX_VALUE)}),0)}}]),e}(),ul=function(){function e(t){v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Va,this.centroidVertexArray=new wo,this.indexArray=new eo,this.programConfigurations=new Ko(t.layers,t.zoom),this.segments=new es,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.enableTerrain=t.enableTerrain}return m(e,[{key:"populate",value:function(e,t,r){this.features=[],this.hasPattern=Uu("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(e){var t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/ts/(1<<e.z)}(r);var n,i=f(e);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.feature,s=a.id,u=a.index,l=a.sourceLayerIndex,c=this.layers[0]._featureFilter.needGeometry,h=as(o,c);if(this.layers[0]._featureFilter.filter(new ba(this.zoom),h,r)){var d={id:s,sourceLayerIndex:l,index:u,geometry:c?h.geometry:is(o),properties:o.properties,type:o.type,patterns:{}},p=this.layoutVertexArray.length;this.hasPattern?this.features.push(Vu("fill-extrusion",this.layers,d,this.zoom,t)):this.addFeature(d,d.geometry,u,r,{}),t.featureIndex.insert(o,d.geometry,u,l,this.index,p)}}}catch(y){i.e(y)}finally{i.f()}this.sortBorders()}},{key:"addFeatures",value:function(e,t,r){var n,i=f(this.features);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.geometry;this.addFeature(a,o,a.index,t,r)}}catch(s){i.e(s)}finally{i.f()}this.sortBorders()}},{key:"update",value:function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"uploadCentroid",value:function(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Wu.members,!0),this.needsCentroidUpdate=!1)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"addFeature",value:function(e,t,r,n,i){var a,o,s=this.enableTerrain?new sl:null,u=f(Fu(t,500));try{for(u.s();!(a=u.n()).done;){var l=a.value,c=0,h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(!(0===l.length||(o=l[0]).every((function(e){return e.x<=0}))||o.every((function(e){return e.x>=ts}))||o.every((function(e){return e.y<=0}))||o.every((function(e){return e.y>=ts})))){for(var d=0;d<l.length;d++){var p=l[d];if(0!==p.length){c+=p.length;var y=0;s&&s.startRing(p[0]);for(var v=0;v<p.length;v++){var m=p[v];if(v>=1){var g=p[v-1];if(!ll(m,g)){s&&s.append(m,g),h.vertexLength+4>es.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var _=m.sub(g)._perp(),b=_.x/(Math.abs(_.x)+Math.abs(_.y)),w=_.y>0?1:0,x=g.dist(m);y+x>32768&&(y=0),ol(this.layoutVertexArray,m.x,m.y,b,w,0,0,y),ol(this.layoutVertexArray,m.x,m.y,b,w,0,1,y),y+=x,ol(this.layoutVertexArray,g.x,g.y,b,w,0,0,y),ol(this.layoutVertexArray,g.x,g.y,b,w,0,1,y);var k=h.vertexLength;this.indexArray.emplaceBack(k,k+2,k+1),this.indexArray.emplaceBack(k+1,k+2,k+3),h.vertexLength+=4,h.primitiveLength+=2}}}}}if(h.vertexLength+c>es.MAX_VERTEX_ARRAY_LENGTH&&(h=this.segments.prepareSegment(c,this.layoutVertexArray,this.indexArray)),"Polygon"===il[e.type]){for(var E=[],S=[],T=h.vertexLength,A=0;A<l.length;A++){var C=l[A];if(0!==C.length){C!==l[0]&&S.push(E.length/2);for(var I=0;I<C.length;I++){var R=C[I];ol(this.layoutVertexArray,R.x,R.y,0,0,1,1,0),E.push(R.x),E.push(R.y),s&&s.currentPolyCount.top++}}}for(var M=su(E,S),P=0;P<M.length;P+=3)this.indexArray.emplaceBack(T+M[P],T+M[P+2],T+M[P+1]);h.primitiveLength+=M.length/3,h.vertexLength+=c}}}}catch(B){u.e(B)}finally{u.f()}if(s&&s.polyCount.length>0){if(s.borders){s.vertexArrayOffset=this.centroidVertexArray.length;for(var O=s.borders,L=this.featuresOnBorder.push(s)-1,D=0;D<4;D++)O[D][0]!==Number.MAX_VALUE&&this.borders[D].push(L)}this.encodeCentroid(s.borders?void 0:s.centroid(),s)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}},{key:"sortBorders",value:function(){for(var e=this,t=function(t){e.borders[t].sort((function(r,n){return e.featuresOnBorder[r].borders[t][0]-e.featuresOnBorder[n].borders[t][0]}))},r=0;r<4;r++)t(r)}},{key:"encodeCentroid",value:function(e,t){var r,n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e)if(0!==e.y){var a=t.span()._mult(this.tileToMeter);r=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(a.x/10)),n=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(a.y/10))}else r=Math.ceil(7*(e.x+450)),n=0;else r=0,n=+i;var o,s=i?this.centroidVertexArray.length:t.vertexArrayOffset,u=f(t.polyCount);try{for(u.s();!(o=u.n()).done;){var l=o.value;i&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*l.edges+l.top);for(var c=0;c<2*l.edges;c++)this.centroidVertexArray.emplace(s++,0,n),this.centroidVertexArray.emplace(s++,r,n);for(var h=0;h<l.top;h++)this.centroidVertexArray.emplace(s++,r,n)}}catch(d){u.e(d)}finally{u.f()}}}]),e}();function ll(e,t){return e.x===t.x&&(e.x<0||e.x>ts)||e.y===t.y&&(e.y<0||e.y>ts)}bi("FillExtrusionBucket",ul,{omit:["layers","features"]}),bi("PartMetadata",sl);var cl={paint:new La({"fill-extrusion-opacity":new Ia(Je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ra(Je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ia(Je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ia(Je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ma(Je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ra(Je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ra(Je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ia(Je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function hl(e,t){return e.x*t.x+e.y*t.y}function fl(e,t){if(1===e.length){for(var r,n=0,i=t[n++];!r||i.equals(r);)if(!(r=t[n++]))return 1/0;for(;n<t.length;n++){var a=t[n],o=e[0],s=r.sub(i),u=a.sub(i),l=o.sub(i),c=hl(s,s),h=hl(s,u),d=hl(u,u),p=hl(l,s),y=hl(l,u),v=c*d-h*h,m=(d*p-h*y)/v,g=(c*y-h*p)/v,_=i.z*(1-m-g)+r.z*m+a.z*g;if(isFinite(_))return _}return 1/0}var b,w=1/0,x=f(t);try{for(x.s();!(b=x.n()).done;){var k=b.value;w=Math.min(w,k.z)}}catch(E){x.e(E)}finally{x.f()}return w}function dl(e){var t=new g(e[0],e[1]);return t.z=e[2],t}function pl(e,t,r,n,i,a,o,s){var u=o*i.getElevationAt(e,t,!0,!0),l=0!==a[0],c=l?0===a[1]?o*(a[0]/7-450):o*function(e,t,r){var n=Math.floor(t[0]/8),i=Math.floor(t[1]/8),a=10*(t[0]-8*n),o=10*(t[1]-8*i),s=e.getElevationAt(n,i,!0,!0),u=e.getMeterToDEM(r),l=Math.floor(.5*(a*u-1)),c=Math.floor(.5*(o*u-1)),h=e.tileCoordToPixel(n,i),f=2*l+1,d=2*c+1,p=function(e,t,r,n,i){return[e.getElevationAtPixel(t,r,!0),e.getElevationAtPixel(t+i,r,!0),e.getElevationAtPixel(t,r+i,!0),e.getElevationAtPixel(t+n,r+i,!0)]}(e,h.x-l,h.y-c,f,d),y=Math.abs(p[0]-p[1]),v=Math.abs(p[2]-p[3]),m=Math.abs(p[0]-p[2])+Math.abs(p[1]-p[3]),g=Math.min(.25,.5*u*(y+v)/f),_=Math.min(.25,.5*u*m/d);return s+Math.max(g*a,_*o)}(i,a,s):u;return{base:u+(0===r)?-1:r,top:l?Math.max(c+n,u+r+2):u+n}}var yl=Fa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4).members,vl=Fa([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,ml=nl.VectorTileFeature.types,gl=Math.cos(Math.PI/180*37.5),_l=function(){function e(t){var r=this;v(this,e),this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((function(e){r.gradients[e.id]={}})),this.layoutVertexArray=new qa,this.layoutVertexArray2=new Ga,this.indexArray=new eo,this.programConfigurations=new Ko(t.layers,t.zoom),this.segments=new es,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id}))}return m(e,[{key:"populate",value:function(e,t,r){this.hasPattern=Uu("line",this.layers,t);var n,i=this.layers[0].layout.get("line-sort-key"),a=[],o=f(e);try{for(o.s();!(n=o.n()).done;){var s=n.value,u=s.feature,l=s.id,c=s.index,h=s.sourceLayerIndex,d=this.layers[0]._featureFilter.needGeometry,p=as(u,d);if(this.layers[0]._featureFilter.filter(new ba(this.zoom),p,r)){var y=i?i.evaluate(p,{},r):void 0,v={id:l,properties:u.properties,type:u.type,sourceLayerIndex:h,index:c,geometry:d?p.geometry:is(u),patterns:{},sortKey:y};a.push(v)}}}catch(A){o.e(A)}finally{o.f()}i&&a.sort((function(e,t){return e.sortKey-t.sortKey}));for(var m=t.lineAtlas,g=t.featureIndex,_=this.addConstantDashes(m),b=0,w=a;b<w.length;b++){var x=w[b],k=x.geometry,E=x.index,S=x.sourceLayerIndex;if(_&&this.addFeatureDashes(x,m),this.hasPattern){var T=Vu("line",this.layers,x,this.zoom,t);this.patternFeatures.push(T)}else this.addFeature(x,k,E,r,m.positions);g.insert(e[E].feature,k,E,S,this.index)}}},{key:"addConstantDashes",value:function(e){var t,r=!1,n=f(this.layers);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=i.paint.get("line-dasharray").value,o=i.layout.get("line-cap").value;if("constant"!==a.kind||"constant"!==o.kind)r=!0;else{var s=o.value,u=a.value;if(!u)continue;e.addDash(u.from,s),e.addDash(u.to,s),u.other&&e.addDash(u.other,s)}}}catch(l){n.e(l)}finally{n.f()}return r}},{key:"addFeatureDashes",value:function(e,t){var r,n=this.zoom,i=f(this.layers);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.paint.get("line-dasharray").value,s=a.layout.get("line-cap").value;if("constant"!==o.kind||"constant"!==s.kind){var u=void 0,l=void 0,c=void 0,h=void 0,d=void 0,p=void 0;if("constant"===o.kind){var y=o.value;if(!y)continue;u=y.other||y.to,l=y.to,c=y.from}else u=o.evaluate({zoom:n-1},e),l=o.evaluate({zoom:n},e),c=o.evaluate({zoom:n+1},e);"constant"===s.kind?h=d=p=s.value:(h=s.evaluate({zoom:n-1},e),d=s.evaluate({zoom:n},e),p=s.evaluate({zoom:n+1},e)),t.addDash(u,h),t.addDash(l,d),t.addDash(c,p);var v=t.getKey(u,h),m=t.getKey(l,d),g=t.getKey(c,p);e.patterns[a.id]={min:v,mid:m,max:g}}}}catch(_){i.e(_)}finally{i.f()}}},{key:"update",value:function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}},{key:"addFeatures",value:function(e,t,r){var n,i=f(this.patternFeatures);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.addFeature(a,a.geometry,a.index,t,r)}}catch(o){i.e(o)}finally{i.f()}}},{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length}},{key:"uploadPending",value:function(){return!this.uploaded||this.programConfigurations.needsUpload}},{key:"upload",value:function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,vl)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,yl),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}},{key:"lineFeatureClips",value:function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}},{key:"addFeature",value:function(e,t,r,n,i){var a=this.layers[0].layout,o=a.get("line-join").evaluate(e,{}),s=a.get("line-cap").evaluate(e,{}),u=a.get("line-miter-limit"),l=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);var c,h=f(t);try{for(h.s();!(c=h.n()).done;){var d=c.value;this.addLine(d,e,o,s,u,l)}}catch(p){h.e(p)}finally{h.f()}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,n)}},{key:"addLine",value:function(e,t,r,n,i,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var o=0;o<e.length-1;o++)this.totalDistance+=e[o].dist(e[o+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var s="Polygon"===ml[t.type],u=e.length;u>=2&&e[u-1].equals(e[u-2]);)u--;for(var l=0;l<u-1&&e[l].equals(e[l+1]);)l++;if(!(u<(s?3:2))){"bevel"===r&&(i=1.05);var c,h,f,d,p,y=this.overscaling<=16?122880/(512*this.overscaling):0,v=this.segments.prepareSegment(10*u,this.layoutVertexArray,this.indexArray);this.e1=this.e2=-1,s&&(c=e[u-2],p=e[l].sub(c)._unit()._perp());for(var m=l;m<u;m++)if(!(f=m===u-1?s?e[l+1]:void 0:e[m+1])||!e[m].equals(f)){p&&(d=p),c&&(h=c),c=e[m],p=f?f.sub(c)._unit()._perp():d;var g=(d=d||p).add(p);0===g.x&&0===g.y||g._unit();var _=d.x*p.x+d.y*p.y,b=g.x*p.x+g.y*p.y,w=0!==b?1/b:1/0,x=2*Math.sqrt(2-2*b),k=b<gl&&h&&f,E=d.x*p.y-d.y*p.x>0;if(k&&m>l){var S=c.dist(h);if(S>2*y){var T=c.sub(c.sub(h)._mult(y/S)._round());this.updateDistance(h,T),this.addCurrentVertex(T,d,0,0,v),h=T}}var A=h&&f,C=A?r:s?"butt":n;if(A&&"round"===C&&(w<a?C="miter":w<=2&&(C="fakeround")),"miter"===C&&w>i&&(C="bevel"),"bevel"===C&&(w>2&&(C="flipbevel"),w<i&&(C="miter")),h&&this.updateDistance(h,c),"miter"===C)g._mult(w),this.addCurrentVertex(c,g,0,0,v);else if("flipbevel"===C){if(w>100)g=p.mult(-1);else{var I=w*d.add(p).mag()/d.sub(p).mag();g._perp()._mult(I*(E?-1:1))}this.addCurrentVertex(c,g,0,0,v),this.addCurrentVertex(c,g.mult(-1),0,0,v)}else if("bevel"===C||"fakeround"===C){var R=-Math.sqrt(w*w-1),M=E?R:0,P=E?0:R;if(h&&this.addCurrentVertex(c,d,M,P,v),"fakeround"===C)for(var O=Math.round(180*x/Math.PI/20),L=1;L<O;L++){var D=L/O;if(.5!==D){var B=D-.5;D+=D*B*(D-1)*((1.0904+_*(_*(3.55645-1.43519*_)-3.2452))*B*B+(.848013+_*(.215638*_-1.06021)))}var N=p.sub(d)._mult(D)._add(d)._unit()._mult(E?-1:1);this.addHalfVertex(c,N.x,N.y,!1,E,0,v)}f&&this.addCurrentVertex(c,p,-M,-P,v)}else if("butt"===C)this.addCurrentVertex(c,g,0,0,v);else if("square"===C){var z=h?1:-1;h||this.addCurrentVertex(c,g,z,z,v),this.addCurrentVertex(c,g,0,0,v),h&&this.addCurrentVertex(c,g,z,z,v)}else"round"===C&&(h&&(this.addCurrentVertex(c,d,0,0,v),this.addCurrentVertex(c,d,1,1,v,!0)),f&&(this.addCurrentVertex(c,p,-1,-1,v,!0),this.addCurrentVertex(c,p,0,0,v)));if(k&&m<u-1){var F=c.dist(f);if(F>2*y){var j=c.add(f.sub(c)._mult(y/F)._round());this.updateDistance(c,j),this.addCurrentVertex(j,p,0,0,v),c=j}}}}}},{key:"addCurrentVertex",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,a,!1,r,i),this.addHalfVertex(e,o,s,a,!0,-n,i)}},{key:"addHalfVertex",value:function(e,t,r,n,i,a,o){var s=e.x,u=e.y;this.layoutVertexArray.emplaceBack((s<<1)+(n?1:0),(u<<1)+(i?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length);var l=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,l),o.primitiveLength++),i?this.e2=l:this.e1=l}},{key:"updateScaledDistance",value:function(){if(this.lineClips){var e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}},{key:"updateDistance",value:function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}]),e}();bi("LineBucket",_l,{omit:["layers","patternFeatures"]});var bl=new La({"line-cap":new Ra(Je.layout_line["line-cap"]),"line-join":new Ra(Je.layout_line["line-join"]),"line-miter-limit":new Ia(Je.layout_line["line-miter-limit"]),"line-round-limit":new Ia(Je.layout_line["line-round-limit"]),"line-sort-key":new Ra(Je.layout_line["line-sort-key"])}),wl={paint:new La({"line-opacity":new Ra(Je.paint_line["line-opacity"]),"line-color":new Ra(Je.paint_line["line-color"]),"line-translate":new Ia(Je.paint_line["line-translate"]),"line-translate-anchor":new Ia(Je.paint_line["line-translate-anchor"]),"line-width":new Ra(Je.paint_line["line-width"]),"line-gap-width":new Ra(Je.paint_line["line-gap-width"]),"line-offset":new Ra(Je.paint_line["line-offset"]),"line-blur":new Ra(Je.paint_line["line-blur"]),"line-dasharray":new Ma(Je.paint_line["line-dasharray"]),"line-pattern":new Ma(Je.paint_line["line-pattern"]),"line-gradient":new Oa(Je.paint_line["line-gradient"])}),layout:bl},xl=new(function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"possiblyEvaluate",value:function(e,t){return t=new ba(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),o(s(r.prototype),"possiblyEvaluate",this).call(this,e,t)}},{key:"evaluate",value:function(e,t,n,i){return t=O({},t,{zoom:Math.floor(t.zoom)}),o(s(r.prototype),"evaluate",this).call(this,e,t,n,i)}}]),r}(Ra))(wl.paint.properties["line-width"].specification);function kl(e,t){return t>0?t+2*e:e}xl.useIntegerZoom=!0;var El=Fa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Sl=Fa([{name:"a_projected_pos",components:3,type:"Float32"}],4);Fa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Tl=Fa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Al=Fa([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Fa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var Cl=Fa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Il=Fa([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Fa([{name:"triangle",components:3,type:"Uint16"}]),Fa([{type:"Float32",name:"anchorX"},{type:"Float32",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Fa([{type:"Float32",name:"anchorX"},{type:"Float32",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Fa([{type:"Float32",name:"offsetX"}]),Fa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Rl=24,Ml=128;function Pl(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new ba(e+1))};if("source"===r.kind)return{kind:"source"};for(var n=r.zoomStops,i=r.interpolationType,a=0;a<n.length&&n[a]<=e;)a++;for(var o=a=Math.max(0,a-1);o<n.length&&n[o]<e+1;)o++;o=Math.min(n.length-1,o);var s=n[a],u=n[o];return"composite"===r.kind?{kind:"composite",minZoom:s,maxZoom:u,interpolationType:i}:{kind:"camera",minZoom:s,maxZoom:u,minSize:r.evaluate(new ba(s)),maxSize:r.evaluate(new ba(u)),interpolationType:i}}function Ol(e,t,r){var n=t.uSize,i=t.uSizeT,a=r.lowerSize,o=r.upperSize;return"source"===e.kind?a/Ml:"composite"===e.kind?vr(a/Ml,o/Ml,i):n}function Ll(e,t){var r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){var i=e.interpolationType,a=e.minZoom,o=e.maxZoom,s=i?I(Dr.interpolationFactor(i,t,a,o),0,1):0;"camera"===e.kind?n=vr(e.minSize,e.maxSize,s):r=s}return{uSizeT:r,uSize:n}}var Dl=Object.freeze({__proto__:null,getSizeData:Pl,evaluateSizeForFeature:Ol,evaluateSizeForZoom:Ll,SIZE_PACK_FACTOR:Ml});function Bl(e,t,r){return e.sections.forEach((function(e){e.text=function(e,t,r){var n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),_a.applyArabicShaping&&(e=_a.applyArabicShaping(e)),e}(e.text,t,r)})),e}var Nl={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function zl(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function Fl(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var jl=function(e,t,r,n,i){var a,o,s=8*i-n-1,u=(1<<s)-1,l=u>>1,c=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+e[t+h],h+=f,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+h],h+=f,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),a-=l}return(d?-1:1)*o*Math.pow(2,a-n)},Ul=function(e,t,r,n,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,y=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=c?(s=0,o=c):o+h>=1?(s=(t*u-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;e[r+d]=255&o,d+=p,o/=256,l-=8);e[r+d-p]|=128*y},Vl=ql;function ql(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}ql.Varint=0,ql.Fixed64=1,ql.Bytes=2,ql.Fixed32=5;var Gl=4294967296,Kl=1/Gl,Hl="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Wl(e){return e.type===ql.Bytes?e.readVarint()+e.pos:e.pos+1}function Zl(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Yl(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function Xl(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Ql(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Jl(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function $l(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function ec(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function tc(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function rc(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function nc(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function ic(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function ac(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function oc(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function sc(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function uc(e,t,r){t.glyphs=[],1===e&&r.readMessage(lc,t)}function lc(e,t,r){if(3===e){var n=r.readMessage(cc,{}),i=n.id,a=n.bitmap,o=n.width,s=n.height,u=n.left,l=n.top,c=n.advance;t.glyphs.push({id:i,bitmap:new tu({width:o+6,height:s+6},a),metrics:{width:o,height:s,left:u,top:l,advance:c}})}else 4===e?t.ascender=r.readSVarint():5===e&&(t.descender=r.readSVarint())}function cc(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function hc(e){var t,r=0,n=0,i=f(e);try{for(i.s();!(t=i.n()).done;){var a=t.value;r+=a.w*a.h,n=Math.max(n,a.w)}}catch(v){i.e(v)}finally{i.f()}e.sort((function(e,t){return t.h-e.h}));var o,s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),n),h:1/0}],u=0,l=0,c=f(e);try{for(c.s();!(o=c.n()).done;)for(var h=o.value,d=s.length-1;d>=0;d--){var p=s[d];if(!(h.w>p.w||h.h>p.h)){if(h.x=p.x,h.y=p.y,l=Math.max(l,h.y+h.h),u=Math.max(u,h.x+h.w),h.w===p.w&&h.h===p.h){var y=s.pop();d<s.length&&(s[d]=y)}else h.h===p.h?(p.x+=h.w,p.w-=h.w):h.w===p.w?(p.y+=h.h,p.h-=h.h):(s.push({x:p.x+h.w,y:p.y,w:p.w-h.w,h:h.h}),p.y+=h.h,p.h-=h.h);break}}}catch(v){c.e(v)}finally{c.f()}return{w:u,h:l,fill:r/(u*l)||0}}ql.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=7&n,e(i,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=ac(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=sc(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=ac(this.buf,this.pos)+ac(this.buf,this.pos+4)*Gl;return this.pos+=8,e},readSFixed64:function(){var e=ac(this.buf,this.pos)+sc(this.buf,this.pos+4)*Gl;return this.pos+=8,e},readFloat:function(){var e=jl(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=jl(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,a=r.buf;if(n=(112&(i=a[r.pos++]))>>4,i<128)return Zl(e,n,t);if(n|=(127&(i=a[r.pos++]))<<3,i<128)return Zl(e,n,t);if(n|=(127&(i=a[r.pos++]))<<10,i<128)return Zl(e,n,t);if(n|=(127&(i=a[r.pos++]))<<17,i<128)return Zl(e,n,t);if(n|=(127&(i=a[r.pos++]))<<24,i<128)return Zl(e,n,t);if(n|=(1&(i=a[r.pos++]))<<31,i<128)return Zl(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Hl?function(e,t,r){return Hl.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",i=t;i<r;){var a,o,s,u=e[i],l=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c>r)break;1===c?u<128&&(l=u):2===c?128==(192&(a=e[i+1]))&&(l=(31&u)<<6|63&a)<=127&&(l=null):3===c?(o=e[i+2],128==(192&(a=e[i+1]))&&128==(192&o)&&((l=(15&u)<<12|(63&a)<<6|63&o)<=2047||l>=55296&&l<=57343)&&(l=null)):4===c&&(o=e[i+2],s=e[i+3],128==(192&(a=e[i+1]))&&128==(192&o)&&128==(192&s)&&((l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||l>=1114112)&&(l=null)),null===l?(l=65533,c=1):l>65535&&(l-=65536,n+=String.fromCharCode(l>>>10&1023|55296),l=56320|1023&l),n+=String.fromCharCode(l),i+=c}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==ql.Bytes)return e.push(this.readVarint(t));var r=Wl(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==ql.Bytes)return e.push(this.readSVarint());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==ql.Bytes)return e.push(this.readBoolean());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==ql.Bytes)return e.push(this.readFloat());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==ql.Bytes)return e.push(this.readDouble());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==ql.Bytes)return e.push(this.readFixed32());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==ql.Bytes)return e.push(this.readSFixed32());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==ql.Bytes)return e.push(this.readFixed64());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==ql.Bytes)return e.push(this.readSFixed64());var t=Wl(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===ql.Varint)for(;this.buf[this.pos++]>127;);else if(t===ql.Bytes)this.pos=this.readVarint()+this.pos;else if(t===ql.Fixed32)this.pos+=4;else{if(t!==ql.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),oc(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),oc(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),oc(this.buf,-1&e,this.pos),oc(this.buf,Math.floor(e*Kl),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),oc(this.buf,-1&e,this.pos),oc(this.buf,Math.floor(e*Kl),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,a=0;a<t.length;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){n>56319||a+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Yl(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Ul(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ul(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Yl(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,ql.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Xl,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Ql,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,ec,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Jl,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,$l,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,tc,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,rc,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,nc,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,ic,t)},writeBytesField:function(e,t){this.writeTag(e,ql.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,ql.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,ql.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,ql.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,ql.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,ql.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,ql.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,ql.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,ql.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,ql.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var fc=function(){function e(t,r){var n=r.pixelRatio,i=r.version,a=r.stretchX,o=r.stretchY,s=r.content;v(this,e),this.paddedRect=t,this.pixelRatio=n,this.stretchX=a,this.stretchY=o,this.content=s,this.version=i}return m(e,[{key:"tl",get:function(){return[this.paddedRect.x+1,this.paddedRect.y+1]}},{key:"br",get:function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}},{key:"displaySize",get:function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}]),e}(),dc=function(){function e(t,r){v(this,e);var n={},i={};this.haveRenderCallbacks=[];var a=[];this.addImages(t,n,a),this.addImages(r,i,a);var o=hc(a),s=o.w,u=o.h,l=new ru({width:s||1,height:u||1});for(var c in t){var h=t[c],f=n[c].paddedRect;ru.copy(h.data,l,{x:0,y:0},{x:f.x+1,y:f.y+1},h.data)}for(var d in r){var p=r[d],y=i[d].paddedRect,m=y.x+1,g=y.y+1,_=p.data.width,b=p.data.height;ru.copy(p.data,l,{x:0,y:0},{x:m,y:g},p.data),ru.copy(p.data,l,{x:0,y:b-1},{x:m,y:g-1},{width:_,height:1}),ru.copy(p.data,l,{x:0,y:0},{x:m,y:g+b},{width:_,height:1}),ru.copy(p.data,l,{x:_-1,y:0},{x:m-1,y:g},{width:1,height:b}),ru.copy(p.data,l,{x:0,y:0},{x:m+_,y:g},{width:1,height:b})}this.image=l,this.iconPositions=n,this.patternPositions=i}return m(e,[{key:"addImages",value:function(e,t,r){for(var n in e){var i=e[n],a={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(a),t[n]=new fc(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}},{key:"patchUpdatedImages",value:function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}},{key:"patchUpdatedImage",value:function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var n=h(e.tl,2),i=n[0],a=n[1];r.update(t.data,void 0,{x:i,y:a})}}}]),e}();bi("ImagePosition",fc),bi("ImageAtlas",dc);var pc={horizontal:1,vertical:2,horizontalOnly:3},yc=function(){function e(){v(this,e),this.scale=1,this.fontStack="",this.imageName=null}return m(e,null,[{key:"forText",value:function(t,r){var n=new e;return n.scale=t||1,n.fontStack=r,n}},{key:"forImage",value:function(t){var r=new e;return r.imageName=t,r}}]),e}(),vc=function(){function e(){v(this,e),this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}return m(e,[{key:"length",value:function(){return this.text.length}},{key:"getSection",value:function(e){return this.sections[this.sectionIndex[e]]}},{key:"getSections",value:function(){return this.sections}},{key:"getSectionIndex",value:function(e){return this.sectionIndex[e]}},{key:"getCharCode",value:function(e){return this.text.charCodeAt(e)}},{key:"verticalizePunctuation",value:function(e){this.text=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e.charCodeAt(n+1)||null,a=e.charCodeAt(n-1)||null;r+=!t&&(i&&ia(i)&&!Nl[e[n+1]]||a&&ia(a)&&!Nl[e[n-1]])||!Nl[e[n]]?e[n]:Nl[e[n]]}return r}(this.text,e)}},{key:"trim",value:function(){for(var e=0,t=0;t<this.text.length&&gc[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,n=this.text.length-1;n>=0&&n>=e&&gc[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}},{key:"substring",value:function(t,r){var n=new e;return n.text=this.text.substring(t,r),n.sectionIndex=this.sectionIndex.slice(t,r),n.sections=this.sections,n}},{key:"toString",value:function(){return this.text}},{key:"getMaxScale",value:function(){var e=this;return this.sectionIndex.reduce((function(t,r){return Math.max(t,e.sections[r].scale)}),0)}},{key:"addTextSection",value:function(e,t){this.text+=e.text,this.sections.push(yc.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,n=0;n<e.text.length;++n)this.sectionIndex.push(r)}},{key:"addImageSection",value:function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(yc.forImage(t)),this.sectionIndex.push(this.sections.length-1)):K("Reached maximum number of images 6401")}else K("Can't add FormattedSection with an empty image.")}},{key:"getNextImageSectionCharCode",value:function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}],[{key:"fromFeature",value:function(t,r){for(var n=new e,i=0;i<t.sections.length;i++){var a=t.sections[i];a.image?n.addImageSection(a):n.addTextSection(a,r)}return n}}]),e}();function mc(e,t,r,n,i,a,o,s,u,l,c,h,d,p,y,v){var m,g=vc.fromFeature(e,i);h===pc.vertical&&g.verticalizePunctuation(d);var _=_a.processBidirectionalText,b=_a.processStyledBidirectionalText;if(_&&1===g.sections.length){m=[];var w,x=_(g.toString(),Sc(g,l,a,t,n,p,y)),k=f(x);try{for(k.s();!(w=k.n()).done;){var E=w.value,S=new vc;S.text=E,S.sections=g.sections;for(var T=0;T<E.length;T++)S.sectionIndex.push(0);m.push(S)}}catch(L){k.e(L)}finally{k.f()}}else if(b){m=[];var A,C=b(g.text,g.sectionIndex,Sc(g,l,a,t,n,p,y)),I=f(C);try{for(I.s();!(A=I.n()).done;){var R=A.value,M=new vc;M.text=R[0],M.sectionIndex=R[1],M.sections=g.sections,m.push(M)}}catch(L){I.e(L)}finally{I.f()}}else m=function(e,t){var r,n=[],i=e.text,a=0,o=f(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;n.push(e.substring(a,s)),a=s}}catch(L){o.e(L)}finally{o.f()}return a<i.length&&n.push(e.substring(a,i.length)),n}(g,Sc(g,l,a,t,n,p,y));var P=[],O={positionedLines:P,text:g.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,r,n,i,a,o,s,u,l,c,h){var d,p=0,y=0,v=0,m="right"===s?1:"left"===s?0:.5,g=!1,_=f(i);try{for(_.s();!(d=_.n()).done;){var b,w=d.value.getSections(),x=f(w);try{for(x.s();!(b=x.n()).done;){var k=b.value;if(!k.imageName){var E=t[k.fontStack];if(E&&!(g=void 0!==E.ascender&&void 0!==E.descender))break}}}catch(L){x.e(L)}finally{x.f()}if(!g)break}}catch(L){_.e(L)}finally{_.f()}var S,T,A=0,C=f(i);try{for(C.s();!(S=C.n()).done;){var I=S.value;I.trim();var R=I.getMaxScale(),M=(R-1)*Rl,P={positionedGlyphs:[],lineOffset:0};e.positionedLines[A]=P;var O=P.positionedGlyphs,D=0;if(I.length()){for(var B=0,N=0,z=0;z<I.length();z++){var F=I.getSection(z),j=I.getSectionIndex(z),U=I.getCharCode(z),V=F.scale,q=null,G=null,K=null,H=Rl,W=0,Z=!(u===pc.horizontal||!c&&!na(U)||c&&(gc[U]||(T=U,Ai(T)||Ci(T)||Ii(T)||Zi(T)||Ji(T))));if(F.imageName){var Y=n[F.imageName];if(!Y)continue;K=F.imageName,e.iconsInText=e.iconsInText||!0,G=Y.paddedRect;var X=Y.displaySize;V=V*Rl/h,q={width:X[0],height:X[1],left:1,top:-3,advance:Z?X[1]:X[0],localGlyph:!1},W=g?-q.height*V:R*Rl-17-X[1]*V,H=q.advance;var Q=(Z?X[0]:X[1])*V-Rl*R;Q>0&&Q>D&&(D=Q)}else{var J=r[F.fontStack];if(!J)continue;J[U]&&(G=J[U]);var $=t[F.fontStack];if(!$)continue;var ee=$.glyphs[U];if(!ee)continue;if(q=ee.metrics,H=8203!==U?Rl:0,g){var te=void 0!==$.ascender?Math.abs($.ascender):0,re=void 0!==$.descender?Math.abs($.descender):0,ne=(te+re)*V;B<ne&&(B=ne,N=(te-re)/2*V),W=-te*V}else W=(R-V)*Rl-17}Z?(e.verticalizable=!0,O.push({glyph:U,imageName:K,x:p,y:y+W,vertical:Z,scale:V,localGlyph:q.localGlyph,fontStack:F.fontStack,sectionIndex:j,metrics:q,rect:G}),p+=H*V+l):(O.push({glyph:U,imageName:K,x:p,y:y+W,vertical:Z,scale:V,localGlyph:q.localGlyph,fontStack:F.fontStack,sectionIndex:j,metrics:q,rect:G}),p+=q.advance*V+l)}0!==O.length&&(v=Math.max(p-l,v),g?Ac(O,m,D,N,a*R/2):Ac(O,m,D,0,a/2)),p=0;var ie=a*R+D;P.lineOffset=Math.max(D,M),y+=ie,++A}else y+=a,++A}}catch(L){C.e(L)}finally{C.f()}var ae=y,oe=Tc(o),se=oe.horizontalAlign,ue=oe.verticalAlign;(function(e,t,r,n,i,a){var o,s=(t-r)*i,u=-a*n,l=f(e);try{for(l.s();!(o=l.n()).done;){var c,h=o.value,d=f(h.positionedGlyphs);try{for(d.s();!(c=d.n()).done;){var p=c.value;p.x+=s,p.y+=u}}catch(L){d.e(L)}finally{d.f()}}}catch(L){l.e(L)}finally{l.f()}})(e.positionedLines,m,se,ue,v,ae),e.top+=-ue*ae,e.bottom=e.top+ae,e.left+=-se*v,e.right=e.left+v,e.hasBaseline=g}(O,t,r,n,m,o,s,u,h,l,d,v),!function(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;)if(0!==t.value.positionedGlyphs.length)return!1}catch(L){r.e(L)}finally{r.f()}return!0}(P)&&O}var gc={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_c={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bc(e,t,r,n,i,a){if(t.imageName){var o=n[t.imageName];return o?o.displaySize[0]*t.scale*Rl/a+i:0}var s=r[t.fontStack],u=s&&s.glyphs[e];return u?u.metrics.advance*t.scale+i:0}function wc(e,t,r,n){var i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function xc(e,t,r){var n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function kc(e,t,r,n,i,a){var o,s=null,u=wc(t,r,i,a),l=f(n);try{for(l.s();!(o=l.n()).done;){var c=o.value,h=wc(t-c.x,r,i,a)+c.badness;h<=u&&(s=c,u=h)}}catch(d){l.e(d)}finally{l.f()}return{index:e,x:t,priorBreak:s,badness:u}}function Ec(e){return e?Ec(e.priorBreak).concat(e.index):[]}function Sc(e,t,r,n,i,a,o){if("point"!==a)return[];if(!e)return[];for(var s,u=[],l=function(e,t,r,n,i,a){for(var o=0,s=0;s<e.length();s++){var u=e.getSection(s);o+=bc(e.getCharCode(s),u,n,i,t,a)}return o/Math.max(1,Math.ceil(o/r))}(e,t,r,n,i,o),c=e.text.indexOf("\u200b")>=0,h=0,f=0;f<e.length();f++){var d=e.getSection(f),p=e.getCharCode(f);if(gc[p]||(h+=bc(p,d,n,i,t,o)),f<e.length()-1){var y=!((s=p)<11904||!(Ni(s)||Bi(s)||Xi(s)||Wi(s)||Ui(s)||Ri(s)||zi(s)||Oi(s)||Vi(s)||qi(s)||ji(s)||$i(s)||Li(s)||Pi(s)||Mi(s)||Fi(s)||Di(s)||Yi(s)||Ki(s)||Gi(s)));(_c[p]||y||d.imageName)&&u.push(kc(f+1,h,l,u,xc(p,e.getCharCode(f+1),y&&c),!1))}}return Ec(kc(e.length(),h,l,u,0,!0))}function Tc(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ac(e,t,r,n,i){if(t||r||n||i)for(var a=e.length-1,o=e[a],s=(o.x+o.metrics.advance*o.scale)*t,u=0;u<=a;u++)e[u].x-=s,e[u].y+=r+n+i}function Cc(e,t,r){var n=Tc(r),i=n.horizontalAlign,a=n.verticalAlign,o=t[0]-e.displaySize[0]*i,s=t[1]-e.displaySize[1]*a;return{image:e,top:s,bottom:s+e.displaySize[1],left:o,right:o+e.displaySize[0]}}function Ic(e,t,r,n,i,a){var o,s=e.image;if(s.content){var u=s.content,l=s.pixelRatio||1;o=[u[0]/l,u[1]/l,s.displaySize[0]-u[2]/l,s.displaySize[1]-u[3]/l]}var c,h,f,d,p=t.left*a,y=t.right*a;"width"===r||"both"===r?(d=i[0]+p-n[3],h=i[0]+y+n[1]):h=(d=i[0]+(p+y-s.displaySize[0])/2)+s.displaySize[0];var v=t.top*a,m=t.bottom*a;return"height"===r||"both"===r?(c=i[1]+v-n[0],f=i[1]+m+n[2]):f=(c=i[1]+(v+m-s.displaySize[1])/2)+s.displaySize[1],{image:s,top:c,right:h,bottom:f,left:d,collisionPadding:o}}var Rc=function(e){p(r,e);var t=y(r);function r(e,n,i,a){var o;return v(this,r),(o=t.call(this,e,n)).angle=i,void 0!==a&&(o.segment=a),o}return m(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.angle,this.segment)}}]),r}(g);function Mc(e,t,r,n,i){if(void 0===t.segment)return!0;for(var a=t,o=t.segment+1,s=0;s>-r/2;){if(--o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;for(var u=[],l=0;s<r/2;){var c=e[o],h=e[o+1];if(!h)return!1;var f=e[o-1].angleTo(c)-c.angleTo(h);for(f=Math.abs((f+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:f}),l+=f;s-u[0].distance>n;)l-=u.shift().angleDelta;if(l>i)return!1;o++,s+=c.dist(h)}return!0}function Pc(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function Oc(e,t,r){return e?.6*t*r:0}function Lc(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Dc(e,t,r,n,i,a){for(var o=Oc(r,i,a),s=Lc(r,n)*a,u=0,l=Pc(e)/2,c=0;c<e.length-1;c++){var h=e[c],f=e[c+1],d=h.dist(f);if(u+d>l){var p=(l-u)/d,y=vr(h.x,f.x,p),v=vr(h.y,f.y,p),m=new Rc(y,v,f.angleTo(h),c);return!o||Mc(e,m,s,o,t)?m:void 0}u+=d}}function Bc(e,t,r,n,i,a,o,s,u){var l=Oc(n,a,o),c=Lc(n,i),h=c*o,f=0===e[0].x||e[0].x===u||0===e[0].y||e[0].y===u;return t-h<t/4&&(t=h+t/4),Nc(e,f?t/2*s%t:(c/2+2*a)*o*s%t,t,l,r,h,f,!1,u)}function Nc(e,t,r,n,i,a,o,s,u){for(var l=a/2,c=Pc(e),h=0,f=t-r,d=[],p=0;p<e.length-1;p++){for(var y=e[p],v=e[p+1],m=y.dist(v),g=v.angleTo(y);f+r<h+m;){var _=((f+=r)-h)/m,b=vr(y.x,v.x,_),w=vr(y.y,v.y,_);if(b>=0&&b<u&&w>=0&&w<u&&f-l>=0&&f+l<=c){var x=new Rc(b,w,g,p);x._round(),n&&!Mc(e,x,a,n,i)||d.push(x)}}h+=m}return s||d.length||o||(d=Nc(e,h/2,r,n,i,a,o,!0,u)),d}function zc(e,t,r,n,i){for(var a=[],o=0;o<e.length;o++)for(var s=e[o],u=void 0,l=0;l<s.length-1;l++){var c=s[l],h=s[l+1];c.x<t&&h.x<t||(c.x<t?c=new g(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x<t&&(h=new g(t,c.y+(t-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y<r&&h.y<r||(c.y<r?c=new g(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round():h.y<r&&(h=new g(c.x+(r-c.y)/(h.y-c.y)*(h.x-c.x),r)._round()),c.x>=n&&h.x>=n||(c.x>=n?c=new g(n,c.y+(n-c.x)/(h.x-c.x)*(h.y-c.y))._round():h.x>=n&&(h=new g(n,c.y+(n-c.x)/(h.x-c.x)*(h.y-c.y))._round()),c.y>=i&&h.y>=i||(c.y>=i?c=new g(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round():h.y>=i&&(h=new g(c.x+(i-c.y)/(h.y-c.y)*(h.x-c.x),i)._round()),u&&c.equals(u[u.length-1])||(u=[c],a.push(u)),u.push(h)))))}return a}bi("Anchor",Rc);var Fc=Vc,jc=Vc,Uc=1e20;function Vc(e,t,r,n,i,a){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=r||8;var o=this.size=this.fontSize+2*this.buffer,s=o+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function qc(e,t,r,n,i,a){for(var o=0;o<t;o++)Gc(e,o,t,r,n,i,a);for(var s=0;s<r;s++)Gc(e,s*t,1,t,n,i,a)}function Gc(e,t,r,n,i,a,o){var s,u,l,c;for(a[0]=0,o[0]=-Uc,o[1]=Uc,s=0;s<n;s++)i[s]=e[t+s*r];for(s=1,u=0,l=0;s<n;s++){do{l=(i[s]-i[c=a[u]]+s*s-c*c)/(s-c)/2}while(l<=o[u]&&--u>-1);a[++u]=s,o[u]=l,o[u+1]=Uc}for(s=0,u=0;s<n;s++){for(;o[u+1]<s;)u++;e[t+s*r]=i[c=a[u]]+(s-c)*(s-c)}}Vc.prototype._draw=function(e,t){var r,n,i,a,o,s,u,l,c,h=this.ctx.measureText(e),f=h.width,d=2*this.buffer;t&&this.useMetrics?(o=Math.floor(h.actualBoundingBoxAscent),l=this.buffer+Math.ceil(h.actualBoundingBoxAscent),s=this.buffer,u=this.buffer,r=(n=Math.min(this.size,Math.ceil(h.actualBoundingBoxRight-h.actualBoundingBoxLeft)))+d,i=(a=Math.min(this.size-s,Math.ceil(h.actualBoundingBoxAscent+h.actualBoundingBoxDescent)))+d,this.ctx.textBaseline="alphabetic"):(r=n=this.size,i=a=this.size,o=19*this.fontSize/24,s=u=0,l=this.middle,this.ctx.textBaseline="middle"),n&&a&&(this.ctx.clearRect(u,s,n,a),this.ctx.fillText(e,this.buffer,l),c=this.ctx.getImageData(u,s,n,a));var p=new Uint8ClampedArray(r*i);return function(e,t,r,n,i,a,o){a.fill(Uc,0,t*r),o.fill(0,0,t*r);for(var s=(t-n)/2,u=0;u<i;u++)for(var l=0;l<n;l++){var c=(u+s)*t+l+s,h=e.data[4*(u*n+l)+3]/255;if(1===h)a[c]=0,o[c]=Uc;else if(0===h)a[c]=Uc,o[c]=0;else{var f=Math.max(0,.5-h),d=Math.max(0,h-.5);a[c]=f*f,o[c]=d*d}}}(c,r,i,n,a,this.gridOuter,this.gridInner),qc(this.gridOuter,r,i,this.f,this.v,this.z),qc(this.gridInner,r,i,this.f,this.v,this.z),function(e,t,r,n,i,a,o){for(var s=0;s<t*r;s++){var u=Math.sqrt(n[s])-Math.sqrt(i[s]);e[s]=Math.round(255-255*(u/a+o))}}(p,r,i,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:p,metrics:{width:n,height:a,sdfWidth:r,sdfHeight:i,top:o,left:0,advance:f}}},Vc.prototype.draw=function(e){return this._draw(e,!1).data},Vc.prototype.drawWithMetrics=function(e){return this._draw(e,!0)},Fc.default=jc;var Kc={none:0,ideographs:1,all:2},Hc=function(){function e(t,r,n){v(this,e),this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=n,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}return m(e,[{key:"setURL",value:function(e){this.url=e}},{key:"getGlyphs",value:function(t,r){var n=this,i=[];for(var a in t){var o,s=f(t[a]);try{for(s.s();!(o=s.n()).done;){var u=o.value;i.push({stack:a,id:u})}}catch(l){s.e(l)}finally{s.f()}}M(i,(function(t,r){var i=t.stack,a=t.id,o=n.entries[i];o||(o=n.entries[i]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});var s=o.glyphs[a];if(void 0===s){if(s=n._tinySDF(o,i,a))return o.glyphs[a]=s,void r(null,{stack:i,id:a,glyph:s});var u=Math.floor(a/256);if(256*u>65535)r(new Error("glyphs > 65535 not supported"));else if(o.ranges[u])r(null,{stack:i,id:a,glyph:s});else{var c=o.requests[u];c||(c=o.requests[u]=[],e.loadGlyphRange(i,u,n.url,n.requestManager,(function(e,t){if(t){for(var r in o.ascender=t.ascender,o.descender=t.descender,t.glyphs)n._doesCharSupportLocalGlyph(+r)||(o.glyphs[+r]=t.glyphs[+r]);o.ranges[u]=!0}var i,a=f(c);try{for(a.s();!(i=a.n()).done;)(0,i.value)(e,t)}catch(l){a.e(l)}finally{a.f()}delete o.requests[u]}))),c.push((function(e,t){e?r(e):t&&r(null,{stack:i,id:a,glyph:t.glyphs[a]||null})}))}}else r(null,{stack:i,id:a,glyph:s})}),(function(e,t){if(e)r(e);else if(t){var i,a={},o=f(t);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.stack,c=s.id,h=s.glyph;void 0===a[u]&&(a[u]={}),void 0===a[u].glyphs&&(a[u].glyphs={}),a[u].glyphs[c]=h&&{id:h.id,bitmap:h.bitmap.clone(),metrics:h.metrics},a[u].ascender=n.entries[u].ascender,a[u].descender=n.entries[u].descender}}catch(l){o.e(l)}finally{o.f()}r(null,a)}}))}},{key:"_doesCharSupportLocalGlyph",value:function(e){return this.localGlyphMode!==Kc.none&&(this.localGlyphMode===Kc.all?!!this.localFontFamily:!!this.localFontFamily&&(qi(e)||Hi(e)||Li(e)||Di(e))||Oi(e))}},{key:"_tinySDF",value:function(t,r,n){var i=this.localFontFamily;if(i&&this._doesCharSupportLocalGlyph(n)){var a=t.tinySDF;if(!a){var o="400";/bold/i.test(r)?o="900":/medium/i.test(r)?o="500":/light/i.test(r)&&(o="200"),a=t.tinySDF=new e.TinySDF(48,6,16,.25,i,o)}if(this.localGlyphs[a.fontWeight][n])return this.localGlyphs[a.fontWeight][n];var s=a.drawWithMetrics(String.fromCharCode(n)),u=s.data,l=s.metrics,c=l.sdfWidth,h=l.sdfHeight,f=l.width,d=l.height,p=l.left,y=l.top,v=l.advance;return this.localGlyphs[a.fontWeight][n]={id:n,bitmap:new tu({width:c,height:h},u),metrics:{width:f/2,height:d/2,left:p/2,top:y/2-27,advance:v/2,localGlyph:!0}}}}}]),e}();function Wc(e,t,r,n){var i=[],a=e.image,o=a.pixelRatio,s=a.paddedRect.w-2,u=a.paddedRect.h-2,l=e.right-e.left,c=e.bottom-e.top,h=a.stretchX||[[0,s]],f=a.stretchY||[[0,u]],d=function(e,t){return e+t[1]-t[0]},p=h.reduce(d,0),y=f.reduce(d,0),v=s-p,m=u-y,_=0,b=p,w=0,x=y,k=0,E=v,S=0,T=m;if(a.content&&n){var A=a.content;_=Zc(h,0,A[0]),w=Zc(f,0,A[1]),b=Zc(h,A[0],A[2]),x=Zc(f,A[1],A[3]),k=A[0]-_,S=A[1]-w,E=A[2]-A[0]-b,T=A[3]-A[1]-x}var C=function(n,i,s,u){var h=Xc(n.stretch-_,b,l,e.left),f=Qc(n.fixed-k,E,n.stretch,p),d=Xc(i.stretch-w,x,c,e.top),v=Qc(i.fixed-S,T,i.stretch,y),m=Xc(s.stretch-_,b,l,e.left),A=Qc(s.fixed-k,E,s.stretch,p),C=Xc(u.stretch-w,x,c,e.top),I=Qc(u.fixed-S,T,u.stretch,y),R=new g(h,d),M=new g(m,d),P=new g(m,C),O=new g(h,C),L=new g(f/o,v/o),D=new g(A/o,I/o),B=t*Math.PI/180;if(B){var N=Math.sin(B),z=Math.cos(B),F=[z,-N,N,z];R._matMult(F),M._matMult(F),O._matMult(F),P._matMult(F)}var j=n.stretch+n.fixed,U=i.stretch+i.fixed;return{tl:R,tr:M,bl:O,br:P,tex:{x:a.paddedRect.x+1+j,y:a.paddedRect.y+1+U,w:s.stretch+s.fixed-j,h:u.stretch+u.fixed-U},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:L,pixelOffsetBR:D,minFontScaleX:E/o/l,minFontScaleY:T/o/c,isSDF:r}};if(n&&(a.stretchX||a.stretchY))for(var I=Yc(h,v,p),R=Yc(f,m,y),M=0;M<I.length-1;M++)for(var P=I[M],O=I[M+1],L=0;L<R.length-1;L++)i.push(C(P,R[L],O,R[L+1]));else i.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:u+1}));return i}function Zc(e,t,r){var n,i=0,a=f(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;i+=Math.max(t,Math.min(r,o[1]))-Math.max(t,Math.min(r,o[0]))}}catch(s){a.e(s)}finally{a.f()}return i}function Yc(e,t,r){var n,i=[{fixed:-1,stretch:0}],a=f(e);try{for(a.s();!(n=a.n()).done;){var o=h(n.value,2),s=o[0],u=o[1],l=i[i.length-1];i.push({fixed:s-l.stretch,stretch:l.stretch}),i.push({fixed:s-l.stretch,stretch:l.stretch+(u-s)})}}catch(c){a.e(c)}finally{a.f()}return i.push({fixed:t+1,stretch:r}),i}function Xc(e,t,r,n){return e/t*r+n}function Qc(e,t,r,n){return e-t*r/n}function Jc(e,t,r,n){var i=t+e.positionedLines[n].lineOffset;return 0===n?r+i/2:r+(i+(t+e.positionedLines[n-1].lineOffset))/2}Hc.loadGlyphRange=function(e,t,r,n,i){var a=256*t,o=a+255,s=n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}","".concat(a,"-").concat(o)),De.Glyphs);Fe(s,(function(e,t){if(e)i(e);else if(t){var r,n={},a=function(e){return new Vl(e).readFields(uc,{})}(t),o=f(a.glyphs);try{for(o.s();!(r=o.n()).done;){var s=r.value;n[s.id]=s}}catch(u){o.e(u)}finally{o.f()}i(null,{glyphs:n,ascender:a.ascender,descender:a.descender})}}))},Hc.TinySDF=Fc;var $c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eh;if(v(this,e),this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}return m(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n}},{key:"_down",value:function(e){for(var t=this.data,r=this.compare,n=this.length>>1,i=t[e];e<n;){var a=1+(e<<1),o=t[a],s=a+1;if(s<this.length&&r(t[s],o)<0&&(a=s,o=t[s]),r(o,i)>=0)break;t[e]=o,e=a}t[e]=i}}]),e}();function eh(e,t){return e<t?-1:e>t?1:0}function th(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=1/0,i=1/0,a=-1/0,o=-1/0,s=e[0],u=0;u<s.length;u++){var l=s[u];(!u||l.x<n)&&(n=l.x),(!u||l.y<i)&&(i=l.y),(!u||l.x>a)&&(a=l.x),(!u||l.y>o)&&(o=l.y)}var c=Math.min(a-n,o-i),h=c/2,f=new $c([],rh);if(0===c)return new g(n,i);for(var d=n;d<a;d+=c)for(var p=i;p<o;p+=c)f.push(new nh(d+h,p+h,h,e));for(var y=function(e){for(var t=0,r=0,n=0,i=e[0],a=0,o=i.length,s=o-1;a<o;s=a++){var u=i[a],l=i[s],c=u.x*l.y-l.x*u.y;r+=(u.x+l.x)*c,n+=(u.y+l.y)*c,t+=3*c}return new nh(r/t,n/t,0,e)}(e),v=f.length;f.length;){var m=f.pop();(m.d>y.d||!y.d)&&(y=m,r&&console.log("found best %d after %d probes",Math.round(1e4*m.d)/1e4,v)),m.max-y.d<=t||(h=m.h/2,f.push(new nh(m.p.x-h,m.p.y-h,h,e)),f.push(new nh(m.p.x+h,m.p.y-h,h,e)),f.push(new nh(m.p.x-h,m.p.y+h,h,e)),f.push(new nh(m.p.x+h,m.p.y+h,h,e)),v+=4)}return r&&(console.log("num probes: ".concat(v)),console.log("best distance: ".concat(y.d))),y.p}function rh(e,t){return t.max-e.max}function nh(e,t,r,n){this.p=new g(e,t),this.h=r,this.d=function(e,t){for(var r=!1,n=1/0,i=0;i<t.length;i++)for(var a=t[i],o=0,s=a.length,u=s-1;o<s;u=o++){var l=a[o],c=a[u];l.y>e.y!=c.y>e.y&&e.x<(c.x-l.x)*(e.y-l.y)/(c.y-l.y)+l.x&&(r=!r),n=Math.min(n,ys(e,l,c))}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}var ih=Number.POSITIVE_INFINITY,ah=Math.sqrt(2);function oh(e,t){return t[1]!==ih?function(e,t,r){var n=0,i=0;switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}return[n,i]}(e,t[0],t[1]):function(e,t){var r=0,n=0;t<0&&(t=0);var i=t/ah;switch(e){case"top-right":case"top-left":n=i-7;break;case"bottom-right":case"bottom-left":n=7-i;break;case"bottom":n=7-t;break;case"top":n=t-7}switch(e){case"top-right":case"bottom-right":r=-i;break;case"top-left":case"bottom-left":r=i;break;case"left":r=t;break;case"right":r=-t}return[r,n]}(e,t[0])}function sh(e,t,r,n,i,a,o,s){e.createArrays(),e.tilePixelRatio=ts/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var u=e.layers[0].layout,l=e.layers[0]._unevaluatedLayout._values,c={};if("composite"===e.textSizeData.kind){var h=e.textSizeData,d=h.minZoom,p=h.maxZoom;c.compositeTextSizes=[l["text-size"].possiblyEvaluate(new ba(d),o),l["text-size"].possiblyEvaluate(new ba(p),o)]}if("composite"===e.iconSizeData.kind){var y=e.iconSizeData,v=y.minZoom,m=y.maxZoom;c.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new ba(v),o),l["icon-size"].possiblyEvaluate(new ba(m),o)]}c.layoutTextSize=l["text-size"].possiblyEvaluate(new ba(s+1),o),c.layoutIconSize=l["icon-size"].possiblyEvaluate(new ba(s+1),o),c.textMaxSize=l["text-size"].possiblyEvaluate(new ba(18),o);var g,_="map"===u.get("text-rotation-alignment")&&"point"!==u.get("symbol-placement"),b=u.get("text-size"),w=f(e.features);try{var x=function(){var a=g.value,s=u.get("text-font").evaluate(a,{},o).join(","),l=b.evaluate(a,{},o),h=c.layoutTextSize.evaluate(a,{},o),f=(c.layoutIconSize.evaluate(a,{},o),{horizontal:{},vertical:void 0}),d=a.text,p=void 0,y=[0,0];if(d){var v=d.toString(),m=u.get("text-letter-spacing").evaluate(a,{},o)*Rl,w=u.get("text-line-height").evaluate(a,{},o)*Rl,x=ta(v)?m:0,k=u.get("text-anchor").evaluate(a,{},o),E=u.get("text-variable-anchor");if(!E){var S=u.get("text-radial-offset").evaluate(a,{},o);y=S?oh(k,[S*Rl,ih]):u.get("text-offset").evaluate(a,{},o).map((function(e){return e*Rl}))}var T=_?"center":u.get("text-justify").evaluate(a,{},o),A=u.get("symbol-placement"),C="point"===A,I="point"===A?u.get("text-max-width").evaluate(a,{},o)*Rl:0,R=function(n){e.allowVerticalPlacement&&ea(v)&&(f.vertical=mc(d,t,r,i,s,I,w,k,n,x,y,pc.vertical,!0,A,h,l))};if(!_&&E){for(var M="auto"===T?E.map((function(e){return uh(e)})):[T],P=!1,O=0;O<M.length;O++){var L=M[O];if(!f.horizontal[L])if(P)f.horizontal[L]=f.horizontal[0];else{var D=mc(d,t,r,i,s,I,w,"center",L,x,y,pc.horizontal,!1,A,h,l);D&&(f.horizontal[L]=D,P=1===D.positionedLines.length)}}R("left")}else{if("auto"===T&&(T=uh(k)),C||u.get("text-writing-mode").indexOf("horizontal")>=0||!ea(v)){var B=mc(d,t,r,i,s,I,w,k,T,x,y,pc.horizontal,!1,A,h,l);B&&(f.horizontal[T]=B)}R("point"===A?"left":T)}}var N=!1;if(a.icon&&a.icon.name){var z=n[a.icon.name];z&&(p=Cc(i[a.icon.name],u.get("icon-offset").evaluate(a,{},o),u.get("icon-anchor").evaluate(a,{},o)),N=z.sdf,void 0===e.sdfIcons?e.sdfIcons=z.sdf:e.sdfIcons!==z.sdf&&K("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(z.pixelRatio!==e.pixelRatio||0!==u.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var F=fh(f.horizontal)||f.vertical;e.iconsInText||(e.iconsInText=!!F&&F.iconsInText),(F||p)&&lh(e,a,f,p,n,c,h,0,y,N,o)};for(w.s();!(g=w.n()).done;)x()}catch(k){w.e(k)}finally{w.f()}a&&e.generateCollisionDebugBuffers(s,e.collisionBoxArray)}function uh(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lh(e,t,r,n,i,a,o,s,u,l,c){var d=a.textMaxSize.evaluate(t,{},c);void 0===d&&(d=o);var p,y=e.layers[0].layout,v=y.get("icon-offset").evaluate(t,{},c),m=fh(r.horizontal)||r.vertical,g=o/24,_=e.tilePixelRatio*d/24,b=e.tilePixelRatio*y.get("symbol-spacing"),w=y.get("text-padding")*e.tilePixelRatio,x=y.get("icon-padding")*e.tilePixelRatio,k=E(y.get("text-max-angle")),S="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement"),T="map"===y.get("icon-rotation-alignment")&&"point"!==y.get("symbol-placement"),A=y.get("symbol-placement"),C=b/2,I=y.get("icon-text-fit");n&&"none"!==I&&(e.allowVerticalPlacement&&r.vertical&&(p=Ic(n,r.vertical,I,y.get("icon-text-fit-padding"),v,g)),m&&(n=Ic(n,m,I,y.get("icon-text-fit-padding"),v,g)));var R=function(s,f){f.x<0||f.x>=ts||f.y<0||f.y>=ts||function(e,t,r,n,i,a,o,s,u,l,c,f,d,p,y,v,m,g,_,b,w,x,k,E){var S,T,A,C,I,R,M,P,O,L=e.addToLineVertexArray(t,r),D=0,B=0,N=0,z=0,F=-1,j=-1,U={},V=To(""),q=0,G=0;if(void 0===s._unevaluatedLayout.getValue("text-radial-offset")?(S=s.layout.get("text-offset").evaluate(b,{},k).map((function(e){return e*Rl})),q=(T=h(S,2))[0],G=T[1]):(q=s.layout.get("text-radial-offset").evaluate(b,{},k)*Rl,G=ih),e.allowVerticalPlacement&&n.vertical){var H=n.vertical;if(p)P=ph(H),o&&(O=ph(o));else{var W=s.layout.get("text-rotate").evaluate(b,{},k)+90;I=dh(u,t,l,c,f,H,d,W,y),o&&(R=dh(u,t,l,c,f,o,m,W))}}if(i){var Z=s.layout.get("icon-rotate").evaluate(b,{},k),Y="none"!==s.layout.get("icon-text-fit"),X=Wc(i,Z,x,Y),Q=o?Wc(o,Z,x,Y):void 0;C=dh(u,t,l,c,f,i,m,Z),D=4*X.length;var J=e.iconSizeData,$=null;"source"===J.kind?($=[Ml*s.layout.get("icon-size").evaluate(b,{},k)])[0]>ch&&K("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')):"composite"===J.kind&&(($=[Ml*w.compositeIconSizes[0].evaluate(b,{},k),Ml*w.compositeIconSizes[1].evaluate(b,{},k)])[0]>ch||$[1]>ch)&&K("".concat(e.layerIds[0],': Value for "icon-size" is >= 255. Reduce your "icon-size".')),e.addSymbols(e.icon,X,$,_,g,b,!1,t,L.lineStartIndex,L.lineLength,-1,k),F=e.icon.placedSymbolArray.length-1,Q&&(B=4*Q.length,e.addSymbols(e.icon,Q,$,_,g,b,pc.vertical,t,L.lineStartIndex,L.lineLength,-1,k),j=e.icon.placedSymbolArray.length-1)}for(var ee in n.horizontal){var te=n.horizontal[ee];A||(V=To(te.text),p?M=ph(te):A=dh(u,t,l,c,f,te,d,s.layout.get("text-rotate").evaluate(b,{},k),y));var re=1===te.positionedLines.length;if(N+=hh(e,t,te,a,s,p,b,y,L,n.vertical?pc.horizontal:pc.horizontalOnly,re?Object.keys(n.horizontal):[ee],U,F,w,k),re)break}n.vertical&&(z+=hh(e,t,n.vertical,a,s,p,b,y,L,pc.vertical,["vertical"],U,j,w,k));var ne=-1,ie=function(e,t){return e?Math.max(e,t):t};ne=ie(M,ne),ne=ie(P,ne);var ae=(ne=ie(O,ne))>-1?1:0;ae&&(ne*=E/Rl),e.glyphOffsetArray.length>=kh.MAX_GLYPHS&&K("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey),e.symbolInstances.emplaceBack(t.x,t.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical>=0?U.vertical:-1,F,j,V,void 0!==A?A:e.collisionBoxArray.length,void 0!==A?A+1:e.collisionBoxArray.length,void 0!==I?I:e.collisionBoxArray.length,void 0!==I?I+1:e.collisionBoxArray.length,void 0!==C?C:e.collisionBoxArray.length,void 0!==C?C+1:e.collisionBoxArray.length,R||e.collisionBoxArray.length,R?R+1:e.collisionBoxArray.length,l,N,z,D,B,ae,0,q,G,ne)}(e,f,s,r,n,i,p,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,w,S,u,0,x,T,v,t,a,l,c,o)};if("line"===A){var M,P=f(zc(t.geometry,0,0,ts,ts));try{for(P.s();!(M=P.n()).done;){var O,L=M.value,D=Bc(L,b,k,r.vertical||m,n,24,_,e.overscaling,ts),B=f(D);try{for(B.s();!(O=B.n()).done;){var N=O.value;m&&yh(e,m.text,C,N)||R(L,N)}}catch(re){B.e(re)}finally{B.f()}}}catch(re){P.e(re)}finally{P.f()}}else if("line-center"===A){var z,F=f(t.geometry);try{for(F.s();!(z=F.n()).done;){var j=z.value;if(j.length>1){var U=Dc(j,k,r.vertical||m,n,24,_);U&&R(j,U)}}}catch(re){F.e(re)}finally{F.f()}}else if("Polygon"===t.type){var V,q=f(Fu(t.geometry,0));try{for(q.s();!(V=q.n()).done;){var G=V.value,H=th(G,16);R(G[0],new Rc(H.x,H.y,0))}}catch(re){q.e(re)}finally{q.f()}}else if("LineString"===t.type){var W,Z=f(t.geometry);try{for(Z.s();!(W=Z.n()).done;){var Y=W.value;R(Y,new Rc(Y[0].x,Y[0].y,0))}}catch(re){Z.e(re)}finally{Z.f()}}else if("Point"===t.type){var X,Q=f(t.geometry);try{for(Q.s();!(X=Q.n()).done;){var J,$=X.value,ee=f($);try{for(ee.s();!(J=ee.n()).done;){var te=J.value;R([te],new Rc(te.x,te.y,0))}}catch(re){ee.e(re)}finally{ee.f()}}}catch(re){Q.e(re)}finally{Q.f()}}}var ch=32640;function hh(e,t,r,n,i,o,s,u,l,h,d,p,y,v,m){var _=function(e,t,r,n,i,o,s,u){var l=[];if(0===t.positionedLines.length)return l;var h,d=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,p=function(e){var t=e[0],r=e[1],n=t*r;return n>0?[t,-r]:n<0?[-t,r]:0===t?[r,t]:[r,-t]}(r),y=Math.abs(t.top-t.bottom),v=f(t.positionedLines);try{for(v.s();!(h=v.n()).done;)y-=h.value.lineOffset}catch(ae){v.e(ae)}finally{v.f()}for(var m=t.positionedLines.length,_=y/m,b=t.top-r[1],w=0;w<m;++w){var x=t.positionedLines[w];b=Jc(t,_,b,w);var k,E=f(x.positionedGlyphs);try{for(E.s();!(k=E.n()).done;){var S=k.value;if(S.rect){var T=S.rect||{},A=4,C=!0,I=1,R=0,M=(i||u)&&S.vertical,P=S.metrics.advance*S.scale/2,O=S.metrics,L=S.rect;if(null!==L){if(u&&t.verticalizable&&(R=S.imageName?P-S.metrics.width*S.scale/2:0),S.imageName){var D=s[S.imageName];if(!D)continue;C=D.sdf,A=1/(I=D.pixelRatio)}var B=i?[S.x+P,S.y]:[0,0],N=[0,0],z=[0,0],F=!1;i||(M?(z=[S.x+P+p[0],S.y+p[1]-R],F=!0):N=[S.x+P+r[0],S.y+r[1]-R]);var j=L.w*S.scale/(I*(S.localGlyph?2:1)),U=L.h*S.scale/(I*(S.localGlyph?2:1)),V=void 0,q=void 0,G=void 0,K=void 0;if(M){var H=S.y-b,W=new g(-P,P-H),Z=-Math.PI/2,Y=a(g,c(z));(V=new g(-P+N[0],N[1]))._rotateAround(Z,W)._add(Y),V.x+=-H+P,V.y-=(O.left-A)*S.scale;var X=S.imageName?O.advance*S.scale:Rl*S.scale,Q=String.fromCharCode(S.glyph);zl(Q)?V.x+=(1-A)*S.scale:Fl(Q)?V.x+=X-O.height*S.scale+(-A-1)*S.scale:V.x+=S.imageName||O.width+2*A===L.w&&O.height+2*A===L.h?(X-U)/2:(X-(O.height+2*A)*S.scale)/2,q=new g(V.x,V.y-j),G=new g(V.x+U,V.y),K=new g(V.x+U,V.y-j)}else{var J=(O.left-A)*S.scale-P+N[0],$=(-O.top-A)*S.scale+N[1],ee=J+j,te=$+U;V=new g(J,$),q=new g(ee,$),G=new g(J,te),K=new g(ee,te)}if(d){var re=void 0;re=i?new g(0,0):F?new g(p[0],p[1]):new g(r[0],r[1]),V._rotateAround(d,re),q._rotateAround(d,re),G._rotateAround(d,re),K._rotateAround(d,re)}var ne=new g(0,0),ie=new g(0,0);l.push({tl:V,tr:q,bl:G,br:K,tex:T,writingMode:t.writingMode,glyphOffset:B,sectionIndex:S.sectionIndex,isSDF:C,pixelOffsetTL:ne,pixelOffsetBR:ie,minFontScaleX:0,minFontScaleY:0})}}}}catch(ae){E.e(ae)}finally{E.f()}}return l}(0,r,u,i,o,s,n,e.allowVerticalPlacement),b=e.textSizeData,w=null;"source"===b.kind?(w=[Ml*i.layout.get("text-size").evaluate(s,{},m)])[0]>ch&&K("".concat(e.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')):"composite"===b.kind&&((w=[Ml*v.compositeTextSizes[0].evaluate(s,{},m),Ml*v.compositeTextSizes[1].evaluate(s,{},m)])[0]>ch||w[1]>ch)&&K("".concat(e.layerIds[0],': Value for "text-size" is >= 255. Reduce your "text-size".')),e.addSymbols(e.text,_,w,u,o,s,h,t,l.lineStartIndex,l.lineLength,y,m);var x,k=f(d);try{for(k.s();!(x=k.n()).done;)p[x.value]=e.text.placedSymbolArray.length-1}catch(E){k.e(E)}finally{k.f()}return 4*_.length}function fh(e){for(var t in e)return e[t];return null}function dh(e,t,r,n,i,a,o,s,u){var l=a.top,c=a.bottom,h=a.left,f=a.right,d=a.collisionPadding;if(d&&(h-=d[0],l-=d[1],f+=d[2],c+=d[3]),s){var p=new g(h,l),y=new g(f,l),v=new g(h,c),m=new g(f,c),_=E(s),b=new g(0,0);u&&(b=new g(u[0],u[1])),p._rotateAround(_,b),y._rotateAround(_,b),v._rotateAround(_,b),m._rotateAround(_,b),h=Math.min(p.x,y.x,v.x,m.x),f=Math.max(p.x,y.x,v.x,m.x),l=Math.min(p.y,y.y,v.y,m.y),c=Math.max(p.y,y.y,v.y,m.y)}return e.emplaceBack(t.x,t.y,h,l,f,c,o,r,n,i),e.length-1}function ph(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);var t=e.bottom-e.top;return t>0?Math.max(10,t):null}function yh(e,t,r,n){var i=e.compareText;if(t in i){for(var a=i[t],o=a.length-1;o>=0;o--)if(n.dist(a[o])<r)return!0}else i[t]=[];return i[t].push(n),!1}var vh=nl.VectorTileFeature.types,mh=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function gh(e,t,r,n,i,a,o,s,u,l,c,h,f){var d=s?Math.min(ch,Math.round(s[0])):0,p=s?Math.min(ch,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),a,o,(d<<1)+(u?1:0),p,16*l,16*c,256*h,256*f)}function _h(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function bh(e){var t,r=f(e.sections);try{for(r.s();!(t=r.n()).done;)if(sa(t.value.text))return!0}catch(n){r.e(n)}finally{r.f()}return!1}var wh=function(){function e(t){v(this,e),this.layoutVertexArray=new Wa,this.indexArray=new eo,this.programConfigurations=t,this.segments=new es,this.dynamicLayoutVertexArray=new Za,this.opacityVertexArray=new Ya,this.placedSymbolArray=new fo}return m(e,[{key:"isEmpty",value:function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}},{key:"upload",value:function(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,El.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Sl.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,mh,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}]),e}();bi("SymbolBuffers",wh);var xh=function(){function e(t,r,n){v(this,e),this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new n,this.segments=new es,this.collisionVertexArray=new $a,this.collisionVertexArrayExt=new Za}return m(e,[{key:"upload",value:function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Tl.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Al.members,!0)}},{key:"destroy",value:function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}]),e}();bi("CollisionBuffers",xh);var kh=function(){function e(t){v(this,e),this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((function(e){return e.id})),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cs([]),this.placementViewportMatrix=Cs([]);var r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Pl(this.zoom,r["text-size"]),this.iconSizeData=Pl(this.zoom,r["icon-size"]);var n=this.layers[0].layout,i=n.get("symbol-sort-key"),a=n.get("symbol-z-order");this.canOverlap=n.get("text-allow-overlap")||n.get("icon-allow-overlap")||n.get("text-ignore-placement")||n.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&void 0!==i.constantOr(1),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=n.get("text-writing-mode").map((function(e){return pc[e]})),this.stateDependentLayerIds=this.layers.filter((function(e){return e.isStateDependent()})).map((function(e){return e.id})),this.sourceID=t.sourceID}return m(e,[{key:"createArrays",value:function(){this.text=new wh(new Ko(this.layers,this.zoom,(function(e){return/^text/.test(e)}))),this.icon=new wh(new Ko(this.layers,this.zoom,(function(e){return/^icon/.test(e)}))),this.glyphOffsetArray=new vo,this.lineVertexArray=new mo,this.symbolInstances=new yo}},{key:"calculateGlyphDependencies",value:function(e,t,r,n,i){for(var a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,n&&i){var o=Nl[e.charAt(a)];o&&(t[o.charCodeAt(0)]=!0)}}},{key:"populate",value:function(e,t,r){var n=this.layers[0],i=n.layout,a=i.get("text-font"),o=i.get("text-field"),s=i.get("icon-image"),u=("constant"!==o.value.kind||o.value.value instanceof At&&!o.value.value.isEmpty()||o.value.value.toString().length>0)&&("constant"!==a.value.kind||a.value.value.length>0),l="constant"!==s.value.kind||!!s.value.value||Object.keys(s.parameters).length>0,c=i.get("symbol-sort-key");if(this.features=[],u||l){var h,d=t.iconDependencies,p=t.glyphDependencies,y=t.availableImages,v=new ba(this.zoom),m=f(e);try{for(m.s();!(h=m.n()).done;){var g=h.value,_=g.feature,b=g.id,w=g.index,x=g.sourceLayerIndex,k=n._featureFilter.needGeometry,E=as(_,k);if(n._featureFilter.filter(v,E,r)){var S=void 0,T=void 0;if(k||(E.geometry=is(_)),u){var A=n.getValueAndResolveTokens("text-field",E,r,y),C=At.factory(A);bh(C)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ma()||this.hasRTLText&&_a.isParsed())&&(S=Bl(C,n,E))}if(l){var I=n.getValueAndResolveTokens("icon-image",E,r,y);T=I instanceof Ct?I:Ct.fromString(I)}if(S||T){var R=this.sortFeaturesByKey?c.evaluate(E,{},r):void 0;if(this.features.push({id:b,text:S,icon:T,index:w,sourceLayerIndex:x,geometry:E.geometry,properties:_.properties,type:vh[_.type],sortKey:R}),T&&(d[T.name]=!0),S){var M=a.evaluate(E,{},r).join(","),P="map"===i.get("text-rotation-alignment")&&"point"!==i.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(pc.vertical)>=0;var O,L=f(S.sections);try{for(L.s();!(O=L.n()).done;){var D=O.value;if(D.image)d[D.image.name]=!0;else{var B=ea(S.toString()),N=D.fontStack||M,z=p[N]=p[N]||{};this.calculateGlyphDependencies(D.text,z,P,this.allowVerticalPlacement,B)}}}catch(F){L.e(F)}finally{L.f()}}}}}}catch(F){m.e(F)}finally{m.f()}"line"===i.get("symbol-placement")&&(this.features=function(e){var t={},r={},n=[],i=0;function a(t){n.push(e[t]),i++}function o(e,t,i){var a=r[e];return delete r[e],r[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(i[0]),a}function s(e,r,i){var a=t[r];return delete t[r],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=i[0].concat(n[a].geometry[0]),a}function u(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(n.x,":").concat(n.y)}for(var l=0;l<e.length;l++){var c=e[l],h=c.geometry,f=c.text?c.text.toString():null;if(f){var d=u(f,h),p=u(f,h,!0);if(d in r&&p in t&&r[d]!==t[p]){var y=s(d,p,h),v=o(d,p,n[y].geometry);delete t[d],delete r[p],r[u(f,n[v].geometry,!0)]=v,n[y].geometry=null}else d in r?o(d,p,h):p in t?s(d,p,h):(a(l),t[d]=i-1,r[p]=i-1)}else a(l)}return n.filter((function(e){return e.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(e,t){return e.sortKey-t.sortKey}))}}},{key:"update",value:function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}},{key:"isEmpty",value:function(){return 0===this.symbolInstances.length&&!this.hasRTLText}},{key:"uploadPending",value:function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}},{key:"upload",value:function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}},{key:"destroyDebugData",value:function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}},{key:"destroy",value:function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}},{key:"addToLineVertexArray",value:function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var n=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),a={},o=e.segment+1;o<t.length;o++)a[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:n},o<t.length-1&&(n+=t[o+1].dist(t[o]));for(var s=e.segment||0;s>=0;s--)a[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=t[s-1].dist(t[s]));for(var u=0;u<t.length;u++){var l=a[u];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}},{key:"addSymbols",value:function(e,t,r,n,i,a,o,s,u,l,c,h){for(var f=e.indexArray,d=e.layoutVertexArray,p=e.segments.prepareSegment(4*t.length,d,f,this.canOverlap?a.sortKey:void 0),y=this.glyphOffsetArray.length,v=p.vertexLength,m=this.allowVerticalPlacement&&o===pc.vertical?Math.PI/2:0,g=a.text&&a.text.sections,_=0;_<t.length;_++){var b=t[_],w=b.tl,x=b.tr,k=b.bl,E=b.br,S=b.tex,T=b.pixelOffsetTL,A=b.pixelOffsetBR,C=b.minFontScaleX,I=b.minFontScaleY,R=b.glyphOffset,M=b.isSDF,P=b.sectionIndex,O=p.vertexLength,L=R[1];gh(d,s.x,s.y,w.x,L+w.y,S.x,S.y,r,M,T.x,T.y,C,I),gh(d,s.x,s.y,x.x,L+x.y,S.x+S.w,S.y,r,M,A.x,T.y,C,I),gh(d,s.x,s.y,k.x,L+k.y,S.x,S.y+S.h,r,M,T.x,A.y,C,I),gh(d,s.x,s.y,E.x,L+E.y,S.x+S.w,S.y+S.h,r,M,A.x,A.y,C,I),_h(e.dynamicLayoutVertexArray,s,m),f.emplaceBack(O,O+1,O+2),f.emplaceBack(O+1,O+2,O+3),p.vertexLength+=4,p.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(R[0]),_!==t.length-1&&P===t[_+1].sectionIndex||e.programConfigurations.populatePaintArrays(d.length,a,a.index,{},h,g&&g[P])}e.placedSymbolArray.emplaceBack(s.x,s.y,y,this.glyphOffsetArray.length-y,v,u,l,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,0,!1,0,c,0)}},{key:"_commitLayoutVertex",value:function(e,t,r,n,i){e.emplaceBack(t.x,t.y,r,n,Math.round(i.x),Math.round(i.y))}},{key:"_addCollisionDebugVertices",value:function(e,t,r,n,i){for(var a=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),o=a.vertexLength,s=i.anchorX,u=i.anchorY,l=0;l<4;l++)r.collisionVertexArray.emplaceBack(0,0,0,0);r.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),r.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(r.layoutVertexArray,n,s,u,new g(e.x1,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,s,u,new g(e.x2,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,s,u,new g(e.x2,e.y2)),this._commitLayoutVertex(r.layoutVertexArray,n,s,u,new g(e.x1,e.y2)),a.vertexLength+=4;var c=r.indexArray;c.emplaceBack(o,o+1),c.emplaceBack(o+1,o+2),c.emplaceBack(o+2,o+3),c.emplaceBack(o+3,o),a.primitiveLength+=4}},{key:"_addTextDebugCollisionBoxes",value:function(e,t,r,n,i,a){for(var o=n;o<i;o++){var s=r.get(o),u=this.getSymbolInstanceTextSize(e,a,t,o);this._addCollisionDebugVertices(s,u,this.textCollisionBox,s.anchorPoint,a)}}},{key:"_addIconDebugCollisionBoxes",value:function(e,t,r,n,i,a){for(var o=n;o<i;o++){var s=r.get(o),u=this.getSymbolInstanceIconSize(e,t,o);this._addCollisionDebugVertices(s,u,this.iconCollisionBox,s.anchorPoint,a)}}},{key:"generateCollisionDebugBuffers",value:function(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xh(Qa,Cl.members,oo),this.iconCollisionBox=new xh(Qa,Cl.members,oo);for(var r=Ll(this.iconSizeData,e),n=Ll(this.textSizeData,e),i=0;i<this.symbolInstances.length;i++){var a=this.symbolInstances.get(i);this._addTextDebugCollisionBoxes(n,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._addTextDebugCollisionBoxes(n,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._addIconDebugCollisionBoxes(r,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex,a),this._addIconDebugCollisionBoxes(r,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a)}}},{key:"getSymbolInstanceTextSize",value:function(e,t,r,n){var i=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n),a=Ol(this.textSizeData,e,i)/Rl;return this.tilePixelRatio*a}},{key:"getSymbolInstanceIconSize",value:function(e,t,r){var n=this.icon.placedSymbolArray.get(r),i=Ol(this.iconSizeData,e,n);return this.tilePixelRatio*i}},{key:"_commitDebugCollisionVertexUpdate",value:function(e,t,r){e.emplaceBack(t,-r,-r),e.emplaceBack(t,r,-r),e.emplaceBack(t,r,r),e.emplaceBack(t,-r,r)}},{key:"_updateTextDebugCollisionBoxes",value:function(e,t,r,n,i,a){for(var o=n;o<i;o++){var s=r.get(o),u=this.getSymbolInstanceTextSize(e,a,t,o);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,u,s.padding)}}},{key:"_updateIconDebugCollisionBoxes",value:function(e,t,r,n,i){for(var a=n;a<i;a++){var o=r.get(a),s=this.getSymbolInstanceIconSize(e,t,a);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,s,o.padding)}}},{key:"updateCollisionDebugBuffers",value:function(e,t){if(this.hasDebugData()){this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();for(var r=Ll(this.iconSizeData,e),n=Ll(this.textSizeData,e),i=0;i<this.symbolInstances.length;i++){var a=this.symbolInstances.get(i);this._updateTextDebugCollisionBoxes(n,e,t,a.textBoxStartIndex,a.textBoxEndIndex,a),this._updateTextDebugCollisionBoxes(n,e,t,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a),this._updateIconDebugCollisionBoxes(r,e,t,a.iconBoxStartIndex,a.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(r,e,t,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}}},{key:"_deserializeCollisionBoxesForSymbol",value:function(e,t,r,n,i,a,o,s,u){for(var l={},c=t;c<r;c++){var h=e.get(c);l.textBox={x1:h.x1,y1:h.y1,x2:h.x2,y2:h.y2,padding:h.padding,anchorPointX:h.anchorPointX,anchorPointY:h.anchorPointY},l.textFeatureIndex=h.featureIndex;break}for(var f=n;f<i;f++){var d=e.get(f);l.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,padding:d.padding,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},l.verticalTextFeatureIndex=d.featureIndex;break}for(var p=a;p<o;p++){var y=e.get(p);l.iconBox={x1:y.x1,y1:y.y1,x2:y.x2,y2:y.y2,padding:y.padding,anchorPointX:y.anchorPointX,anchorPointY:y.anchorPointY},l.iconFeatureIndex=y.featureIndex;break}for(var v=s;v<u;v++){var m=e.get(v);l.verticalIconBox={x1:m.x1,y1:m.y1,x2:m.x2,y2:m.y2,padding:m.padding,anchorPointX:m.anchorPointX,anchorPointY:m.anchorPointY},l.verticalIconFeatureIndex=m.featureIndex;break}return l}},{key:"deserializeCollisionBoxes",value:function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}},{key:"hasTextData",value:function(){return this.text.segments.get().length>0}},{key:"hasIconData",value:function(){return this.icon.segments.get().length>0}},{key:"hasDebugData",value:function(){return this.textCollisionBox&&this.iconCollisionBox}},{key:"hasTextCollisionBoxData",value:function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}},{key:"hasIconCollisionBoxData",value:function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}},{key:"addIndicesForPlacedSymbol",value:function(e,t){for(var r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs,i=r.vertexStartIndex;i<n;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)}},{key:"getSortedSymbolIndexes",value:function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),n=[],i=[],a=[],o=0;o<this.symbolInstances.length;++o){a.push(o);var s=this.symbolInstances.get(o);n.push(0|Math.round(t*s.anchorX+r*s.anchorY)),i.push(s.featureIndex)}return a.sort((function(e,t){return n[e]-n[t]||i[t]-i[e]})),a}},{key:"addToSortKeyRanges",value:function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}},{key:"sortFeatures",value:function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];var r,n=f(this.symbolInstanceIndexes);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(e,r,n){e>=0&&n.indexOf(e)===r&&t.addIndicesForPlacedSymbol(t.text,e)})),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}}catch(o){n.e(o)}finally{n.f()}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}]),e}();bi("SymbolBucket",kh,{omit:["layers","collisionBoxArray","features","compareText"]}),kh.MAX_GLYPHS=65535,kh.addDynamicAttributes=_h;var Eh=new La({"symbol-placement":new Ia(Je.layout_symbol["symbol-placement"]),"symbol-spacing":new Ia(Je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ia(Je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ra(Je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ia(Je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ia(Je.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ia(Je.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ia(Je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ia(Je.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ra(Je.layout_symbol["icon-size"]),"icon-text-fit":new Ia(Je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ia(Je.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ra(Je.layout_symbol["icon-image"]),"icon-rotate":new Ra(Je.layout_symbol["icon-rotate"]),"icon-padding":new Ia(Je.layout_symbol["icon-padding"]),"icon-keep-upright":new Ia(Je.layout_symbol["icon-keep-upright"]),"icon-offset":new Ra(Je.layout_symbol["icon-offset"]),"icon-anchor":new Ra(Je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ia(Je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ia(Je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ia(Je.layout_symbol["text-rotation-alignment"]),"text-field":new Ra(Je.layout_symbol["text-field"]),"text-font":new Ra(Je.layout_symbol["text-font"]),"text-size":new Ra(Je.layout_symbol["text-size"]),"text-max-width":new Ra(Je.layout_symbol["text-max-width"]),"text-line-height":new Ra(Je.layout_symbol["text-line-height"]),"text-letter-spacing":new Ra(Je.layout_symbol["text-letter-spacing"]),"text-justify":new Ra(Je.layout_symbol["text-justify"]),"text-radial-offset":new Ra(Je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ia(Je.layout_symbol["text-variable-anchor"]),"text-anchor":new Ra(Je.layout_symbol["text-anchor"]),"text-max-angle":new Ia(Je.layout_symbol["text-max-angle"]),"text-writing-mode":new Ia(Je.layout_symbol["text-writing-mode"]),"text-rotate":new Ra(Je.layout_symbol["text-rotate"]),"text-padding":new Ia(Je.layout_symbol["text-padding"]),"text-keep-upright":new Ia(Je.layout_symbol["text-keep-upright"]),"text-transform":new Ra(Je.layout_symbol["text-transform"]),"text-offset":new Ra(Je.layout_symbol["text-offset"]),"text-allow-overlap":new Ia(Je.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ia(Je.layout_symbol["text-ignore-placement"]),"text-optional":new Ia(Je.layout_symbol["text-optional"])}),Sh={paint:new La({"icon-opacity":new Ra(Je.paint_symbol["icon-opacity"]),"icon-color":new Ra(Je.paint_symbol["icon-color"]),"icon-halo-color":new Ra(Je.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ra(Je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ra(Je.paint_symbol["icon-halo-blur"]),"icon-translate":new Ia(Je.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ia(Je.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ra(Je.paint_symbol["text-opacity"]),"text-color":new Ra(Je.paint_symbol["text-color"],{runtimeType:ct,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new Ra(Je.paint_symbol["text-halo-color"]),"text-halo-width":new Ra(Je.paint_symbol["text-halo-width"]),"text-halo-blur":new Ra(Je.paint_symbol["text-halo-blur"]),"text-translate":new Ia(Je.paint_symbol["text-translate"]),"text-translate-anchor":new Ia(Je.paint_symbol["text-translate-anchor"])}),layout:Eh},Th=function(){function e(t){v(this,e),this.type=t.property.overrides?t.property.overrides.runtimeType:ot,this.defaultValue=t}return m(e,[{key:"evaluate",value:function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}},{key:"eachChild",value:function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}},{key:"outputDefined",value:function(){return!1}},{key:"serialize",value:function(){return null}}]),e}();bi("FormatSectionOverride",Th,{omit:["defaultValue"]});var Ah=function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,Sh)}return m(r,[{key:"recalculate",value:function(e,t){o(s(r.prototype),"recalculate",this).call(this,e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));var n=this.layout.get("text-writing-mode");if(n){var i,a=[],u=f(n);try{for(u.s();!(i=u.n()).done;){var l=i.value;a.indexOf(l)<0&&a.push(l)}}catch(c){u.e(c)}finally{u.f()}this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}},{key:"getValueAndResolveTokens",value:function(e,t,r,n){var i=this.layout.get(e).evaluate(t,{},r,n),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||xn(a.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,(function(t,r){return r in e?String(e[r]):""}))}(t.properties,i)}},{key:"createBucket",value:function(e){return new kh(e)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){return!1}},{key:"_setPaintOverrides",value:function(){var e,t=f(Sh.paint.overridableProperties);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(r.hasPaintOverride(this.layout,n)){var i=this.paint.get(n),a=new Th(i),o=new wn(a,i.property.specification),s=null;s="constant"===i.value.kind||"source"===i.value.kind?new En("source",o):new Sn("composite",o,i.value.zoomStops,i.value._interpolationType),this.paint._values[n]=new Aa(i.property,s,i.parameters)}}}catch(u){t.e(u)}finally{t.f()}}},{key:"_handleOverridablePaintPropertyUpdate",value:function(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&r.hasPaintOverride(this.layout,e)}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}}],[{key:"hasPaintOverride",value:function(e,t){var r=e.get("text-field"),n=Sh.paint.properties[t],i=!1,a=function(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(n.overrides&&n.overrides.hasOverride(a))return void(i=!0)}}catch(o){r.e(o)}finally{r.f()}};if("constant"===r.value.kind&&r.value.value instanceof At)a(r.value.value.sections);else if("source"===r.value.kind){var o=function e(t){i||(t instanceof Ot&&Mt(t.value)===pt?a(t.value.sections):t instanceof Nt?a(t.sections):t.eachChild(e))},s=r.value;s._styleExpression&&o(s._styleExpression.expression)}return i}}]),r}(Jo),Ch={paint:new La({"background-color":new Ia(Je.paint_background["background-color"]),"background-pattern":new Pa(Je.paint_background["background-pattern"]),"background-opacity":new Ia(Je.paint_background["background-opacity"])})},Ih={paint:new La({"raster-opacity":new Ia(Je.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ia(Je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ia(Je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ia(Je.paint_raster["raster-brightness-max"]),"raster-saturation":new Ia(Je.paint_raster["raster-saturation"]),"raster-contrast":new Ia(Je.paint_raster["raster-contrast"]),"raster-resampling":new Ia(Je.paint_raster["raster-resampling"]),"raster-fade-duration":new Ia(Je.paint_raster["raster-fade-duration"])})},Rh=function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,e,{})).implementation=e,n}return m(r,[{key:"is3D",value:function(){return"3d"===this.implementation.renderingMode}},{key:"hasOffscreenPass",value:function(){return void 0!==this.implementation.prerender}},{key:"recalculate",value:function(){}},{key:"updateTransitions",value:function(){}},{key:"hasTransition",value:function(){}},{key:"serialize",value:function(){}},{key:"onAdd",value:function(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}},{key:"onRemove",value:function(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}]),r}(Jo),Mh={paint:new La({"sky-type":new Ia(Je.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ia(Je.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ia(Je.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ia(Je.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ia(Je.paint_sky["sky-gradient-radius"]),"sky-gradient":new Oa(Je.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ia(Je.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ia(Je.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ia(Je.paint_sky["sky-opacity"])})};function Ph(e,t,r){var n=Os(0,0,1),i=Ks(Gs());return function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u-a*s,e[1]=i*u+o*s,e[2]=a*u+n*s,e[3]=o*u-i*s}(i,i,r?-E(e)+Math.PI:E(e)),Hs(i,i,-E(t)),zs(n,n,i),Ns(n,n)}var Oh={circle:function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,Ss)}return m(r,[{key:"createBucket",value:function(e){return new ss(e)}},{key:"queryRadius",value:function(e){var t=e;return bs("circle-radius",this,t)+bs("circle-stroke-width",this,t)+ws(this.paint.get("circle-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,r,n,i,a,o,s){var u=this,l="map"===this.paint.get("circle-pitch-alignment");if(l&&e.queryGeometry.isAboveHorizon)return!1;var c,h=ks(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),d=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r),p=l?d*e.pixelToTileUnitsFactor:d,y=f(n);try{for(y.s();!(c=y.n()).done;){var v,m=c.value,g=f(m);try{var _=function(){var t=v.value,r=t.add(h),n=s&&a.elevation?a.elevation.exaggeration()*s.getElevationAt(r.x,r.y,!0):0,i=l?r:Ws(r,n,o),c=l?e.tilespaceRays.map((function(e){return Xs(e,n)})):e.queryGeometry.screenGeometry,f=p,d=qs([],[t.x,t.y,n,1],o);if("viewport"===u.paint.get("circle-pitch-scale")&&"map"===u.paint.get("circle-pitch-alignment")?f*=d[3]/a.cameraToCenterDistance:"map"===u.paint.get("circle-pitch-scale")&&"viewport"===u.paint.get("circle-pitch-alignment")&&(f*=a.cameraToCenterDistance/d[3]),ls(c,i,f))return{v:!0}};for(g.s();!(v=g.n()).done;){var b=_();if("object"===typeof b)return b.v}}catch(w){g.e(w)}finally{g.f()}}}catch(w){y.e(w)}finally{y.f()}return!1}},{key:"getProgramIds",value:function(){return["circle"]}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}}]),r}(Jo),heatmap:function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,e,nu))._updateColorRamp(),n}return m(r,[{key:"createBucket",value:function(e){return new Qs(e)}}]),m(r,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"heatmap-color"===e&&this._updateColorRamp()}},{key:"_updateColorRamp",value:function(){this.colorRamp=iu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}},{key:"resize",value:function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}},{key:"queryRadius",value:function(){return 0}},{key:"queryIntersectsFeature",value:function(){return!1}},{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["heatmap","heatmapTexture"]}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}}]),r}(Jo),hillshade:function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,au)}return m(r,[{key:"hasOffscreenPass",value:function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},{key:"getProgramIds",value:function(){return["hillshade","hillshadePrepare"]}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}}]),r}(Jo),fill:function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,Ku)}return m(r,[{key:"getProgramIds",value:function(){var e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}},{key:"recalculate",value:function(e,t){o(s(r.prototype),"recalculate",this).call(this,e,t);var n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}},{key:"createBucket",value:function(e){return new qu(e)}},{key:"queryRadius",value:function(){return ws(this.paint.get("fill-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,r,n,i,a){return!e.queryGeometry.isAboveHorizon&&cs(xs(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),n)}},{key:"isTileClipped",value:function(){return!0}}]),r}(Jo),"fill-extrusion":function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,cl)}return m(r,[{key:"createBucket",value:function(e){return new ul(e)}},{key:"queryRadius",value:function(){return ws(this.paint.get("fill-extrusion-translate"))}},{key:"is3D",value:function(){return!0}},{key:"getProgramIds",value:function(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}},{key:"queryIntersectsFeature",value:function(e,t,r,n,i,a,o,s,u){var l=ks(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),c=this.paint.get("fill-extrusion-height").evaluate(t,r),h=this.paint.get("fill-extrusion-base").evaluate(t,r),d=[0,0],p=s&&a.elevation,y=a.elevation?a.elevation.exaggeration():1;if(p){var v=e.tile.getBucket(this).centroidVertexArray,m=u+1;if(m<v.length){var _=v.get(m);d[0]=_.a_centroid_pos0,d[1]=_.a_centroid_pos1}}if(0===d[0]&&1===d[1])return!1;var b=function(e,t,r,n,i,a,o,s,u){return a?function(e,t,r,n,i,a,o,s,u){var l,c=[],h=[],d=[0,0,0,1],p=f(e);try{for(p.s();!(l=p.n()).done;){var y,v=l.value,m=[],g=[],_=f(v);try{for(_.s();!(y=_.n()).done;){var b=y.value,w=b.x+n.x,x=b.y+n.y,k=pl(w,x,t,r,a,o,s,u);d[0]=w,d[1]=x,d[2]=k.base,d[3]=1,qs(d,d,i),d[3]=Math.max(d[3],1e-5);var E=dl([d[0]/d[3],d[1]/d[3],d[2]/d[3]]);d[0]=w,d[1]=x,d[2]=k.top,d[3]=1,qs(d,d,i),d[3]=Math.max(d[3],1e-5);var S=dl([d[0]/d[3],d[1]/d[3],d[2]/d[3]]);m.push(E),g.push(S)}}catch(T){_.e(T)}finally{_.f()}c.push(m),h.push(g)}}catch(T){p.e(T)}finally{p.f()}return[c,h]}(e,t,r,n,i,a,o,s,u):function(e,t,r,n,i){var a,o=[],s=[],u=i[8]*t,l=i[9]*t,c=i[10]*t,h=i[11]*t,d=i[8]*r,p=i[9]*r,y=i[10]*r,v=i[11]*r,m=f(e);try{for(m.s();!(a=m.n()).done;){var _,b=a.value,w=[],x=[],k=f(b);try{for(k.s();!(_=k.n()).done;){var E=_.value,S=E.x+n.x,T=E.y+n.y,A=i[0]*S+i[4]*T+i[12],C=i[1]*S+i[5]*T+i[13],I=i[2]*S+i[6]*T+i[14],R=i[3]*S+i[7]*T+i[15],M=A+u,P=C+l,O=I+c,L=Math.max(R+h,1e-5),D=A+d,B=C+p,N=I+y,z=Math.max(R+v,1e-5),F=new g(M/L,P/L);F.z=O/L,w.push(F);var j=new g(D/z,B/z);j.z=N/z,x.push(j)}}catch(U){k.e(U)}finally{k.f()}o.push(w),s.push(x)}}catch(U){m.e(U)}finally{m.f()}return[o,s]}(e,t,r,n,i)}(n,h,c,l,o,p?s:null,d,y,a.center.lat),w=e.queryGeometry;return function(e,t,r){var n=1/0;cs(r,t)&&(n=fl(r,t[0]));for(var i=0;i<t.length;i++)for(var a=t[i],o=e[i],s=0;s<a.length-1;s++){var u=a[s],l=[u,a[s+1],o[s+1],o[s],u];us(r,l)&&(n=Math.min(n,fl(r,l)))}return n!==1/0&&n}(b[0],b[1],w.isPointQuery()?w.screenBounds:w.screenGeometry)}}]),r}(Jo),line:function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,e,wl)).gradientVersion=0,n}return m(r,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){if("line-gradient"===e){var t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof yr,this.gradientVersion=(this.gradientVersion+1)%w}}},{key:"gradientExpression",value:function(){return this._transitionablePaint._values["line-gradient"].value.expression}},{key:"recalculate",value:function(e,t){o(s(r.prototype),"recalculate",this).call(this,e,t),this.paint._values["line-floorwidth"]=xl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}},{key:"createBucket",value:function(e){return new _l(e)}},{key:"getProgramIds",value:function(){var e=this.paint.get("line-dasharray"),t=this.paint.get("line-pattern").constantOr(1),r=this.paint.get("line-gradient");return[t?"linePattern":e?"lineSDF":r?"lineGradient":"line"]}},{key:"getProgramConfiguration",value:function(e){return new Go(this,e)}},{key:"queryRadius",value:function(e){var t=e,r=kl(bs("line-width",this,t),bs("line-gap-width",this,t)),n=bs("line-offset",this,t);return r/2+Math.abs(n)+ws(this.paint.get("line-translate"))}},{key:"queryIntersectsFeature",value:function(e,t,r,n,i,a){if(e.queryGeometry.isAboveHorizon)return!1;var o=xs(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,e.pixelToTileUnitsFactor),s=e.pixelToTileUnitsFactor/2*kl(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(n=function(e,t){for(var r=[],n=new g(0,0),i=0;i<e.length;i++){for(var a=e[i],o=[],s=0;s<a.length;s++){var u=a[s-1],l=a[s],c=a[s+1],h=0===s?n:l.sub(u)._unit()._perp(),f=s===a.length-1?n:c.sub(l)._unit()._perp(),d=h._add(f)._unit();d._mult(1/(d.x*f.x+d.y*f.y)),o.push(d._mult(t)._add(l))}r.push(o)}return r}(n,u*e.pixelToTileUnitsFactor)),function(e,t,r){for(var n=0;n<t.length;n++){var i=t[n];if(e.length>=3)for(var a=0;a<i.length;a++)if(ms(e,i[a]))return!0;if(hs(e,i,r))return!0}return!1}(o,n,s)}},{key:"isTileClipped",value:function(){return!0}}]),r}(Jo),symbol:Ah,background:function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,Ch)}return m(r,[{key:"getProgramIds",value:function(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}}]),r}(Jo),raster:function(e){p(r,e);var t=y(r);function r(e){return v(this,r),t.call(this,e,Ih)}return m(r,[{key:"getProgramIds",value:function(){return["raster"]}}]),r}(Jo),sky:function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,e,Mh))._updateColorRamp(),n}return m(r,[{key:"_handleSpecialPaintPropertyUpdate",value:function(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}},{key:"_updateColorRamp",value:function(){this.colorRamp=iu({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}},{key:"needsSkyboxCapture",value:function(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){var t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}}},{key:"getCenter",value:function(e,t){var r=this.paint.get("sky-type");if("atmosphere"===r){var n=this.paint.get("sky-atmosphere-sun"),i=!n,a=e.style.light,o=a.properties.get("position");return i&&"viewport"===a.properties.get("anchor")&&K("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),i?Ph(o.azimuthal,90-o.polar,t):Ph(n[0],90-n[1],t)}if("gradient"===r){var s=this.paint.get("sky-gradient-center");return Ph(s[0],90-s[1],t)}}},{key:"is3D",value:function(){return!1}},{key:"isSky",value:function(){return!0}},{key:"markSkyboxValid",value:function(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}},{key:"hasOffscreenPass",value:function(){return!0}},{key:"getProgramIds",value:function(){var e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}]),r}(Jo)},Lh=b.HTMLImageElement,Dh=b.HTMLCanvasElement,Bh=b.HTMLVideoElement,Nh=b.ImageData,zh=b.ImageBitmap,Fh=function(){function e(t,r,n,i){v(this,e),this.context=t,this.format=n,this.texture=t.gl.createTexture(),this.update(r,i)}return m(e,[{key:"update",value:function(e,t,r){var n=e.width,i=e.height,a=!(this.size&&this.size[0]===n&&this.size[1]===i||r),o=this.context,s=o.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),s.bindTexture(s.TEXTURE_2D,this.texture),o.pixelStoreUnpackFlipY.set(!1),o.pixelStoreUnpack.set(1),o.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!t||!1!==t.premultiply)),a)this.size=[n,i],e instanceof Lh||e instanceof Dh||e instanceof Bh||e instanceof Nh||zh&&e instanceof zh?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,n,i,0,this.format,s.UNSIGNED_BYTE,e.data);else{var u=r||{x:0,y:0},l=u.x,c=u.y;e instanceof Lh||e instanceof Dh||e instanceof Bh||e instanceof Nh||zh&&e instanceof zh?s.texSubImage2D(s.TEXTURE_2D,0,l,c,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,l,c,n,i,s.RGBA,s.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&s.generateMipmap(s.TEXTURE_2D)}},{key:"bind",value:function(e,t,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}},{key:"isSizePowerOfTwo",value:function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}},{key:"destroy",value:function(){this.context.gl.deleteTexture(this.texture),this.texture=null}}]),e}(),jh=function(){function e(t,r){v(this,e),t&&(r?this.setSouthWest(t).setNorthEast(r):4===t.length?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}return m(e,[{key:"setNorthEast",value:function(e){return this._ne=e instanceof Vh?new Vh(e.lng,e.lat):Vh.convert(e),this}},{key:"setSouthWest",value:function(e){return this._sw=e instanceof Vh?new Vh(e.lng,e.lat):Vh.convert(e),this}},{key:"extend",value:function(t){var r,n,i=this._sw,a=this._ne;if(t instanceof Vh)r=t,n=t;else{if(!(t instanceof e))return Array.isArray(t)?4===t.length||t.every(Array.isArray)?this.extend(e.convert(t)):this.extend(Vh.convert(t)):this;if(r=t._sw,n=t._ne,!r||!n)return this}return i||a?(i.lng=Math.min(r.lng,i.lng),i.lat=Math.min(r.lat,i.lat),a.lng=Math.max(n.lng,a.lng),a.lat=Math.max(n.lat,a.lat)):(this._sw=new Vh(r.lng,r.lat),this._ne=new Vh(n.lng,n.lat)),this}},{key:"getCenter",value:function(){return new Vh((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}},{key:"getSouthWest",value:function(){return this._sw}},{key:"getNorthEast",value:function(){return this._ne}},{key:"getNorthWest",value:function(){return new Vh(this.getWest(),this.getNorth())}},{key:"getSouthEast",value:function(){return new Vh(this.getEast(),this.getSouth())}},{key:"getWest",value:function(){return this._sw.lng}},{key:"getSouth",value:function(){return this._sw.lat}},{key:"getEast",value:function(){return this._ne.lng}},{key:"getNorth",value:function(){return this._ne.lat}},{key:"toArray",value:function(){return[this._sw.toArray(),this._ne.toArray()]}},{key:"toString",value:function(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}},{key:"isEmpty",value:function(){return!(this._sw&&this._ne)}},{key:"contains",value:function(e){var t=Vh.convert(e),r=t.lng,n=t.lat,i=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=n&&n<=this._ne.lat&&i}}],[{key:"convert",value:function(t){return!t||t instanceof e?t:new e(t)}}]),e}(),Uh=6371008.8,Vh=function(){function e(t,r){if(v(this,e),isNaN(t)||isNaN(r))throw new Error("Invalid LngLat object: (".concat(t,", ").concat(r,")"));if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}return m(e,[{key:"wrap",value:function(){return new e(R(this.lng,-180,180),this.lat)}},{key:"toArray",value:function(){return[this.lng,this.lat]}},{key:"toString",value:function(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}},{key:"distanceTo",value:function(e){var t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Uh*Math.acos(Math.min(i,1))}},{key:"toBounds",value:function(){var t=360*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new jh(new e(this.lng-r,this.lat-t),new e(this.lng+r,this.lat+t))}}],[{key:"convert",value:function(t){if(t instanceof e)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}]),e}(),qh=2*Math.PI*Uh;function Gh(e){return qh*Math.cos(e*Math.PI/180)}function Kh(e){return(180+e)/360}function Hh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Wh(e,t){return e/Gh(t)}function Zh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function Yh(e,t){return e*Gh(Zh(t))}var Xh=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;v(this,e),this.x=+t,this.y=+r,this.z=+n}return m(e,[{key:"toLngLat",value:function(){return new Vh(360*this.x-180,Zh(this.y))}},{key:"toAltitude",value:function(){return Yh(this.z,this.y)}},{key:"meterInMercatorCoordinateUnits",value:function(){return 1/qh*(e=Zh(this.y),1/Math.cos(e*Math.PI/180));var e}}],[{key:"fromLngLat",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Vh.convert(t);return new e(Kh(n.lng),Hh(n.lat),Wh(r,n.lat))}}]),e}(),Qh=function(){function e(t,r){v(this,e),this.width=t,this.height=r,this.nextRow=0,this.image=new tu({width:t,height:r}),this.positions={},this.uploaded=!1}return m(e,[{key:"getDash",value:function(e,t){var r=this.getKey(e,t);return this.positions[r]}},{key:"trim",value:function(){var e=this.width,t=this.height=N(this.nextRow);this.image.resize({width:e,height:t})}},{key:"getKey",value:function(e,t){return e.join(",")+t}},{key:"getDashRanges",value:function(e,t,r){var n=[],i=e.length%2==1?-e[e.length-1]*r:0,a=e[0]*r,o=!0;n.push({left:i,right:a,isDash:o,zeroLength:0===e[0]});for(var s=e[0],u=1;u<e.length;u++){o=!o;var l=e[u];i=s*r,a=(s+=l)*r,n.push({left:i,right:a,isDash:o,zeroLength:0===l})}return n}},{key:"addRoundDash",value:function(e,t,r){for(var n=t/2,i=-r;i<=r;i++)for(var a=this.width*(this.nextRow+r+i),o=0,s=e[o],u=0;u<this.width;u++){u/s.right>1&&(s=e[++o]);var l=Math.abs(u-s.left),c=Math.abs(u-s.right),h=Math.min(l,c),f=void 0,d=i/r*(n+1);if(s.isDash){var p=n-Math.abs(d);f=Math.sqrt(h*h+p*p)}else f=n-Math.sqrt(h*h+d*d);this.image.data[a+u]=Math.max(0,Math.min(255,f+128))}}},{key:"addRegularDash",value:function(e,t){for(var r=e.length-1;r>=0;--r){var n=e[r],i=e[r+1];n.zeroLength?e.splice(r,1):i&&i.isDash===n.isDash&&(i.left=n.left,e.splice(r,1))}var a=e[0],o=e[e.length-1];a.isDash===o.isDash&&(a.left=o.left-this.width,o.right=a.right+this.width);for(var s=this.width*this.nextRow,u=0,l=e[u],c=0;c<this.width;c++){c/l.right>1&&(l=e[++u]);var h=Math.abs(c-l.left),f=Math.abs(c-l.right),d=Math.min(h,f);this.image.data[s+c]=Math.max(0,Math.min(255,(l.isDash?d:-d)+t+128))}}},{key:"addDash",value:function(e,t){var r=this.getKey(e,t);if(this.positions[r])return this.positions[r];var n="round"===t,i=n?7:0,a=2*i+1;if(this.nextRow+a>this.height)return K("LineAtlas out of space"),null;0===e.length&&e.push(1);for(var o=0,s=0;s<e.length;s++)e[s]<0&&(K("Negative value is found in line dasharray, replacing values with 0"),e[s]=0),o+=e[s];if(0!==o){var u=this.width/o,l=this.getDashRanges(e,this.width,u);n?this.addRoundDash(l,u,i):this.addRegularDash(l,"square"===t?.5*u:0)}var c=this.nextRow+i;this.nextRow+=a;var h={tl:[c,i],br:[o,0]};return this.positions[r]=h,h}}]),e}();bi("LineAtlas",Qh);var Jh=function(){function e(t){var r=this;v(this,e),this._callback=t,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){r._triggered=!1,r._callback()})}return m(e,[{key:"trigger",value:function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){e._triggered=!1,e._callback()}),0))}},{key:"remove",value:function(){delete this._channel,this._callback=function(){}}}]),e}(),$h=b.performance;function ef(e){var t=e?e.url.toString():void 0;return $h.getEntriesByName(t)}var tf=function(){function e(){v(this,e),this.tasks={},this.taskQueue=[],F(["process"],this),this.invoker=new Jh(this.process),this.nextId=0}return m(e,[{key:"add",value:function(e,t){var r=this,n=this.nextId++,i=function(e){var t=e.type,r=e.isSymbolTile,n=e.zoom;return n=n||0,"message"===t?0:"maybePrepare"!==t||r?"parseTile"!==t||r?"parseTile"===t&&r?300-n:"maybePrepare"===t&&r?400-n:500:200-n:100-n}(t);if(0===i){Z();try{e()}finally{}return{cancel:function(){}}}return this.tasks[n]={fn:e,metadata:t,priority:i,id:n},this.taskQueue.push(n),this.invoker.trigger(),{cancel:function(){delete r.tasks[n]}}}},{key:"process",value:function(){var e=this;Z();try{if(this.taskQueue=this.taskQueue.filter((function(t){return!!e.tasks[t]})),!this.taskQueue.length)return;var t=this.pick();if(null===t)return;var r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}},{key:"pick",value:function(){for(var e=null,t=1/0,r=0;r<this.taskQueue.length;r++){var n=this.tasks[this.taskQueue[r]];n.priority<t&&(t=n.priority,e=r)}if(null===e)return null;var i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}},{key:"remove",value:function(){this.invoker.remove()}}]),e}();function rf(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}var nf=function(){function e(t,r,n){v(this,e),this.z=t,this.x=r,this.y=n,this.key=sf(0,t,t,r,n)}return m(e,[{key:"equals",value:function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}},{key:"url",value:function(e,t){var r,n,i,a,o,s=(n=this.y,i=this.z,a=rf(256*(r=this.x),256*(n=Math.pow(2,i)-n-1),i),o=rf(256*(r+1),256*(n+1),i),a[0]+","+a[1]+","+o[0]+","+o[1]),u=function(e,t,r){for(var n,i="",a=e;a>0;a--)i+=(t&(n=1<<a-1)?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",s)}},{key:"getTilePoint",value:function(e){var t=Math.pow(2,this.z);return new g((e.x*t-this.x)*ts,(e.y*t-this.y)*ts)}},{key:"getTileVec3",value:function(e){var t=Math.pow(2,this.z);return Os((e.x*t-this.x)*ts,(e.y*t-this.y)*ts,Yh(e.z,e.y))}},{key:"toString",value:function(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}]),e}(),af=function e(t,r){v(this,e),this.wrap=t,this.canonical=r,this.key=sf(t,r.z,r.z,r.x,r.y)},of=function(){function e(t,r,n,i,a){v(this,e),this.overscaledZ=t,this.wrap=r,this.canonical=new nf(n,+i,+a),this.key=0===r&&t===n?this.canonical.key:sf(r,t,n,i,a)}return m(e,[{key:"equals",value:function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}},{key:"scaledTo",value:function(t){var r=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}},{key:"calculateScaledKey",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return sf(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);var r=this.canonical.z-e;return sf(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}},{key:"isChildOf",value:function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}},{key:"children",value:function(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var r=this.canonical.z+1,n=2*this.canonical.x,i=2*this.canonical.y;return[new e(r,this.wrap,r,n,i),new e(r,this.wrap,r,n+1,i),new e(r,this.wrap,r,n,i+1),new e(r,this.wrap,r,n+1,i+1)]}},{key:"isLessThan",value:function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}},{key:"wrapped",value:function(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"unwrapTo",value:function(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}},{key:"overscaleFactor",value:function(){return Math.pow(2,this.overscaledZ-this.canonical.z)}},{key:"toUnwrapped",value:function(){return new af(this.wrap,this.canonical)}},{key:"toString",value:function(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}},{key:"getTilePoint",value:function(e){return this.canonical.getTilePoint(new Xh(e.x-this.wrap,e.y))}},{key:"getTileVec3",value:function(e){return this.canonical.getTileVec3(new Xh(e.x-this.wrap,e.y,e.z))}}]),e}();function sf(e,t,r,n,i){var a=1<<Math.min(r,22),o=a*(i%a)+n%a;return e&&r<22&&(o+=a*a*((e<0?-2*e-1:2*e)%(1<<2*(22-r)))),16*(32*o+r)+(t-r)}bi("CanonicalTileID",nf),bi("OverscaledTileID",of,{omit:["projMatrix"]});var uf=function(){function e(t){v(this,e),this._stringToNumber={},this._numberToString=[];for(var r=0;r<t.length;r++){var n=t[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}return m(e,[{key:"encode",value:function(e){return this._stringToNumber[e]}},{key:"decode",value:function(e){return this._numberToString[e]}}]),e}(),lf=function(){function e(t,r,n,i,a){v(this,e),this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=n,t._y=i,this.properties=t.properties,this.id=a}return m(e,[{key:"toJSON",value:function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}},{key:"geometry",get:function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},set:function(e){this._geometry=e}}]),e}(),cf=Fa([{name:"a_pos",type:"Int16",components:2}]),hf=function(){function e(t,r,n){v(this,e),this.tileID=t,this.uid=D(),this.uses=0,this.tileSize=r,this.tileZoom=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}return m(e,[{key:"registerFadeDuration",value:function(e){var t=e+this.timeAdded;t<ae.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}},{key:"wasRequested",value:function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}},{key:"loadVectorData",value:function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var n in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){var r={};if(!t)return r;var n,i=f(e);try{var a=function(){var e=n.value,i=e.layerIds.map((function(e){return t.getLayer(e)})).filter(Boolean);if(0!==i.length){e.layers=i,e.stateDependentLayerIds&&(e.stateDependentLayers=e.stateDependentLayerIds.map((function(e){return i.filter((function(t){return t.id===e}))[0]})));var a,o=f(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;r[s.id]=e}}catch(u){o.e(u)}finally{o.f()}}};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return r}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var i=this.buckets[n];if(i instanceof kh){if(this.hasSymbolBuckets=!0,!r)break;i.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var a in this.buckets){var o=this.buckets[a];if(o instanceof kh&&o.hasRTLText){this.hasRTLText=!0,_a.isLoading()||_a.isLoaded()||"deferred"!==ma()||ga();break}}for(var s in this.queryPadding=0,this.buckets){var u=this.buckets[s];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(s).queryRadius(u))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new co}},{key:"unloadVectorData",value:function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}},{key:"getBucket",value:function(e){return this.buckets[e.id]}},{key:"upload",value:function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Fh(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Fh(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Fh(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}},{key:"prepare",value:function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}},{key:"queryRenderedFeatures",value:function(e,t,r,n,i,a,o,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:o,transform:a,params:i},e,t,r):{}}},{key:"querySourceFeatures",value:function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var n=r.loadVTLayers(),i=t?t.sourceLayer:"",a=n._geojsonTileLayer||n[i];if(a)for(var o=Nn(t&&t.filter),s=this.tileID.canonical,u=s.z,l=s.x,c=s.y,h={z:u,x:l,y:c},f=0;f<a.length;f++){var d=a.feature(f);if(o.needGeometry){var p=as(d,!0);if(!o.filter(new ba(this.tileID.overscaledZ),p,this.tileID.canonical))continue}else if(!o.filter(new ba(this.tileID.overscaledZ),d))continue;var y=r.getId(d,i),v=new lf(d,u,l,c,y);v.tile=h,e.push(v)}}}},{key:"hasData",value:function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}},{key:"patternsLoaded",value:function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}},{key:"setExpiryData",value:function(e){var t=this.expirationTime;if(e.cacheControl){var r=Y(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var n=Date.now(),i=!1;if(this.expirationTime>n)i=!1;else if(t)if(this.expirationTime<t)i=!0;else{var a=this.expirationTime-t;a?this.expirationTime=n+Math.max(a,3e4):i=!0}else i=!0;i?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}},{key:"getExpiryTimeout",value:function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}},{key:"setFeatureState",value:function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var n in this.buckets)if(t.style.hasLayer(n)){var i=this.buckets[n],a=i.layers[0].sourceLayer||"_geojsonTileLayer",o=r[a],s=e[a];if(o&&s&&0!==Object.keys(s).length){i.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});var u=t&&t.style&&t.style.getLayer(n);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(i)))}}}}},{key:"holdingForFade",value:function(){return void 0!==this.symbolFadeHoldUntil}},{key:"symbolFadeFinished",value:function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ae.now()}},{key:"clearFadeHold",value:function(){this.symbolFadeHoldUntil=void 0}},{key:"setHoldDuration",value:function(e){this.symbolFadeHoldUntil=ae.now()+e}},{key:"setDependencies",value:function(e,t){var r,n={},i=f(t);try{for(i.s();!(r=i.n()).done;)n[r.value]=!0}catch(a){i.e(a)}finally{i.f()}this.dependencies[e]=n}},{key:"hasDependency",value:function(e,t){var r,n=f(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=this.dependencies[i];if(a){var o,s=f(t);try{for(s.s();!(o=s.n()).done;)if(a[o.value])return!0}catch(u){s.e(u)}finally{s.f()}}}}catch(u){n.e(u)}finally{n.f()}return!1}},{key:"clearQueryDebugViz",value:function(){}}]),e}(),ff=function(){function e(){v(this,e),this.state={},this.stateChanges={},this.deletedStates={}}return m(e,[{key:"updateState",value:function(e,t,r){var n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},O(this.stateChanges[e][n],r),null===this.deletedStates[e])for(var i in this.deletedStates[e]={},this.state[e])i!==n&&(this.deletedStates[e][i]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][n])for(var a in this.deletedStates[e][n]={},this.state[e][n])r[a]||(this.deletedStates[e][n][a]=null);else for(var o in r)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][o]&&delete this.deletedStates[e][n][o]}},{key:"removeFeatureState",value:function(e,t,r){if(null!==this.deletedStates[e]){var n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}}},{key:"getState",value:function(e,t){var r=String(t),n=O({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var i=this.deletedStates[e][t];if(null===i)return{};for(var a in i)delete n[a]}return n}},{key:"initializeTileState",value:function(e,t){e.setFeatureState(this.state,t)}},{key:"coalesceChanges",value:function(e,t){var r={};for(var n in this.stateChanges){this.state[n]=this.state[n]||{};var i={};for(var a in this.stateChanges[n])this.state[n][a]||(this.state[n][a]={}),O(this.state[n][a],this.stateChanges[n][a]),i[a]=this.state[n][a];r[n]=i}for(var o in this.deletedStates){this.state[o]=this.state[o]||{};var s={};if(null===this.deletedStates[o])for(var u in this.state[o])s[u]={},this.state[o][u]={};else for(var l in this.deletedStates[o]){if(null===this.deletedStates[o][l])this.state[o][l]={};else for(var c=0,h=Object.keys(this.deletedStates[o][l]);c<h.length;c++){var f=h[c];delete this.state[o][l][f]}s[l]=this.state[o][l]}r[o]=r[o]||{},O(r[o],s)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var d in e)e[d].setFeatureState(r,t)}}]),e}(),df=function(){function e(t){v(this,e),this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}return m(e,[{key:"getElevation",value:function(e,t){var r=this.toIdx(e,t);return{min:this.minimums[r],max:this.maximums[r]}}},{key:"isLeaf",value:function(e,t){return this.leaves[this.toIdx(e,t)]}},{key:"toIdx",value:function(e,t){return t*this.size+e}}]),e}();function pf(e,t,r,n){for(var i=0,a=Number.MAX_VALUE,o=0;o<3;o++)if(Math.abs(n[o])<1e-15){if(r[o]<e[o]||r[o]>t[o])return null}else{var s=1/n[o],u=(e[o]-r[o])*s,l=(t[o]-r[o])*s;if(u>l){var c=u;u=l,l=c}if(u>i&&(i=u),l<a&&(a=l),i>a)return null}return i}function yf(e,t,r,n,i,a,o,s,u,l,c){var h=n-e,f=i-t,d=a-r,p=o-e,y=s-t,v=u-r,m=c[1]*v-c[2]*y,g=c[2]*p-c[0]*v,_=c[0]*y-c[1]*p,b=h*m+f*g+d*_;if(Math.abs(b)<1e-15)return null;var w=1/b,x=l[0]-e,k=l[1]-t,E=l[2]-r,S=(x*m+k*g+E*_)*w;if(S<0||S>1)return null;var T=k*d-E*f,A=E*h-x*d,C=x*f-k*h,I=(c[0]*T+c[1]*A+c[2]*C)*w;return I<0||S+I>1?null:(p*T+y*A+v*C)*w}function vf(e,t,r){return(e-t)/(r-t)}function mf(e,t,r,n,i,a,o,s,u){var l=1<<r,c=a-n,h=o-i,f=(e+1)/l*c+n,d=(t+0)/l*h+i,p=(t+1)/l*h+i;s[0]=(e+0)/l*c+n,s[1]=d,u[0]=f,u[1]=p}var gf=function(){function e(t){if(v(this,e),this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],this.dem){var r=function(e){for(var t=Math.ceil(Math.log2(e.dim/8)),r=[],n=Math.ceil(Math.pow(2,t)),i=1/n,a=function(e,t,r,n,i){var a=n?1:0,o=(e+1)*r-a,s=t*r,u=(t+1)*r-a;i[0]=e*r,i[1]=s,i[2]=o,i[3]=u},o=new df(n),s=[],u=0;u<n*n;u++){a(u%n,Math.floor(u/n),i,!1,s);var l=bf(s[0],s[1],e),c=bf(s[2],s[1],e),h=bf(s[2],s[3],e),f=bf(s[0],s[3],e);o.minimums.push(Math.min(l,c,h,f)),o.maximums.push(Math.max(l,c,h,f)),o.leaves.push(1)}for(r.push(o),n/=2;n>=1;n/=2){var d=r[r.length-1];o=new df(n);for(var p=0;p<n*n;p++){a(p%n,Math.floor(p/n),2,!0,s);var y=d.getElevation(s[0],s[1]),v=d.getElevation(s[2],s[1]),m=d.getElevation(s[2],s[3]),g=d.getElevation(s[0],s[3]),_=d.isLeaf(s[0],s[1]),b=d.isLeaf(s[2],s[1]),w=d.isLeaf(s[2],s[3]),x=d.isLeaf(s[0],s[3]),k=Math.min(y.min,v.min,m.min,g.min),E=Math.max(y.max,v.max,m.max,g.max),S=_&&b&&w&&x;o.maximums.push(E),o.minimums.push(k),o.leaves.push(E-k<=5&&S?1:0)}r.push(o)}return r}(this.dem),n=r.length-1,i=r[n];this._addNode(i.minimums[0],i.maximums[0],i.leaves[0]),this._construct(r,0,0,n,0)}}return m(e,[{key:"raycastRoot",value:function(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return pf([e,t,-100],[r,n,this.maximums[0]*o],i,a)}},{key:"raycast",value:function(e,t,r,n,i,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;if(!this.nodeCount)return null;var s=this.raycastRoot(e,t,r,n,i,a,o);if(null==s)return null;for(var u=[],l=[],c=[],h=[],f=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];f.length>0;){var d=f.pop(),p=d.idx,y=d.t,v=d.nodex,m=d.nodey,g=d.depth;if(this.leaves[p]){mf(v,m,g,e,t,r,n,c,h);var _=1<<g,b=(v+0)/_,w=(v+1)/_,x=(m+0)/_,k=(m+1)/_,E=bf(b,x,this.dem)*o,S=bf(w,x,this.dem)*o,T=bf(w,k,this.dem)*o,A=bf(b,k,this.dem)*o,C=yf(c[0],c[1],E,h[0],c[1],S,h[0],h[1],T,i,a),I=yf(h[0],h[1],T,c[0],h[1],A,c[0],c[1],E,i,a),R=Math.min(null!==C?C:Number.MAX_VALUE,null!==I?I:Number.MAX_VALUE);if(R!==Number.MAX_VALUE)return R;var M=Bs([],i,a,y);if(_f(E,S,A,T,vf(M[0],c[0],h[0]),vf(M[1],c[1],h[1]))>=M[2])return y}else{for(var P=0,O=0;O<this._siblingOffset.length;O++){mf((v<<1)+this._siblingOffset[O][0],(m<<1)+this._siblingOffset[O][1],g+1,e,t,r,n,c,h),c[2]=-100,h[2]=this.maximums[this.childOffsets[p]+O]*o;var L=pf(c,h,i,a);if(null!=L){var D=L;u[O]=D;for(var B=!1,N=0;N<P&&!B;N++)D>=u[l[N]]&&(l.splice(N,0,O),B=!0);B||(l[P]=O),P++}}for(var z=0;z<P;z++){var F=l[z];f.push({idx:this.childOffsets[p]+F,t:u[F],nodex:(v<<1)+this._siblingOffset[F][0],nodey:(m<<1)+this._siblingOffset[F][1],depth:g+1})}}}return null}},{key:"_addNode",value:function(e,t,r){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}},{key:"_construct",value:function(e,t,r,n,i){if(1!==e[n].isLeaf(t,r)){this.childOffsets[i]||(this.childOffsets[i]=this.nodeCount);for(var a,o=n-1,s=e[o],u=0,l=0;l<this._siblingOffset.length;l++){var c=2*t+this._siblingOffset[l][0],h=2*r+this._siblingOffset[l][1],f=s.getElevation(c,h),d=s.isLeaf(c,h),p=this._addNode(f.min,f.max,d);d&&(u|=1<<l),a||(a=p)}for(var y=0;y<this._siblingOffset.length;y++)u&1<<y||this._construct(e,2*t+this._siblingOffset[y][0],2*r+this._siblingOffset[y][1],o,a+y)}}}]),e}();function _f(e,t,r,n,i,a){return vr(vr(e,r,a),vr(t,n,a),i)}function bf(e,t,r){var n=r.dim,i=I(e*n-.5,0,n-1),a=I(t*n-.5,0,n-1),o=Math.floor(i),s=Math.floor(a),u=Math.min(o+1,n-1),l=Math.min(s+1,n-1);return _f(r.get(o,s),r.get(u,s),r.get(o,l),r.get(u,l),i-o,a-s)}var wf={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]},xf=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(v(this,e),this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&"mapbox"!==n&&"terrarium"!==n)return K('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".'));this.stride=r.height;var o=this.dim=r.height-2;if(this.data=new Uint32Array(r.data.buffer),this.encoding=n||"mapbox",this.borderReady=i,!i){for(var s=0;s<o;s++)this.data[this._idx(-1,s)]=this.data[this._idx(0,s)],this.data[this._idx(o,s)]=this.data[this._idx(o-1,s)],this.data[this._idx(s,-1)]=this.data[this._idx(s,0)],this.data[this._idx(s,o)]=this.data[this._idx(s,o-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(o,-1)]=this.data[this._idx(o-1,0)],this.data[this._idx(-1,o)]=this.data[this._idx(0,o-1)],this.data[this._idx(o,o)]=this.data[this._idx(o-1,o-1)],a&&this._buildQuadTree()}}return m(e,[{key:"tree",get:function(){return this._tree||this._buildQuadTree(),this._tree}}]),m(e,[{key:"_buildQuadTree",value:function(){this._tree=new gf(this)}},{key:"get",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=new Uint8Array(this.data.buffer);r&&(e=I(e,-1,this.dim),t=I(t,-1,this.dim));var i=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(n[i],n[i+1],n[i+2])}},{key:"_idx",value:function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}},{key:"_unpackMapbox",value:function(e,t,r){return(256*e*256+256*t+r)/10-1e4}},{key:"_unpackTerrarium",value:function(e,t,r){return 256*e+t+r/256-32768}},{key:"getPixels",value:function(){return new ru({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}},{key:"backfillBorder",value:function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var n=t*this.dim,i=t*this.dim+this.dim,a=r*this.dim,o=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:a=o-1;break;case 1:o=a+1}for(var s=-t*this.dim,u=-r*this.dim,l=a;l<o;l++)for(var c=n;c<i;c++)this.data[this._idx(c,l)]=e.data[this._idx(c+s,l+u)]}},{key:"onDeserialize",value:function(){this._tree&&(this._tree.dem=this)}},{key:"unpackVector",get:function(){return wf[this.encoding]}}],[{key:"getUnpackVector",value:function(e){return wf[e]}},{key:"pack",value:function(t,r){var n=[0,0,0,0],i=e.getUnpackVector(r),a=Math.floor((t+i[3])/i[2]);return n[2]=a%256,a=Math.floor(a/256),n[1]=a%256,a=Math.floor(a/256),n[0]=a,n}}]),e}();bi("DEMData",xf),bi("DemMinMaxQuadTree",gf,{omit:["dem"]});var kf=function(){function e(t,r){v(this,e),this.max=t,this.onRemove=r,this.reset()}return m(e,[{key:"reset",value:function(){for(var e in this.data){var t,r=f(this.data[e]);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}}catch(i){r.e(i)}finally{r.f()}}return this.data={},this.order=[],this}},{key:"add",value:function(e,t,r){var n=this,i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var a={value:t,timeout:void 0};if(void 0!==r&&(a.timeout=setTimeout((function(){n.remove(e,a)}),r)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}},{key:"has",value:function(e){return e.wrapped().key in this.data}},{key:"getAndRemove",value:function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}},{key:"_getAndRemoveByKey",value:function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}},{key:"getByKey",value:function(e){var t=this.data[e];return t?t[0].value:null}},{key:"get",value:function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}},{key:"remove",value:function(e,t){if(!this.has(e))return this;var r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}},{key:"setMaxSize",value:function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}},{key:"filter",value:function(e){var t=[];for(var r in this.data){var n,i=f(this.data[r]);try{for(i.s();!(n=i.n()).done;){var a=n.value;e(a.value)||t.push(a)}}catch(l){i.e(l)}finally{i.f()}}for(var o=0,s=t;o<s.length;o++){var u=s[o];this.remove(u.value.tileID,u)}}}]),e}(),Ef=function e(t,r,n){v(this,e),this.func=t,this.mask=r,this.range=n};Ef.ReadOnly=!1,Ef.ReadWrite=!0,Ef.disabled=new Ef(519,Ef.ReadOnly,[0,1]);var Sf=7680,Tf=function e(t,r,n,i,a,o){v(this,e),this.test=t,this.ref=r,this.mask=n,this.fail=i,this.depthFail=a,this.pass=o};Tf.disabled=new Tf({func:519,mask:0},0,0,Sf,Sf,Sf);var Af=function e(t,r,n){v(this,e),this.blendFunction=t,this.blendColor=r,this.mask=n};Af.Replace=[1,0],Af.disabled=new Af(Af.Replace,Et.transparent,[!1,!1,!1,!1]),Af.unblended=new Af(Af.Replace,Et.transparent,[!0,!0,!0,!0]),Af.alphaBlended=new Af([1,771],Et.transparent,[!0,!0,!0,!0]);var Cf=1029,If=2305,Rf=function e(t,r,n){v(this,e),this.enable=t,this.mode=r,this.frontFace=n};Rf.disabled=new Rf(!1,Cf,If),Rf.backCCW=new Rf(!0,Cf,If),Rf.backCW=new Rf(!0,Cf,2304),Rf.frontCW=new Rf(!0,1028,2304),Rf.frontCCW=new Rf(!0,1028,If);var Mf=function(e){p(r,e);var t=y(r);function r(e,n,a){var o;return v(this,r),(o=t.call(this)).id=e,o._onlySymbols=a,n.on("data",(function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(o._sourceLoaded=!0),o._sourceLoaded&&!o._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(o.reload(),o.transform&&o.update(o.transform))})),n.on("error",(function(){o._sourceErrored=!0})),o._source=n,o._tiles={},o._cache=new kf(0,o._unloadTile.bind(i(o))),o._timers={},o._cacheTimers={},o._maxTileCacheSize=null,o._loadedParentTiles={},o._coveredTiles={},o._state=new ff,o}return m(r,[{key:"onAdd",value:function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null}},{key:"loaded",value:function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}},{key:"getSource",value:function(){return this._source}},{key:"pause",value:function(){this._paused=!0}},{key:"resume",value:function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}}},{key:"_loadTile",value:function(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}},{key:"_unloadTile",value:function(e){if(this._source.unloadTile)return this._source.unloadTile(e,(function(){}))}},{key:"_abortTile",value:function(e){if(this._source.abortTile)return this._source.abortTile(e,(function(){}))}},{key:"serialize",value:function(){return this._source.serialize()}},{key:"prepare",value:function(e){for(var t in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}},{key:"getIds",value:function(){return P(this._tiles).map((function(e){return e.tileID})).sort(Pf).map((function(e){return e.key}))}},{key:"getRenderableIds",value:function(e){var t=this,r=[];for(var n in this._tiles)this._isIdRenderable(+n,e)&&r.push(this._tiles[n]);return e?r.sort((function(e,r){var n=e.tileID,i=r.tileID,a=new g(n.canonical.x,n.canonical.y)._rotate(t.transform.angle),o=new g(i.canonical.x,i.canonical.y)._rotate(t.transform.angle);return n.overscaledZ-i.overscaledZ||o.y-a.y||o.x-a.x})).map((function(e){return e.tileID.key})):r.map((function(e){return e.tileID})).sort(Pf).map((function(e){return e.key}))}},{key:"hasRenderableParent",value:function(e){var t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}},{key:"_isIdRenderable",value:function(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}},{key:"reload",value:function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}},{key:"_reloadTile",value:function(e,t){var r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))}},{key:"_tileLoaded",value:function(e,t,r,n){if(n)return e.state="errored",void(404!==n.status?this._source.fire(new Xe(n,{tile:e})):this.update(this.transform));e.timeAdded=ae.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ye("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}},{key:"_backfillDEM",value:function(e){for(var t=this.getRenderableIds(),r=0;r<t.length;r++){var n=t[r];if(e.neighboringTiles&&e.neighboringTiles[n]){var i=this.getTileByID(n);a(e,i),a(i,e)}}function a(e,t){if(e.dem&&!e.dem.borderReady){e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;var r=t.tileID.canonical.x-e.tileID.canonical.x,n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}}},{key:"getTile",value:function(e){return this.getTileByID(e.key)}},{key:"getTileByID",value:function(e){return this._tiles[e]}},{key:"_retainLoadedChildren",value:function(e,t,r,n){for(var i in this._tiles){var a=this._tiles[i];if(!(n[i]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>r)){for(var o=a.tileID;a&&a.tileID.overscaledZ>t+1;){var s=a.tileID.scaledTo(a.tileID.overscaledZ-1);(a=this._tiles[s.key])&&a.hasData()&&(o=s)}for(var u=o;u.overscaledZ>t;)if(e[(u=u.scaledTo(u.overscaledZ-1)).key]){n[o.key]=o;break}}}}},{key:"findLoadedParent",value:function(e,t){if(e.key in this._loadedParentTiles){var r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(var n=e.overscaledZ-1;n>=t;n--){var i=e.scaledTo(n),a=this._getLoadedTile(i);if(a)return a}}},{key:"_getLoadedTile",value:function(e){var t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}},{key:"updateCacheSize",value:function(e,t){t=t||this._source.tileSize;var r=Math.ceil(e.width/t)+1,n=Math.ceil(e.height/t)+1,i=Math.floor(r*n*5),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(a)}},{key:"handleWrapJump",value:function(e){var t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){var r={};for(var n in this._tiles){var i=this._tiles[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),r[i.tileID.key]=i}for(var a in this._tiles=r,this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(var o in this._tiles)this._setTileReloadTimer(+o,this._tiles[o])}}},{key:"update",value:function(e,t,n){var i=this;if(this.transform=e,this._sourceLoaded&&!this._paused&&!this.transform.freezeTileCoverage&&(!this.usedForTerrain||n)){var a;this.updateCacheSize(e,t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(e){return new of(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)})):(a=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!n,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter((function(e){return i._source.hasTile(e)})))):a=[];var o=this._updateRetainedTiles(a);if(Of(this._source.type)&&0!==a.length){for(var s={},u={},l=0,c=Object.keys(o);l<c.length;l++){var h=c[l],d=o[h],p=this._tiles[h];if(p&&!(p.fadeEndTime&&p.fadeEndTime<=ae.now())){var y=this.findLoadedParent(d,Math.max(d.overscaledZ-r.maxOverzooming,this._source.minzoom));y&&(this._addTile(y.tileID),s[y.tileID.key]=y.tileID),u[h]=d}}var v=a[a.length-1].overscaledZ;for(var m in this._tiles){var g=this._tiles[m];if(!o[m]&&g.hasData())for(var _=g.tileID;_.overscaledZ>v;){_=_.scaledTo(_.overscaledZ-1);var b=this._tiles[_.key];if(b&&b.hasData()&&u[_.key]){o[m]=g.tileID;break}}}for(var w in s)o[w]||(this._coveredTiles[w]=!0,o[w]=s[w])}for(var x in o)this._tiles[x].clearFadeHold();var k,E=function(e,t){var r=[];for(var n in e)n in t||r.push(n);return r}(this._tiles,o),S=f(E);try{for(S.s();!(k=S.n()).done;){var T=k.value,A=this._tiles[T];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+T)}}catch(C){S.e(C)}finally{S.f()}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}}},{key:"releaseSymbolFadeTiles",value:function(){for(var e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}},{key:"_updateRetainedTiles",value:function(e){var t={};if(0===e.length)return t;var n,i={},a=e[e.length-1].overscaledZ,o=e[0].overscaledZ,s=Math.max(o-r.maxOverzooming,this._source.minzoom),u=Math.max(o+r.maxUnderzooming,this._source.minzoom),l={},c=f(e);try{for(c.s();!(n=c.n()).done;){var h=n.value,d=this._addTile(h);t[h.key]=h,d.hasData()||a<this._source.maxzoom&&(l[h.key]=h)}}catch(E){c.e(E)}finally{c.f()}this._retainLoadedChildren(l,a,u,t);var p,y=f(e);try{for(y.s();!(p=y.n()).done;){var v=p.value,m=this._tiles[v.key];if(!m.hasData()){if(v.canonical.z>=this._source.maxzoom){var g=v.children(this._source.maxzoom)[0],_=this.getTile(g);if(_&&_.hasData()){t[g.key]=g;continue}}else{var b=v.children(this._source.maxzoom);if(t[b[0].key]&&t[b[1].key]&&t[b[2].key]&&t[b[3].key])continue}for(var w=m.wasRequested(),x=v.overscaledZ-1;x>=s;--x){var k=v.scaledTo(x);if(i[k.key])break;if(i[k.key]=!0,!(m=this.getTile(k))&&w&&(m=this._addTile(k)),m&&(t[k.key]=k,w=m.wasRequested(),m.hasData()))break}}}}catch(E){y.e(E)}finally{y.f()}return t}},{key:"_updateLoadedParentTileCache",value:function(){for(var e in this._loadedParentTiles={},this._tiles){for(var t=[],r=void 0,n=this._tiles[e].tileID;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);var i=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(i))break;n=i}for(var a=0,o=t;a<o.length;a++){var s=o[a];this._loadedParentTiles[s]=r}}}},{key:"_addTile",value:function(e){var t=this._tiles[e.key];if(t)return t;(t=this._cache.getAndRemove(e))&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));var r=Boolean(t);return r||(t=new hf(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))),t?(t.uses++,this._tiles[e.key]=t,r||this._source.fire(new Ye("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}},{key:"_setTileReloadTimer",value:function(e,t){var r=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout((function(){r._reloadTile(e,"expired"),delete r._timers[e]}),n))}},{key:"_removeTile",value:function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}},{key:"clearTiles",value:function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(+e);this._cache.reset()}},{key:"tilesIn",value:function(e,t,r){var n=[],i=this.transform;if(!i)return n;for(var a in this._tiles){var o=this._tiles[a];if(r&&o.clearQueryDebugViz(),!o.holdingForFade()){var s=e.containsTile(o,i,t);s&&n.push(s)}}return n}},{key:"getVisibleCoordinates",value:function(e){var t,r=this,n=this.getRenderableIds(e).map((function(e){return r._tiles[e].tileID})),i=f(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped())}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"hasTransition",value:function(){if(this._source.hasTransition())return!0;if(Of(this._source.type))for(var e in this._tiles){var t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=ae.now())return!0}return!1}},{key:"setFeatureState",value:function(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}},{key:"removeFeatureState",value:function(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}},{key:"getFeatureState",value:function(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}},{key:"setDependencies",value:function(e,t,r){var n=this._tiles[e];n&&n.setDependencies(t,r)}},{key:"reloadTilesForDependencies",value:function(e,t){for(var r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(+r,"reloading");this._cache.filter((function(r){return!r.hasDependency(e,t)}))}}]),r}(Qe);function Pf(e,t){var r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function Of(e){return"raster"===e||"image"===e||"video"===e}Mf.maxOverzooming=10,Mf.maxUnderzooming=3;var Lf=function(){function e(t,r,n){v(this,e),this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=n}return m(e,[{key:"tileCoordToPixel",value:function(e,t){var r=t*this._scale+this._offset[1],n=Math.floor(e*this._scale+this._offset[0]),i=Math.floor(r);return new g(n,i)}},{key:"getElevationAt",value:function(e,t,r,n){var i=e*this._scale+this._offset[0],a=t*this._scale+this._offset[1],o=Math.floor(i),s=Math.floor(a),u=this._dem;return n=!!n,r?vr(vr(u.get(o,s,n),u.get(o,s+1,n),a-s),vr(u.get(o+1,s,n),u.get(o+1,s+1,n),a-s),i-o):u.get(o,s,n)}},{key:"getElevationAtPixel",value:function(e,t,r){return this._dem.get(e,t,!!r)}},{key:"getMeterToDEM",value:function(e){return(1<<this._demTile.tileID.canonical.z)*Wh(1,e)*this._dem.stride}}],[{key:"create",value:function(t,r,n){var i=n||t.findDEMTileFor(r);if(i&&i.dem){var a=i.dem,o=i.tileID,s=1<<r.canonical.z-o.canonical.z;return new e(i,i.tileSize/ts/s,[(r.canonical.x/s-o.canonical.x)*a.dim,(r.canonical.y/s-o.canonical.y)*a.dim])}}}]),e}(),Df=function(){function e(t,r){v(this,e),this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new yi(ts,16,0),this.featureIndexArray=new _o,this.promoteId=r}return m(e,[{key:"insert",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i,a);for(var s=this.grid,u=0;u<t.length;u++){for(var l=t[u],c=[1/0,1/0,-1/0,-1/0],h=0;h<l.length;h++){var f=l[h];c[0]=Math.min(c[0],f.x),c[1]=Math.min(c[1],f.y),c[2]=Math.max(c[2],f.x),c[3]=Math.max(c[3],f.y)}c[0]<ts&&c[1]<ts&&c[2]>=0&&c[3]>=0&&s.insert(o,c[0],c[1],c[2],c[3])}}},{key:"loadVTLayers",value:function(){return this.vtLayers||(this.vtLayers=new nl.VectorTile(new Vl(this.rawTileData)).layers,this.sourceLayerCoder=new uf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}},{key:"query",value:function(e,t,r,n){var i=this;this.loadVTLayers();var a=e.params||{},o=Nn(a.filter),s=e.tileResult,u=e.transform,l=s.bufferedTilespaceBounds,c=this.grid.query(l.min.x,l.min.y,l.max.x,l.max.y,(function(e,t,r,n){return gs(s.bufferedTilespaceGeometry,e,t,r,n)}));c.sort(Nf);var h=null;u.elevation&&c.length>0&&(h=Lf.create(u.elevation,this.tileID));for(var f,d={},p=function(u){var l=c[u];if(l===f)return"continue";f=l;var p=i.featureIndexArray.get(l),y=null;i.loadMatchingFeature(d,p,o,a.layers,a.availableImages,t,r,n,(function(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return y||(y=is(t)),r.queryIntersectsFeature(s,t,n,y,i.z,e.transform,e.pixelPosMatrix,h,a)}))},y=0;y<c.length;y++)p(y);return d}},{key:"loadMatchingFeature",value:function(e,t,r,n,i,a,o,s,u){var l=t.featureIndex,c=t.bucketIndex,h=t.sourceLayerIndex,f=t.layoutVertexArrayOffset,d=this.bucketLayerIDs[c];if(!n||function(e,t){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(n,d)){var p=this.sourceLayerCoder.decode(h),y=this.vtLayers[p].feature(l);if(r.needGeometry){var v=as(y,!0);if(!r.filter(new ba(this.tileID.overscaledZ),v,this.tileID.canonical))return}else if(!r.filter(new ba(this.tileID.overscaledZ),y))return;for(var m=this.getId(y,p),g=0;g<d.length;g++){var _=d[g];if(!(n&&n.indexOf(_)<0)){var b=a[_];if(b){var w={};void 0!==m&&s&&(w=s.getState(b.sourceLayer||"_geojsonTileLayer",m));var x=O({},o[_]);x.paint=Bf(x.paint,b.paint,y,w,i),x.layout=Bf(x.layout,b.layout,y,w,i);var k=!u||u(y,b,w,f);if(k){var E=new lf(y,this.z,this.x,this.y,m);E.layer=x;var S=e[_];void 0===S&&(S=e[_]=[]),S.push({featureIndex:l,feature:E,intersectionZ:k})}}}}}}},{key:"lookupSymbolFeatures",value:function(e,t,r,n,i,a,o,s){var u={};this.loadVTLayers();var l,c=Nn(i),h=f(e);try{for(h.s();!(l=h.n()).done;){var d=l.value;this.loadMatchingFeature(u,{bucketIndex:r,sourceLayerIndex:n,featureIndex:d,layoutVertexArrayOffset:0},c,a,o,s,t)}}catch(p){h.e(p)}finally{h.f()}return u}},{key:"hasLayer",value:function(e){var t,r=f(this.bucketLayerIDs);try{for(r.s();!(t=r.n()).done;){var n,i=t.value,a=f(i);try{for(a.s();!(n=a.n()).done;)if(e===n.value)return!0}catch(o){a.e(o)}finally{a.f()}}}catch(o){r.e(o)}finally{r.f()}return!1}},{key:"getId",value:function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r}}]),e}();function Bf(e,t,r,n,i){return U(e,(function(e,a){var o=t instanceof Ca?t.get(a):null;return o&&o.evaluate?o.evaluate(r,n,i):o}))}function Nf(e,t){return t-e}bi("FeatureIndex",Df,{omit:["rawTileData","sourceLayerCoder"]});var zf=function e(t){v(this,e);var r={},n=[];for(var i in t){var a=t[i],o=r[i]={};for(var s in a.glyphs){var u=a.glyphs[+s];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var l=u.metrics.localGlyph?2:1,c={x:0,y:0,w:u.bitmap.width+2*l,h:u.bitmap.height+2*l};n.push(c),o[s]=c}}}var h=hc(n),f=h.w,d=h.h,p=new tu({width:f||1,height:d||1});for(var y in t){var m=t[y];for(var g in m.glyphs){var _=m.glyphs[+g];if(_&&0!==_.bitmap.width&&0!==_.bitmap.height){var b=r[y][g],w=_.metrics.localGlyph?2:1;tu.copy(_.bitmap,p,{x:0,y:0},{x:b.x+w,y:b.y+w},_.bitmap)}}}this.image=p,this.positions=r};bi("GlyphAtlas",zf);var Ff=function(){function e(t){v(this,e),this.tileID=new of(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile}return m(e,[{key:"parse",value:function(e,t,r,n,i){var a=this;this.status="parsing",this.data=e,this.collisionBoxArray=new co;var o=new uf(Object.keys(e.layers).sort()),s=new Df(this.tileID,this.promoteId);s.bucketLayerIDs=[];var u,l,c,h,d={},p=new Qh(256,256),y={featureIndex:s,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:p,availableImages:r},v=t.familiesBySource[this.source];for(var m in v){var g=e.layers[m];if(g){var _,b=!1,w=!1,x=f(v[m]);try{for(x.s();!(_=x.n()).done;)"symbol"===_.value[0].type?b=!0:w=!0}catch(z){x.e(z)}finally{x.f()}if((!0!==this.isSymbolTile||b)&&(!1!==this.isSymbolTile||w)){1===g.version&&K('Vector tile source "'.concat(this.source,'" layer "').concat(m,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));for(var k=o.encode(m),E=[],S=0;S<g.length;S++){var T=g.feature(S),A=s.getId(T,m);E.push({feature:T,id:A,index:S,sourceLayerIndex:k})}var C,I=f(v[m]);try{for(I.s();!(C=I.n()).done;){var R=C.value,M=R[0];void 0!==this.isSymbolTile&&"symbol"===M.type!==this.isSymbolTile||M.minzoom&&this.zoom<Math.floor(M.minzoom)||M.maxzoom&&this.zoom>=M.maxzoom||"none"!==M.visibility&&(jf(R,this.zoom,r),(d[M.id]=M.createBucket({index:s.bucketLayerIDs.length,layers:R,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:k,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(E,y,this.tileID.canonical),s.bucketLayerIDs.push(R.map((function(e){return e.id}))))}}catch(z){I.e(z)}finally{I.f()}}}}p.trim();var O={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},L=U(y.glyphDependencies,(function(e){return Object.keys(e).map(Number)}));Object.keys(L).length?n.send("getGlyphs",{uid:this.uid,stacks:L},(function(e,t){u||(u=e,l=t,N.call(a))}),void 0,!1,O):l={};var D=Object.keys(y.iconDependencies);D.length?n.send("getImages",{icons:D,source:this.source,tileID:this.tileID,type:"icons"},(function(e,t){u||(u=e,c=t,N.call(a))}),void 0,!1,O):c={};var B=Object.keys(y.patternDependencies);function N(){if(u)return i(u);if(l&&c&&h){var e=new zf(l),t=new dc(c,h);for(var n in d){var a=d[n];a instanceof kh?(jf(a.layers,this.zoom,r),sh(a,l,e.positions,c,t.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):a.hasPattern&&(a instanceof _l||a instanceof qu||a instanceof ul)&&(jf(a.layers,this.zoom,r),a.addFeatures(y,this.tileID.canonical,t.patternPositions))}this.status="done",i(null,{buckets:P(d).filter((function(e){return!e.isEmpty()})),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:p,imageAtlas:t,glyphMap:this.returnDependencies?l:null,iconMap:this.returnDependencies?c:null,glyphPositions:this.returnDependencies?e.positions:null})}}B.length?n.send("getImages",{icons:B,source:this.source,tileID:this.tileID,type:"patterns"},(function(e,t){u||(u=e,h=t,N.call(a))}),void 0,!1,O):h={},N.call(this)}}]),e}();function jf(e,t,r){var n,i=new ba(t),a=f(e);try{for(a.s();!(n=a.n()).done;)n.value.recalculate(i,r)}catch(o){a.e(o)}finally{a.f()}}var Uf=function(){function e(t){v(this,e),this.entries={},this.scheduler=t}return m(e,[{key:"request",value:function(e,t,r,n){var i=this,a=this.entries[e]=this.entries[e]||{callbacks:[]};if(a.result){var o=h(a.result,2),s=o[0],u=o[1];return this.scheduler?this.scheduler.add((function(){n(s,u)}),t):n(s,u),function(){}}return a.callbacks.push(n),a.cancel||(a.cancel=r((function(r,n){a.result=[r,n];var o,s=f(a.callbacks);try{var u=function(){var e=o.value;i.scheduler?i.scheduler.add((function(){e(r,n)}),t):e(r,n)};for(s.s();!(o=s.n()).done;)u()}catch(l){s.e(l)}finally{s.f()}setTimeout((function(){return delete i.entries[e]}),3e3)}))),function(){a.result||(a.callbacks=a.callbacks.filter((function(e){return e!==n})),a.callbacks.length||(a.cancel(),delete i.entries[e]))}}}]),e}();function Vf(e,t,r){var n=JSON.stringify(e.request);return e.data&&(this.deduped.entries[n]={result:[null,e.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(function(t){var n=Fe(e.request,(function(e,n,i,a){e?t(e):n&&t(null,{vectorTile:r?void 0:new nl.VectorTile(new Vl(n)),rawData:n,cacheControl:i,expires:a})}));return function(){n.cancel(),t()}}),t)}e.ARRAY_TYPE=Ts,e.AUTH_ERR_MSG=fe,e.Actor=function(){function e(t,r,n){v(this,e),this.target=t,this.parent=r,this.mapId=n,this.callbacks={},this.cancelCallbacks={},F(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Z()?t:b,this.scheduler=new tf}return m(e,[{key:"send",value:function(e,t,r,n){var i=this,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,s=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=o,this.callbacks[s]=r);var u=ee(this.globalScope)?void 0:[];return this.target.postMessage({id:s,type:e,hasCallback:!!r,targetMapId:n,mustQueue:a,sourceMapId:this.mapId,data:Ei(t,u)},u),{cancel:function(){r&&delete i.callbacks[s],i.target.postMessage({id:s,type:"<cancel>",targetMapId:n,sourceMapId:i.mapId})}}}},{key:"receive",value:function(e){var t=this,r=e.data,n=r.id;if(n&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){var i=this.cancelCallbacks[n];delete this.cancelCallbacks[n],i&&i.cancel()}else if(r.mustQueue||Z()){var a=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add((function(){return t.processTask(n,r)}),a&&a.metadata||{type:"message"})}else this.processTask(n,r)}},{key:"processTask",value:function(e,t){var r=this;if("<response>"===t.type){var n=this.callbacks[e];delete this.callbacks[e],n&&(t.error?n(Si(t.error)):n(null,Si(t.data)))}else{var i=ee(this.globalScope)?void 0:[],a=t.hasCallback?function(t,n){delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:t?Ei(t):null,data:Ei(n,i)},i)}:function(e){},o=Si(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,o,a);else if(this.parent.getWorkerSource){var s=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,s[0],o.source)[s[1]](o,a)}else a(new Error("Could not find function ".concat(t.type)))}}},{key:"remove",value:function(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}]),e}(),e.CanonicalTileID=nf,e.Color=Et,e.ColorMode=Af,e.CullFaceMode=Rf,e.DEMData=xf,e.DataConstantProperty=Ia,e.DedupedRequest=Uf,e.DepthMode=Ef,e.EXTENT=ts,e.Elevation=function(){function e(){v(this,e)}return m(e,[{key:"getAtPointOrZero",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getAtPoint(e,t)||0}},{key:"getAtPoint",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];null==t&&(t=null);var n=this._source();if(!n)return t;if(e.y<0||e.y>1)return t;var i=n.getSource().maxzoom,a=1<<i,o=Math.floor(e.x),s=e.x-o,u=new of(i,o,i,Math.floor(s*a),Math.floor(e.y*a)),l=this.findDEMTileFor(u);if(!l||!l.dem)return t;var c=l.dem,h=1<<l.tileID.canonical.z,f=(s*h-l.tileID.canonical.x)*c.dim,d=(e.y*h-l.tileID.canonical.y)*c.dim,p=Math.floor(f),y=Math.floor(d);return(r?this.exaggeration():1)*vr(vr(c.get(p,y),c.get(p,y+1),d-y),vr(c.get(p+1,y),c.get(p+1,y+1),d-y),f-p)}},{key:"getAtTileOffset",value:function(e,t,r){var n=1<<e.canonical.z;return this.getAtPointOrZero(new Xh(e.wrap+(e.canonical.x+t/ts)/n,(e.canonical.y+r/ts)/n))}},{key:"getForTilePoints",value:function(e,t,r,n){var i=this,a=Lf.create(this,e,n);return!!a&&(t.forEach((function(e){e[2]=i.exaggeration()*a.getElevationAt(e[0],e[1],r)})),!0)}},{key:"getMinMaxForTile",value:function(e){var t=this.findDEMTileFor(e);if(!t||!t.dem)return null;for(var r=t.dem.tree,n=t.tileID,i=1<<e.canonical.z-n.canonical.z,a=e.canonical.x/i-n.canonical.x,o=e.canonical.y/i-n.canonical.y,s=0,u=0;u<e.canonical.z-n.canonical.z&&!r.leaves[s];u++){a*=2,o*=2;var l=2*Math.floor(o)+Math.floor(a);s=r.childOffsets[s]+l,a%=1,o%=1}return{min:this.exaggeration()*r.minimums[s],max:this.exaggeration()*r.maximums[s]}}},{key:"getMinElevationBelowMSL",value:function(){throw new Error("Pure virtual method called.")}},{key:"raycast",value:function(e,t,r){throw new Error("Pure virtual method called.")}},{key:"pointCoordinate",value:function(e){throw new Error("Pure virtual method called.")}},{key:"_source",value:function(){throw new Error("Pure virtual method called.")}},{key:"exaggeration",value:function(){throw new Error("Pure virtual method called.")}},{key:"findDEMTileFor",value:function(e){throw new Error("Pure virtual method called.")}},{key:"visibleDemTiles",get:function(){throw new Error("Getter must be implemented in subclass.")}}]),e}(),e.ErrorEvent=Xe,e.EvaluationParameters=ba,e.Event=Ye,e.Evented=Qe,e.GlyphManager=Hc,e.ImagePosition=fc,e.LineAtlas=Qh,e.LngLat=Vh,e.LngLatBounds=jh,e.LocalGlyphMode=Kc,e.MAX_SAFE_INTEGER=w,e.MercatorCoordinate=Xh,e.ONE_EM=Rl,e.OverscaledTileID=of,e.Properties=La,e.RGBAImage=ru,e.RequestManager=function(){function e(t,r,n){v(this,e),this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!n,this._createSkuToken()}return m(e,[{key:"_createSkuToken",value:function(){var e=function(){for(var e="",t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",he,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}},{key:"_isSkuTokenExpired",value:function(){return Date.now()>this._skuTokenExpiresAt}},{key:"transformRequest",value:function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}},{key:"normalizeStyleURL",value:function(e,t){if(!de(e))return e;var r=ve(e);return r.path="/styles/v1".concat(r.path),this._makeAPIURL(r,this._customAccessToken||t)}},{key:"normalizeGlyphsURL",value:function(e,t){if(!de(e))return e;var r=ve(e);return r.path="/fonts/v1".concat(r.path),this._makeAPIURL(r,this._customAccessToken||t)}},{key:"normalizeSourceURL",value:function(e,t){if(!de(e))return e;var r=ve(e);return r.path="/v4/".concat(r.authority,".json"),r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)}},{key:"normalizeSpriteURL",value:function(e,t,r,n){var i=ve(e);return de(e)?(i.path="/styles/v1".concat(i.path,"/sprite").concat(t).concat(r),this._makeAPIURL(i,this._customAccessToken||n)):(i.path+="".concat(t).concat(r),me(i))}},{key:"normalizeTileURL",value:function(e,t,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!de(e))return e;var n=ve(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,"".concat(t||r&&"raster"!==n.authority&&512===r?"@2x":"").concat(se.supported?".webp":"$1")),"raster"===n.authority?n.path="/".concat(oe.RASTER_URL_PREFIX).concat(n.path):(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path="/".concat(oe.TILE_URL_VERSION).concat(n.path));var i=this._customAccessToken||function(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;){var n=t.value.match(/^access_token=(.*)$/);if(n)return n[1]}}catch(i){r.e(i)}finally{r.f()}return null}(n.params)||oe.ACCESS_TOKEN;return oe.REQUIRE_ACCESS_TOKEN&&i&&this._skuToken&&n.params.push("sku=".concat(this._skuToken)),this._makeAPIURL(n,i)}},{key:"canonicalizeTileURL",value:function(e,t){var r=ve(e);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return e;var n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+="raster/".concat(r.path.replace("/".concat(oe.RASTER_URL_PREFIX,"/"),"")):n+="tiles/".concat(r.path.replace("/".concat(oe.TILE_URL_VERSION,"/"),""));var i=r.params;return t&&(i=i.filter((function(e){return!e.match(/^access_token=/)}))),i.length&&(n+="?".concat(i.join("&"))),n}},{key:"canonicalizeTileset",value:function(e,t){var r,n=!!t&&de(t),i=[],a=f(e.tiles||[]);try{for(a.s();!(r=a.n()).done;){var o=r.value;pe(o)?i.push(this.canonicalizeTileURL(o,n)):i.push(o)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"_makeAPIURL",value:function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",n=ve(oe.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){var i=e.params.indexOf("secure");i>=0&&e.params.splice(i,1)}if("/"!==n.path&&(e.path="".concat(n.path).concat(e.path)),!oe.REQUIRE_ACCESS_TOKEN)return me(e);if(t=t||oe.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error("An API access token is required to use Mapbox GL. ".concat(r));if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ".concat(r))}return e.params=e.params.filter((function(e){return-1===e.indexOf("access_token")})),e.params.push("access_token=".concat(t||"")),me(e)}}]),e}(),e.ResourceType=De,e.SegmentVector=es,e.SourceCache=Mf,e.StencilMode=Tf,e.StructArrayLayout1ui2=so,e.StructArrayLayout2f1f2i16=Ja,e.StructArrayLayout2i4=Ua,e.StructArrayLayout2ui4=oo,e.StructArrayLayout3f12=Za,e.StructArrayLayout3ui6=eo,e.StructArrayLayout4i8=Va,e.Texture=Fh,e.Tile=hf,e.Transitionable=ka,e.Uniform1f=Oo,e.Uniform1i=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=0,i}return m(r,[{key:"set",value:function(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}}]),r}(Po),e.Uniform2f=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=[0,0],i}return m(r,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}}]),r}(Po),e.Uniform3f=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=[0,0,0],i}return m(r,[{key:"set",value:function(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}}]),r}(Po),e.Uniform4f=Lo,e.UniformColor=Do,e.UniformMatrix3f=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=No,i}return m(r,[{key:"set",value:function(e){for(var t=0;t<9;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix3fv(this.location,!1,e);break}}}]),r}(Po),e.UniformMatrix4f=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e,n)).current=Bo,i}return m(r,[{key:"set",value:function(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(var t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}}]),r}(Po),e.UnwrappedTileID=af,e.ValidationError=$e,e.VectorTileWorkerSource=function(e){p(r,e);var t=y(r);function r(e,n,i,a,o){var s;return v(this,r),(s=t.call(this)).actor=e,s.layerIndex=n,s.availableImages=i,s.loadVectorData=o||Vf,s.loading={},s.loaded={},s.deduped=new Uf(e.scheduler),s.isSpriteLoaded=a,s.scheduler=e.scheduler,s}return m(r,[{key:"loadTile",value:function(e,t){var r=this,n=e.uid,i=e&&e.request,a=i&&i.collectResourceTiming,o=this.loading[n]=new Ff(e);o.abort=this.loadVectorData(e,(function(s,u){var l=!r.loading[n];if(delete r.loading[n],l||s||!u)return o.status="done",l||(r.loaded[n]=o),t(s);var c=u.rawData,h={};u.expires&&(h.expires=u.expires),u.cacheControl&&(h.cacheControl=u.cacheControl),o.vectorTile=u.vectorTile||new nl.VectorTile(new Vl(c));var f=function(){o.parse(o.vectorTile,r.layerIndex,r.availableImages,r.actor,(function(e,r){if(e||!r)return t(e);var n={};if(a){var o=ef(i);o.length>0&&(n.resourceTiming=JSON.parse(JSON.stringify(o)))}t(null,O({rawTileData:c.slice(0)},r,h,n))}))};r.isSpriteLoaded?f():r.once("isSpriteLoaded",(function(){r.scheduler?r.scheduler.add(f,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):f()})),r.loaded=r.loaded||{},r.loaded[n]=o}))}},{key:"reloadTile",value:function(e,t){var r=this,n=this.loaded,i=e.uid,a=this;if(n&&n[i]){var o=n[i];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain;var s=function(e,n){var i=o.reloadCallback;i&&(delete o.reloadCallback,o.parse(o.vectorTile,a.layerIndex,r.availableImages,a.actor,i)),t(e,n)};"parsing"===o.status?o.reloadCallback=s:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,s):s())}}},{key:"abortTile",value:function(e,t){var r=e.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),t()}},{key:"removeTile",value:function(e,t){var r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()}}]),r}(Qe),e.WritingMode=pc,e.ZoomHistory=Ti,e.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},e.addDynamicAttributes=_h,e.altitudeFromMercatorZ=Yh,e.asyncAll=M,e.bezier=A,e.bindAll=F,e.bufferConvexPolygon=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=R(n-1,-1,e.length-1),a=R(n+1,-1,e.length-1),o=e[n],s=e[a],u=e[i].sub(o).unit(),l=s.sub(o).unit(),c=l.angleWithSep(u.x,u.y),h=u.add(l).unit().mult(-1*t/Math.sin(c/2));r.push(o.add(h))}return r},e.cacheEntryPossiblyAdded=function(e){++Le>Me&&(e.getActor().send("enforceCacheSizeLimit",Re),Le=0)},e.clamp=I,e.clearTileCache=function(e){var t=b.caches.delete(Ie);e&&t.catch(e).then((function(){return e()}))},e.clipLine=zc,e.clone=function(e){var t=new Ts(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.clone$1=function(e){var t=new Ts(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$2=q,e.collisionCircleLayout=Il,e.config=oe,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.create=Ms,e.create$1=function(){var e=new Ts(16);return Ts!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$2=As,e.createExpression=kn,e.createFilter=Nn,e.createLayout=Fa,e.createStyleLayer=function(e){return"custom"===e.type?new Rh(e):new Oh[e.type](e)},e.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],u=r[2];return e[0]=i*u-a*s,e[1]=a*o-n*u,e[2]=n*s-i*o,e},e.degToRad=E,e.div=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},e.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.ease=C,e.easeCubicInOut=T,e.emitValidationErrors=pi,e.endsWith=j,e.enforceCacheSizeLimit=function(e){Pe(),_e&&_e.then((function(t){t.keys().then((function(r){for(var n=0;n<r.length-e;n++)t.delete(r[n])}))}))},e.evaluateSizeForFeature=Ol,e.evaluateSizeForZoom=Ll,e.evaluateVariableOffset=oh,e.evented=va,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=ae,e.exported$1=se,e.extend=O,e.filterObject=V,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,u=i+i,l=r*o,c=n*o,h=n*s,f=i*o,d=i*s,p=i*u,y=a*o,v=a*s,m=a*u;return e[0]=1-h-p,e[1]=c+m,e[2]=f-v,e[3]=0,e[4]=c-m,e[5]=1-l-p,e[6]=d+y,e[7]=0,e[8]=f+v,e[9]=d-y,e[10]=1-l-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.furthestTileCorner=function(e){var t=Math.round((e+45+360)%360/90)%4;return S[t]},e.getAABBPointSquareDist=function(e,t,r){for(var n=0,i=0;i<2;++i){var a=r?r[i]:0;e[i]>a&&(n+=(e[i]-a)*(e[i]-a)),t[i]<a&&(n+=(a-t[i])*(a-t[i]))}return n},e.getAnchorAlignment=Tc,e.getAnchorJustification=uh,e.getBounds=function(e){var t,r=1/0,n=1/0,i=-1/0,a=-1/0,o=f(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;r=Math.min(r,s.x),n=Math.min(n,s.y),i=Math.max(i,s.x),a=Math.max(a,s.y)}}catch(u){o.e(u)}finally{o.f()}return{min:new g(r,n),max:new g(i,a)}},e.getImage=He,e.getJSON=function(e,t){return ze(O(e,{type:"json"}),t)},e.getMapSessionAPI=Ae,e.getPerformanceMeasurement=ef,e.getRTLTextPluginStatus=ma,e.getReferrer=Ne,e.getVideo=function(e,t){var r=b.document.createElement("video");r.muted=!0,r.onloadstart=function(){t(null,r)};for(var n=0;n<e.length;n++){var i=b.document.createElement("source");Ve(e[n])||(r.crossOrigin="Anonymous"),i.src=e[n],r.appendChild(i)}return{cancel:function(){}}},e.identity=Cs,e.identity$1=Ks,e.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],f=t[10],d=t[11],p=t[12],y=t[13],v=t[14],m=t[15],g=r*s-n*o,_=r*u-i*o,b=r*l-a*o,w=n*u-i*s,x=n*l-a*s,k=i*l-a*u,E=c*y-h*p,S=c*v-f*p,T=c*m-d*p,A=h*v-f*y,C=h*m-d*y,I=f*m-d*v,R=g*I-_*C+b*A+w*T-x*S+k*E;return R?(e[0]=(s*I-u*C+l*A)*(R=1/R),e[1]=(i*C-n*I-a*A)*R,e[2]=(y*k-v*x+m*w)*R,e[3]=(f*x-h*k-d*w)*R,e[4]=(u*T-o*I-l*S)*R,e[5]=(r*I-i*T+a*S)*R,e[6]=(v*b-p*k-m*_)*R,e[7]=(c*k-f*b+d*_)*R,e[8]=(o*C-s*T+l*E)*R,e[9]=(n*T-r*C-a*E)*R,e[10]=(p*x-y*b+m*g)*R,e[11]=(h*b-c*x-d*g)*R,e[12]=(s*S-o*A-u*E)*R,e[13]=(r*A-n*S+i*E)*R,e[14]=(y*_-p*w-v*g)*R,e[15]=(c*w-h*_+f*g)*R,e):null},e.isMapAuthenticated=function(e){return Ce.has(e)},e.isMapboxURL=de,e.latFromMercatorY=Zh,e.len=Vs,e.length=Ps,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.loadVectorTile=Vf,e.makeRequest=ze,e.mercatorXfromLng=Kh,e.mercatorYfromLat=Hh,e.mercatorZfromAltitude=Wh,e.mul=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},e.mul$1=Rs,e.mul$2=Us,e.multiply=Is,e.multiply$1=Ds,e.nextPowerOfTwo=N,e.normalize=Ns,e.normalize$1=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o,e},e.number=vr,e.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),u=1/(n-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(o+a)*l,e[15]=1,e},e.pbf=Vl,e.perspective=function(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+n)*(a=1/(n-i)),e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){for(var r={},n=0;n<t.length;n++){var i=t[n];i in e&&(r[i]=e[i])}return r},e.plugin=_a,e.pointGeometry=g,e.polygonIntersectsBox=gs,e.polygonIntersectsPolygon=us,e.polygonizeBounds=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=new g(r,r),a=e.sub(i),o=t.add(i),s=[a,new g(o.x,a.y),o,new g(a.x,o.y)];return n&&s.push(a),s},e.posAttributes=cf,e.postMapLoadEvent=Se,e.postTurnstileEvent=ke,e.potpack=hc,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=function(e){return e*k},e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:fa,pluginURL:da}),va.on("pluginStateChange",e),e},e.removeAuthState=function(e){Ce.delete(e)},e.renderColorRamp=iu,e.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+c*n,e[6]=s*i+h*n,e[7]=u*i+f*n,e[8]=l*i-a*n,e[9]=c*i-o*n,e[10]=h*i-s*n,e[11]=f*i-u*n,e},e.rotateX$1=Hs,e.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-c*n,e[2]=s*i-h*n,e[3]=u*i-f*n,e[8]=a*n+l*i,e[9]=o*n+c*i,e[10]=s*n+h*i,e[11]=u*n+f*i,e},e.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+c*n,e[2]=s*i+h*n,e[3]=u*i+f*n,e[4]=l*i-a*n,e[5]=c*i-o*n,e[6]=h*i-s*n,e[7]=f*i-u*n,e},e.rotateZ$1=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=a*u+o*s,e[3]=o*u-a*s,e},e.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},e.scale$1=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},e.scaleAndAdd=Bs,e.setCacheLimits=function(e,t){Re=e,Me=t},e.setRTLTextPlugin=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(fa===ua||fa===la||fa===ca)throw new Error("setRTLTextPlugin cannot be called multiple times.");da=ae.resolveURL(e),fa=ua,ha=t,ya(),r||ga()},e.smoothstep=function(e,t,r){return(r=I((r-e)/(t-e),0,1))*r*(3-2*r)},e.spec=Je,e.storeAuthState=function(e,t){t?Ce.add(e):Ce.delete(e)},e.sub=js,e.subtract=Ls,e.symbolSize=Dl,e.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e},e.transformMat4=qs,e.transformMat4$1=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/(o=o||1),e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e},e.transformQuat=zs,e.translate=function(e,t,r){var n,i,a,o,s,u,l,c,h,f,d,p,y=r[0],v=r[1],m=r[2];return t===e?(e[12]=t[0]*y+t[4]*v+t[8]*m+t[12],e[13]=t[1]*y+t[5]*v+t[9]*m+t[13],e[14]=t[2]*y+t[6]*v+t[10]*m+t[14],e[15]=t[3]*y+t[7]*v+t[11]*m+t[15]):(i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=n=t[0],e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=n*y+s*v+h*m+t[12],e[13]=i*y+u*v+f*m+t[13],e[14]=a*y+l*v+d*m+t[14],e[15]=o*y+c*v+p*m+t[15]),e},e.triggerPluginCompletionEvent=pa,e.uniqueId=D,e.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers.".concat(r,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(r,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(r,': property "renderingMode" must be either "2d" or "3d"')}),t},e.validateFog=hi,e.validateLight=ci,e.validateStyle=li,e.values=P,e.vectorTile=nl,e.version=t,e.warnOnce=K,e.window=b,e.wrap=R})),g(["./shared"],(function(e){function t(e){var r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){var n,i="[",a=f(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;i+="".concat(t(o),",")}}catch(c){a.e(c)}finally{a.f()}return"".concat(i,"]")}for(var s=Object.keys(e).sort(),u="{",l=0;l<s.length;l++)u+="".concat(JSON.stringify(s[l]),":").concat(t(e[s[l]]),",");return"".concat(u,"}")}function r(r){var n,i="",a=f(e.refProperties);try{for(a.s();!(n=a.n()).done;){var o=n.value;i+="/".concat(t(r[o]))}}catch(s){a.e(s)}finally{a.f()}return i}var n=function(){function t(e){v(this,t),this.keyCache={},e&&this.replace(e)}return m(t,[{key:"replace",value:function(e){this._layerConfigs={},this._layers={},this.update(e,[])}},{key:"update",value:function(t,n){var i,a=this,o=f(t);try{for(o.s();!(i=o.n()).done;){var s=i.value;this._layerConfigs[s.id]=s;var u=this._layers[s.id]=e.createStyleLayer(s);u._featureFilter=e.createFilter(u.filter),this.keyCache[s.id]&&delete this.keyCache[s.id]}}catch(x){o.e(x)}finally{o.f()}var l,c=f(n);try{for(c.s();!(l=c.n()).done;){var h=l.value;delete this.keyCache[h],delete this._layerConfigs[h],delete this._layers[h]}}catch(x){c.e(x)}finally{c.f()}this.familiesBySource={};var d,p=function(e,t){for(var n={},i=0;i<e.length;i++){var a=t&&t[e[i].id]||r(e[i]);t&&(t[e[i].id]=a);var o=n[a];o||(o=n[a]=[]),o.push(e[i])}var s=[];for(var u in n)s.push(n[u]);return s}(e.values(this._layerConfigs),this.keyCache),y=f(p);try{for(y.s();!(d=y.n()).done;){var v=d.value.map((function(e){return a._layers[e.id]})),m=v[0];if("none"!==m.visibility){var g=m.source||"",_=this.familiesBySource[g];_||(_=this.familiesBySource[g]={});var b=m.sourceLayer||"_geojsonTileLayer",w=_[b];w||(w=_[b]=[]),w.push(v)}}}catch(x){y.e(x)}finally{y.f()}}}]),t}(),i=e.window.ImageBitmap,a=function(){function t(){v(this,t)}return m(t,[{key:"loadTile",value:function(t,r){var n=t.uid,a=t.encoding,o=t.rawImageData,s=t.padding,u=t.buildQuadTree,l=i&&o instanceof i?this.getImageData(o,s):o;r(null,new e.DEMData(n,l,a,s<1,u))}},{key:"getImageData",value:function(t,r){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(t.width,t.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=t.width,this.offscreenCanvas.height=t.height,this.offscreenCanvasContext.drawImage(t,0,0,t.width,t.height);var n=this.offscreenCanvasContext.getImageData(-r,-r,t.width+2*r,t.height+2*r);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:n.width,height:n.height},n.data)}}]),t}(),u=function e(t,r){var n,i=t&&t.type;if("FeatureCollection"===i)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===i)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===i)e(t.geometry,r);else if("Polygon"===i)l(t.coordinates,r);else if("MultiPolygon"===i)for(n=0;n<t.coordinates.length;n++)l(t.coordinates[n],r);return t};function l(e,t){if(0!==e.length){c(e[0],t);for(var r=1;r<e.length;r++)c(e[r],!t)}}function c(e,t){for(var r=0,n=0,i=e.length,a=i-1;n<i;a=n++)r+=(e[n][0]-e[a][0])*(e[a][1]+e[n][1]);r>=0!=!!t&&e.reverse()}var d=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,g=function(){function t(r){v(this,t),this._feature=r,this.extent=e.EXTENT,this.type=r.type,this.properties=r.tags,"id"in r&&!isNaN(r.id)&&(this.id=parseInt(r.id,10))}return m(t,[{key:"loadGeometry",value:function(){if(1===this._feature.type){var t,r=[],n=f(this._feature.geometry);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.push([new e.pointGeometry(i[0],i[1])])}}catch(p){n.e(p)}finally{n.f()}return r}var a,o=[],s=f(this._feature.geometry);try{for(s.s();!(a=s.n()).done;){var u,l=a.value,c=[],h=f(l);try{for(h.s();!(u=h.n()).done;){var d=u.value;c.push(new e.pointGeometry(d[0],d[1]))}}catch(p){h.e(p)}finally{h.f()}o.push(c)}}catch(p){s.e(p)}finally{s.f()}return o}},{key:"toGeoJSON",value:function(e,t,r){return d.call(this,e,t,r)}}]),t}(),_=function(){function t(r){v(this,t),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=r.length,this._features=r}return m(t,[{key:"feature",value:function(e){return new g(this._features[e])}}]),t}(),b=e.vectorTile.VectorTileFeature,w=x;function x(e,t){this.options=t||{},this.features=e,this.length=e.length}function k(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}x.prototype.feature=function(e){return new k(this.features[e],this.options.extent)},k.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var n=t[r],i=[],a=0;a<n.length;a++)i.push(new e.pointGeometry(n[a][0],n[a][1]));this.geometry.push(i)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var u=o[s];t=Math.min(t,u.x),r=Math.max(r,u.x),n=Math.min(n,u.y),i=Math.max(i,u.y)}return[t,n,r,i]},k.prototype.toGeoJSON=b.prototype.toGeoJSON;var E=T,S=w;function T(t){var r=new e.pbf;return function(e,t){for(var r in e.layers)t.writeMessage(3,A,e.layers[r])}(t,r),r.finish()}function A(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,C,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var a=n.values;for(r=0;r<a.length;r++)t.writeMessage(4,O,a[r])}function C(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,I,e),t.writeVarintField(3,r.type),t.writeMessage(4,P,r)}function I(e,t){var r=e.feature,n=e.keys,i=e.values,a=e.keycache,o=e.valuecache;for(var s in r.properties){var u=a[s];void 0===u&&(n.push(s),a[s]=u=n.length-1),t.writeVarint(u);var l=r.properties[s],c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var h=c+":"+l,f=o[h];void 0===f&&(i.push(l),o[h]=f=i.length-1),t.writeVarint(f)}}function R(e,t){return(t<<3)+(7&e)}function M(e){return e<<1^e>>31}function P(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,a=0,o=r.length,s=0;s<o;s++){var u=r[s],l=1;1===n&&(l=u.length),t.writeVarint(R(1,l));for(var c=3===n?u.length-1:u.length,h=0;h<c;h++){1===h&&1!==n&&t.writeVarint(R(2,c-1));var f=u[h].x-i,d=u[h].y-a;t.writeVarint(M(f)),t.writeVarint(M(d)),i+=f,a+=d}3===n&&t.writeVarint(R(7,1))}}function O(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function L(e,t,r,n,i,a){if(!(i-n<=r)){var o=n+i>>1;D(e,t,o,n,i,a%2),L(e,t,r,n,o-1,a+1),L(e,t,r,o+1,i,a+1)}}function D(e,t,r,n,i,a){for(;i>n;){if(i-n>600){var o=i-n+1,s=r-n+1,u=Math.log(o),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(o-l)/o)*(s-o/2<0?-1:1);D(e,t,r,Math.max(n,Math.floor(r-s*l/o+c)),Math.min(i,Math.floor(r+(o-s)*l/o+c)),a)}var h=t[2*r+a],f=n,d=i;for(B(e,t,n,r),t[2*i+a]>h&&B(e,t,n,i);f<d;){for(B(e,t,f,d),f++,d--;t[2*f+a]<h;)f++;for(;t[2*d+a]>h;)d--}t[2*n+a]===h?B(e,t,n,d):B(e,t,++d,i),d<=r&&(n=d+1),r<=d&&(i=d-1)}}function B(e,t,r,n){N(e,r,n),N(t,2*r,2*n),N(t,2*r+1,2*n+1)}function N(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function z(e,t,r,n){var i=e-r,a=t-n;return i*i+a*a}E.fromVectorTileJs=T,E.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new w(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return T({layers:r})},E.GeoJSONWrapper=S;var F,j=function(e){return e[0]},U=function(e){return e[1]},V=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:U,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Float64Array;v(this,e),this.nodeSize=i,this.points=t;for(var o=t.length<65536?Uint16Array:Uint32Array,s=this.ids=new o(t.length),u=this.coords=new a(2*t.length),l=0;l<t.length;l++)s[l]=l,u[2*l]=r(t[l]),u[2*l+1]=n(t[l]);L(s,u,i,0,s.length-1,0)}return m(e,[{key:"range",value:function(e,t,r,n){return function(e,t,r,n,i,a,o){for(var s,u,l=[0,e.length-1,0],c=[];l.length;){var h=l.pop(),f=l.pop(),d=l.pop();if(f-d<=o)for(var p=d;p<=f;p++)s=t[2*p],u=t[2*p+1],s>=r&&s<=i&&u>=n&&u<=a&&c.push(e[p]);else{var y=Math.floor((d+f)/2);s=t[2*y],u=t[2*y+1],s>=r&&s<=i&&u>=n&&u<=a&&c.push(e[y]);var v=(h+1)%2;(0===h?r<=s:n<=u)&&(l.push(d),l.push(y-1),l.push(v)),(0===h?i>=s:a>=u)&&(l.push(y+1),l.push(f),l.push(v))}}return c}(this.ids,this.coords,e,t,r,n,this.nodeSize)}},{key:"within",value:function(e,t,r){return function(e,t,r,n,i,a){for(var o=[0,e.length-1,0],s=[],u=i*i;o.length;){var l=o.pop(),c=o.pop(),h=o.pop();if(c-h<=a)for(var f=h;f<=c;f++)z(t[2*f],t[2*f+1],r,n)<=u&&s.push(e[f]);else{var d=Math.floor((h+c)/2),p=t[2*d],y=t[2*d+1];z(p,y,r,n)<=u&&s.push(e[d]);var v=(l+1)%2;(0===l?r-i<=p:n-i<=y)&&(o.push(h),o.push(d-1),o.push(v)),(0===l?r+i>=p:n+i>=y)&&(o.push(d+1),o.push(c),o.push(v))}}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}}]),e}(),q={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(e){return e}},G=Math.fround||(F=new Float32Array(1),function(e){return F[0]=+e,F[0]}),K=function(){function e(t){v(this,e),this.options=$(Object.create(q),t),this.trees=new Array(this.options.maxZoom+1)}return m(e,[{key:"load",value:function(e){var t=this.options,r=t.log,n=t.minZoom,i=t.maxZoom,a=t.nodeSize;r&&console.time("total time");var o="prepare ".concat(e.length," points");r&&console.time(o),this.points=e;for(var s=[],u=0;u<e.length;u++)e[u].geometry&&s.push(W(e[u],u));this.trees[i+1]=new V(s,ee,te,a,Float32Array),r&&console.timeEnd(o);for(var l=i;l>=n;l--){var c=+Date.now();s=this._cluster(s,l),this.trees[l]=new V(s,ee,te,a,Float32Array),r&&console.log("z%d: %d clusters in %dms",l,s.length,+Date.now()-c)}return r&&console.timeEnd("total time"),this}},{key:"getClusters",value:function(e,t){var r=((e[0]+180)%360+360)%360-180,n=Math.max(-90,Math.min(90,e[1])),i=180===e[2]?180:((e[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){var o=this.getClusters([r,n,180,a],t),s=this.getClusters([-180,n,i,a],t);return o.concat(s)}var u,l=this.trees[this._limitZoom(t)],c=l.range(X(r),Q(a),X(i),Q(n)),h=[],d=f(c);try{for(d.s();!(u=d.n()).done;){var p=u.value,y=l.points[p];h.push(y.numPoints?Z(y):this.points[y.index])}}catch(v){d.e(v)}finally{d.f()}return h}},{key:"getChildren",value:function(e){var t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);var a=i.points[t];if(!a)throw new Error(n);var o,s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),u=i.within(a.x,a.y,s),l=[],c=f(u);try{for(c.s();!(o=c.n()).done;){var h=o.value,d=i.points[h];d.parentId===e&&l.push(d.numPoints?Z(d):this.points[d.index])}}catch(p){c.e(p)}finally{c.f()}if(0===l.length)throw new Error(n);return l}},{key:"getLeaves",value:function(e,t,r){var n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}},{key:"getTile",value:function(e,t,r){var n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),a=this.options,o=a.extent,s=a.radius/o,u=(r-s)/i,l=(r+1+s)/i,c={features:[]};return this._addTileFeatures(n.range((t-s)/i,u,(t+1+s)/i,l),n.points,t,r,i,c),0===t&&this._addTileFeatures(n.range(1-s/i,u,1,l),n.points,i,r,i,c),t===i-1&&this._addTileFeatures(n.range(0,u,s/i,l),n.points,-1,r,i,c),c.features.length?c:null}},{key:"getClusterExpansionZoom",value:function(e){for(var t=this._getOriginZoom(e)-1;t<=this.options.maxZoom;){var r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}},{key:"_appendLeaves",value:function(e,t,r,n,i){var a,o=this.getChildren(t),s=f(o);try{for(s.s();!(a=s.n()).done;){var u=a.value,l=u.properties;if(l&&l.cluster?i+l.point_count<=n?i+=l.point_count:i=this._appendLeaves(e,l.cluster_id,r,n,i):i<n?i++:e.push(u),e.length===r)break}}catch(c){s.e(c)}finally{s.f()}return i}},{key:"_addTileFeatures",value:function(e,t,r,n,i,a){var o,s=f(e);try{for(s.s();!(o=s.n()).done;){var u=t[o.value],l=u.numPoints,c=void 0,h=void 0,d=void 0;if(l)c=Y(u),h=u.x,d=u.y;else{var p=this.points[u.index];c=p.properties,h=X(p.geometry.coordinates[0]),d=Q(p.geometry.coordinates[1])}var y={type:1,geometry:[[Math.round(this.options.extent*(h*i-r)),Math.round(this.options.extent*(d*i-n))]],tags:c},v=void 0;l?v=u.id:this.options.generateId?v=u.index:this.points[u.index].id&&(v=this.points[u.index].id),void 0!==v&&(y.id=v),a.features.push(y)}}catch(m){s.e(m)}finally{s.f()}}},{key:"_limitZoom",value:function(e){return Math.max(this.options.minZoom,Math.min(+e,this.options.maxZoom+1))}},{key:"_cluster",value:function(e,t){for(var r=[],n=this.options,i=n.radius,a=n.extent,o=n.reduce,s=n.minPoints,u=i/(a*Math.pow(2,t)),l=0;l<e.length;l++){var c=e[l];if(!(c.zoom<=t)){c.zoom=t;var h,d=this.trees[t+1],p=d.within(c.x,c.y,u),y=c.numPoints||1,v=y,m=f(p);try{for(m.s();!(h=m.n()).done;){var g=h.value,_=d.points[g];_.zoom>t&&(v+=_.numPoints||1)}}catch(O){m.e(O)}finally{m.f()}if(v>=s){var b,w=c.x*y,x=c.y*y,k=o&&y>1?this._map(c,!0):null,E=(l<<5)+(t+1)+this.points.length,S=f(p);try{for(S.s();!(b=S.n()).done;){var T=b.value,A=d.points[T];if(!(A.zoom<=t)){A.zoom=t;var C=A.numPoints||1;w+=A.x*C,x+=A.y*C,A.parentId=E,o&&(k||(k=this._map(c,!0)),o(k,this._map(A)))}}}catch(O){S.e(O)}finally{S.f()}c.parentId=E,r.push(H(w/v,x/v,E,v,k))}else if(r.push(c),v>1){var I,R=f(p);try{for(R.s();!(I=R.n()).done;){var M=I.value,P=d.points[M];P.zoom<=t||(P.zoom=t,r.push(P))}}catch(O){R.e(O)}finally{R.f()}}}}return r}},{key:"_getOriginId",value:function(e){return e-this.points.length>>5}},{key:"_getOriginZoom",value:function(e){return(e-this.points.length)%32}},{key:"_map",value:function(e,t){if(e.numPoints)return t?$({},e.properties):e.properties;var r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?$({},n):n}}]),e}();function H(e,t,r,n,i){return{x:G(e),y:G(t),zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function W(e,t){var r=h(e.geometry.coordinates,2),n=r[0],i=r[1];return{x:G(X(n)),y:G(Q(i)),zoom:1/0,index:t,parentId:-1}}function Z(e){return{type:"Feature",id:e.id,properties:Y(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),J(e.y)]}};var t}function Y(e){var t=e.numPoints,r=t>=1e4?"".concat(Math.round(t/1e3),"k"):t>=1e3?Math.round(t/100)/10+"k":t;return $($({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function X(e){return e/360+.5}function Q(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function J(e){var t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function $(e,t){for(var r in t)e[r]=t[r];return e}function ee(e){return e.x}function te(e){return e.y}function re(e,t,r,n){for(var i,a=n,o=r-t>>1,s=r-t,u=e[t],l=e[t+1],c=e[r],h=e[r+1],f=t+3;f<r;f+=3){var d=ne(e[f],e[f+1],u,l,c,h);if(d>a)i=f,a=d;else if(d===a){var p=Math.abs(f-o);p<s&&(i=f,s=p)}}a>n&&(i-t>3&&re(e,t,i,n),e[i+2]=a,r-i>3&&re(e,i,r,n))}function ne(e,t,r,n,i,a){var o=i-r,s=a-n;if(0!==o||0!==s){var u=((e-r)*o+(t-n)*s)/(o*o+s*s);u>1?(r=i,n=a):u>0&&(r+=o*u,n+=s*u)}return(o=e-r)*o+(s=t-n)*s}function ie(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)ae(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)ae(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)ae(e,t[n][i])}(i),i}function ae(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function oe(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,a=t.geometry.type,o=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],u=t.id;if(r.promoteId?u=t.properties[r.promoteId]:r.generateId&&(u=n||0),"Point"===a)se(i,s);else if("MultiPoint"===a)for(var l=0;l<i.length;l++)se(i[l],s);else if("LineString"===a)ue(i,s,o,!1);else if("MultiLineString"===a){if(r.lineMetrics){for(l=0;l<i.length;l++)ue(i[l],s=[],o,!1),e.push(ie(u,"LineString",s,t.properties));return}le(i,s,o,!1)}else if("Polygon"===a)le(i,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(l=0;l<t.geometry.geometries.length;l++)oe(e,{id:u,geometry:t.geometry.geometries[l],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(l=0;l<i.length;l++){var c=[];le(i[l],c,o,!0),s.push(c)}}e.push(ie(u,a,s,t.properties))}}function se(e,t){t.push(ce(e[0])),t.push(he(e[1])),t.push(0)}function ue(e,t,r,n){for(var i,a,o=0,s=0;s<e.length;s++){var u=ce(e[s][0]),l=he(e[s][1]);t.push(u),t.push(l),t.push(0),s>0&&(o+=n?(i*l-u*a)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(l-a,2))),i=u,a=l}var c=t.length-3;t[2]=1,re(t,0,c,r),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function le(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];ue(e[i],a,r,n),t.push(a)}}function ce(e){return e/360+.5}function he(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function fe(e,t,r,n,i,a,o,s){if(n/=t,a>=(r/=t)&&o<n)return e;if(o<r||a>=n)return null;for(var u=[],l=0;l<e.length;l++){var c=e[l],h=c.geometry,f=c.type,d=0===i?c.minX:c.minY,p=0===i?c.maxX:c.maxY;if(d>=r&&p<n)u.push(c);else if(!(p<r||d>=n)){var y=[];if("Point"===f||"MultiPoint"===f)de(h,y,r,n,i);else if("LineString"===f)pe(h,y,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===f)ve(h,y,r,n,i,!1);else if("Polygon"===f)ve(h,y,r,n,i,!0);else if("MultiPolygon"===f)for(var v=0;v<h.length;v++){var m=[];ve(h[v],m,r,n,i,!0),m.length&&y.push(m)}if(y.length){if(s.lineMetrics&&"LineString"===f){for(v=0;v<y.length;v++)u.push(ie(c.id,f,y[v],c.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===y.length?(f="LineString",y=y[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===y.length?"Point":"MultiPoint"),u.push(ie(c.id,f,y,c.tags))}}}return u.length?u:null}function de(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var o=e[a+i];o>=r&&o<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function pe(e,t,r,n,i,a,o){for(var s,u,l=ye(e),c=0===i?ge:_e,h=e.start,f=0;f<e.length-3;f+=3){var d=e[f],p=e[f+1],y=e[f+2],v=e[f+3],m=e[f+4],g=0===i?d:p,_=0===i?v:m,b=!1;o&&(s=Math.sqrt(Math.pow(d-v,2)+Math.pow(p-m,2))),g<r?_>r&&(u=c(l,d,p,v,m,r),o&&(l.start=h+s*u)):g>n?_<n&&(u=c(l,d,p,v,m,n),o&&(l.start=h+s*u)):me(l,d,p,y),_<r&&g>=r&&(u=c(l,d,p,v,m,r),b=!0),_>n&&g<=n&&(u=c(l,d,p,v,m,n),b=!0),!a&&b&&(o&&(l.end=h+s*u),t.push(l),l=ye(e)),o&&(h+=s)}var w=e.length-3;d=e[w],p=e[w+1],y=e[w+2],(g=0===i?d:p)>=r&&g<=n&&me(l,d,p,y),w=l.length-3,a&&w>=3&&(l[w]!==l[0]||l[w+1]!==l[1])&&me(l,l[0],l[1],l[2]),l.length&&t.push(l)}function ye(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function ve(e,t,r,n,i,a){for(var o=0;o<e.length;o++)pe(e[o],t,r,n,i,a,!1)}function me(e,t,r,n){e.push(t),e.push(r),e.push(n)}function ge(e,t,r,n,i,a){var o=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*o),e.push(1),o}function _e(e,t,r,n,i,a){var o=(a-r)/(i-r);return e.push(t+(n-t)*o),e.push(a),e.push(1),o}function be(e,t){for(var r=[],n=0;n<e.length;n++){var i,a=e[n],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)i=we(a.geometry,t);else if("MultiLineString"===o||"Polygon"===o){i=[];for(var s=0;s<a.geometry.length;s++)i.push(we(a.geometry[s],t))}else if("MultiPolygon"===o)for(i=[],s=0;s<a.geometry.length;s++){for(var u=[],l=0;l<a.geometry[s].length;l++)u.push(we(a.geometry[s][l],t));i.push(u)}r.push(ie(a.id,o,i,a.tags))}return r}function we(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function xe(e,t){if(e.transformed)return e;var r,n,i,a=1<<e.z,o=e.x,s=e.y;for(r=0;r<e.features.length;r++){var u=e.features[r],l=u.geometry,c=u.type;if(u.geometry=[],1===c)for(n=0;n<l.length;n+=2)u.geometry.push(ke(l[n],l[n+1],t,a,o,s));else for(n=0;n<l.length;n++){var h=[];for(i=0;i<l[n].length;i+=2)h.push(ke(l[n][i],l[n][i+1],t,a,o,s));u.geometry.push(h)}}return e.transformed=!0,e}function ke(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function Ee(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,Se(o,e[s],a,i);var u=e[s].minX,l=e[s].minY,c=e[s].maxX,h=e[s].maxY;u<o.minX&&(o.minX=u),l<o.minY&&(o.minY=l),c>o.maxX&&(o.maxX=c),h>o.maxY&&(o.maxY=h)}return o}function Se(e,t,r,n){var i=t.geometry,a=t.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<i.length;s+=3)o.push(i[s]),o.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)Te(o,i,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<i.length;s++)Te(o,i[s],e,r,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var u=0;u<i.length;u++){var l=i[u];for(s=0;s<l.length;s++)Te(o,l[s],e,r,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===a&&n.lineMetrics){for(var h in c={},t.tags)c[h]=t.tags[h];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==t.id&&(f.id=t.id),e.features.push(f)}}function Te(e,t,r,n,i,a){var o=n*n;if(n>0&&t.size<(i?o:n))r.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===n||t[u+2]>o)&&(r.numSimplified++,s.push(t[u]),s.push(t[u+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=s}}(s,a),e.push(s)}}function Ae(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)oe(r,e.features[n],t,n);else oe(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var r=t.buffer/t.extent,n=e,i=fe(e,1,-1-r,r,0,-1,2,t),a=fe(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=fe(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=be(i,1).concat(n)),a&&(n=n.concat(be(a,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ce(e,t,r){return 32*((1<<e)*r+t)+e}function Ie(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);var i=new _(n.features),a=E(i);0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),t(null,{vectorTile:i,rawData:a.buffer})}Ae.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ae.prototype.splitTile=function(e,t,r,n,i,a,o){for(var s=[e,t,r,n],u=this.options,l=u.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,h=Ce(t,r,n),f=this.tiles[h];if(!f&&(l>1&&console.time("creation"),f=this.tiles[h]=Ee(e,t,r,n,u),this.tileCoords.push({z:t,x:r,y:n}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(f.source=e,i){if(t===u.maxZoom||t===i)continue;var p=1<<i-t;if(r!==Math.floor(a/p)||n!==Math.floor(o/p))continue}else if(t===u.indexMaxZoom||f.numPoints<=u.indexMaxPoints)continue;if(f.source=null,0!==e.length){l>1&&console.time("clipping");var y,v,m,g,_,b,w=.5*u.buffer/u.extent,x=.5-w,k=.5+w,E=1+w;y=v=m=g=null,_=fe(e,c,r-w,r+k,0,f.minX,f.maxX,u),b=fe(e,c,r+x,r+E,0,f.minX,f.maxX,u),e=null,_&&(y=fe(_,c,n-w,n+k,1,f.minY,f.maxY,u),v=fe(_,c,n+x,n+E,1,f.minY,f.maxY,u),_=null),b&&(m=fe(b,c,n-w,n+k,1,f.minY,f.maxY,u),g=fe(b,c,n+x,n+E,1,f.minY,f.maxY,u),b=null),l>1&&console.timeEnd("clipping"),s.push(y||[],t+1,2*r,2*n),s.push(v||[],t+1,2*r,2*n+1),s.push(m||[],t+1,2*r+1,2*n),s.push(g||[],t+1,2*r+1,2*n+1)}}},Ae.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e,s=Ce(e,t=(t%o+o)%o,r);if(this.tiles[s])return xe(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var u,l=e,c=t,h=r;!u&&l>0;)l--,c=Math.floor(c/2),h=Math.floor(h/2),u=this.tiles[Ce(l,c,h)];return u&&u.source?(a>1&&console.log("found parent tile z%d-%d-%d",l,c,h),a>1&&console.time("drilling down"),this.splitTile(u.source,l,c,h,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[s]?xe(this.tiles[s],i):null):null};var Re=function(t){p(n,t);var r=y(n);function n(e,t,i,a,o){var s;return v(this,n),s=r.call(this,e,t,i,a,Ie),o&&(s.loadGeoJSON=o),s}return m(n,[{key:"loadData",value:function(t,r){var n=this,i=t&&t.request,a=i&&i.collectResourceTiming;this.loadGeoJSON(t,(function(o,s){if(o||!s)return r(o);if("object"!=typeof s)return r(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));u(s,!0);try{if(t.filter){var l=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===l.result)throw new Error(l.value.map((function(e){return"".concat(e.key,": ").concat(e.message)})).join(", "));var c=s.features.filter((function(e){return l.value.evaluate({zoom:0},e)}));s={type:"FeatureCollection",features:c}}n._geoJSONIndex=t.cluster?new K(function(t){var r=t.superclusterOptions,n=t.clusterProperties;if(!n||!r)return r;for(var i={},a={},o={accumulated:null,zoom:0},s={properties:null},u=Object.keys(n),l=0,c=u;l<c.length;l++){var d=c[l],p=h(n[d],2),y=p[0],v=p[1],m=e.createExpression(v),g=e.createExpression("string"==typeof y?[y,["accumulated"],["get",d]]:y);i[d]=m.value,a[d]=g.value}return r.map=function(e){s.properties=e;var t,r={},n=f(u);try{for(n.s();!(t=n.n()).done;){var a=t.value;r[a]=i[a].evaluate(o,s)}}catch(l){n.e(l)}finally{n.f()}return r},r.reduce=function(e,t){s.properties=t;var r,n=f(u);try{for(n.s();!(r=n.n()).done;){var i=r.value;o.accumulated=e[i],e[i]=a[i].evaluate(o,s)}}catch(l){n.e(l)}finally{n.f()}},r}(t)).load(s.features):function(e,t){return new Ae(e,t)}(s,t.geojsonVtOptions)}catch(o){return r(o)}n.loaded={};var d={};if(a){var p=e.getPerformanceMeasurement(i);p&&(d.resourceTiming={},d.resourceTiming[t.source]=JSON.parse(JSON.stringify(p)))}r(null,d)}))}},{key:"reloadTile",value:function(e,t){var r=this.loaded;return r&&r[e.uid]?o(s(n.prototype),"reloadTile",this).call(this,e,t):this.loadTile(e,t)}},{key:"loadGeoJSON",value:function(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object.")))}}}},{key:"getClusterExpansionZoom",value:function(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}},{key:"getClusterChildren",value:function(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}},{key:"getClusterLeaves",value:function(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}]),n}(e.VectorTileWorkerSource),Me=function(){function t(r){var n=this;v(this,t),this.self=r,this.actor=new e.Actor(r,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:Re},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(n.workerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));n.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}return m(t,[{key:"checkIfReady",value:function(e,t,r){r()}},{key:"setReferrer",value:function(e,t){this.referrer=t}},{key:"spriteLoaded",value:function(t,r){for(var n in this.isSpriteLoaded=r,this.workerSources[t]){var i=this.workerSources[t][n];for(var a in i)i[a]instanceof e.VectorTileWorkerSource&&(i[a].isSpriteLoaded=r,i[a].fire(new e.Event("isSpriteLoaded")))}}},{key:"setImages",value:function(e,t,r){for(var n in this.availableImages[e]=t,this.workerSources[e]){var i=this.workerSources[e][n];for(var a in i)i[a].availableImages=t}r()}},{key:"enableTerrain",value:function(e,t,r){this.terrain=t,r()}},{key:"setLayers",value:function(e,t,r){this.getLayerIndex(e).replace(t),r()}},{key:"updateLayers",value:function(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()}},{key:"loadTile",value:function(t,r,n){var i=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;this.getWorkerSource(t,r.type,r.source).loadTile(i,n)}},{key:"loadDEMTile",value:function(t,r,n){var i=this.enableTerrain?e.extend({buildQuadTree:this.terrain},r):r;this.getDEMWorkerSource(t,r.source).loadTile(i,n)}},{key:"reloadTile",value:function(t,r,n){var i=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;this.getWorkerSource(t,r.type,r.source).reloadTile(i,n)}},{key:"abortTile",value:function(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)}},{key:"removeTile",value:function(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)}},{key:"removeSource",value:function(e,t,r){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}}},{key:"loadWorkerSource",value:function(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}}},{key:"syncRTLPluginState",value:function(t,r,n){try{e.plugin.setState(r);var i=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=i){this.self.importScripts(i);var a=e.plugin.isParsed();n(a?void 0:new Error("RTL Text Plugin failed to import scripts from ".concat(i)),a)}}catch(e){n(e.toString())}}},{key:"getAvailableImages",value:function(e){var t=this.availableImages[e];return t||(t=[]),t}},{key:"getLayerIndex",value:function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}},{key:"getWorkerSource",value:function(e,t,r){var n=this;return this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),this.workerSources[e][t][r]||(this.workerSources[e][t][r]=new this.workerSourceTypes[t]({send:function(t,r,i,a,o,s){n.actor.send(t,r,i,e,o,s)},scheduler:this.actor.scheduler},this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded)),this.workerSources[e][t][r]}},{key:"getDEMWorkerSource",value:function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new a),this.demWorkerSources[e][t]}},{key:"enforceCacheSizeLimit",value:function(t,r){e.enforceCacheSizeLimit(r)}},{key:"getWorkerPerformanceMetrics",value:function(e,t,r){r(void 0,void 0)}}]),t}();return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Me(self)),Me})),g(["./shared"],(function(e){var t=r;function r(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}()?(void 0===a[t=e&&e.failIfMajorPerformanceCaveat]&&(a[t]=function(e){var t,n=function(e){var t=document.createElement("canvas"),n=Object.create(r.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,t.getContext("webgl",n)||t.getContext("experimental-webgl",n)}(e);if(!n)return!1;try{t=n.createShader(n.VERTEX_SHADER)}catch(e){return!1}return!(!t||n.isContextLost())&&(n.shaderSource(t,"void main() {}"),n.compileShader(t),!0===n.getShaderParameter(t,n.COMPILE_STATUS))}(t)),a[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var a={};function l(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!l(e[r],t[r]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(!l(e[n],t[n]))return!1;return!0}return e===t}r.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};var d,g={create:function(t,r,n){var i=e.window.document.createElement(t);return void 0!==r&&(i.className=r),n&&n.appendChild(i),i},createNS:function(t,r){return e.window.document.createElementNS(t,r)}},_=e.window.document&&e.window.document.documentElement.style,b=_&&void 0!==_.userSelect?"userSelect":"WebkitUserSelect";g.disableDrag=function(){_&&b&&(d=_[b],_[b]="none")},g.enableDrag=function(){_&&b&&(_[b]=d)},g.setTransform=function(e,t){e.style.transform=t};var w=!1;try{var x=Object.defineProperty({},"passive",{get:function(){w=!0}});e.window.addEventListener("test",x,x),e.window.removeEventListener("test",x,x)}catch(e){w=!1}g.addEventListener=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.addEventListener(t,r,"passive"in n&&w?n:n.capture)},g.removeEventListener=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.removeEventListener(t,r,"passive"in n&&w?n:n.capture)};var k=function t(r){r.preventDefault(),r.stopPropagation(),e.window.removeEventListener("click",t,!0)};function E(t,r,n){var i=t.offsetWidth===r.width?1:t.offsetWidth/r.width;return new e.pointGeometry((n.clientX-r.left)*i,(n.clientY-r.top)*i)}g.suppressClick=function(){e.window.addEventListener("click",k,!0),e.window.setTimeout((function(){e.window.removeEventListener("click",k,!0)}),0)},g.mousePos=function(e,t){var r=e.getBoundingClientRect();return E(e,r,t)},g.touchPos=function(e,t){for(var r=e.getBoundingClientRect(),n=[],i=0;i<t.length;i++)n.push(E(e,r,t[i]));return n},g.mouseButton=function(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button},g.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var S=function(){function t(e,r){v(this,t),this.pos=e,this.dir=r}return m(t,[{key:"intersectsPlane",value:function(t,r,n){var i=e.dot(r,this.dir);if(Math.abs(i)<1e-6)return!1;var a=e.dot(e.sub(e.create(),t,this.pos),r)/i,o=e.scaleAndAdd(e.create(),this.pos,this.dir,a);return e.copy(n,o),!0}}]),t}(),T=function(){function t(e,r){v(this,t),this.points=e,this.planes=r}return m(t,null,[{key:"fromInvProjectionMatrix",value:function(r,n,i){var a=Math.pow(2,i),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(t){var i=e.transformMat4([],t,r),o=1/i[3]/n*a;return e.mul(i,i,[o,o,1/i[3],o])})),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(t){var r=e.sub([],o[t[0]],o[t[1]]),n=e.sub([],o[t[2]],o[t[1]]),i=e.normalize([],e.cross([],r,n)),a=-e.dot(i,o[t[1]]);return i.concat(a)}));return new t(o,s)}}]),t}(),A=function(){function t(r,n){v(this,t),this.min=r,this.max=n,this.center=e.scale([],e.add([],this.min,this.max),.5)}return m(t,[{key:"quadrant",value:function(r){for(var n=[r%2==0,r<2],i=e.clone(this.min),a=e.clone(this.max),o=0;o<n.length;o++)i[o]=n[o]?this.min[o]:this.center[o],a[o]=n[o]?this.center[o]:this.max[o];return a[2]=this.max[2],new t(i,a)}},{key:"distanceX",value:function(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}},{key:"distanceY",value:function(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}},{key:"distanceZ",value:function(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}},{key:"intersects",value:function(t){for(var r=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],n=!0,i=0;i<t.planes.length;i++){for(var a=t.planes[i],o=0,s=0;s<r.length;s++)o+=e.dot$1(a,r[s])>=0;if(0===o)return 0;o!==r.length&&(n=!1)}if(n)return 2;for(var u=0;u<3;u++){for(var l=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0;h<t.points.length;h++){var f=t.points[h][u]-this.min[u];l=Math.min(l,f),c=Math.max(c,f)}if(c<0||l>this.max[u]-this.min[u])return 0}return 1}}]),t}();function C(e){var t=e.userImage;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}var I=function(t){p(n,t);var r=y(n);function n(){var t;return v(this,n),(t=r.call(this)).images={},t.updatedImages={},t.callbackDispatchedThisFrame={},t.loaded=!1,t.requestors=[],t.patterns={},t.atlasImage=new e.RGBAImage({width:1,height:1}),t.dirty=!0,t}return m(n,[{key:"isLoaded",value:function(){return this.loaded}},{key:"setLoaded",value:function(e){if(this.loaded!==e&&(this.loaded=e,e)){var t,r=f(this.requestors);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=n.ids,a=n.callback;this._notify(i,a)}}catch(o){r.e(o)}finally{r.f()}this.requestors=[]}}},{key:"getImage",value:function(e){return this.images[e]}},{key:"addImage",value:function(e,t){this._validate(e,t)&&(this.images[e]=t)}},{key:"_validate",value:function(t,r){var n=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchX" value')))),n=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "stretchY" value')))),n=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error('Image "'.concat(t,'" has invalid "content" value')))),n=!1),n}},{key:"_validateStretch",value:function(e,t){if(!e)return!0;var r,n=0,i=f(e);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a[0]<n||a[1]<a[0]||t<a[1])return!1;n=a[1]}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"_validateContent",value:function(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}},{key:"updateImage",value:function(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}},{key:"removeImage",value:function(e){var t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}},{key:"listImages",value:function(){return Object.keys(this.images)}},{key:"getImages",value:function(e,t){var r=!0;if(!this.isLoaded()){var n,i=f(e);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.images[a]||(r=!1)}}catch(o){i.e(o)}finally{i.f()}}this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})}},{key:"_notify",value:function(t,r){var n,i={},a=f(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;this.images[o]||this.fire(new e.Event("styleimagemissing",{id:o}));var s=this.images[o];s?i[o]={data:s.data.clone(),pixelRatio:s.pixelRatio,sdf:s.sdf,version:s.version,stretchX:s.stretchX,stretchY:s.stretchY,content:s.content,hasRenderCallback:Boolean(s.userImage&&s.userImage.render)}:e.warnOnce('Image "'.concat(o,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}}catch(u){a.e(u)}finally{a.f()}r(null,i)}},{key:"getPixelSize",value:function(){var e=this.atlasImage;return{width:e.width,height:e.height}}},{key:"getPattern",value:function(t){var r=this.patterns[t],n=this.getImage(t);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{var i={w:n.data.width+2,h:n.data.height+2,x:0,y:0},a=new e.ImagePosition(i,n);this.patterns[t]={bin:i,position:a}}return this._updatePatternAtlas(),this.patterns[t].position}},{key:"bind",value:function(t){var r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}},{key:"_updatePatternAtlas",value:function(){var t=[];for(var r in this.patterns)t.push(this.patterns[r].bin);var n=e.potpack(t),i=n.w,a=n.h,o=this.atlasImage;for(var s in o.resize({width:i||1,height:a||1}),this.patterns){var u=this.patterns[s].bin,l=u.x+1,c=u.y+1,h=this.images[s].data,f=h.width,d=h.height;e.RGBAImage.copy(h,o,{x:0,y:0},{x:l,y:c},{width:f,height:d}),e.RGBAImage.copy(h,o,{x:0,y:d-1},{x:l,y:c-1},{width:f,height:1}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:l,y:c+d},{width:f,height:1}),e.RGBAImage.copy(h,o,{x:f-1,y:0},{x:l-1,y:c},{width:1,height:d}),e.RGBAImage.copy(h,o,{x:0,y:0},{x:l+f,y:c},{width:1,height:d})}this.dirty=!0}},{key:"beginFrame",value:function(){this.callbackDispatchedThisFrame={}}},{key:"dispatchRenderCallbacks",value:function(e){var t,r=f(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(!this.callbackDispatchedThisFrame[n]){this.callbackDispatchedThisFrame[n]=!0;var i=this.images[n];C(i)&&this.updateImage(n,i)}}}catch(a){r.e(a)}finally{r.f()}}}]),n}(e.Evented),R=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new(function(){function t(){v(this,t),this.specification=e.spec.light.position}return m(t,[{key:"possiblyEvaluate",value:function(t,r){return function(t){var r=h(t,3),n=r[0],i=r[1],a=r[2],o=e.degToRad(i+90),s=e.degToRad(a);return{x:n*Math.cos(o)*Math.sin(s),y:n*Math.sin(o)*Math.sin(s),z:n*Math.cos(s),azimuthal:i,polar:a}}(t.expression.evaluate(r))}},{key:"interpolate",value:function(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n),azimuthal:e.number(t.azimuthal,r.azimuthal,n),polar:e.number(t.polar,r.polar,n)}}}]),t}()),color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)}),M="-transition",P=function(t){p(n,t);var r=y(n);function n(t){var i;return v(this,n),(i=r.call(this))._transitionable=new e.Transitionable(R),i.setLight(t),i._transitioning=i._transitionable.untransitioned(),i}return m(n,[{key:"getLight",value:function(){return this._transitionable.serialize()}},{key:"setLight",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateLight,t,r))for(var n in t){var i=t[n];e.endsWith(n,M)?this._transitionable.setTransition(n.slice(0,-M.length),i):this._transitionable.setValue(n,i)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}]),n}(e.Evented),O=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)}),L="-transition",D=function(t){p(n,t);var r=y(n);function n(t){var i;return v(this,n),(i=r.call(this))._transitionable=new e.Transitionable(O),i.set(t),i._transitioning=i._transitionable.untransitioned(),i}return m(n,[{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){for(var r in t){var n=t[r];e.endsWith(r,L)?this._transitionable.setTransition(r.slice(0,-L.length),n):this._transitionable.setValue(r,n)}}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}}]),n}(e.Evented);function B(t,r,n,i){var a=e.smoothstep(45,65,n),o=N(t,i),s=h(o,2),u=s[0],l=s[1],c=e.length(r),f=1-Math.min(1,Math.exp((c-u)/(l-u)*-6));return f*=f*f,(f=Math.min(1,1.00747*f))*a*t.alpha}function N(e,t){var r=.5/Math.tan(.5*t);return[e.range[0]+r,e.range[1]+r]}var z=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"])}),F="-transition",j=function(t){p(n,t);var r=y(n);function n(t){var i;return v(this,n),(i=r.call(this))._transitionable=new e.Transitionable(z),i.set(t),i._transitioning=i._transitionable.untransitioned(),i}return m(n,[{key:"get",value:function(){return this._transitionable.serialize()}},{key:"set",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(e.validateFog,t,r))for(var n in t){var i=t[n];e.endsWith(n,F)?this._transitionable.setTransition(n.slice(0,-F.length),i):this._transitionable.setValue(n,i)}}},{key:"getOpacity",value:function(t){var r=this.properties&&this.properties.get("color")||1;return e.smoothstep(45,65,t)*r.a}},{key:"getOpacityAtLatLng",value:function(t,r){return function(t,r,n){var i=e.MercatorCoordinate.fromLngLat(r),a=n.elevation?n.elevation.getAtPointOrZero(i):0,o=[i.x,i.y,a];return e.transformMat4$1(o,o,n.mercatorFogMatrix),B(t,o,n.pitch,n._fov)}(this.state,t,r)}},{key:"getFovAdjustedRange",value:function(e){return N(this.state,e)}},{key:"updateTransitions",value:function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}},{key:"hasTransition",value:function(){return this._transitioning.hasTransition()}},{key:"recalculate",value:function(e){this.properties=this._transitioning.possiblyEvaluate(e)}},{key:"_validate",value:function(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}},{key:"state",get:function(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}}]),n}(e.Evented),U=function(){function t(r,n){var i=this;v(this,t),this.workerPool=r,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var a=this.workerPool.acquire(this.id),o=0;o<a.length;o++){var s=new t.Actor(a[o],n,this.id);s.name="Worker ".concat(o),this.actors.push(s)}this.ready=!1,this.broadcast("checkIfReady",null,(function(){i.ready=!0}))}return m(t,[{key:"broadcast",value:function(t,r,n){e.asyncAll(this.actors,(function(e,n){e.send(t,r,n)}),n=n||function(){})}},{key:"getActor",value:function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}},{key:"remove",value:function(){this.actors.forEach((function(e){e.remove()})),this.actors=[],this.workerPool.release(this.id)}}]),t}();function V(t,r,n){return r*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}U.Actor=e.Actor;var q=function(){function t(e,r,n,i){v(this,t),this.screenBounds=e,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=n,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map((function(e){return i.pointCoordinate3D(e)})),this.cameraGeometry=this.bufferedCameraGeometry(0)}return m(t,[{key:"isPointQuery",value:function(){return 1===this.screenBounds.length}},{key:"bufferedScreenGeometry",value:function(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}},{key:"bufferedCameraGeometry",value:function(t){var r=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.pointGeometry(1,1)):this.screenBounds[1],i=e.polygonizeBounds(r,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<n.x?i.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?i[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(i[3]=this.cameraPoint)),e.bufferConvexPolygon(i,t)}},{key:"containsTile",value:function(t,r,n){var i,a=t.queryPadding+1,o=n?this._bufferedCameraMercator(a,r).map((function(e){return t.tileID.getTilePoint(e)})):this._bufferedScreenMercator(a,r).map((function(e){return t.tileID.getTilePoint(e)})),s=this.screenGeometryMercator.map((function(e){return t.tileID.getTileVec3(e)})),u=s.map((function(t){return new e.pointGeometry(t[0],t[1])})),l=r.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),c=t.tileID.getTileVec3(l),h=s.map((function(t){var r=e.sub(t,t,c);return e.normalize(r,r),new S(c,r)})),f=V(t,1,r.zoom);if(e.polygonIntersectsBox(o,0,0,e.EXTENT,e.EXTENT))return{queryGeometry:this,tilespaceGeometry:u,tilespaceRays:h,bufferedTilespaceGeometry:o,bufferedTilespaceBounds:(i=e.getBounds(o),i.min.x=e.clamp(i.min.x,0,e.EXTENT),i.min.y=e.clamp(i.min.y,0,e.EXTENT),i.max.x=e.clamp(i.max.x,0,e.EXTENT),i.max.y=e.clamp(i.max.y,0,e.EXTENT),i),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:f}}},{key:"_bufferedScreenMercator",value:function(e,t){var r=G(e);if(this._screenRaycastCache[r])return this._screenRaycastCache[r];var n=this.bufferedScreenGeometry(e).map((function(e){return t.pointCoordinate3D(e)}));return this._screenRaycastCache[r]=n,n}},{key:"_bufferedCameraMercator",value:function(e,t){var r=G(e);if(this._cameraRaycastCache[r])return this._cameraRaycastCache[r];var n=this.bufferedCameraGeometry(e).map((function(e){return t.pointCoordinate3D(e)}));return this._cameraRaycastCache[r]=n,n}}],[{key:"createFromScreenPoints",value:function(r,n){var i,a;if(r instanceof e.pointGeometry||"number"==typeof r[0]){var o=e.pointGeometry.convert(r);i=[e.pointGeometry.convert(r)],a=n.isPointAboveHorizon(o)}else{var s=e.pointGeometry.convert(r[0]),u=e.pointGeometry.convert(r[1]);i=[s,u],a=e.polygonizeBounds(s,u).every((function(e){return n.isPointAboveHorizon(e)}))}return new t(i,n.getCameraPoint(),a,n)}}]),t}();function G(e){return 100*e|0}function K(t,r,n){var i=function(i,a){if(i)return n(i);if(a){var o=e.pick(e.extend(a,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);a.vector_layers&&(o.vectorLayers=a.vector_layers,o.vectorLayerIds=o.vectorLayers.map((function(e){return e.id}))),o.tiles=r.canonicalizeTileset(o,t.url),n(null,o)}};return t.url?e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url),e.ResourceType.Source),i):e.exported.frame((function(){return i(null,t)}))}var H,W=function(){function t(r,n,i){v(this,t),this.bounds=e.LngLatBounds.convert(this.validateBounds(r)),this.minzoom=n||0,this.maxzoom=i||24}return m(t,[{key:"validateBounds",value:function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}},{key:"contains",value:function(t){var r=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),i=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),a=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),o=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=n&&t.x<a&&t.y>=i&&t.y<o}}]),t}(),Z=function(){function e(t,r,n){v(this,e),this.context=t;var i=t.gl;this.buffer=i.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}return m(e,[{key:"bind",value:function(){this.context.bindElementBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),Y={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},X=function(){function e(t,r,n,i){v(this,e),this.length=r.length,this.attributes=n,this.itemSize=r.bytesPerElement,this.dynamicDraw=i,this.context=t;var a=t.gl;this.buffer=a.createBuffer(),t.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete r.arrayBuffer}return m(e,[{key:"bind",value:function(){this.context.bindVertexBuffer.set(this.buffer)}},{key:"updateData",value:function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}},{key:"enableAttributes",value:function(e,t){for(var r=0;r<this.attributes.length;r++){var n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}},{key:"setVertexAttribPointers",value:function(e,t,r){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],a=t.attributes[i.name];void 0!==a&&e.vertexAttribPointer(a,i.components,e[Y[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}},{key:"destroy",value:function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}]),e}(),Q=function(){function e(t){v(this,e),this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}return m(e,[{key:"get",value:function(){return this.current}},{key:"set",value:function(e){}},{key:"getDefault",value:function(){return this.default}},{key:"setDefault",value:function(){this.set(this.default)}}]),e}(),J=function(t){p(n,t);var r=y(n);function n(){return v(this,n),r.apply(this,arguments)}return m(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(Q),$=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return 1}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}]),r}(Q),ee=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return 0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}]),r}(Q),te=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return[!0,!0,!0,!0]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),r}(Q),re=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}]),r}(Q),ne=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return 255}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}]),r}(Q),ie=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return{func:this.gl.ALWAYS,ref:0,mask:255}}},{key:"set",value:function(e){var t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}]),r}(Q),ae=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){var e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}]),r}(Q),oe=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}}]),r}(Q),se=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return[0,1]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}]),r}(Q),ue=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}}]),r}(Q),le=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return this.gl.LESS}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}]),r}(Q),ce=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}}]),r}(Q),he=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){var e=this.gl;return[e.ONE,e.ZERO]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}]),r}(Q),fe=function(t){p(n,t);var r=y(n);function n(){return v(this,n),r.apply(this,arguments)}return m(n,[{key:"getDefault",value:function(){return e.Color.transparent}},{key:"set",value:function(e){var t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}]),n}(Q),de=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return this.gl.FUNC_ADD}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}]),r}(Q),pe=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}}]),r}(Q),ye=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return this.gl.BACK}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}]),r}(Q),ve=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return this.gl.CCW}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}]),r}(Q),me=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}]),r}(Q),ge=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return this.gl.TEXTURE0}},{key:"set",value:function(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}]),r}(Q),_e=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){var e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}},{key:"set",value:function(e){var t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}]),r}(Q),be=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}}]),r}(Q),we=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),r}(Q),xe=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}}]),r}(Q),ke=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}}]),r}(Q),Ee=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){var t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}]),r}(Q),Se=function(e){p(r,e);var t=y(r);function r(e){var n;return v(this,r),(n=t.call(this,e)).vao=e.extVertexArrayObject,n}return m(r,[{key:"getDefault",value:function(){return null}},{key:"set",value:function(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}]),r}(Q),Te=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return 4}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}}]),r}(Q),Ae=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}}]),r}(Q),Ce=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"getDefault",value:function(){return!1}},{key:"set",value:function(e){if(e!==this.current||this.dirty){var t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}}]),r}(Q),Ie=function(e){p(r,e);var t=y(r);function r(e,n){var i;return v(this,r),(i=t.call(this,e)).context=e,i.parent=n,i}return m(r,[{key:"getDefault",value:function(){return null}}]),r}(Q),Re=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"setDirty",value:function(){this.dirty=!0}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}}]),r}(Ie),Me=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"attachment",value:function(){return this.gl.DEPTH_ATTACHMENT}},{key:"set",value:function(e){if(e!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}}]),r}(Ie),Pe=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"attachment",value:function(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}]),r}(Me),Oe=function(){function e(t,r,n,i){v(this,e),this.context=t,this.width=r,this.height=n;var a=this.framebuffer=t.gl.createFramebuffer();this.colorAttachment=new Re(t,a),i&&(this.depthAttachment=new Me(t,a))}return m(e,[{key:"destroy",value:function(){var e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){var r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)}}]),e}(),Le=function(){function t(e){v(this,t),this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new J(this),this.clearDepth=new $(this),this.clearStencil=new ee(this),this.colorMask=new te(this),this.depthMask=new re(this),this.stencilMask=new ne(this),this.stencilFunc=new ie(this),this.stencilOp=new ae(this),this.stencilTest=new oe(this),this.depthRange=new se(this),this.depthTest=new ue(this),this.depthFunc=new le(this),this.blend=new ce(this),this.blendFunc=new he(this),this.blendColor=new fe(this),this.blendEquation=new de(this),this.cullFace=new pe(this),this.cullFaceSide=new ye(this),this.frontFace=new ve(this),this.program=new me(this),this.activeTexture=new ge(this),this.viewport=new _e(this),this.bindFramebuffer=new be(this),this.bindRenderbuffer=new we(this),this.bindTexture=new xe(this),this.bindVertexBuffer=new ke(this),this.bindElementBuffer=new Ee(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Se(this),this.pixelStoreUnpack=new Te(this),this.pixelStoreUnpackPremultiplyAlpha=new Ae(this),this.pixelStoreUnpackFlipY=new Ce(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(e.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}return m(t,[{key:"setDefault",value:function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}},{key:"setDirty",value:function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}},{key:"createIndexBuffer",value:function(e,t){return new Z(this,e,t)}},{key:"createVertexBuffer",value:function(e,t,r){return new X(this,e,t,r)}},{key:"createRenderbuffer",value:function(e,t,r){var n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}},{key:"createFramebuffer",value:function(e,t,r){return new Oe(this,e,t,r)}},{key:"clear",value:function(e){var t=e.color,r=e.depth,n=e.stencil,i=this.gl,a=0;t&&(a|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(a|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),void 0!==n&&(a|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(n),this.stencilMask.set(255)),i.clear(a)}},{key:"setCullFace",value:function(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}},{key:"setDepthMode",value:function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}},{key:"setStencilMode",value:function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}},{key:"setColorMode",value:function(t){l(t.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}},{key:"unbindVAO",value:function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}]),t}(),De=function(t){p(n,t);var r=y(n);function n(t,a,o,s){var u;return v(this,n),(u=r.call(this)).id=t,u.dispatcher=o,u.setEventedParent(s),u.type="raster",u.minzoom=0,u.maxzoom=22,u.roundZoom=!0,u.scheme="xyz",u.tileSize=512,u._loaded=!1,u._options=e.extend({type:"raster"},a),e.extend(i(u),e.pick(a,["url","scheme","tileSize"])),u}return m(n,[{key:"load",value:function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=K(this._options,this.map._requestManager,(function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new W(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))}},{key:"loaded",value:function(){return this._loaded}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"loadTile",value:function(t,r){var n=this,i=e.exported.devicePixelRatio>=2,a=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(a,e.ResourceType.Tile),(function(i,a,o,s){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(i)t.state="errored",r(i);else if(a){n.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s});var u=n.map.painter.context,l=u.gl;t.texture=n.map.painter.getTileTexture(a.width),t.texture?t.texture.update(a,{useMipmap:!0}):(t.texture=new e.Texture(u,a,l.RGBA,{useMipmap:!0}),t.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),u.extTextureFilterAnisotropic&&l.texParameterf(l.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax)),t.state="loaded",e.cacheEntryPossiblyAdded(n.dispatcher),r(null)}}))}},{key:"abortTile",value:function(e,t){e.request&&(e.request.cancel(),delete e.request),t()}},{key:"unloadTile",value:function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),Be=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ne=function(t){p(n,t);var r=y(n);function n(e,t,i,a){var o;return v(this,n),(o=r.call(this)).id=e,o.dispatcher=i,o.coordinates=t.coordinates,o.type="image",o.minzoom=0,o.maxzoom=22,o.tileSize=512,o.tiles={},o._loaded=!1,o.setEventedParent(a),o.options=t,o}return m(n,[{key:"load",value:function(t,r){var n=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),(function(i,a){n._loaded=!0,i?n.fire(new e.ErrorEvent(i)):a&&(n.image=e.exported.getImageData(a),t&&(n.coordinates=t),r&&r(),n._finishLoading())}))}},{key:"loaded",value:function(){return this._loaded}},{key:"updateImage",value:function(e){var t=this;return this.image&&e.url?(this.options.url=e.url,this.load(e.coordinates,(function(){t.texture=null})),this):this}},{key:"_finishLoading",value:function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"setCoordinates",value:function(t){var r=this;this.coordinates=t;var n=t.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(t){var r,n=1/0,i=1/0,a=-1/0,o=-1/0,s=f(t);try{for(s.s();!(r=s.n()).done;){var u=r.value;n=Math.min(n,u.x),i=Math.min(i,u.y),a=Math.max(a,u.x),o=Math.max(o,u.y)}}catch(d){s.e(d)}finally{s.f()}var l=Math.max(a-n,o-i),c=Math.max(0,Math.floor(-Math.log(l)/Math.LN2)),h=Math.pow(2,c);return new e.CanonicalTileID(c,Math.floor((n+a)/2*h),Math.floor((i+o)/2*h))}(n),this.minzoom=this.maxzoom=this.tileID.z;var i=n.map((function(e){return r.tileID.getTilePoint(e)._round()}));return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(i[0].x,i[0].y,0,0),this._boundsArray.emplaceBack(i[1].x,i[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(i[3].x,i[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(i[2].x,i[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}},{key:"prepare",value:function(){if(0!==Object.keys(this.tiles).length&&this.image){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Be.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}}},{key:"loadTile",value:function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}},{key:"serialize",value:function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),ze={vector:function(t){p(n,t);var r=y(n);function n(t,a,o,s){var l;if(v(this,n),(l=r.call(this)).id=t,l.dispatcher=o,l.type="vector",l.minzoom=0,l.maxzoom=22,l.scheme="xyz",l.tileSize=512,l.reparseOverscaled=!0,l.isTileClipped=!0,l._loaded=!1,e.extend(i(l),e.pick(a,["url","scheme","tileSize","promoteId"])),l._options=e.extend({type:"vector"},a),l._collectResourceTiming=a.collectResourceTiming,512!==l.tileSize)throw new Error("vector tile sources must have a tileSize of 512");return l.setEventedParent(s),l._tileWorkers={},l._deduped=new e.DedupedRequest,u(l)}return m(n,[{key:"load",value:function(){var t=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=K(this._options,this.map._requestManager,(function(r,n){t._tileJSONRequest=null,t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new W(n.bounds,t.minzoom,t.maxzoom)),e.postTurnstileEvent(n.tiles,t.map._requestManager._customAccessToken),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))}))}},{key:"loaded",value:function(){return this._loaded}},{key:"hasTile",value:function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}},{key:"onAdd",value:function(e){this.map=e,this.load()}},{key:"setSourceProperty",value:function(e){this._tileJSONRequest&&this._tileJSONRequest.cancel(),e();var t,r=this.map.style._getSourceCaches(this.id),n=f(r);try{for(n.s();!(t=n.n()).done;)t.value.clearTiles()}catch(i){n.e(i)}finally{n.f()}this.load()}},{key:"setTiles",value:function(e){var t=this;return this.setSourceProperty((function(){t._options.tiles=e})),this}},{key:"setUrl",value:function(e){var t=this;return this.setSourceProperty((function(){t.url=e,t._options.url=e})),this}},{key:"onRemove",value:function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}},{key:"serialize",value:function(){return e.extend({},this._options)}},{key:"loadTile",value:function(t,r){var n=this,i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(i,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(a.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",a,s.bind(this));else if(t.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",a,s.bind(this),void 0,!0);else{var o=e.loadVectorTile.call({deduped:this._deduped},a,(function(e,r){e||!r?s.call(n,e):(a.data={cacheControl:r.cacheControl,expires:r.expires,rawData:r.rawData.slice(0)},t.actor&&t.actor.send("loadTile",a,s.bind(n),void 0,!0))}),!0);t.request={cancel:o}}function s(n,i){return delete t.request,t.aborted?r(null):n&&404!==n.status?r(n):(i&&i.resourceTiming&&(t.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"unloadTile",value:function(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"hasTransition",value:function(){return!1}},{key:"afterUpdate",value:function(){this._tileWorkers={}}}]),n}(e.Evented),raster:De,"raster-dem":function(t){p(n,t);var r=y(n);function n(t,i,a,o){var s;return v(this,n),(s=r.call(this,t,i,a,o)).type="raster-dem",s.maxzoom=22,s._options=e.extend({type:"raster-dem"},i),s.encoding=i.encoding||"mapbox",s}return m(n,[{key:"loadTile",value:function(t,r){var n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(e,n){e&&(t.state="errored",r(e)),n&&(t.dem=n,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",r(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,a,o,s){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(a){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:s});var u=e.window.ImageBitmap&&a instanceof e.window.ImageBitmap&&(null==H&&(H=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),H),l=1-(a.width-e.prevPowerOfTwo(a.width))/2;l<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));var c=u?a:e.exported.getImageData(a,l),h={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:c,encoding:this.encoding,padding:l};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",h,i.bind(this),void 0,!0))}}.bind(this))}},{key:"_getNeighboringTiles",value:function(t){var r=t.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,a=0===r.x?t.wrap-1:t.wrap,o=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,u={};return u[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(u[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(u[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),u}},{key:"unloadTile",value:function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}}]),n}(De),geojson:function(t){p(n,t);var r=y(n);function n(t,i,a,o){var s;v(this,n),(s=r.call(this)).id=t,s.type="geojson",s.minzoom=0,s.maxzoom=18,s.tileSize=512,s.isTileClipped=!0,s.reparseOverscaled=!0,s._loaded=!1,s.actor=a.getActor(),s.setEventedParent(o),s._data=i.data,s._options=e.extend({},i),s._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(s.maxzoom=i.maxzoom),i.type&&(s.type=i.type),i.attribution&&(s.attribution=i.attribution),s.promoteId=i.promoteId;var u=e.EXTENT/s.tileSize;return s.workerOptions=e.extend({source:s.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*u,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*u,extent:e.EXTENT,maxZoom:s.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:s.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*u,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions),s}return m(n,[{key:"onAdd",value:function(e){this.map=e,this.setData(this._data)}},{key:"setData",value:function(e){return this._data=e,this._updateWorkerData(),this}},{key:"getClusterExpansionZoom",value:function(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}},{key:"getClusterChildren",value:function(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}},{key:"getClusterLeaves",value:function(e,t,r,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},n),this}},{key:"_updateWorkerData",value:function(){var t=this;if(this._pendingLoad)this._coalesce=!0;else{this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;var r=e.extend({},this.workerOptions),n=this._data;"string"==typeof n?(r.request=this.map._requestManager.transformRequest(e.exported.resolveURL(n),e.ResourceType.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(n),this._pendingLoad=this.actor.send("".concat(this.type,".loadData"),r,(function(r,n){if(t._loaded=!0,t._pendingLoad=null,r)t.fire(new e.ErrorEvent(r));else{var i={dataType:"source",sourceDataType:t._metadataFired?"content":"metadata"};t._collectResourceTiming&&n&&n.resourceTiming&&n.resourceTiming[t.id]&&(i.resourceTiming=n.resourceTiming[t.id]),t.fire(new e.Event("data",i)),t._metadataFired=!0}t._coalesce&&(t._updateWorkerData(),t._coalesce=!1)}))}}},{key:"loaded",value:function(){return this._loaded}},{key:"loadTile",value:function(t,r){var n=this,i=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(i,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(e,a){return delete t.request,t.unloadVectorData(),t.aborted?r(null):e?r(e):(t.loadVectorData(a,n.map.painter,"reloadTile"===i),r(null))}),void 0,"loadTile"===i)}},{key:"abortTile",value:function(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}},{key:"unloadTile",value:function(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}},{key:"onRemove",value:function(){this._pendingLoad&&this._pendingLoad.cancel()}},{key:"serialize",value:function(){return e.extend({},this._options,{type:this.type,data:this._data})}},{key:"hasTransition",value:function(){return!1}}]),n}(e.Evented),video:function(t){p(n,t);var r=y(n);function n(e,t,i,a){var o;return v(this,n),(o=r.call(this,e,t,i,a)).roundZoom=!0,o.type="video",o.options=t,o}return m(n,[{key:"load",value:function(){var t=this;this._loaded=!1;var r=this.options;this.urls=[];var n,i=f(r.urls);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.urls.push(this.map._requestManager.transformRequest(a,e.ResourceType.Source).url)}}catch(o){i.e(o)}finally{i.f()}e.getVideo(this.urls,(function(r,n){t._loaded=!0,r?t.fire(new e.ErrorEvent(r)):n&&(t.video=n,t.video.loop=!0,t.video.addEventListener("playing",(function(){t.map.triggerRepaint()})),t.map&&t.video.play(),t._finishLoading())}))}},{key:"pause",value:function(){this.video&&this.video.pause()}},{key:"play",value:function(){this.video&&this.video.play()}},{key:"seek",value:function(t){if(this.video){var r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(r.start(0)," and ").concat(r.end(0),"-second mark.")))):this.video.currentTime=t}}},{key:"getVideo",value:function(){return this.video}},{key:"onAdd",value:function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}},{key:"prepare",value:function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Be.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}}},{key:"serialize",value:function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this.video&&!this.video.paused}}]),n}(Ne),image:Ne,canvas:function(t){p(n,t);var r=y(n);function n(t,i,a,o){var s;return v(this,n),s=r.call(this,t,i,a,o),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some((function(e){return!Array.isArray(e)||2!==e.length||e.some((function(e){return"number"!=typeof e}))}))||s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof e.window.HTMLCanvasElement||s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):s.fire(new e.ErrorEvent(new e.ValidationError("sources.".concat(t),null,'missing required property "canvas"'))),s.options=i,s.animate=void 0===i.animate||i.animate,s}return m(n,[{key:"load",value:function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}},{key:"getCanvas",value:function(){return this.canvas}},{key:"onAdd",value:function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}},{key:"onRemove",value:function(){this.pause()}},{key:"prepare",value:function(){var t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var r=this.map.painter.context,n=r.gl;for(var i in this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Be.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(r,this.canvas,n.RGBA,{premultiply:!0}),this.tiles){var a=this.tiles[i];"loaded"!==a.state&&(a.state="loaded",a.texture=this.texture)}}}},{key:"serialize",value:function(){return{type:"canvas",coordinates:this.coordinates}}},{key:"hasTransition",value:function(){return this._playing}},{key:"_hasInvalidDimensions",value:function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e++){var r=t[e];if(isNaN(r)||r<=0)return!0}return!1}}]),n}(Ne)},Fe=function(t,r,n,i){var a=new ze[r.type](t,r,n,i);if(a.id!==t)throw new Error("Expected Source id to be ".concat(t," instead of ").concat(a.id));return e.bindAll(["load","abort","unload","serialize","prepare"],a),a};function je(t,r){var n=e.identity([]);return e.scale$1(n,n,[.5*t.width,.5*-t.height,1]),e.translate(n,n,[1,-1,0]),e.multiply(n,n,t.calculateProjMatrix(r.toUnwrapped()))}function Ue(e,t,r,n,i,a,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=e.tilesIn(n,o,s);u.sort(qe);var l,c=[],h=f(u);try{for(h.s();!(l=h.n()).done;){var d=l.value;c.push({wrappedTileID:d.tile.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,r,e._state,d,i,a,je(e.transform,d.tile.tileID),s)})}}catch(v){h.e(v)}finally{h.f()}var p=function(e){var t,r={},n={},i=f(e);try{for(i.s();!(t=i.n()).done;){var a=t.value,o=a.queryResults,s=a.wrappedTileID,u=n[s]=n[s]||{};for(var l in o){var c,h=o[l],d=u[l]=u[l]||{},p=r[l]=r[l]||[],y=f(h);try{for(y.s();!(c=y.n()).done;){var m=c.value;d[m.featureIndex]||(d[m.featureIndex]=!0,p.push(m))}}catch(v){y.e(v)}finally{y.f()}}}}catch(v){i.e(v)}finally{i.f()}return r}(c);for(var y in p)p[y].forEach((function(t){var r=t.feature,n=e.getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=n}));return p}function Ve(e,t){for(var r=e.getRenderableIds().map((function(t){return e.getTileByID(t)})),n=[],i={},a=0;a<r.length;a++){var o=r[a],s=o.tileID.canonical.key;i[s]||(i[s]=!0,o.querySourceFeatures(n,t))}return n}function qe(e,t){var r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function Ge(){return null!=oa.workerClass?new oa.workerClass:new e.window.Worker(oa.workerUrl)}var Ke,He="mapboxgl_preloaded_worker_pool",We=function(){function e(){v(this,e),this.active={}}return m(e,[{key:"acquire",value:function(t){if(!this.workers)for(this.workers=[];this.workers.length<e.workerCount;)this.workers.push(new Ge);return this.active[t]=!0,this.workers.slice()}},{key:"release",value:function(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((function(e){e.terminate()})),this.workers=null)}},{key:"isPreloaded",value:function(){return!!this.active[He]}},{key:"numActive",value:function(){return Object.keys(this.active).length}}]),e}();function Ze(){return Ke||(Ke=new We),Ke}function Ye(t,r){var n={};for(var i in t)"ref"!==i&&(n[i]=t[i]);return e.refProperties.forEach((function(e){e in r&&(n[e]=r[e])})),n}function Xe(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=Ye(e[n],t[e[n].ref]));return e}We.workerCount=2;var Qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Je(e,t,r){r.push({command:Qe.addSource,args:[e,t[e]]})}function $e(e,t,r){t.push({command:Qe.removeSource,args:[e]}),r[e]=!0}function et(e,t,r,n){$e(e,r,n),Je(e,t,r)}function tt(e,t,r){var n;for(n in e[r])if(e[r].hasOwnProperty(n)&&"data"!==n&&!l(e[r][n],t[r][n]))return!1;for(n in t[r])if(t[r].hasOwnProperty(n)&&"data"!==n&&!l(e[r][n],t[r][n]))return!1;return!0}function rt(e,t,r,n,i,a){var o;for(o in t=t||{},e=e||{})e.hasOwnProperty(o)&&(l(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}));for(o in t)t.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(l(e[o],t[o])||r.push({command:a,args:[n,o,t[o],i]}))}function nt(e){return e.id}function it(e,t){return e[t.id]=t,e}var at=function(){function t(e,r){v(this,t),this.reset(e,r)}return m(t,[{key:"reset",value:function(e,t){this.points=e||[],this._distances=[0];for(var r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}},{key:"lerp",value:function(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);for(var r=1,n=this._distances[r],i=t*this.paddedLength+this.padding;n<i&&r<this._distances.length;)n=this._distances[++r];var a=r-1,o=this._distances[a],s=n-o,u=s>0?(i-o)/s:0;return this.points[a].mult(1-u).add(this.points[r].mult(u))}}]),t}(),ot=function(){function e(t,r,n){v(this,e);var i=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(r/n);for(var o=0;o<this.xCellCount*this.yCellCount;o++)i.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}return m(e,[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}},{key:"insertCircle",value:function(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}},{key:"_insertBoxCell",value:function(e,t,r,n,i,a){this.boxCells[i].push(a)}},{key:"_insertCircleCell",value:function(e,t,r,n,i,a){this.circleCells[i].push(a)}},{key:"_query",value:function(e,t,r,n,i,a){if(r<0||e>this.width||n<0||t>this.height)return!i&&[];var o=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(var s=0;s<this.boxKeys.length;s++)o.push({key:this.boxKeys[s],x1:this.bboxes[4*s],y1:this.bboxes[4*s+1],x2:this.bboxes[4*s+2],y2:this.bboxes[4*s+3]});for(var u=0;u<this.circleKeys.length;u++){var l=this.circles[3*u],c=this.circles[3*u+1],h=this.circles[3*u+2];o.push({key:this.circleKeys[u],x1:l-h,y1:c-h,x2:l+h,y2:c+h})}return a?o.filter(a):o}return this._forEachCell(e,t,r,n,this._queryCell,o,{hitTest:i,seenUids:{box:{},circle:{}}},a),i?o.length>0:o}},{key:"_queryCircle",value:function(e,t,r,n,i){var a=e-r,o=e+r,s=t-r,u=t+r;if(o<0||a>this.width||u<0||s>this.height)return!n&&[];var l=[];return this._forEachCell(a,s,o,u,this._queryCellCircle,l,{hitTest:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),n?l.length>0:l}},{key:"query",value:function(e,t,r,n,i){return this._query(e,t,r,n,!1,i)}},{key:"hitTest",value:function(e,t,r,n,i){return this._query(e,t,r,n,!0,i)}},{key:"hitTestCircle",value:function(e,t,r,n){return this._queryCircle(e,t,r,!0,n)}},{key:"_queryCell",value:function(e,t,r,n,i,a,o,s){var u=o.seenUids,l=this.boxCells[i];if(null!==l){var c,h=this.bboxes,d=f(l);try{for(d.s();!(c=d.n()).done;){var p=c.value;if(!u.box[p]){u.box[p]=!0;var y=4*p;if(e<=h[y+2]&&t<=h[y+3]&&r>=h[y+0]&&n>=h[y+1]&&(!s||s(this.boxKeys[p]))){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[p],x1:h[y],y1:h[y+1],x2:h[y+2],y2:h[y+3]})}}}}catch(S){d.e(S)}finally{d.f()}}var v=this.circleCells[i];if(null!==v){var m,g=this.circles,_=f(v);try{for(_.s();!(m=_.n()).done;){var b=m.value;if(!u.circle[b]){u.circle[b]=!0;var w=3*b;if(this._circleAndRectCollide(g[w],g[w+1],g[w+2],e,t,r,n)&&(!s||s(this.circleKeys[b]))){if(o.hitTest)return a.push(!0),!0;var x=g[w],k=g[w+1],E=g[w+2];a.push({key:this.circleKeys[b],x1:x-E,y1:k-E,x2:x+E,y2:k+E})}}}}catch(S){_.e(S)}finally{_.f()}}}},{key:"_queryCellCircle",value:function(e,t,r,n,i,a,o,s){var u=o.circle,l=o.seenUids,c=this.boxCells[i];if(null!==c){var h,d=this.bboxes,p=f(c);try{for(p.s();!(h=p.n()).done;){var y=h.value;if(!l.box[y]){l.box[y]=!0;var v=4*y;if(this._circleAndRectCollide(u.x,u.y,u.radius,d[v+0],d[v+1],d[v+2],d[v+3])&&(!s||s(this.boxKeys[y])))return a.push(!0),!0}}}catch(k){p.e(k)}finally{p.f()}}var m=this.circleCells[i];if(null!==m){var g,_=this.circles,b=f(m);try{for(b.s();!(g=b.n()).done;){var w=g.value;if(!l.circle[w]){l.circle[w]=!0;var x=3*w;if(this._circlesCollide(_[x],_[x+1],_[x+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[w])))return a.push(!0),!0}}}catch(k){b.e(k)}finally{b.f()}}}},{key:"_forEachCell",value:function(e,t,r,n,i,a,o,s){for(var u=this._convertToXCellCoord(e),l=this._convertToYCellCoord(t),c=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n),f=u;f<=c;f++)for(var d=l;d<=h;d++)if(i.call(this,e,t,r,n,this.xCellCount*d+f,a,o,s))return}},{key:"_convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"_convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}},{key:"_circlesCollide",value:function(e,t,r,n,i,a){var o=n-e,s=i-t,u=r+a;return u*u>o*o+s*s}},{key:"_circleAndRectCollide",value:function(e,t,r,n,i,a,o){var s=(a-n)/2,u=Math.abs(e-(n+s));if(u>s+r)return!1;var l=(o-i)/2,c=Math.abs(t-(i+l));if(c>l+r)return!1;if(u<=s||c<=l)return!0;var h=u-s,f=c-l;return h*h+f*f<=r*r}}]),e}(),st=Math.tan(85*Math.PI/180);function ut(t,r,n,i,a){var o=e.create$1();return r?(e.scale$1(o,o,[1/a,1/a,1]),n||e.rotateZ(o,o,i.angle)):e.multiply(o,i.labelPlaneMatrix,t),o}function lt(t,r,n,i,a){if(r){var o=e.clone$1(t);return e.scale$1(o,o,[a,a,1]),n||e.rotateZ(o,o,-i.angle),o}return i.glCoordMatrix}function ct(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[t.x,t.y,n,1];n?e.transformMat4(i,i,r):wt(i,i,r);var a=i[3];return{point:new e.pointGeometry(i[0]/a,i[1]/a),signedDistanceFromCamera:a}}function ht(e,t){return Math.min(.5+e/t*.5,1.5)}function ft(e,t){var r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function dt(t,r,n,i,a,o,s,u,l){var c=i?t.textSizeData:t.iconSizeData,h=e.evaluateSizeForZoom(c,n.transform.zoom),f=[256/n.width*2+1,256/n.height*2+1],d=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;d.clear();for(var p=t.lineVertexArray,y=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,v=n.transform.width/n.transform.height,m=!1,g=0;g<y.length;g++){var _=y.get(g);if(_.writingMode!==e.WritingMode.vertical||m||0!==g&&y.get(g-1).writingMode===e.WritingMode.horizontal||(m=!0),_.hidden||_.writingMode===e.WritingMode.vertical&&!m)bt(_.numGlyphs,d);else{m=!1;var b=l?l({x:_.anchorX,y:_.anchorY}):0,w=[_.anchorX,_.anchorY,b,1];if(e.transformMat4(w,w,r),ft(w,f)){var x=ht(n.transform.cameraToCenterDistance,w[3]),k=e.evaluateSizeForFeature(c,h,_),E=s?k/x:k*x,S=new e.pointGeometry(_.anchorX,_.anchorY),T=ct(S,a,b);if(T.signedDistanceFromCamera<=0)bt(_.numGlyphs,d);else{var A=T.point,C={},I=s?null:l,R=vt(_,E,!1,u,r,a,o,t.glyphOffsetArray,p,d,A,S,C,v,I);m=R.useVertical,I&&R.needsFlipping&&(C={}),(R.notEnoughRoom||m||R.needsFlipping&&vt(_,E,!0,u,r,a,o,t.glyphOffsetArray,p,d,A,S,C,v,I).notEnoughRoom)&&bt(_.numGlyphs,d)}}else bt(_.numGlyphs,d)}}i?t.text.dynamicLayoutVertexBuffer.updateData(d):t.icon.dynamicLayoutVertexBuffer.updateData(d)}function pt(e,t,r,n,i,a,o,s,u,l,c,h,f){var d=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,y=s.lineStartIndex+s.lineLength,v=t.getoffsetX(s.glyphStartIndex),m=t.getoffsetX(d-1),g=gt(e*v,r,n,i,a,o,s.segment,p,y,u,l,c,h,f,!0);if(!g)return null;var _=gt(e*m,r,n,i,a,o,s.segment,p,y,u,l,c,h,f,!0);return _?{first:g,last:_}:null}function yt(t,r,n,i){return t.writingMode===e.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i?{useVertical:!0}:t.writingMode===e.WritingMode.vertical?r.y<n.y?{needsFlipping:!0}:null:0!==t.flipState&&function(e,t,r){var n=(t.x-e.x)*r;return 0===n||Math.abs((t.y-e.y)/n)>st}(r,n,i)?1===t.flipState?{needsFlipping:!0}:null:r.x>n.x?{needsFlipping:!0}:null}function vt(t,r,n,i,a,o,s,u,l,c,h,d,p,y,v){var m,g=r/24,_=t.lineOffsetX*g,b=t.lineOffsetY*g;if(t.numGlyphs>1){var w=t.glyphStartIndex+t.numGlyphs,x=t.lineStartIndex,k=t.lineStartIndex+t.lineLength,E=pt(g,u,_,b,n,h,d,t,l,o,p,v);if(!E)return{notEnoughRoom:!0};var S=ct(E.first.point,s).point,T=ct(E.last.point,s).point;if(i&&!n){var A=yt(t,S,T,y);if(t.flipState=A&&A.needsFlipping?1:2,A)return A}m=[E.first];for(var C=t.glyphStartIndex+1;C<w-1;C++)m.push(gt(g*u.getoffsetX(C),_,b,n,h,d,t.segment,x,k,l,o,p,v));m.push(E.last)}else{if(i&&!n){var I=ct(d,a).point,R=t.lineStartIndex+t.segment+1,M=new e.pointGeometry(l.getx(R),l.gety(R)),P=ct(M,a),O=yt(t,I,P.signedDistanceFromCamera>0?P.point:mt(d,M,I,1,a),y);if(t.flipState=O&&O.needsFlipping?1:2,O)return O}var L=gt(g*u.getoffsetX(t.glyphStartIndex),_,b,n,h,d,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,l,o,p,v);if(!L)return{notEnoughRoom:!0};m=[L]}var D,B=f(m);try{for(B.s();!(D=B.n()).done;){var N=D.value;e.addDynamicAttributes(c,N.point,N.angle)}}catch(z){B.e(z)}finally{B.f()}return{}}function mt(e,t,r,n,i,a){var o=e.add(e.sub(t)._unit()),s=ct(o,i,a?a(o):0).point,u=r.sub(s);return r.add(u._mult(n/u.mag()))}function gt(t,r,n,i,a,o,s,u,l,c,h,f,d,p,y){var v=i?t-r:t+r,m=v>0?1:-1,g=0;i&&(m*=-1,g=Math.PI),m<0&&(g+=Math.PI);for(var _=m>0?u+s:u+s+1,b=a,w=a,x=0,k=0,E=Math.abs(v),S=[],T=[],A=o,C=function(){var t=_-m;return 0===x?o:new e.pointGeometry(c.getx(t),c.gety(t))},I=function(){return mt(C(),A,w,E-x+1,h,d)};x+k<=E;){if((_+=m)<u||_>=l)return null;if(w=b,S.push(b),p&&T.push(A||C()),void 0===(b=f[_])){var R=ct(A=new e.pointGeometry(c.getx(_),c.gety(_)),h,d?d(A):0);b=R.signedDistanceFromCamera>0?f[_]=R.point:I()}else A=null;x+=k,k=w.dist(b)}y&&d&&(A=A||new e.pointGeometry(c.getx(_),c.gety(_)),f[_]=b=void 0===f[_]?b:I(),k=w.dist(b));var M=(E-x)/k,P=b.sub(w),O=P.mult(M)._add(w);n&&O._add(P._unit()._perp()._mult(n*m));var L=g+Math.atan2(b.y-w.y,b.x-w.x);return S.push(O),p&&(A=A||new e.pointGeometry(c.getx(_),c.gety(_)),T.push(function(t,r,n){var i=1-n;return new e.pointGeometry(t.x*i+r.x*n,t.y*i+r.y*n)}(T.length>0?T[T.length-1]:A,A,M))),{point:O,angle:L,path:S,tilePath:T}}var _t=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function bt(e,t){for(var r=0;r<e;r++){var n=t.length;t.resize(n+4),t.float32.set(_t,3*n)}}function wt(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}var xt=100,kt=function(){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ot(e.width+200,e.height+200,25),i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ot(e.width+200,e.height+200,25);v(this,t),this.transform=e,this.grid=n,this.ignoredGrid=i,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+xt,this.screenBottomBoundary=e.height+xt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=r}return m(t,[{key:"placeCollisionBox",value:function(e,t,r,n,i,a,o){var s=this.projectAndGetPerspectiveRatio(a,t.anchorPointX,t.anchorPointY,t.elevation,t.tileID),u=i*s.perspectiveRatio,l=(t.x1*e+r.x-t.padding)*u+s.point.x,c=(t.y1*e+r.y-t.padding)*u+s.point.y,h=(t.x2*e+r.x+t.padding)*u+s.point.x,f=(t.y2*e+r.y+t.padding)*u+s.point.y,d=s.perspectiveRatio<=.55||s.aboveHorizon;return!this.isInsideGrid(l,c,h,f)||!n&&this.grid.hitTest(l,c,h,f,o)||d?{box:[],offscreen:!1}:{box:[l,c,h,f],offscreen:this.isOffscreen(l,c,h,f)}}},{key:"placeCollisionCircles",value:function(t,r,n,i,a,o,s,u,l,c,h,d,p,y){var v=[],m=this.transform.elevation,g=m?function(e){return m.getAtTileOffset(y,e.x,e.y)}:function(e){return 0},_=new e.pointGeometry(r.anchorX,r.anchorY),b=g(_),w=this.projectAndGetPerspectiveRatio(o,_.x,_.y,b,y),x=w.perspectiveRatio,k=(c?a/x:a*x)/e.ONE_EM,E=ct(_,s,b).point,S=w.signedDistanceFromCamera>0?pt(k,i,r.lineOffsetX*k,r.lineOffsetY*k,!1,E,_,r,n,s,{},m&&!c?g:null,c&&!!m):null,T=!1,A=!1,C=!0;if(S&&!w.aboveHorizon){for(var I=.5*d*x+p,R=new e.pointGeometry(-100,-100),M=new e.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),P=new at,O=S.first,L=S.last,D=[],B=O.path.length-1;B>=1;B--)D.push(O.path[B]);for(var N=1;N<L.path.length;N++)D.push(L.path[N]);var z=2.5*I;if(u){var F=D.map(m?function(e,t){var r=g(t<O.path.length-1?O.tilePath[O.path.length-1-t]:L.tilePath[t-O.path.length+2]);return ct(e,u,r)}:function(e){return ct(e,u)});D=F.some((function(e){return e.signedDistanceFromCamera<=0}))?[]:F.map((function(e){return e.point}))}var j=[];if(D.length>0){for(var U=D[0].clone(),V=D[0].clone(),q=1;q<D.length;q++)U.x=Math.min(U.x,D[q].x),U.y=Math.min(U.y,D[q].y),V.x=Math.max(V.x,D[q].x),V.y=Math.max(V.y,D[q].y);j=U.x>=R.x&&V.x<=M.x&&U.y>=R.y&&V.y<=M.y?[D]:V.x<R.x||U.x>M.x||V.y<R.y||U.y>M.y?[]:e.clipLine([D],R.x,R.y,M.x,M.y)}var G,K=f(j);try{for(K.s();!(G=K.n()).done;){var H=G.value;P.reset(H,.25*I);var W=0;W=P.length<=.5*I?1:Math.ceil(P.paddedLength/z)+1;for(var Z=0;Z<W;Z++){var Y=Z/Math.max(W-1,1),X=P.lerp(Y),Q=X.x+xt,J=X.y+xt;v.push(Q,J,I,0);var $=Q-I,ee=J-I,te=Q+I,re=J+I;if(C=C&&this.isOffscreen($,ee,te,re),A=A||this.isInsideGrid($,ee,te,re),!t&&this.grid.hitTestCircle(Q,J,I,h)&&(T=!0,!l))return{circles:[],offscreen:!1,collisionDetected:T}}}}catch(ne){K.e(ne)}finally{K.f()}}return{circles:!l&&T||!A?[]:v,offscreen:C,collisionDetected:T}}},{key:"queryRenderedSymbols",value:function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};var r,n=[],i=1/0,a=1/0,o=-1/0,s=-1/0,u=f(t);try{for(u.s();!(r=u.n()).done;){var l=r.value,c=new e.pointGeometry(l.x+xt,l.y+xt);i=Math.min(i,c.x),a=Math.min(a,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y),n.push(c)}}catch(b){u.e(b)}finally{u.f()}var h,d=this.grid.query(i,a,o,s).concat(this.ignoredGrid.query(i,a,o,s)),p={},y={},v=f(d);try{for(v.s();!(h=v.n()).done;){var m=h.value,g=m.key;if(void 0===p[g.bucketInstanceId]&&(p[g.bucketInstanceId]={}),!p[g.bucketInstanceId][g.featureIndex]){var _=[new e.pointGeometry(m.x1,m.y1),new e.pointGeometry(m.x2,m.y1),new e.pointGeometry(m.x2,m.y2),new e.pointGeometry(m.x1,m.y2)];e.polygonIntersectsPolygon(n,_)&&(p[g.bucketInstanceId][g.featureIndex]=!0,void 0===y[g.bucketInstanceId]&&(y[g.bucketInstanceId]=[]),y[g.bucketInstanceId].push(g.featureIndex))}}}catch(b){v.e(b)}finally{v.f()}return y}},{key:"insertCollisionBox",value:function(e,t,r,n,i){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:i},e[0],e[1],e[2],e[3])}},{key:"insertCollisionCircles",value:function(e,t,r,n,i){for(var a=t?this.ignoredGrid:this.grid,o={bucketInstanceId:r,featureIndex:n,collisionGroupID:i},s=0;s<e.length;s+=4)a.insertCircle(o,e[s],e[s+1],e[s+2])}},{key:"projectAndGetPerspectiveRatio",value:function(t,r,n,i,a){var o=[r,n,i||0,1],s=!1;if(i||this.transform.pitch>0){e.transformMat4(o,o,t);var u=!1;this.fogState&&a&&(u=function(t,r,n,i,a,o){var s=o.calculateFogTileMatrix(a),u=[r,n,i];return e.transformMat4$1(u,u,s),B(t,u,o.pitch,o._fov)}(this.fogState,r,n,i||0,a.toUnwrapped(),this.transform)>.9),s=o[2]>o[3]||u}else wt(o,o,t);return{point:new e.pointGeometry((o[0]/o[3]+1)/2*this.transform.width+xt,(-o[1]/o[3]+1)/2*this.transform.height+xt),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/o[3]*.5,1.5),signedDistanceFromCamera:o[3],aboveHorizon:s}}},{key:"isOffscreen",value:function(e,t,r,n){return r<xt||e>=this.screenRightBoundary||n<xt||t>this.screenBottomBoundary}},{key:"isInsideGrid",value:function(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}},{key:"getViewportMatrix",value:function(){var t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}]),t}(),Et=function(){function e(t,r,n,i){v(this,e),this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):i&&n?1:0,this.placed=n}return m(e,[{key:"isHidden",value:function(){return 0===this.opacity&&!this.placed}}]),e}(),St=function(){function e(t,r,n,i,a){v(this,e),this.text=new Et(t?t.text:null,r,n,a),this.icon=new Et(t?t.icon:null,r,i,a)}return m(e,[{key:"isHidden",value:function(){return this.text.isHidden()&&this.icon.isHidden()}}]),e}(),Tt=function e(t,r,n){v(this,e),this.text=t,this.icon=r,this.skipFade=n},At=function t(){v(this,t),this.invProjMatrix=e.create$1(),this.viewportMatrix=e.create$1(),this.circles=[]},Ct=function e(t,r,n,i,a){v(this,e),this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=n,this.bucketIndex=i,this.tileID=a},It=function(){function e(t){v(this,e),this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}return m(e,[{key:"get",value:function(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){var t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:function(e){return e.collisionGroupID===t}}}return this.collisionGroups[e]}}]),e}();function Rt(t,r,n,i,a){var o=e.getAnchorAlignment(t),s=-(o.horizontalAlign-.5)*r,u=-(o.verticalAlign-.5)*n,l=e.evaluateVariableOffset(t,i);return new e.pointGeometry(s+l[0]*a,u+l[1]*a)}function Mt(t,r,n,i,a){var o=new e.pointGeometry(t,r);return n&&o._rotate(i?a:-a),o}var Pt=function(){function t(e,r,n,i,a){v(this,t),this.transform=e.clone(),this.collisionIndex=new kt(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new It(n),this.collisionCircleArrays={},this.prevPlacement=i,i&&(i.prevPlacement=void 0),this.placedOrientations={}}return m(t,[{key:"getBucketParts",value:function(t,r,n,i){var a=n.getBucket(r),o=n.latestFeatureIndex;if(a&&o&&r.id===a.layerIds[0]){var s=n.collisionBoxArray,u=a.layers[0].layout,l=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),c=n.tileSize/e.EXTENT,h=this.transform.calculateProjMatrix(n.tileID.toUnwrapped()),d="map"===u.get("text-pitch-alignment"),p="map"===u.get("text-rotation-alignment"),y=V(n,1,this.transform.zoom),v=ut(h,d,p,this.transform,y),m=null;if(d){var g=lt(h,d,p,this.transform,y);m=e.multiply([],this.transform.labelPlaneMatrix,g)}this.retainedQueryData[a.bucketInstanceId]=new Ct(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,n.tileID);var _={bucket:a,layout:u,posMatrix:h,textLabelPlaneMatrix:v,labelToScreenMatrix:m,scale:l,textPixelRatio:c,holdingForFade:n.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(a.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(a.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i){var b,w=f(a.sortKeyRanges);try{for(w.s();!(b=w.n()).done;){var x=b.value,k=x.sortKey,E=x.symbolInstanceStart,S=x.symbolInstanceEnd;t.push({sortKey:k,symbolInstanceStart:E,symbolInstanceEnd:S,parameters:_})}}catch(T){w.e(T)}finally{w.f()}}else t.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:_})}}},{key:"attemptAnchorPlacement",value:function(e,t,r,n,i,a,o,s,u,l,c,h,f,d,p,y,v,m){var g,_=[h.textOffset0,h.textOffset1],b=Rt(e,r,n,_,i),w=this.collisionIndex.placeCollisionBox(i,t,Mt(b.x,b.y,a,o,this.transform.angle),c,s,u,l.predicate);if((!y||0!==this.collisionIndex.placeCollisionBox(d.getSymbolInstanceIconSize(m,this.transform.zoom,f),y,Mt(b.x,b.y,a,o,this.transform.angle),c,s,u,l.predicate).box.length)&&w.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID]&&this.prevPlacement.placements[h.crossTileID].text&&(g=this.prevPlacement.variableOffsets[h.crossTileID].anchor),this.variableOffsets[h.crossTileID]={textOffset:_,width:r,height:n,anchor:e,textScale:i,prevAnchor:g},this.markUsedJustification(d,e,h,p),d.allowVerticalPlacement&&(this.markUsedOrientation(d,p,h),this.placedOrientations[h.crossTileID]=p),{shift:b,placedGlyphBoxes:w}}},{key:"placeLayerBucketPart",value:function(t,r,n){var i=this,a=t.parameters,o=a.bucket,s=a.layout,u=a.posMatrix,l=a.textLabelPlaneMatrix,c=a.labelToScreenMatrix,h=a.textPixelRatio,d=a.holdingForFade,p=a.collisionBoxArray,y=a.partiallyEvaluatedTextSize,v=a.partiallyEvaluatedIconSize,m=a.collisionGroup,g=s.get("text-optional"),_=s.get("icon-optional"),b=s.get("text-allow-overlap"),w=s.get("icon-allow-overlap"),x="map"===s.get("text-rotation-alignment"),k="map"===s.get("text-pitch-alignment"),E="none"!==s.get("icon-text-fit"),S="viewport-y"===s.get("symbol-z-order"),T=b&&(w||!o.hasIconData()||_),A=w&&(b||!o.hasTextData()||g);!o.collisionArrays&&p&&o.deserializeCollisionBoxes(p),n&&o.updateCollisionDebugBuffers(this.transform.zoom,p);var C=function(t,a,p){if(!r[t.crossTileID])if(d)i.placements[t.crossTileID]=new Tt(!1,!1,!1);else{var S=!1,C=!1,I=!0,R=null,M={box:null,offscreen:null},P={box:null,offscreen:null},O=null,L=null,D=null,B=0,N=0,z=0;p.textFeatureIndex?B=p.textFeatureIndex:t.useRuntimeCollisionCircles&&(B=t.featureIndex),p.verticalTextFeatureIndex&&(N=p.verticalTextFeatureIndex);var F=function(e){e.tileID=i.retainedQueryData[o.bucketInstanceId].tileID,(i.transform.elevation||e.elevation)&&(e.elevation=i.transform.elevation?i.transform.elevation.getAtTileOffset(i.retainedQueryData[o.bucketInstanceId].tileID,e.anchorPointX,e.anchorPointY):0)},j=p.textBox;if(j){F(j);var U=function(r){var n=e.WritingMode.horizontal;if(o.allowVerticalPlacement&&!r&&i.prevPlacement){var a=i.prevPlacement.placedOrientations[t.crossTileID];a&&(i.placedOrientations[t.crossTileID]=a,n=a,i.markUsedOrientation(o,n,t))}return n},V=function(r,n){if(o.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&p.verticalTextBox){var i,a=f(o.writingModes);try{for(a.s();!(i=a.n()).done&&(i.value===e.WritingMode.vertical?(M=n(),P=M):M=r(),!(M&&M.box&&M.box.length)););}catch(s){a.e(s)}finally{a.f()}}else M=r()};if(s.get("text-variable-anchor")){var q=s.get("text-variable-anchor");if(i.prevPlacement&&i.prevPlacement.variableOffsets[t.crossTileID]){var G=i.prevPlacement.variableOffsets[t.crossTileID];q.indexOf(G.anchor)>0&&(q=q.filter((function(e){return e!==G.anchor}))).unshift(G.anchor)}var K=function(e,r,n){var s=o.getSymbolInstanceTextSize(y,t,i.transform.zoom,a),l=(e.x2-e.x1)*s+2*e.padding,c=(e.y2-e.y1)*s+2*e.padding,f=E&&!w?r:null;f&&F(f);for(var d={box:[],offscreen:!1},p=b?2*q.length:q.length,g=0;g<p;++g){var _=i.attemptAnchorPlacement(q[g%q.length],e,l,c,s,x,k,h,u,m,g>=q.length,t,a,o,n,f,y,v);if(_&&(d=_.placedGlyphBoxes)&&d.box&&d.box.length){S=!0,R=_.shift;break}}return d};V((function(){return K(j,p.iconBox,e.WritingMode.horizontal)}),(function(){var r=p.verticalTextBox;return r&&F(r),o.allowVerticalPlacement&&!(M&&M.box&&M.box.length)&&t.numVerticalGlyphVertices>0&&r?K(r,p.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}})),M&&(S=M.box,I=M.offscreen);var H=U(M&&M.box);if(!S&&i.prevPlacement){var W=i.prevPlacement.variableOffsets[t.crossTileID];W&&(i.variableOffsets[t.crossTileID]=W,i.markUsedJustification(o,W.anchor,t,H))}}else{var Z=function(r,n){var s=o.getSymbolInstanceTextSize(y,t,i.transform.zoom,a),l=i.collisionIndex.placeCollisionBox(s,r,new e.pointGeometry(0,0),b,h,u,m.predicate);return l&&l.box&&l.box.length&&(i.markUsedOrientation(o,n,t),i.placedOrientations[t.crossTileID]=n),l};V((function(){return Z(j,e.WritingMode.horizontal)}),(function(){var r=p.verticalTextBox;return o.allowVerticalPlacement&&t.numVerticalGlyphVertices>0&&r?(F(r),Z(r,e.WritingMode.vertical)):{box:null,offscreen:null}})),U(M&&M.box&&M.box.length)}}if(S=(O=M)&&O.box&&O.box.length>0,I=O&&O.offscreen,t.useRuntimeCollisionCircles){var Y=o.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),X=e.evaluateSizeForFeature(o.textSizeData,y,Y),Q=s.get("text-padding");L=i.collisionIndex.placeCollisionCircles(b,Y,o.lineVertexArray,o.glyphOffsetArray,X,u,l,c,n,k,m.predicate,t.collisionCircleDiameter,Q,i.retainedQueryData[o.bucketInstanceId].tileID),S=b||L.circles.length>0&&!L.collisionDetected,I=I&&L.offscreen}if(p.iconFeatureIndex&&(z=p.iconFeatureIndex),p.iconBox){var J=function(t){F(t);var r=E&&R?Mt(R.x,R.y,x,k,i.transform.angle):new e.pointGeometry(0,0),n=o.getSymbolInstanceIconSize(v,i.transform.zoom,a);return i.collisionIndex.placeCollisionBox(n,t,r,w,h,u,m.predicate)};C=P&&P.box&&P.box.length&&p.verticalIconBox?(D=J(p.verticalIconBox)).box.length>0:(D=J(p.iconBox)).box.length>0,I=I&&D.offscreen}var $=g||0===t.numHorizontalGlyphVertices&&0===t.numVerticalGlyphVertices,ee=_||0===t.numIconVertices;if($||ee?ee?$||(C=C&&S):S=C&&S:C=S=C&&S,S&&O&&O.box&&i.collisionIndex.insertCollisionBox(O.box,s.get("text-ignore-placement"),o.bucketInstanceId,P&&P.box&&N?N:B,m.ID),C&&D&&i.collisionIndex.insertCollisionBox(D.box,s.get("icon-ignore-placement"),o.bucketInstanceId,z,m.ID),L&&(S&&i.collisionIndex.insertCollisionCircles(L.circles,s.get("text-ignore-placement"),o.bucketInstanceId,B,m.ID),n)){var te=o.bucketInstanceId,re=i.collisionCircleArrays[te];void 0===re&&(re=i.collisionCircleArrays[te]=new At);for(var ne=0;ne<L.circles.length;ne+=4)re.circles.push(L.circles[ne+0]),re.circles.push(L.circles[ne+1]),re.circles.push(L.circles[ne+2]),re.circles.push(L.collisionDetected?1:0)}i.placements[t.crossTileID]=new Tt(S||T,C||A,I||o.justReloaded),r[t.crossTileID]=!0}};if(S)for(var I=o.getSortedSymbolIndexes(this.transform.angle),R=I.length-1;R>=0;--R){var M=I[R];C(o.symbolInstances.get(M),M,o.collisionArrays[M])}else for(var P=t.symbolInstanceStart;P<t.symbolInstanceEnd;P++)C(o.symbolInstances.get(P),P,o.collisionArrays[P]);if(n&&o.bucketInstanceId in this.collisionCircleArrays){var O=this.collisionCircleArrays[o.bucketInstanceId];e.invert(O.invProjMatrix,u),O.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1}},{key:"markUsedJustification",value:function(t,r,n,i){var a;a=i===e.WritingMode.vertical?n.verticalPlacedTextSymbolIndex:{left:n.leftJustifiedTextSymbolIndex,center:n.centerJustifiedTextSymbolIndex,right:n.rightJustifiedTextSymbolIndex}[e.getAnchorJustification(r)];for(var o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex,n.verticalPlacedTextSymbolIndex];o<s.length;o++){var u=s[o];u>=0&&(t.text.placedSymbolArray.get(u).crossTileID=a>=0&&u!==a?0:n.crossTileID)}}},{key:"markUsedOrientation",value:function(t,r,n){for(var i=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,a=r===e.WritingMode.vertical?r:0,o=0,s=[n.leftJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.rightJustifiedTextSymbolIndex];o<s.length;o++){var u=s[o];t.text.placedSymbolArray.get(u).placedOrientation=i}n.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).placedOrientation=a)}},{key:"commit",value:function(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;var t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;var n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(var s in this.placements){var u=this.placements[s],l=i[s];l?(this.opacities[s]=new St(l,n,u.text,u.icon),r=r||u.text!==l.text.placed||u.icon!==l.icon.placed):(this.opacities[s]=new St(null,n,u.text,u.icon,u.skipFade),r=r||u.text||u.icon)}for(var c in i){var h=i[c];if(!this.opacities[c]){var f=new St(h,n,!1,!1);f.isHidden()||(this.opacities[c]=f,r=r||h.text.placed||h.icon.placed)}}for(var d in a)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=a[d]);for(var p in o)this.placedOrientations[p]||!this.opacities[p]||this.opacities[p].isHidden()||(this.placedOrientations[p]=o[p]);r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}},{key:"updateLayerOpacities",value:function(e,t){var r,n={},i=f(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,o=a.getBucket(e);o&&a.latestFeatureIndex&&e.id===o.layerIds[0]&&this.updateBucketOpacities(o,n,a.collisionBoxArray)}}catch(s){i.e(s)}finally{i.f()}}},{key:"updateBucketOpacities",value:function(t,r,n){var i=this;t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();var a=t.layers[0].layout,o=new St(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),u=a.get("icon-allow-overlap"),l=a.get("text-variable-anchor"),c="map"===a.get("text-rotation-alignment"),h="map"===a.get("text-pitch-alignment"),f="none"!==a.get("icon-text-fit"),d=new St(null,0,s&&(u||!t.hasIconData()||a.get("icon-optional")),u&&(s||!t.hasTextData()||a.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);for(var p=function(e,t,r){for(var n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r)},y=function(n){var a=t.symbolInstances.get(n),s=a.numHorizontalGlyphVertices,u=a.numVerticalGlyphVertices,y=a.crossTileID,v=i.opacities[y];r[y]?v=o:v||(v=d,i.opacities[y]=v),r[y]=!0;var m=a.numIconVertices>0,g=i.placedOrientations[a.crossTileID],_=g===e.WritingMode.vertical,b=g===e.WritingMode.horizontal||g===e.WritingMode.horizontalOnly;if(s>0||u>0){var w=Ut(v.text);p(t.text,s,_?Vt:w),p(t.text,u,b?Vt:w);var x=v.text.isHidden();[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((function(e){e>=0&&(t.text.placedSymbolArray.get(e).hidden=x||_?1:0)})),a.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).hidden=x||b?1:0);var k=i.variableOffsets[a.crossTileID];k&&i.markUsedJustification(t,k.anchor,a,g);var E=i.placedOrientations[a.crossTileID];E&&(i.markUsedJustification(t,"left",a,E),i.markUsedOrientation(t,E,a))}if(m){var S=Ut(v.icon);a.placedIconSymbolIndex>=0&&(p(t.icon,a.numIconVertices,_?Vt:S),t.icon.placedSymbolArray.get(a.placedIconSymbolIndex).hidden=v.icon.isHidden()),a.verticalPlacedIconSymbolIndex>=0&&(p(t.icon,a.numVerticalIconVertices,b?Vt:S),t.icon.placedSymbolArray.get(a.verticalPlacedIconSymbolIndex).hidden=v.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){var T=t.collisionArrays[n];if(T){var A=new e.pointGeometry(0,0);if(T.textBox||T.verticalTextBox){var C=!0;if(l){var I=i.variableOffsets[y];I?(A=Rt(I.anchor,I.width,I.height,I.textOffset,I.textScale),c&&A._rotate(h?i.transform.angle:-i.transform.angle)):C=!1}T.textBox&&Ot(t.textCollisionBox.collisionVertexArray,v.text.placed,!C||_,A.x,A.y),T.verticalTextBox&&Ot(t.textCollisionBox.collisionVertexArray,v.text.placed,!C||b,A.x,A.y)}var R=Boolean(!b&&T.verticalIconBox);T.iconBox&&Ot(t.iconCollisionBox.collisionVertexArray,v.icon.placed,R,f?A.x:0,f?A.y:0),T.verticalIconBox&&Ot(t.iconCollisionBox.collisionVertexArray,v.icon.placed,!R,f?A.x:0,f?A.y:0)}}},v=0;v<t.symbolInstances.length;v++)y(v);if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){var m=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=m.invProjMatrix,t.placementViewportMatrix=m.viewportMatrix,t.collisionCircleArray=m.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}},{key:"symbolFadeChange",value:function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}},{key:"zoomAdjustment",value:function(e){return Math.max(0,(this.transform.zoom-e)/1.5)}},{key:"hasTransitions",value:function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}},{key:"stillRecent",value:function(e,t){var r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}},{key:"setStale",value:function(){this.stale=!0}}]),t}();function Ot(e,t,r,n,i){e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0)}var Lt=Math.pow(2,25),Dt=Math.pow(2,24),Bt=Math.pow(2,17),Nt=Math.pow(2,16),zt=Math.pow(2,9),Ft=Math.pow(2,8),jt=Math.pow(2,1);function Ut(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Lt+t*Dt+r*Bt+t*Nt+r*zt+t*Ft+r*jt+t}var Vt=0,qt=function(){function e(t){v(this,e),this._sortAcrossTiles="viewport-y"!==t.layout.get("symbol-z-order")&&void 0!==t.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}return m(e,[{key:"continuePlacement",value:function(e,t,r,n,i){for(var a=this._bucketParts;this._currentTileIndex<e.length;)if(t.getBucketParts(a,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((function(e,t){return e.sortKey-t.sortKey})));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,r),this._currentPartIndex++,i())return!0;return!1}}]),e}(),Gt=function(){function t(e,r,n,i,a,o,s,u){v(this,t),this.placement=new Pt(e,a,o,s,u),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=i,this._done=!1}return m(t,[{key:"isDone",value:function(){return this._done}},{key:"continuePlacement",value:function(t,r,n){for(var i=this,a=e.exported.now(),o=function(){var t=e.exported.now()-a;return!i._forceFullPlacement&&t>2};this._currentPlacementIndex>=0;){var s=r[t[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=u)&&(!s.maxzoom||s.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new qt(s)),this._inProgressLayer.continuePlacement(n[s.source],this.placement,this._showCollisionBoxes,s,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}},{key:"commit",value:function(e){return this.placement.commit(e),this.placement}}]),t}(),Kt=512/e.EXTENT/2,Ht=function(){function t(e,r,n){v(this,t),this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=n;for(var i=0;i<r.length;i++){var a=r.get(i),o=a.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:a.crossTileID,coord:this.getScaledCoordinates(a,e)})}}return m(t,[{key:"getScaledCoordinates",value:function(t,r){var n=Kt/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.anchorX)*n),y:Math.floor((r.canonical.y*e.EXTENT+t.anchorY)*n)}}},{key:"findMatches",value:function(e,t,r){for(var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),i=0;i<e.length;i++){var a=e.get(i);if(!a.crossTileID){var o=this.indexedSymbolInstances[a.key];if(o){var s,u=this.getScaledCoordinates(a,t),l=f(o);try{for(l.s();!(s=l.n()).done;){var c=s.value;if(Math.abs(c.coord.x-u.x)<=n&&Math.abs(c.coord.y-u.y)<=n&&!r[c.crossTileID]){r[c.crossTileID]=!0,a.crossTileID=c.crossTileID;break}}}catch(h){l.e(h)}finally{l.f()}}}}}}]),t}(),Wt=function(){function e(){v(this,e),this.maxCrossTileID=0}return m(e,[{key:"generate",value:function(){return++this.maxCrossTileID}}]),e}(),Zt=function(){function e(){v(this,e),this.indexes={},this.usedCrossTileIDs={},this.lng=0}return m(e,[{key:"handleWrapJump",value:function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var r in this.indexes){var n=this.indexes[r],i={};for(var a in n){var o=n[a];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),i[o.tileID.key]=o}this.indexes[r]=i}this.lng=e}},{key:"addBucket",value:function(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var n=0;n<t.symbolInstances.length;n++)t.symbolInstances.get(n).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var i=this.usedCrossTileIDs[e.overscaledZ];for(var a in this.indexes){var o=this.indexes[a];if(Number(a)>e.overscaledZ)for(var s in o){var u=o[s];u.tileID.isChildOf(e)&&u.findMatches(t.symbolInstances,e,i)}else{var l=o[e.scaledTo(Number(a)).key];l&&l.findMatches(t.symbolInstances,e,i)}}for(var c=0;c<t.symbolInstances.length;c++){var h=t.symbolInstances.get(c);h.crossTileID||(h.crossTileID=r.generate(),i[h.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ht(e,t.symbolInstances,t.bucketInstanceId),!0}},{key:"removeBucketCrossTileIDs",value:function(e,t){for(var r in t.indexedSymbolInstances){var n,i=f(t.indexedSymbolInstances[r]);try{for(i.s();!(n=i.n()).done;){var a=n.value;delete this.usedCrossTileIDs[e][a.crossTileID]}}catch(o){i.e(o)}finally{i.f()}}}},{key:"removeStaleBuckets",value:function(e){var t=!1;for(var r in this.indexes){var n=this.indexes[r];for(var i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}]),e}(),Yt=function(){function e(){v(this,e),this.layerIndexes={},this.crossTileIDs=new Wt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}return m(e,[{key:"addLayer",value:function(e,t,r){var n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Zt);var i=!1,a={};n.handleWrapJump(r);var o,s=f(t);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=u.getBucket(e);l&&e.id===l.layerIds[0]&&(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(u.tileID,l,this.crossTileIDs)&&(i=!0),a[l.bucketInstanceId]=!0)}}catch(c){s.e(c)}finally{s.f()}return n.removeStaleBuckets(a)&&(i=!0),i}},{key:"pruneUnusedLayers",value:function(e){var t={};for(var r in e.forEach((function(e){t[e]=!0})),this.layerIndexes)t[r]||delete this.layerIndexes[r]}}]),e}(),Xt=function(t,r){return e.emitValidationErrors(t,r&&r.filter((function(e){return"source.canvas"!==e.identifier})))},Qt=e.pick(Qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),Jt=e.pick(Qe,["setCenter","setZoom","setBearing","setPitch"]),$t=function(){var t={},r=e.spec.$version;for(var n in e.spec.$root){var i=e.spec.$root[n];if(i.required){var a=null;null!=(a="version"===n?r:"array"===i.type?[]:{})&&(t[n]=a)}}return t}(),er={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0},tr=function(t){p(n,t);var r=y(n);function n(t){var a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(this,n),(a=r.call(this)).map=t,a.dispatcher=new U(Ze(),i(a)),a.imageManager=new I,a.imageManager.setEventedParent(i(a)),a.glyphManager=new e.GlyphManager(t._requestManager,o.localFontFamily?e.LocalGlyphMode.all:o.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,o.localFontFamily||o.localIdeographFontFamily),a.lineAtlas=new e.LineAtlas(256,512),a.crossTileSymbolIndex=new Yt,a._layers={},a._num3DLayers=0,a._numSymbolLayers=0,a._numCircleLayers=0,a._serializedLayers={},a._sourceCaches={},a._otherSourceCaches={},a._symbolSourceCaches={},a.zoomHistory=new e.ZoomHistory,a._loaded=!1,a._availableImages=[],a._order=[],a._drapedFirstOrder=[],a._markersNeedUpdate=!1,a._resetUpdates(),a.dispatcher.broadcast("setReferrer",e.getReferrer());var s=i(a);return a._rtlTextPluginCallback=n.registerForPluginStateChange((function(t){s.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},(function(t,r){if(e.triggerPluginCompletionEvent(t),r&&r.every((function(e){return e})))for(var n in s._sourceCaches){var i=s._sourceCaches[n],a=i.getSource().type;"vector"!==a&&"geojson"!==a||i.reload()}}))})),a.on("data",(function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=a.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(var r in a._layers){var n=a._layers[r];n.source===t.id&&a._validateLayer(n)}}})),a}return m(n,[{key:"loadURL",value:function(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof n.validate?n.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,n.accessToken);var a=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(a,(function(t,n){r._request=null,t?r.fire(new e.ErrorEvent(t)):n&&r._load(n,i)}))}},{key:"loadJSON",value:function(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((function(){r._request=null,r._load(t,!1!==n.validate)}))}},{key:"loadEmpty",value:function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load($t,!1)}},{key:"_updateLayerCount",value:function(e,t){var r=t?1:-1;e.is3D()&&(this._num3DLayers+=r),"circle"===e.type&&(this._numCircleLayers+=r),"symbol"===e.type&&(this._numSymbolLayers+=r)}},{key:"_load",value:function(t,r){if(!r||!Xt(this,e.validateStyle(t))){for(var n in this._loaded=!0,this.stylesheet=t,t.sources)this.addSource(n,t.sources[n],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);var i=Xe(this.stylesheet.layers);this._order=i.map((function(e){return e.id})),this._layers={},this._serializedLayers={};var a,o=f(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;(s=e.createStyleLayer(s)).setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=s,this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}}catch(u){o.e(u)}finally{o.f()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new P(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}}},{key:"_loadSprite",value:function(t){var r=this;this._spriteRequest=function(t,r,n){var i,a,o,s=e.exported.devicePixelRatio>1?"@2x":"",u=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),(function(e,t){u=null,o||(o=e,i=t,c())})),l=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),(function(e,t){l=null,o||(o=e,a=t,c())}));function c(){if(o)n(o);else if(i&&a){var t=e.exported.getImageData(a),r={};for(var s in i){var u=i[s],l=u.width,c=u.height,h=u.x,f=u.y,d=u.sdf,p=u.pixelRatio,y=u.stretchX,v=u.stretchY,m=u.content,g=new e.RGBAImage({width:l,height:c});e.RGBAImage.copy(t,g,{x:h,y:f},{x:0,y:0},{width:l,height:c}),r[s]={data:g,pixelRatio:p,sdf:d,stretchX:y,stretchY:v,content:m}}n(null,r)}}return{cancel:function(){u&&(u.cancel(),u=null),l&&(l.cancel(),l=null)}}}(t,this.map._requestManager,(function(t,n){if(r._spriteRequest=null,t)r.fire(new e.ErrorEvent(t));else if(n)for(var i in n)r.imageManager.addImage(i,n[i]);r.imageManager.setLoaded(!0),r._availableImages=r.imageManager.listImages(),r.dispatcher.broadcast("setImages",r._availableImages),r.dispatcher.broadcast("spriteLoaded",!0),r.fire(new e.Event("data",{dataType:"style"}))}))}},{key:"_validateLayer",value:function(t){var r=this.getSource(t.source);if(r){var n=t.sourceLayer;n&&("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'.concat(n,'" does not exist on source "').concat(r.id,'" as specified by style layer "').concat(t.id,'"'))))}}},{key:"loaded",value:function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}},{key:"_serializeLayers",value:function(e){var t,r=[],n=f(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._layers[i];"custom"!==a.type&&r.push(a.serialize())}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"hasTransitions",value:function(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(var e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}},{key:"isLayerDraped",value:function(e){return!!this.terrain&&er[e.type]}},{key:"_checkLoaded",value:function(){if(!this._loaded)throw new Error("Style is not done loading")}},{key:"update",value:function(t){if(this._loaded){var r=this._changed;if(this._changed){var n=Object.keys(this._updatedLayers),i=Object.keys(this._removedLayers);for(var a in(n.length||i.length)&&this._updateWorkerLayers(n,i),this._updatedSources){var o=this._updatedSources[a];"reload"===o?this._reloadSource(a):"clear"===o&&this._clearSource(a)}for(var s in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[s].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}var u={};for(var l in this._sourceCaches){var c=this._sourceCaches[l];u[l]=c.used,c.used=!1}var h,d=f(this._order);try{for(d.s();!(h=d.n()).done;){var p=h.value,y=this._layers[p];if(y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)){var v=this._getLayerSourceCache(y);v&&(v.used=!0)}var m=this.map.painter;if(m){var g=y.getProgramIds();if(!g)continue;var _,b=y.getProgramConfiguration(t.zoom),w=f(g);try{for(w.s();!(_=w.n()).done;){var x=_.value;m.useProgram(x,b)}}catch(S){w.e(S)}finally{w.f()}}}}catch(S){d.e(S)}finally{d.f()}for(var k in u){var E=this._sourceCaches[k];u[k]!==E.used&&E.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:E.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new e.Event("data",{dataType:"style"}))}}},{key:"_updateTilesForChangedImages",value:function(){var e=Object.keys(this._changedImages);if(e.length){for(var t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}},{key:"_updateWorkerLayers",value:function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}},{key:"_resetUpdates",value:function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}},{key:"setState",value:function(t){var r=this;if(this._checkLoaded(),Xt(this,e.validateStyle(t)))return!1;(t=e.clone$2(t)).layers=Xe(t.layers);var n=function(e,t){if(!e)return[{command:Qe.setStyle,args:[t]}];var r=[];try{if(!l(e.version,t.version))return[{command:Qe.setStyle,args:[t]}];l(e.center,t.center)||r.push({command:Qe.setCenter,args:[t.center]}),l(e.zoom,t.zoom)||r.push({command:Qe.setZoom,args:[t.zoom]}),l(e.bearing,t.bearing)||r.push({command:Qe.setBearing,args:[t.bearing]}),l(e.pitch,t.pitch)||r.push({command:Qe.setPitch,args:[t.pitch]}),l(e.sprite,t.sprite)||r.push({command:Qe.setSprite,args:[t.sprite]}),l(e.glyphs,t.glyphs)||r.push({command:Qe.setGlyphs,args:[t.glyphs]}),l(e.transition,t.transition)||r.push({command:Qe.setTransition,args:[t.transition]}),l(e.light,t.light)||r.push({command:Qe.setLight,args:[t.light]}),l(e.fog,t.fog)||r.push({command:Qe.setFog,args:[t.fog]});var n={},i=[];!function(e,t,r,n){var i;for(i in t=t||{},e=e||{})e.hasOwnProperty(i)&&(t.hasOwnProperty(i)||$e(i,r,n));for(i in t)t.hasOwnProperty(i)&&(e.hasOwnProperty(i)?l(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&tt(e,t,i)?r.push({command:Qe.setGeoJSONSourceData,args:[i,t[i].data]}):et(i,t,r,n)):Je(i,t,r))}(e.sources,t.sources,i,n);var a=[];e.layers&&e.layers.forEach((function(e){n[e.source]?r.push({command:Qe.removeLayer,args:[e.id]}):a.push(e)}));var o=e.terrain;o&&n[o.source]&&(r.push({command:Qe.setTerrain,args:[void 0]}),o=void 0),r=r.concat(i),l(o,t.terrain)||r.push({command:Qe.setTerrain,args:[t.terrain]}),function(e,t,r){t=t||[];var n,i,a,o,s,u,c,h=(e=e||[]).map(nt),f=t.map(nt),d=e.reduce(it,{}),p=t.reduce(it,{}),y=h.slice(),v=Object.create(null);for(n=0,i=0;n<h.length;n++)a=h[n],p.hasOwnProperty(a)?i++:(r.push({command:Qe.removeLayer,args:[a]}),y.splice(y.indexOf(a,i),1));for(n=0,i=0;n<f.length;n++)a=f[f.length-1-n],y[y.length-1-n]!==a&&(d.hasOwnProperty(a)?(r.push({command:Qe.removeLayer,args:[a]}),y.splice(y.lastIndexOf(a,y.length-i),1)):i++,u=y[y.length-n],r.push({command:Qe.addLayer,args:[p[a],u]}),y.splice(y.length-n,0,a),v[a]=!0);for(n=0;n<f.length;n++)if(o=d[a=f[n]],s=p[a],!v[a]&&!l(o,s))if(l(o.source,s.source)&&l(o["source-layer"],s["source-layer"])&&l(o.type,s.type)){for(c in rt(o.layout,s.layout,r,a,null,Qe.setLayoutProperty),rt(o.paint,s.paint,r,a,null,Qe.setPaintProperty),l(o.filter,s.filter)||r.push({command:Qe.setFilter,args:[a,s.filter]}),l(o.minzoom,s.minzoom)&&l(o.maxzoom,s.maxzoom)||r.push({command:Qe.setLayerZoomRange,args:[a,s.minzoom,s.maxzoom]}),o)o.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?rt(o[c],s[c],r,a,c.slice(6),Qe.setPaintProperty):l(o[c],s[c])||r.push({command:Qe.setLayerProperty,args:[a,c,s[c]]}));for(c in s)s.hasOwnProperty(c)&&!o.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?rt(o[c],s[c],r,a,c.slice(6),Qe.setPaintProperty):l(o[c],s[c])||r.push({command:Qe.setLayerProperty,args:[a,c,s[c]]}))}else r.push({command:Qe.removeLayer,args:[a]}),u=y[y.lastIndexOf(a)+1],r.push({command:Qe.addLayer,args:[s,u]})}(a,t.layers,r)}catch(e){console.warn("Unable to compute style diff:",e),r=[{command:Qe.setStyle,args:[t]}]}return r}(this.serialize(),t).filter((function(e){return!(e.command in Jt)}));if(0===n.length)return!1;var i=n.filter((function(e){return!(e.command in Qt)}));if(i.length>0)throw new Error("Unimplemented: ".concat(i.map((function(e){return e.command})).join(", "),"."));return n.forEach((function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)})),this.stylesheet=t,!0}},{key:"addImage",value:function(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,r),this._afterImageUpdated(t)}},{key:"updateImage",value:function(e,t){this.imageManager.updateImage(e,t)}},{key:"getImage",value:function(e){return this.imageManager.getImage(e)}},{key:"removeImage",value:function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this._afterImageUpdated(t)}},{key:"_afterImageUpdated",value:function(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}},{key:"listImages",value:function(){return this._checkLoaded(),this.imageManager.listImages()}},{key:"addSource",value:function(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(r).join(", "),"."));if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(e.validateStyle.source,"sources.".concat(t),r,null,i))){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var a=Fe(t,r,this.dispatcher,this);a.setEventedParent(this,(function(){return{isSourceLoaded:n.loaded(),source:a.serialize(),sourceId:t}}));var o=function(r){var i=(r?"symbol:":"other:")+t,o=n._sourceCaches[i]=new e.SourceCache(i,a,r);(r?n._symbolSourceCaches:n._otherSourceCaches)[t]=o,o.style=n,o.onAdd(n.map)};o(!1),"vector"!==r.type&&"geojson"!==r.type||o(!0),a.onAdd&&a.onAdd(this.map),this._changed=!0}}},{key:"removeSource",value:function(t){this._checkLoaded();var r=this.getSource(t);if(void 0===r)throw new Error("There is no source with this ID");for(var n in this._layers)if(this._layers[n].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while layer "').concat(n,'" is using it.'))));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error('Source "'.concat(t,'" cannot be removed while terrain is using it.'))));var i,a=this._getSourceCaches(t),o=f(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;delete this._sourceCaches[s.id],delete this._updatedSources[s.id],s.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:s.getSource().id})),s.setEventedParent(null),s.clearTiles()}}catch(u){o.e(u)}finally{o.f()}delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changed=!0}},{key:"setGeoJSONSourceData",value:function(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}},{key:"getSource",value:function(e){var t=this._getSourceCache(e);return t&&t.getSource()}},{key:"addLayer",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=t.id;if(this.getLayer(i))this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(i,'" already exists on this map'))));else{var a;if("custom"===t.type){if(Xt(this,e.validateCustomStyleLayer(t)))return;a=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.clone$2(t),t=e.extend(t,{source:i})),this._validate(e.validateStyle.layer,"layers.".concat(i),t,{arrayIndex:-1},n))return;a=e.createStyleLayer(t),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[a.id]=a.serialize(),this._updateLayerCount(a,!0)}var o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(r,'" does not exist on this map.'))));else{this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a;var s=this._getLayerSourceCache(a);if(this._removedLayers[i]&&a.source&&s&&"custom"!==a.type){var u=this._removedLayers[i];delete this._removedLayers[i],u.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",s.pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map),this._updateDrapeFirstLayers()}}}},{key:"moveLayer",value:function(t,r){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==r){var n=this._order.indexOf(t);this._order.splice(n,1);var i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new e.ErrorEvent(new Error('Layer with id "'.concat(r,'" does not exist on this map.')))):(this._order.splice(i,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be moved."))))}},{key:"removeLayer",value:function(t){this._checkLoaded();var r=this._layers[t];if(r){r.setEventedParent(null),this._updateLayerCount(r,!1);var n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map),this._updateDrapeFirstLayers()}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be removed."))))}},{key:"getLayer",value:function(e){return this._layers[e]}},{key:"hasLayer",value:function(e){return e in this._layers}},{key:"hasLayerType",value:function(e){for(var t in this._layers)if(this._layers[t].type===e)return!0;return!1}},{key:"setLayerZoomRange",value:function(t,r,n){this._checkLoaded();var i=this.getLayer(t);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot have zoom extent."))))}},{key:"setFilter",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();var i=this.getLayer(t);if(i){if(!l(i.filter,r))return null==r?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(e.validateStyle.filter,"layers.".concat(i.id,".filter"),r,null,n)||(i.filter=e.clone$2(r),this._updateLayer(i)))}else this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be filtered."))))}},{key:"getFilter",value:function(t){return e.clone$2(this.getLayer(t).filter)}},{key:"setLayoutProperty",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var a=this.getLayer(t);a?l(a.getLayoutProperty(r),n)||(a.setLayoutProperty(r,n,i),this._updateLayer(a)):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be styled."))))}},{key:"getLayoutProperty",value:function(t,r){var n=this.getLayer(t);if(n)return n.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style."))))}},{key:"setPaintProperty",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();var a=this.getLayer(t);a?l(a.getPaintProperty(r),n)||(a.setPaintProperty(r,n,i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new e.ErrorEvent(new Error("The layer '".concat(t,"' does not exist in the map's style and cannot be styled."))))}},{key:"getPaintProperty",value:function(e,t){return this.getLayer(e).getPaintProperty(t)}},{key:"setFeatureState",value:function(t,r){this._checkLoaded();var n=t.source,i=t.sourceLayer,a=this.getSource(n);if(void 0!==a){var o=a.type;if("geojson"===o&&i)this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));else if("vector"!==o||i){void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));var s,u=this._getSourceCaches(n),l=f(u);try{for(l.s();!(s=l.n()).done;)s.value.setFeatureState(i,t.id,r)}catch(c){l.e(c)}finally{l.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"removeFeatureState",value:function(t,r){this._checkLoaded();var n=t.source,i=this.getSource(n);if(void 0!==i){var a=i.type,o="vector"===a?t.sourceLayer:void 0;if("vector"!==a||o)if(r&&"string"!=typeof t.id&&"number"!=typeof t.id)this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));else{var s,u=this._getSourceCaches(n),l=f(u);try{for(l.s();!(s=l.n()).done;)s.value.removeFeatureState(o,t.id,r)}catch(c){l.e(c)}finally{l.f()}}else this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(n,"' does not exist in the map's style."))))}},{key:"getFeatureState",value:function(t){this._checkLoaded();var r=t.source,n=t.sourceLayer,i=this.getSource(r);if(void 0!==i){if("vector"!==i.type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(r)[0].getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '".concat(r,"' does not exist in the map's style."))))}},{key:"getTransition",value:function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}},{key:"serialize",value:function(){var t={};for(var r in this._sourceCaches){var n=this._sourceCaches[r].getSource();t[n.id]||(t[n.id]=n.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:t,layers:this._serializeLayers(this._order)},(function(e){return void 0!==e}))}},{key:"_updateLayer",value:function(e){this._updatedLayers[e.id]=!0;var t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0}},{key:"_flattenAndSortRenderedFeatures",value:function(e){for(var t=this,r=function(e){return"fill-extrusion"===t._layers[e].type},n={},i=[],a=this._order.length-1;a>=0;a--){var o=this._order[a];if(r(o)){n[o]=a;var s,u=f(e);try{for(u.s();!(s=u.n()).done;){var l=s.value[o];if(l){var c,h=f(l);try{for(h.s();!(c=h.n()).done;){var d=c.value;i.push(d)}}catch(S){h.e(S)}finally{h.f()}}}}catch(S){u.e(S)}finally{u.f()}}}i.sort((function(e,t){return t.intersectionZ-e.intersectionZ}));for(var p=[],y=this._order.length-1;y>=0;y--){var v=this._order[y];if(r(v))for(var m=i.length-1;m>=0;m--){var g=i[m].feature;if(n[g.layer.id]<y)break;p.push(g),i.pop()}else{var _,b=f(e);try{for(b.s();!(_=b.n()).done;){var w=_.value[v];if(w){var x,k=f(w);try{for(k.s();!(x=k.n()).done;){var E=x.value;p.push(E.feature)}}catch(S){k.e(S)}finally{k.f()}}}}catch(S){b.e(S)}finally{b.f()}}}return p}},{key:"queryRenderedFeatures",value:function(t,r,n){var i=this;r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter,null,r);var a={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];var o,s=f(r.layers);try{for(s.s();!(o=s.n()).done;){var u=o.value,l=this._layers[u];if(!l)return this.fire(new e.ErrorEvent(new Error("The layer '".concat(u,"' does not exist in the map's style and cannot be queried for features.")))),[];a[l.source]=!0}}catch(v){s.e(v)}finally{s.f()}}var c=[];r.availableImages=this._availableImages;var h=r&&r.layers?r.layers.some((function(e){var t=i.getLayer(e);return t&&t.is3D()})):this.has3DLayers(),d=q.createFromScreenPoints(t,n);for(var p in this._sourceCaches){var y=this._sourceCaches[p].getSource().id;r.layers&&!a[y]||c.push(Ue(this._sourceCaches[p],this._layers,this._serializedLayers,d,r,n,h,!!this.map._showQueryGeometry))}return this.placement&&c.push(function(e,t,r,n,i,a,o){var s,u={},l=a.queryRenderedSymbols(n),c=[],h=f(Object.keys(l).map(Number));try{for(h.s();!(s=h.n()).done;){var d=s.value;c.push(o[d])}}catch(v){h.e(v)}finally{h.f()}c.sort(qe);for(var p=function(){var r=m[y],n=r.featureIndex.lookupSymbolFeatures(l[r.bucketInstanceId],t,r.bucketIndex,r.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(var a in n){var o=u[a]=u[a]||[],s=n[a];s.sort((function(e,t){var n=r.featureSortOrder;if(n){var i=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-i}return t.featureIndex-e.featureIndex}));var c,h=f(s);try{for(h.s();!(c=h.n()).done;){var d=c.value;o.push(d)}}catch(v){h.e(v)}finally{h.f()}}},y=0,m=c;y<m.length;y++)p();var g=function(t){u[t].forEach((function(n){var i=n.feature,a=r(e[t]).getFeatureState(i.layer["source-layer"],i.id);i.source=i.layer.source,i.layer["source-layer"]&&(i.sourceLayer=i.layer["source-layer"]),i.state=a}))};for(var _ in u)g(_);return u}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),d.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(c)}},{key:"querySourceFeatures",value:function(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter,null,r);var n,i=this._getSourceCaches(t),a=[],o=f(i);try{for(o.s();!(n=o.n()).done;){var s=n.value;a=a.concat(Ve(s,r))}}catch(u){o.e(u)}finally{o.f()}return a}},{key:"addSourceType",value:function(e,t,r){return n.getSourceType(e)?r(new Error('A source type called "'.concat(e,'" already exists.'))):(n.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},r):r(null,null))}},{key:"getLight",value:function(){return this.light.getLight()}},{key:"setLight",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();var n=this.light.getLight(),i=!1;for(var a in t)if(!l(t[a],n[a])){i=!0;break}if(i){var o={now:e.exported.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,r),this.light.updateTransitions(o)}}},{key:"getTerrain",value:function(){return this.terrain?this.terrain.get():null}},{key:"setTerrain",value:function(t){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof t.source){var r="terrain-dem-src";this.addSource(r,t.source),t=e.clone$2(t),t=e.extend(t,{source:r})}if(!this._validate(e.validateStyle.terrain,"terrain",t)){if(this.terrain){var n=this.terrain,i=n.get();for(var a in t)if(!l(t[a],i[a])){n.set(t),this.stylesheet.terrain=t;var o={now:e.exported.now(),transition:e.extend({duration:0},this.stylesheet.transition)};n.updateTransitions(o);break}}else this._createTerrain(t);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}},{key:"_createFog",value:function(t){var r=this.fog=new j(t);this.stylesheet.fog=t;var n={now:e.exported.now(),transition:e.extend({duration:0},this.stylesheet.transition)};r.updateTransitions(n)}},{key:"_updateMarkersOpacity",value:function(){var e=this;0!==this.map._markers.length&&this.map._requestDomTask((function(){var t,r=f(e.map._markers);try{for(r.s();!(t=r.n()).done;)t.value._evaluateOpacity()}catch(n){r.e(n)}finally{r.f()}}))}},{key:"getFog",value:function(){return this.fog?this.fog.get():null}},{key:"setFog",value:function(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){var r=this.fog,n=r.get();for(var i in t)if(!l(t[i],n[i])){r.set(t),this.stylesheet.fog=t;var a={now:e.exported.now(),transition:e.extend({duration:0},this.stylesheet.transition)};r.updateTransitions(a);break}}else this._createFog(t);this._markersNeedUpdate=!0}},{key:"_updateDrapeFirstLayers",value:function(){var e,t,r=this;if(this.map._optimizeForTerrain&&this.terrain){var n=this._order.filter((function(e){return r.isLayerDraped(r._layers[e])})),i=this._order.filter((function(e){return!r.isLayerDraped(r._layers[e])}));this._drapedFirstOrder=[],(e=this._drapedFirstOrder).push.apply(e,c(n)),(t=this._drapedFirstOrder).push.apply(t,c(i))}}},{key:"_createTerrain",value:function(t){var r=this.terrain=new D(t);this.stylesheet.terrain=t,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();var n={now:e.exported.now(),transition:e.extend({duration:0},this.stylesheet.transition)};r.updateTransitions(n)}},{key:"_force3DLayerUpdate",value:function(){for(var e in this._layers){var t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}},{key:"_validate",value:function(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&Xt(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.spec},i)))}},{key:"_remove",value:function(){for(var t in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[t].setEventedParent(null);for(var r in this._sourceCaches)this._sourceCaches[r].clearTiles(),this._sourceCaches[r].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}},{key:"_clearSource",value:function(e){var t,r=this._getSourceCaches(e),n=f(r);try{for(n.s();!(t=n.n()).done;)t.value.clearTiles()}catch(i){n.e(i)}finally{n.f()}}},{key:"_reloadSource",value:function(e){var t,r=this._getSourceCaches(e),n=f(r);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.resume(),i.reload()}}catch(a){n.e(a)}finally{n.f()}}},{key:"_updateSources",value:function(e){for(var t in this._sourceCaches)this._sourceCaches[t].update(e)}},{key:"_generateCollisionBoxes",value:function(){for(var e in this._sourceCaches){var t=this._sourceCaches[e];t.resume(),t.reload()}}},{key:"_updatePlacement",value:function(t,r,n,i){var a,o=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=!1,l=!1,c={},h=f(this._order);try{for(h.s();!(a=h.n()).done;){var d=a.value,p=this._layers[d];if("symbol"===p.type){if(!c[p.source]&&"continue"===function(){var e=o._getLayerSourceCache(p);if(!e)return"continue";c[p.source]=e.getRenderableIds(!0).map((function(t){return e.getTileByID(t)})).sort((function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)}))}())continue;var y=this.crossTileSymbolIndex.addLayer(p,c[p.source],t.center.lng);u=u||y}}}catch(b){h.e(b)}finally{h.f()}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new Gt(t,this._order,s,r,n,i,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,c),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),l=!0),u&&this.pauseablePlacement.placement.setStale()),l||u){var v,m=f(this._order);try{for(m.s();!(v=m.n()).done;){var g=v.value,_=this._layers[g];"symbol"===_.type&&this.placement.updateLayerOpacities(_,c[_.source])}}catch(b){m.e(b)}finally{m.f()}}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}},{key:"_releaseSymbolFadeTiles",value:function(){for(var e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}},{key:"getImages",value:function(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();var n=function(e){e&&e.setDependencies(t.tileID.key,t.type,t.icons)};n(this._otherSourceCaches[t.source]),n(this._symbolSourceCaches[t.source])}},{key:"getGlyphs",value:function(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)}},{key:"getResource",value:function(t,r,n){return e.makeRequest(r,n)}},{key:"_getSourceCache",value:function(e){return this._otherSourceCaches[e]}},{key:"_getLayerSourceCache",value:function(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}},{key:"_getSourceCaches",value:function(e){var t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}},{key:"has3DLayers",value:function(){return this._num3DLayers>0}},{key:"hasSymbolLayers",value:function(){return this._numSymbolLayers>0}},{key:"hasCircleLayers",value:function(){return this._numCircleLayers>0}},{key:"order",get:function(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}}]),n}(e.Evented);tr.getSourceType=function(e){return ze[e]},tr.setSourceType=function(e,t){ze[e]=t},tr.registerForPluginStateChange=e.registerForPluginStateChange;var rr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",nr="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ir={},ar={};ir=lr("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),ar=lr("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);var or=lr("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),sr=rr,ur={background:lr("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:lr("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:lr("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:lr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:lr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:lr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:lr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=u_matrix*vec4(a_pos,elevation(a_pos),1.0);gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:lr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:lr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:lr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:lr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:lr("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:lr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:lr("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);gl_Position=u_matrix*vec4(pos,1);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:lr("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;\n#ifdef TERRAIN\nvec2 centroid_pos=a_centroid_pos;bool flat_roof=centroid_pos.x !=0.0;float ele=elevation(pos_nx.xy);float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);\n#else\nvec3 p=vec3(pos_nx.xy,z);gl_Position=u_matrix*vec4(p,1);\n#endif\nvec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:lr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:lr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:lr("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineGradient:lr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:lr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),lineSDF:lr("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);vec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 dash_from\n#pragma mapbox: initialize mediump vec4 dash_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);v_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:lr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:lr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:lr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:lr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float h=elevation(a_pos);vec4 projectedPoint=u_matrix*vec4(a_pos,h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),h,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h,1.0);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:lr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:lr("#ifdef GL_ES\nprecision highp float;\n#endif\nvec4 pack_depth(float ndc_z) {float depth=ndc_z*0.5+0.5;const vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:lr("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",nr),skyboxGradient:lr("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",nr),skyboxCapture:lr("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}")};function lr(e,t,r){var n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,i=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,a=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),o=e.match(i),s=t.match(i),u=rr.match(i),l=s?s.concat(o):o;r||(ir.staticUniforms&&(l=ir.staticUniforms.concat(l)),ar.staticUniforms&&(l=ar.staticUniforms.concat(l))),l&&(l=l.concat(u));var c={};return{fragmentSource:e=e.replace(n,(function(e,t,r,n,i){return c[i]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nvarying ").concat(r," ").concat(n," ").concat(i,";\n#else\nuniform ").concat(r," ").concat(n," u_").concat(i,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(r," ").concat(n," ").concat(i," = u_").concat(i,";\n#endif\n")})),vertexSource:t=t.replace(n,(function(e,t,r,n,i){var a="float"===n?"vec2":"vec4",o=i.match(/color/)?"color":a;return c[i]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(r," ").concat(a," a_").concat(i,";\nvarying ").concat(r," ").concat(n," ").concat(i,";\n#else\nuniform ").concat(r," ").concat(n," u_").concat(i,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(r," ").concat(n," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(o,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(r," ").concat(n," ").concat(i," = u_").concat(i,";\n#endif\n"):"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(r," ").concat(a," a_").concat(i,";\n#else\nuniform ").concat(r," ").concat(n," u_").concat(i,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(r," ").concat(n," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(r," ").concat(n," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(r," ").concat(n," ").concat(i," = unpack_mix_").concat(o,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(r," ").concat(n," ").concat(i," = u_").concat(i,";\n#endif\n")})),staticAttributes:a,staticUniforms:l}}var cr=function(){function e(){v(this,e),this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}return m(e,[{key:"bind",value:function(e,t,r,n,i,a,o,s){this.context=e;for(var u=this.boundPaintVertexBuffers.length!==n.length,l=0;!u&&l<n.length;l++)this.boundPaintVertexBuffers[l]!==n[l]&&(u=!0);e.extVertexArrayObject&&this.vao&&this.boundProgram===t&&this.boundLayoutVertexBuffer===r&&!u&&this.boundIndexBuffer===i&&this.boundVertexOffset===a&&this.boundDynamicVertexBuffer===o&&this.boundDynamicVertexBuffer2===s?(e.bindVertexArrayOES.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind()):this.freshBind(t,r,n,i,a,o,s)}},{key:"freshBind",value:function(e,t,r,n,i,a,o){var s,u=e.numAttributes,l=this.context,c=l.gl;if(l.extVertexArrayObject)this.vao&&this.destroy(),this.vao=l.extVertexArrayObject.createVertexArrayOES(),l.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o;else{s=l.currentNumAttributes||0;for(var h=u;h<s;h++)c.disableVertexAttribArray(h)}t.enableAttributes(c,e);var d,p=f(r);try{for(p.s();!(d=p.n()).done;)d.value.enableAttributes(c,e)}catch(g){p.e(g)}finally{p.f()}a&&a.enableAttributes(c,e),o&&o.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);var y,v=f(r);try{for(v.s();!(y=v.n()).done;){var m=y.value;m.bind(),m.setVertexAttribPointers(c,e,i)}}catch(g){v.e(g)}finally{v.f()}a&&(a.bind(),a.setVertexAttribPointers(c,e,i)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,e,i)),l.currentNumAttributes=u}},{key:"destroy",value:function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}]),e}();function hr(t,r){var n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new e.MercatorCoordinate(0,i/n).toLngLat().lat,new e.MercatorCoordinate(0,(i+1)/n).toLngLat().lat]}function fr(t,r,n,i,a,o,s){var u=t.context,l=u.gl,c=n.fbo;if(c){t.prepareDrawTile(r);var h=t.useProgram("hillshade");u.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.colorAttachment.get());var f=function(e,t,r,n){var i=r.paint.get("hillshade-shadow-color"),a=r.paint.get("hillshade-highlight-color"),o=r.paint.get("hillshade-accent-color"),s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);var u=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),u),u_image:0,u_latrange:hr(0,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:a,u_accent:o}}(t,n,i,t.terrain?r.projMatrix:null);t.prepareDrawProgram(u,h,r.toUnwrapped()),h.draw(u,l.TRIANGLES,a,o,s,e.CullFaceMode.disabled,f,i.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}function dr(t,r,n){if(r.needsDEMTextureUpload){var i=t.context,a=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(n.stride);var o=n.getPixels();r.demTexture?r.demTexture.update(o,{premultiply:!1}):r.demTexture=new e.Texture(i,o,a.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}}function pr(t,r,n,i,a,o){var s=t.context,u=s.gl;if(r.dem){var l=r.dem;if(s.activeTexture.set(u.TEXTURE1),dr(t,r,l),r.demTexture){r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);var c=l.dim;s.activeTexture.set(u.TEXTURE0);var h=r.fbo;if(!h){var f=new e.Texture(s,{width:c,height:c,data:null},u.RGBA);f.bind(u.LINEAR,u.CLAMP_TO_EDGE),(h=r.fbo=s.createFramebuffer(c,c,!0)).colorAttachment.set(f.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,c,c]),t.useProgram("hillshadePrepare").draw(s,u.TRIANGLES,i,a,o,e.CullFaceMode.disabled,function(t,r){var n=r.stride,i=e.create$1();return e.ortho(i,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(i,i,[0,-e.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:r.unpackVector}}(r.tileID,l),n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments),r.needsHillshadePrepare=!1}}}var yr=function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image0:new e.Uniform1i(t,r.u_image0),u_skirt_height:new e.Uniform1f(t,r.u_skirt_height)}},vr=function(e,t){return{u_matrix:e,u_image0:0,u_skirt_height:t}},mr=new(function(){function e(){v(this,e),this.operations={}}return m(e,[{key:"newMorphing",value:function(e,t,r,n,i){if(e in this.operations){var a=this.operations[e];a.to.tileID.key!==r.tileID.key&&(a.queued=r)}else this.operations[e]={startTime:n,phase:0,duration:i,from:t,to:r,queued:null}}},{key:"getMorphValuesForProxy",value:function(e){if(!(e in this.operations))return null;var t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}},{key:"update",value:function(e){for(var t in this.operations){var r=this.operations[t];for(r.phase=(e-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,e)){delete this.operations[t];break}}}},{key:"_nextOp",value:function(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}},{key:"_validOp",value:function(e){return e.from.hasData()&&e.to.hasData()}}]),e}()),gr={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function _r(e,t){var r=1<<e.z;return!t&&(0===e.x||e.x===r-1)||0===e.y||e.y===r-1}var br=function(e){return{u_matrix:e}};function wr(t,r,n,i,a){if(a>0){var o=e.exported.now(),s=(o-t.timeAdded)/a,u=r?(o-r.timeAdded)/a:-1,l=n.getSource(),c=i.coveringZoomLevel({tileSize:l.tileSize,roundZoom:l.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-c)>Math.abs(t.tileID.overscaledZ-c),f=h&&t.refreshedUponExpiration?1:e.clamp(h?s:1-u,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}var xr=function(t){p(n,t);var r=y(n);function n(e){var t;v(this,n);var a=Fe("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new U(Ze(),null),e.style);return t=r.call(this,"proxy",a,!1),a.setEventedParent(i(t)),t.map=t.getSource().map=e,t.used=t._sourceLoaded=!0,t.renderCache=[],t.renderCachePool=[],t.proxyCachedFBO={},t}return m(n,[{key:"update",value:function(t,r,n){var i=this;if(!t.freezeTileCoverage){this.transform=t;var a=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((function(r,n){if(r[n.key]="",!i._tiles[n.key]){var a=new e.Tile(n,i._source.tileSize*n.overscaleFactor(),t.tileZoom);a.state="loaded",i._tiles[n.key]=a}return r}),{});for(var o in this._tiles)o in a||(this.freeFBO(o),this._tiles[o].state="unloaded",delete this._tiles[o])}}},{key:"freeFBO",value:function(e){var t=this.proxyCachedFBO[e];if(void 0!==t){var r,n=Object.values(t);(r=this.renderCachePool).push.apply(r,c(n)),delete this.proxyCachedFBO[e]}}},{key:"deallocRenderCache",value:function(){this.renderCache.forEach((function(e){return e.fb.destroy()})),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}]),n}(e.SourceCache),kr=function(e){p(r,e);var t=y(r);function r(e,n,i){var a;return v(this,r),(a=t.call(this,e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)).proxyTileKey=n,a.projMatrix=i,a}return r}(e.OverscaledTileID),Er=function(t){p(n,t);var r=y(n);function n(t,i){var a;v(this,n),(a=r.call(this)).painter=t,a.terrainTileForTile={},a.prevTerrainTileForTile={};var o=function(t){var r=new e.StructArrayLayout4i8,n=new e.StructArrayLayout3ui6,i=131;r.reserve(17161),n.reserve(33800);for(var a=e.EXTENT/128,o=e.EXTENT+a/2,s=o+a,u=-a;u<s;u+=a)for(var l=-a;l<s;l+=a){var c=l<0||l>o||u<0||u>o?24575:0,h=e.clamp(Math.round(l),0,e.EXTENT),f=e.clamp(Math.round(u),0,e.EXTENT);r.emplaceBack(h+c,f,h,f)}for(var d=function(e,t){var r=t*i+e;n.emplaceBack(r+1,r,r+i),n.emplaceBack(r+i,r+i+1,r+1)},p=1;p<129;p++)for(var y=1;y<129;y++)d(y,p);return[0,129].forEach((function(e){for(var t=0;t<130;t++)d(t,e),d(e,t)})),[r,n,32768]}(),s=h(o,3),u=s[0],l=s[1],c=s[2],f=t.context;a.gridBuffer=f.createVertexBuffer(u,Be.members),a.gridIndexBuffer=f.createIndexBuffer(l),a.gridSegments=e.SegmentVector.simpleSegment(0,0,u.length,l.length),a.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,u.length,c),a.proxyCoords=[],a.proxiedCoords={},a._visibleDemTiles=[],a._drapedRenderBatches=[],a._sourceTilesOverlap={},a.proxySourceCache=new xr(i.map),a.orthoMatrix=e.create$1(),e.ortho(a.orthoMatrix,0,e.EXTENT,0,e.EXTENT,0,1);var d=f.gl;return a._overlapStencilMode=new e.StencilMode({func:d.GEQUAL,mask:255},0,255,d.KEEP,d.KEEP,d.REPLACE),a._previousZoom=t.transform.zoom,a.pool=[],a._findCoveringTileCache={},a._tilesDirty={},a.style=i,a._useVertexMorphing=!0,a._exaggeration=1,a}return m(n,[{key:"update",value:function(t,r,n){var i=this;if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;var a=t.terrain.properties;this.sourceCache=t._getSourceCache(a.get("source")),this._exaggeration=a.get("exaggeration");var o=function(){i.sourceCache.used&&e.warnOnce("Raster DEM source '".concat(i.sourceCache.id,"' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source."));var t=i.sourceCache.getSource().tileSize/128,n=i.proxySourceCache.getSource().tileSize;i.sourceCache.update(r,t*n,!0),i._findCoveringTileCache[i.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),r.updateElevation(!n),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0}else this._disable()}},{key:"_checkRenderCacheEfficiency",value:function(){var t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce("Terrain render cache efficiency is not optimal (".concat(t.efficiency,"%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '").concat(t.firstUndrapedLayer,"' or create a map using optimizeForTerrain: true option."))}},{key:"_onStyleDataEvent",value:function(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}},{key:"_disable",value:function(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(var e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}},{key:"destroy",value:function(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((function(e){return e.fb.destroy()})),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}},{key:"_source",value:function(){return this.enabled?this.sourceCache:null}},{key:"exaggeration",value:function(){return this._exaggeration}},{key:"updateTileBinding",value:function(t){var r=this;if(this.enabled){this.prevTerrainTileForTile=this.terrainTileForTile;var n=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=0===i._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(i.center),-1),this._emptyDEMTextureDirty=!this._initializing);var a=this.proxyCoords=n.getIds().map((function(e){var t=n.getTileByID(e).tileID;return t.projMatrix=i.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,r){var n=r.transform.pointCoordinate(r.transform.getCameraPoint()),i=new e.pointGeometry(n.x,n.y);t.sort((function(t,r){if(r.overscaledZ-t.overscaledZ)return r.overscaledZ-t.overscaledZ;var n=new e.pointGeometry(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),a=new e.pointGeometry(r.canonical.x+(1<<r.canonical.z)*r.wrap,r.canonical.y),o=i.mult(1<<t.canonical.z);return o.x-=.5,o.y-=.5,o.distSqr(n)-o.distSqr(a)}))}(a,this.painter),this._previousZoom=i.zoom;var o=this.proxyToSource||{};this.proxyToSource={},a.forEach((function(e){r.proxyToSource[e.key]={}})),this.terrainTileForTile={};var s=this._style._sourceCaches;for(var u in s){var l=s[u];if(l.used&&(l!==this.sourceCache&&(this._findCoveringTileCache[l.id]={}),this._setupProxiedCoordsForOrtho(l,t[u],o),!l.usedForTerrain)){var c=t[u];l.getSource().reparseOverscaled&&this._assignTerrainTiles(c)}}this.proxiedCoords[n.id]=a.map((function(e){return new kr(e,e.key,r.orthoMatrix)})),this._assignTerrainTiles(a),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();var h={};this._visibleDemTiles=[];var d,p=f(this.proxyCoords);try{for(p.s();!(d=p.n()).done;){var y=d.value,v=this.terrainTileForTile[y.key];if(v){var m=v.tileID.key;m in h||(this._visibleDemTiles.push(v),h[m]=m)}}}catch(g){p.e(g)}finally{p.f()}}}},{key:"_assignTerrainTiles",value:function(e){var t=this;this._initializing||e.forEach((function(e){if(!t.terrainTileForTile[e.key]){var r=t._findTileCoveringTileID(e,t.sourceCache);r&&(t.terrainTileForTile[e.key]=r)}}))}},{key:"_prepareDEMTextures",value:function(){var e=this.painter.context,t=e.gl;for(var r in this.terrainTileForTile){var n=this.terrainTileForTile[r],i=n.dem;!i||n.demTexture&&!n.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),dr(this.painter,n,i))}}},{key:"_prepareDemTileUniforms",value:function(e,t,r,n){if(!t||null==t.demTexture)return!1;var i=e.tileID.canonical,a=Math.pow(2,t.tileID.canonical.z-i.z),o=n||"";return r["u_dem_tl".concat(o)]=[i.x*a%1,i.y*a%1],r["u_dem_scale".concat(o)]=a,!0}},{key:"_getLoadedAreaMinimum",value:function(){var e=0,t=this._visibleDemTiles.reduce((function(t,r){if(!r.dem)return t;var n=r.dem.tree.minimums[0];return n>0&&e++,t+n}),0);return e?t/e:0}},{key:"_updateEmptyDEMTexture",value:function(){var t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);var n=this._getLoadedAreaMinimum(),i={width:1,height:1,data:new Uint8Array(e.DEMData.pack(n,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;var a=this._emptyDEMTexture;return a?a.update(i,{premultiply:!1}):a=this._emptyDEMTexture=new e.Texture(t,i,r.RGBA,{premultiply:!1}),a}},{key:"setupElevationDraw",value:function(t,r,n){var i,a=this.painter.context,o=a.gl,s=(i=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(i),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});s.u_dem_size=this.sourceCache.getSource().tileSize,s.u_exaggeration=this.exaggeration();var u=null,l=null,c=1;if(n&&n.morphing&&this._useVertexMorphing){var h=n.morphing.srcDemTile,f=n.morphing.dstDemTile;c=n.morphing.phase,h&&f&&(this._prepareDemTileUniforms(t,h,s,"_prev")&&(l=h),this._prepareDemTileUniforms(t,f,s)&&(u=f))}if(l&&u?(a.activeTexture.set(o.TEXTURE2),u.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.activeTexture.set(o.TEXTURE4),l.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_dem_lerp=c):(u=this.terrainTileForTile[t.tileID.key],a.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(t,u,s)?u.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST)),n&&n.useDepthForOcclusion&&(a.activeTexture.set(o.TEXTURE3),this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),s.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),n&&n.useMeterToDem&&u){var d=(1<<u.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;s.u_meter_to_dem=d}n&&n.labelPlaneMatrixInv&&(s.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),r.setTerrainUniformValues(a,s)}},{key:"renderToBackBuffer",value:function(t){var r=this.painter,n=this.painter.context;0!==t.length&&(n.bindFramebuffer.set(null),n.viewport.set([0,0,r.width,r.height]),this.renderingToTexture=!1,function(t,r,n,i,a){var o,s,u=t.context,l=u.gl,c=t.options.showTerrainWireframe?2:0,d=function(e,r){if(s!==e){var n=[gr[e]];r&&n.push(gr[c]),o=t.useProgram("terrainRaster",null,n),s=e}},p=t.colorModeForRenderPass(),y=new e.DepthMode(l.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);mr.update(a);var v=t.transform,m=6*Math.pow(1.5,22-v.zoom)*r.exaggeration();(c?[!1,!0]:[!1]).forEach((function(c){s=-1;var g,_,b,w=c?l.LINES:l.TRIANGLES,x=c?r.getWirefameBuffer():[r.gridIndexBuffer,r.gridSegments],k=h(x,2),E=k[0],S=k[1],T=f(i);try{for(T.s();!(g=T.n()).done;){var A=g.value,C=n.getTile(A),I=e.StencilMode.disabled,R=r.prevTerrainTileForTile[A.key],M=r.terrainTileForTile[A.key];b=M,null!=(_=R)&&null!=b&&_.hasData()&&b.hasData()&&null!=_.demTexture&&null!=b.demTexture&&_.tileID.key!==b.tileID.key&&mr.newMorphing(A.key,R,M,a,250),u.activeTexture.set(l.TEXTURE0),C.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);var P=mr.getMorphValuesForProxy(A.key),O=P?1:0,L=void 0;P&&(L={morphing:{srcDemTile:P.from,dstDemTile:P.to,phase:e.easeCubicInOut(P.phase)}});var D=vr(A.projMatrix,_r(A.canonical,v.renderWorldCopies)?m/10:m);d(O,c),r.setupElevationDraw(C,o,L),t.prepareDrawProgram(u,o,A.toUnwrapped()),o.draw(u,w,y,I,p,e.CullFaceMode.backCCW,D,"terrain_raster",r.gridBuffer,E,S)}}catch(B){T.e(B)}finally{T.f()}}))}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,t.splice(0,t.length))}},{key:"renderBatch",value:function(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;var r,n=this.painter,i=this.painter.context,a=this.proxySourceCache,o=this.proxiedCoords[a.id],s=this._drapedRenderBatches.shift(),u=[],l=n.style.order,c=0,h=f(o);try{for(h.s();!(r=h.n()).done;){var d=r.value,p=a.getTileByID(d.proxyTileKey),y=a.proxyCachedFBO[d.key]?a.proxyCachedFBO[d.key][t]:void 0,v=void 0!==y?a.renderCache[y]:this.pool[c++],m=void 0!==y;if(p.texture=v.tex,!m||v.dirty){var g=void 0;i.bindFramebuffer.set(v.fb.framebuffer),this.renderedToTile=!1,v.dirty&&(i.clear({color:e.Color.transparent}),v.dirty=!1);for(var _=s.start;_<=s.end;++_){var b=n.style._layers[l[_]];if(!b.isHidden(n.transform.zoom)){var w=n.style._getLayerSourceCache(b),x=w?this.proxyToSource[d.key][w.id]:[d];if(x){var k=x;i.viewport.set([0,0,v.fb.width,v.fb.height]),g!==(w?w.id:null)&&(this._setupStencil(v,x,b,w),g=w?w.id:null),n.renderLayer(n,w,b,k)}}}this.renderedToTile?(v.dirty=!0,u.push(p.tileID)):m||--c,5===c&&(c=0,this.renderToBackBuffer(u))}else u.push(p.tileID)}}catch(E){h.e(E)}finally{h.f()}return this.renderToBackBuffer(u),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,n.width,n.height]),s.end+1}},{key:"postRender",value:function(){}},{key:"renderCacheEfficiency",value:function(e){var t=e.order.length;if(0===t)return{efficiency:100};for(var r,n=0,i=0,a=!1,o=0;o<t;++o){var s=e._layers[e.order[o]];this._style.isLayerDraped(s)?(a&&++n,++i):a||(a=!0,r=s.id)}return 0===i?{efficiency:100}:{efficiency:100*(1-n/i),firstUndrapedLayer:r}}},{key:"getMinElevationBelowMSL",value:function(){var e=0;return this._visibleDemTiles.filter((function(e){return e.dem})).forEach((function(t){e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}},{key:"raycast",value:function(e,t,r){if(!this._visibleDemTiles)return null;var n=this._visibleDemTiles.filter((function(e){return e.dem})).map((function(n){var i=n.tileID,a=Math.pow(2,i.overscaledZ),o=i.canonical,s=o.x,u=o.y,l=s/a,c=(s+1)/a,h=u/a,f=(u+1)/a;return{minx:l,miny:h,maxx:c,maxy:f,t:n.dem.tree.raycastRoot(l,h,c,f,e,t,r),tile:n}}));n.sort((function(e,t){return(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)}));var i,a=f(n);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(null==o.t)return null;var s=o.tile.dem.tree.raycast(o.minx,o.miny,o.maxx,o.maxy,e,t,r);if(null!=s)return s}}catch(u){a.e(u)}finally{a.f()}return null}},{key:"_createFBO",value:function(){var t=this.painter.context,r=t.gl,n=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);var i=new e.Texture(t,{width:n[0],height:n[1],data:null},r.RGBA);i.bind(r.LINEAR,r.CLAMP_TO_EDGE);var a=t.createFramebuffer(n[0],n[1],!1);return a.colorAttachment.set(i.texture),a.depthAttachment=new Pe(t,a.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,a.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):a.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:a,tex:i,dirty:!1}}},{key:"_initFBOPool",value:function(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}},{key:"_shouldDisableRenderCache",value:function(){var e=this;if(this._style.light&&this._style.light.hasTransition())return!0;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t].hasTransition())return!0;return this._style.order.some((function(t){var r=e._style._layers[t],n=r.isHidden(e.painter.transform.zoom),i=r.getCrossfadeParameters(),a=!!i&&1!==i.t,o=r.hasTransition();return"custom"!==r.type&&!n&&(a||o)}))}},{key:"_clearRasterFadeFromRenderCache",value:function(){var e=!1;for(var t in this._style._sourceCaches)if(this._style._sourceCaches[t]._source instanceof De){e=!0;break}if(e)for(var r=0;r<this._style.order.length;++r){var n=this._style._layers[this._style.order[r]],i=n.isHidden(this.painter.transform.zoom),a=this._style._getLayerSourceCache(n);if("raster"===n.type&&!i&&a){var o,s=n.paint.get("raster-fade-duration"),u=f(this.proxyCoords);try{for(u.s();!(o=u.n()).done;){var l=o.value,c=this.proxyToSource[l.key][a.id];if(c){var h,d=f(c);try{for(d.s();!(h=d.n()).done;){var p=h.value,y=wr(a.getTile(p),a.findLoadedParent(p,0),a,this.painter.transform,s);(1!==y.opacity||0!==y.mix)&&this._clearRenderCacheForTile(a.id,p)}}catch(v){d.e(v)}finally{d.f()}}}}catch(v){u.e(v)}finally{u.f()}}}}},{key:"_setupDrapedRenderBatches",value:function(){var e=this._style.order,t=e.length;if(0!==t){for(var r,n=[],i=0,a=this._style._layers[e[i]];!this._style.isLayerDraped(a)&&a.isHidden(this.painter.transform.zoom)&&++i<t;)a=this._style._layers[e[i]];for(;i<t;++i){var o=this._style._layers[e[i]];o.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(o)?void 0===r&&(r=i):void 0!==r&&(n.push({start:r,end:i-1}),r=void 0))}void 0!==r&&n.push({start:r,end:i-1}),this._drapedRenderBatches=n}}},{key:"_setupRenderCache",value:function(e){var t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){var r=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(var n=0;n<r.length;++n){var i,a=Object.values(r[n]);(i=t.renderCachePool).push.apply(i,c(a))}}}else{this._clearRasterFadeFromRenderCache();for(var o=this.proxyCoords,s=this._tilesDirty,u=o.length-1;u>=0;u--){var l=o[u];if(t.getTileByID(l.key),void 0!==t.proxyCachedFBO[l.key]){var h=e[l.key],d=this.proxyToSource[l.key],p=0,y=function(e){var t=d[e],r=h[e];if(!r||r.length!==t.length||t.some((function(t,n){return t!==r[n]||s[e]&&s[e].hasOwnProperty(t.key)})))return p=-1,"break";++p};for(var v in d)if("break"===y(v))break;for(var m in t.proxyCachedFBO[l.key])t.renderCache[t.proxyCachedFBO[l.key][m]].dirty=p<0||p!==Object.values(h).length}}var g=c(this._drapedRenderBatches);g.sort((function(e,t){return t.end-t.start-(e.end-e.start)}));var _,b=f(g);try{for(b.s();!(_=b.n()).done;){var w,x=_.value,k=f(o);try{for(k.s();!(w=k.n()).done;){var E=w.value;if(!t.proxyCachedFBO[E.key]){var S=t.renderCachePool.pop();void 0===S&&t.renderCache.length<50&&(S=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==S&&(t.proxyCachedFBO[E.key]={},t.proxyCachedFBO[E.key][x.start]=S,t.renderCache[S].dirty=!0)}}}catch(T){k.e(T)}finally{k.f()}}}catch(T){b.e(T)}finally{b.f()}this._tilesDirty={}}}},{key:"_setupStencil",value:function(e,t,r,n){if(n&&this._sourceTilesOverlap[n.id]){var i=this.painter.context,a=i.gl;if(t.length<=1)this._overlapStencilType=!1;else{var o;if(r.isTileClipped())o=t.length,this._overlapStencilMode.test={func:a.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);o=1,this._overlapStencilMode.test={func:a.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+o>255&&(i.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=o,this._overlapStencilMode.ref=this._stencilRef,r.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}}else this._overlapStencilType&&(this._overlapStencilType=!1)}},{key:"stencilModeForRTTOverlap",value:function(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}},{key:"_renderTileClippingMasks",value:function(t,r){var n=this.painter,i=this.painter.context,a=i.gl;n._tileClippingMaskIDs={},i.setColorMode(e.ColorMode.disabled),i.setDepthMode(e.DepthMode.disabled);var o,s=n.useProgram("clippingMask"),u=f(t);try{for(u.s();!(o=u.n()).done;){var l=o.value,c=n._tileClippingMaskIDs[l.key]=--r;s.draw(i,a.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:a.ALWAYS,mask:0},c,255,a.KEEP,a.KEEP,a.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,br(l.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}catch(h){u.e(h)}finally{u.f()}}},{key:"pointCoordinate",value:function(t){var r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;var n=[t.x,t.y,1,1];e.transformMat4(n,n,r.pixelMatrixInverse),e.scale$2(n,n,1/n[3]),n[0]/=r.worldSize,n[1]/=r.worldSize;var i=r._camera.position,a=e.mercatorZfromAltitude(1,r.center.lat),o=[i[0],i[1],i[2]/a,0],s=e.subtract([],n.slice(0,3),o);e.normalize(s,s);var u=this.raycast(o,s,this._exaggeration);return null!==u&&u?(e.scaleAndAdd(o,o,s,u),o[3]=o[2],o[2]*=a,o):null}},{key:"drawDepth",value:function(){var t=this.painter,r=t.context,n=this.proxySourceCache,i=Math.ceil(t.width),a=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===i&&this._depthFBO.height===a||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){var o=r.gl,s=r.createFramebuffer(i,a,!0);r.activeTexture.set(o.TEXTURE0);var u=new e.Texture(r,{width:i,height:a,data:null},o.RGBA);u.bind(o.NEAREST,o.CLAMP_TO_EDGE),s.colorAttachment.set(u.texture);var l=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,i,a);s.depthAttachment.set(l),this._depthFBO=s,this._depthTexture=u}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,i,a]),function(t,r,n,i){var a=t.context,o=a.gl;a.clear({depth:1});var s,u=t.useProgram("terrainDepth"),l=new e.DepthMode(o.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D),c=f(i);try{for(c.s();!(s=c.n()).done;){var h=s.value,d=n.getTile(h),p=vr(h.projMatrix,0);r.setupElevationDraw(d,u),u.draw(a,o.TRIANGLES,l,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,p,"terrain_depth",r.gridBuffer,r.gridIndexBuffer,r.gridNoSkirtSegments)}}catch(y){c.e(y)}finally{c.f()}}(t,this,n,this.proxyCoords)}},{key:"_setupProxiedCoordsForOrtho",value:function(e,t,r){if(e.getSource()instanceof Ne)return this._setupProxiedCoordsForImageSource(e,t,r);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};for(var n=this.proxiedCoords[e.id]=[],i=this.proxyCoords,a=0;a<i.length;a++){var o=i[a],s=this._findTileCoveringTileID(o,e);if(s){var u=this._createProxiedId(o,s,r[o.key]&&r[o.key][e.id]);n.push(u),this.proxyToSource[o.key][e.id]=[u]}}for(var l=!1,c=0;c<t.length;c++){var h=e.getTile(t[c]);if(h&&h.hasData()){var f=this._findTileCoveringTileID(h.tileID,this.proxySourceCache);if(f&&f.tileID.canonical.z!==h.tileID.canonical.z){var d=this.proxyToSource[f.tileID.key][e.id],p=this._createProxiedId(f.tileID,h,r[f.tileID.key]&&r[f.tileID.key][e.id]);d?d.splice(d.length-1,0,p):this.proxyToSource[f.tileID.key][e.id]=[p],n.push(p),l=!0}}}this._sourceTilesOverlap[e.id]=l}},{key:"_setupProxiedCoordsForImageSource",value:function(t,r,n){if(t.getSource().loaded())for(var i=this.proxiedCoords[t.id]=[],a=this.proxyCoords,o=t.getSource(),s=new e.pointGeometry(o.tileID.x,o.tileID.y)._div(1<<o.tileID.z),u=o.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce((function(e,t){return e.min.x=Math.min(e.min.x,t.x-s.x),e.min.y=Math.min(e.min.y,t.y-s.y),e.max.x=Math.max(e.max.x,t.x-s.x),e.max.y=Math.max(e.max.y,t.y-s.y),e}),{min:new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),l=function(t,r){var n=t.wrap+t.canonical.x/(1<<t.canonical.z),i=t.canonical.y/(1<<t.canonical.z),a=e.EXTENT/(1<<t.canonical.z),o=r.wrap+r.canonical.x/(1<<r.canonical.z),s=r.canonical.y/(1<<r.canonical.z);return n+a<o+u.min.x||n>o+u.max.x||i+a<s+u.min.y||i>s+u.max.y},c=0;c<a.length;c++)for(var h=a[c],f=0;f<r.length;f++){var d=t.getTile(r[f]);if(d&&d.hasData()&&!l(h,d.tileID)){var p=this._createProxiedId(h,d,n[h.key]&&n[h.key][t.id]),y=this.proxyToSource[h.key][t.id];y?y.push(p):this.proxyToSource[h.key][t.id]=[p],i.push(p)}}}},{key:"_createProxiedId",value:function(t,r,n){var i=this.orthoMatrix;if(n){var a=n.find((function(e){return e.key===r.tileID.key}));if(a)return a}if(r.tileID.key!==t.key){var o,s,u,l=t.canonical.z-r.tileID.canonical.z;i=e.create$1();var c=r.tileID.wrap-t.wrap<<t.overscaledZ;l>0?(s=(o=e.EXTENT>>l)*((r.tileID.canonical.x<<l)-t.canonical.x+c),u=o*((r.tileID.canonical.y<<l)-t.canonical.y)):(o=e.EXTENT<<-l,s=e.EXTENT*(r.tileID.canonical.x-(t.canonical.x+c<<-l)),u=e.EXTENT*(r.tileID.canonical.y-(t.canonical.y<<-l))),e.ortho(i,0,o,0,o,0,1),e.translate(i,i,[s,u,0])}return new kr(r.tileID,t.key,i)}},{key:"_findTileCoveringTileID",value:function(t,r){var n=r.getTile(t);if(n&&n.hasData())return n;var i=this._findCoveringTileCache[r.id],a=i[t.key];if((n=a?r.getTileByID(a):null)&&n.hasData()||null===a)return n;var o=n?n.tileID:t,s=o.overscaledZ,u=r.getSource().minzoom,l=[];if(!a){var c=r.getSource().maxzoom;if(t.canonical.z>=c){var h=t.canonical.z-c;r.getSource().reparseOverscaled?(s=Math.max(t.canonical.z+2,r.transform.tileZoom),o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h)):0!==h&&(s=c,o=new e.OverscaledTileID(s,t.wrap,c,t.canonical.x>>h,t.canonical.y>>h))}o.key!==t.key&&(l.push(o.key),n=r.getTile(o))}var f=function(e){l.forEach((function(t){i[t]=e})),l.length=0};for(s-=1;s>=u&&(!n||!n.hasData());s--){n&&f(n.tileID.key);var d=o.calculateScaledKey(s);if((n=r.getTileByID(d))&&n.hasData())break;var p=i[d];if(null===p)break;void 0===p?l.push(d):n=r.getTileByID(p)}return f(n?n.tileID.key:null),n&&n.hasData()?n:null}},{key:"findDEMTileFor",value:function(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}},{key:"prepareDrawTile",value:function(e){this.renderedToTile=!0}},{key:"_clearRenderCacheForTile",value:function(e,t){var r=this._tilesDirty[e];r||(r=this._tilesDirty[e]={}),r[t.key]=!0}},{key:"getWirefameBuffer",value:function(){if(!this.wireframeSegments){var t=function(t){var r,n,i,a=new e.StructArrayLayout2ui4,o=131;for(n=1;n<129;n++){for(r=1;r<129;r++)i=n*o+r,a.emplaceBack(i,i+1),a.emplaceBack(i,i+o),a.emplaceBack(i+1,i+o),128===n&&a.emplaceBack(i+o,i+o+1);a.emplaceBack(i+1,i+1+o)}return a}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}},{key:"style",set:function(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency()}},{key:"visibleDemTiles",get:function(){return this._visibleDemTiles}},{key:"drapeBufferSize",get:function(){var e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}},{key:"useVertexMorphing",set:function(e){this._useVertexMorphing=e}},{key:"emptyDEMTexture",get:function(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}}]),n}(e.Elevation);function Sr(e){for(var t=[],r=0;r<e.length;r++)if(null!==e[r]){var n=e[r].split(" ");t.push(n.pop())}return t}var Tr=function(){function t(r,n,i,a,o,s){v(this,t);var u=r.gl;this.program=u.createProgram();var l,c=Sr(i.staticAttributes),h=a?a.getBinderAttributes():[],d=c.concat(h),p=i.staticUniforms?Sr(i.staticUniforms):[],y=a?a.getBinderUniforms():[],m=p.concat(y),g=[],_=f(m);try{for(_.s();!(l=_.n()).done;){var b=l.value;g.indexOf(b)<0&&g.push(b)}}catch(M){_.e(M)}finally{_.f()}var w=a?a.defines():[],x=(w=w.concat(s.map((function(e){return"#define ".concat(e)})))).concat(or.fragmentSource,sr,ar.fragmentSource,i.fragmentSource).join("\n"),k=w.concat(or.vertexSource,sr,ar.vertexSource,ir.vertexSource,i.vertexSource).join("\n"),E=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(E,x),u.compileShader(E),u.attachShader(this.program,E);var S=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(S,k),u.compileShader(S),u.attachShader(this.program,S),this.attributes={};var T={};this.numAttributes=d.length;for(var A=0;A<this.numAttributes;A++)d[A]&&(u.bindAttribLocation(this.program,A,d[A]),this.attributes[d[A]]=A);u.linkProgram(this.program),u.deleteShader(S),u.deleteShader(E);for(var C=0;C<g.length;C++){var I=g[C];if(I&&!T[I]){var R=u.getUniformLocation(this.program,I);R&&(T[I]=R)}}this.fixedUniforms=o(r,T),this.binderUniforms=a?a.getUniforms(r,T):[],-1!==s.indexOf("TERRAIN")&&(this.terrainUniforms=function(t,r){return{u_dem:new e.Uniform1i(t,r.u_dem),u_dem_prev:new e.Uniform1i(t,r.u_dem_prev),u_dem_unpack:new e.Uniform4f(t,r.u_dem_unpack),u_dem_tl:new e.Uniform2f(t,r.u_dem_tl),u_dem_scale:new e.Uniform1f(t,r.u_dem_scale),u_dem_tl_prev:new e.Uniform2f(t,r.u_dem_tl_prev),u_dem_scale_prev:new e.Uniform1f(t,r.u_dem_scale_prev),u_dem_size:new e.Uniform1f(t,r.u_dem_size),u_dem_lerp:new e.Uniform1f(t,r.u_dem_lerp),u_exaggeration:new e.Uniform1f(t,r.u_exaggeration),u_depth:new e.Uniform1i(t,r.u_depth),u_depth_size_inv:new e.Uniform2f(t,r.u_depth_size_inv),u_meter_to_dem:new e.Uniform1f(t,r.u_meter_to_dem),u_label_plane_matrix_inv:new e.UniformMatrix4f(t,r.u_label_plane_matrix_inv)}}(r,T)),-1!==s.indexOf("FOG")&&(this.fogUniforms=function(t,r){return{u_fog_matrix:new e.UniformMatrix4f(t,r.u_fog_matrix),u_fog_range:new e.Uniform2f(t,r.u_fog_range),u_fog_color:new e.Uniform4f(t,r.u_fog_color),u_fog_horizon_blend:new e.Uniform1f(t,r.u_fog_horizon_blend),u_fog_temporal_offset:new e.Uniform1f(t,r.u_fog_temporal_offset)}}(r,T))}}}return m(t,null,[{key:"cacheKey",value:function(e,t,r){var n,i="".concat(e).concat(r?r.cacheKey:""),a=f(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;i+="/".concat(o)}}catch(s){a.e(s)}finally{a.f()}return i}}]),m(t,[{key:"setTerrainUniformValues",value:function(e,t){if(this.terrainUniforms){var r=this.terrainUniforms;if(!this.failedToCreate)for(var n in e.program.set(this.program),t)r[n].set(t[n])}}},{key:"setFogUniformValues",value:function(e,t){if(this.fogUniforms){var r=this.fogUniforms;if(!this.failedToCreate)for(var n in e.program.set(this.program),t)r[n].location&&r[n].set(t[n])}}},{key:"draw",value:function(e,t,r,i,a,o,s,u,l,c,h,d,p,y,v,m){var g,_=e.gl;if(!this.failedToCreate){for(var b in e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(i),e.setColorMode(a),e.setCullFace(o),this.fixedUniforms)this.fixedUniforms[b].set(s[b]);y&&y.setUniforms(e,this.binderUniforms,d,{zoom:p});var w,x=(g={},n(g,_.LINES,2),n(g,_.TRIANGLES,3),n(g,_.LINE_STRIP,1),g)[t],k=f(h.get());try{for(k.s();!(w=k.n()).done;){var E=w.value,S=E.vaos||(E.vaos={});(S[u]||(S[u]=new cr)).bind(e,this,l,y?y.getPaintVertexBuffers():[],c,E.vertexOffset,v,m),_.drawElements(t,E.primitiveLength*x,_.UNSIGNED_SHORT,E.primitiveOffset*x*2)}}catch(T){k.e(T)}finally{k.f()}}}}]),t}();function Ar(e,t,r){var n=1/V(r,1,t.transform.tileZoom),i=Math.pow(2,r.tileID.overscaledZ),a=r.tileSize*Math.pow(2,t.transform.tileZoom)/i,o=a*(r.tileID.canonical.x+r.tileID.wrap*i),s=a*r.tileID.canonical.y;return{u_image:0,u_texsize:r.imageAtlasTexture.size,u_scale:[n,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}var Cr=function(t,r,n,i){var a=r.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],u=e.create$2();"viewport"===a.properties.get("anchor")&&(e.fromRotation(u,-r.transform.angle),e.transformMat3(s,s,u));var l=a.properties.get("color");return{u_matrix:t,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+n,u_opacity:i}},Ir=function(t,r,n,i,a,o,s){return e.extend(Cr(t,r,n,i),Ar(o,r,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8})},Rr=function(e){return{u_matrix:e}},Mr=function(t,r,n,i){return e.extend(Rr(t),Ar(n,r,i))},Pr=function(e,t){return{u_matrix:e,u_world:t}},Or=function(t,r,n,i,a){return e.extend(Mr(t,r,n,i),{u_world:a})},Lr=function(t,r,n,i){var a,o=t.transform;if("map"===i.paint.get("circle-pitch-alignment")){var s=V(n,1,o.zoom);a=[s,s]}else a=o.pixelsToGLUnits;return{u_camera_to_center_distance:o.cameraToCenterDistance,u_matrix:t.translatePosMatrix(r.projMatrix,n,i.paint.get("circle-translate"),i.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:a}},Dr=function(e){var t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},Br=function(t,r,n){var i=e.EXTENT/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:r.cameraToCenterDistance,u_extrude_scale:[r.pixelsToGLUnits[0]/i,r.pixelsToGLUnits[1]/i]}},Nr=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},zr=function(e,t,r,n){return{u_matrix:e,u_extrude_scale:V(t,1,r),u_intensity:n}},Fr=function(t,r,n,i){var a=t.transform;return{u_matrix:Gr(t,r,n,i),u_ratio:1/V(r,1,a.zoom),u_device_pixel_ratio:e.exported.devicePixelRatio,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},jr=function(t,r,n,i,a){return e.extend(Fr(t,r,n,i),{u_image:0,u_image_height:a})},Ur=function(t,r,n,i,a){var o=t.transform,s=qr(r,o);return{u_matrix:Gr(t,r,n,a),u_texsize:r.imageAtlasTexture.size,u_ratio:1/V(r,1,o.zoom),u_device_pixel_ratio:e.exported.devicePixelRatio,u_image:0,u_scale:[s,i.fromScale,i.toScale],u_fade:i.t,u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]]}},Vr=function(t,r,n,i,a){var o=qr(r,t.transform);return e.extend(Fr(t,r,n,a),{u_texsize:r.lineAtlasTexture.size,u_scale:[o,i.fromScale,i.toScale],u_image:0,u_mix:i.t})};function qr(e,t){return 1/V(e,1,t.tileZoom)}function Gr(e,t,r,n){return e.translatePosMatrix(n||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}var Kr=function(e,t,r,n,i){return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(o=i.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=i.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Hr(i.paint.get("raster-hue-rotate"))};var a,o};function Hr(e){e*=Math.PI/180;var t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}var Wr,Zr=function(e,t,r,n,i,a,o,s,u,l){var c=i.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+r,u_aspect_ratio:c.width/c.height,u_fade_change:i.options.fadeDuration?i.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+u,u_pitch_with_map:+n,u_texsize:l,u_texture:0}},Yr=function(t,r,n,i,a,o,s,u,l,c,h){var f=a.transform,d=f.cameraToCenterDistance,p=f._pitch;return e.extend(Zr(t,r,n,i,a,o,s,u,l,c),{u_gamma_scale:i?d*Math.cos(a.terrain?0:p):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+h})},Xr=function(t,r,n,i,a,o,s,u,l,c){return e.extend(Yr(t,r,n,i,a,o,s,u,!0,l,!0),{u_texsize_icon:c,u_texture_icon:1})},Qr=function(e,t,r){return{u_matrix:e,u_opacity:t,u_color:r}},Jr=function(t,r,n,i,a,o){return e.extend(function(e,t,r,n){var i=r.imageManager.getPattern(e.from.toString()),a=r.imageManager.getPattern(e.to.toString()),o=r.imageManager.getPixelSize(),s=o.width,u=o.height,l=Math.pow(2,n.tileID.overscaledZ),c=n.tileSize*Math.pow(2,r.transform.tileZoom)/l,h=c*(n.tileID.canonical.x+n.tileID.wrap*l),f=c*n.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[s,u],u_mix:t.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/V(n,1,r.transform.tileZoom),u_pixel_coord_upper:[h>>16,f>>16],u_pixel_coord_lower:[65535&h,65535&f]}}(i,o,n,a),{u_matrix:t,u_opacity:r})},$r={fillExtrusion:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fillExtrusionPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_lightpos:new e.Uniform3f(t,r.u_lightpos),u_lightintensity:new e.Uniform1f(t,r.u_lightintensity),u_lightcolor:new e.Uniform3f(t,r.u_lightcolor),u_vertical_gradient:new e.Uniform1f(t,r.u_vertical_gradient),u_height_factor:new e.Uniform1f(t,r.u_height_factor),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade),u_opacity:new e.Uniform1f(t,r.u_opacity)}},fill:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},fillPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},fillOutline:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world)}},fillOutlinePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_world:new e.Uniform2f(t,r.u_world),u_image:new e.Uniform1i(t,r.u_image),u_texsize:new e.Uniform2f(t,r.u_texsize),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},circle:function(t,r){return{u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},collisionBox:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_extrude_scale:new e.Uniform2f(t,r.u_extrude_scale)}},collisionCircle:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_inv_matrix:new e.UniformMatrix4f(t,r.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(t,r.u_viewport_size)}},debug:function(t,r){return{u_color:new e.UniformColor(t,r.u_color),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_overlay:new e.Uniform1i(t,r.u_overlay),u_overlay_scale:new e.Uniform1f(t,r.u_overlay_scale)}},clippingMask:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmap:function(t,r){return{u_extrude_scale:new e.Uniform1f(t,r.u_extrude_scale),u_intensity:new e.Uniform1f(t,r.u_intensity),u_matrix:new e.UniformMatrix4f(t,r.u_matrix)}},heatmapTexture:function(t,r){return{u_image:new e.Uniform1i(t,r.u_image),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_opacity:new e.Uniform1f(t,r.u_opacity)}},hillshade:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_latrange:new e.Uniform2f(t,r.u_latrange),u_light:new e.Uniform2f(t,r.u_light),u_shadow:new e.UniformColor(t,r.u_shadow),u_highlight:new e.UniformColor(t,r.u_highlight),u_accent:new e.UniformColor(t,r.u_accent)}},hillshadePrepare:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_image:new e.Uniform1i(t,r.u_image),u_dimension:new e.Uniform2f(t,r.u_dimension),u_zoom:new e.Uniform1f(t,r.u_zoom),u_unpack:new e.Uniform4f(t,r.u_unpack)}},line:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels)}},lineGradient:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image),u_image_height:new e.Uniform1f(t,r.u_image_height)}},linePattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_image:new e.Uniform1i(t,r.u_image),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_scale:new e.Uniform3f(t,r.u_scale),u_fade:new e.Uniform1f(t,r.u_fade)}},lineSDF:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_texsize:new e.Uniform2f(t,r.u_texsize),u_ratio:new e.Uniform1f(t,r.u_ratio),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(t,r.u_units_to_pixels),u_image:new e.Uniform1i(t,r.u_image),u_scale:new e.Uniform3f(t,r.u_scale),u_mix:new e.Uniform1f(t,r.u_mix)}},raster:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_tl_parent:new e.Uniform2f(t,r.u_tl_parent),u_scale_parent:new e.Uniform1f(t,r.u_scale_parent),u_buffer_scale:new e.Uniform1f(t,r.u_buffer_scale),u_fade_t:new e.Uniform1f(t,r.u_fade_t),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image0:new e.Uniform1i(t,r.u_image0),u_image1:new e.Uniform1i(t,r.u_image1),u_brightness_low:new e.Uniform1f(t,r.u_brightness_low),u_brightness_high:new e.Uniform1f(t,r.u_brightness_high),u_saturation_factor:new e.Uniform1f(t,r.u_saturation_factor),u_contrast_factor:new e.Uniform1f(t,r.u_contrast_factor),u_spin_weights:new e.Uniform3f(t,r.u_spin_weights)}},symbolIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture)}},symbolSDF:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texture:new e.Uniform1i(t,r.u_texture),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},symbolTextAndIcon:function(t,r){return{u_is_size_zoom_constant:new e.Uniform1i(t,r.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(t,r.u_is_size_feature_constant),u_size_t:new e.Uniform1f(t,r.u_size_t),u_size:new e.Uniform1f(t,r.u_size),u_camera_to_center_distance:new e.Uniform1f(t,r.u_camera_to_center_distance),u_pitch:new e.Uniform1f(t,r.u_pitch),u_rotate_symbol:new e.Uniform1i(t,r.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(t,r.u_aspect_ratio),u_fade_change:new e.Uniform1f(t,r.u_fade_change),u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(t,r.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(t,r.u_coord_matrix),u_is_text:new e.Uniform1i(t,r.u_is_text),u_pitch_with_map:new e.Uniform1i(t,r.u_pitch_with_map),u_texsize:new e.Uniform2f(t,r.u_texsize),u_texsize_icon:new e.Uniform2f(t,r.u_texsize_icon),u_texture:new e.Uniform1i(t,r.u_texture),u_texture_icon:new e.Uniform1i(t,r.u_texture_icon),u_gamma_scale:new e.Uniform1f(t,r.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(t,r.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(t,r.u_is_halo)}},background:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_color:new e.UniformColor(t,r.u_color)}},backgroundPattern:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_opacity:new e.Uniform1f(t,r.u_opacity),u_image:new e.Uniform1i(t,r.u_image),u_pattern_tl_a:new e.Uniform2f(t,r.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(t,r.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(t,r.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(t,r.u_pattern_br_b),u_texsize:new e.Uniform2f(t,r.u_texsize),u_mix:new e.Uniform1f(t,r.u_mix),u_pattern_size_a:new e.Uniform2f(t,r.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(t,r.u_pattern_size_b),u_scale_a:new e.Uniform1f(t,r.u_scale_a),u_scale_b:new e.Uniform1f(t,r.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(t,r.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(t,r.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(t,r.u_tile_units_to_pixels)}},terrainRaster:yr,terrainDepth:yr,skybox:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_sun_direction:new e.Uniform3f(t,r.u_sun_direction),u_cubemap:new e.Uniform1i(t,r.u_cubemap),u_opacity:new e.Uniform1f(t,r.u_opacity),u_temporal_offset:new e.Uniform1f(t,r.u_temporal_offset)}},skyboxGradient:function(t,r){return{u_matrix:new e.UniformMatrix4f(t,r.u_matrix),u_color_ramp:new e.Uniform1i(t,r.u_color_ramp),u_center_direction:new e.Uniform3f(t,r.u_center_direction),u_radius:new e.Uniform1f(t,r.u_radius),u_opacity:new e.Uniform1f(t,r.u_opacity),u_temporal_offset:new e.Uniform1f(t,r.u_temporal_offset)}},skyboxCapture:function(t,r){return{u_matrix_3f:new e.UniformMatrix3f(t,r.u_matrix_3f),u_sun_direction:new e.Uniform3f(t,r.u_sun_direction),u_sun_intensity:new e.Uniform1f(t,r.u_sun_intensity),u_color_tint_r:new e.Uniform4f(t,r.u_color_tint_r),u_color_tint_m:new e.Uniform4f(t,r.u_color_tint_m),u_luminance:new e.Uniform1f(t,r.u_luminance)}}};function en(t,r,n,i,a,o,s){for(var u=t.context,l=u.gl,c=t.useProgram("collisionBox"),h=[],f=0,d=0,p=0;p<i.length;p++){var y=i[p],v=r.getTile(y),m=v.getBucket(n);if(m){var g=y.projMatrix;0===a[0]&&0===a[1]||(g=t.translatePosMatrix(y.projMatrix,v,a,o));var _=s?m.textCollisionBox:m.iconCollisionBox,b=m.collisionCircleArray;if(b.length>0){var w=e.create$1(),x=g;e.mul$1(w,m.placementInvProjMatrix,t.transform.glCoordMatrix),e.mul$1(w,w,m.placementViewportMatrix),h.push({circleArray:b,circleOffset:d,transform:x,invTransform:w}),d=f+=b.length/4}_&&(t.terrain&&t.terrain.setupElevationDraw(v,c),c.draw(u,l.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,Br(g,t.transform,v),n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,null,t.transform.zoom,null,_.collisionVertexBuffer,_.collisionVertexBufferExt))}}if(s&&h.length){var k=t.useProgram("collisionCircle"),E=new e.StructArrayLayout2f1f2i16;E.resize(4*f),E._trim();for(var S=0,T=0,A=h;T<A.length;T++)for(var C=A[T],I=0;I<C.circleArray.length/4;I++){var R=4*I,M=C.circleArray[R+0],P=C.circleArray[R+1],O=C.circleArray[R+2],L=C.circleArray[R+3];E.emplace(S++,M,P,O,L,0),E.emplace(S++,M,P,O,L,1),E.emplace(S++,M,P,O,L,2),E.emplace(S++,M,P,O,L,3)}(!Wr||Wr.length<2*f)&&(Wr=function(t){var r=2*t,n=new e.StructArrayLayout3ui6;n.resize(r),n._trim();for(var i=0;i<r;i++){var a=6*i;n.uint16[a+0]=4*i+0,n.uint16[a+1]=4*i+1,n.uint16[a+2]=4*i+2,n.uint16[a+3]=4*i+2,n.uint16[a+4]=4*i+3,n.uint16[a+5]=4*i+0}return n}(f));for(var D,B=u.createIndexBuffer(Wr,!0),N=u.createVertexBuffer(E,e.collisionCircleLayout.members,!0),z=0,F=h;z<F.length;z++){var j=F[z],U={u_matrix:j.transform,u_inv_matrix:j.invTransform,u_camera_to_center_distance:(D=t.transform).cameraToCenterDistance,u_viewport_size:[D.width,D.height]};k.draw(u,l.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,U,n.id,N,B,e.SegmentVector.simpleSegment(0,2*j.circleOffset,j.circleArray.length,j.circleArray.length/2),null,t.transform.zoom,null,null,null)}N.destroy(),B.destroy()}}var tn=e.identity(new Float32Array(16));function rn(t,r,n,i,a,o){var s=e.getAnchorAlignment(t),u=-(s.horizontalAlign-.5)*r,l=-(s.verticalAlign-.5)*n,c=e.evaluateVariableOffset(t,i);return new e.pointGeometry((u/a+c[0])*o,(l/a+c[1])*o)}function nn(t,r,n,i,a,o,s,u,l,c,h,f){var d=t.text.placedSymbolArray,p=t.text.dynamicLayoutVertexArray,y=t.icon.dynamicLayoutVertexArray,v={};p.clear();for(var m=0;m<d.length;m++){var g=d.get(m),_=t.allowVerticalPlacement&&!g.placedOrientation,b=g.hidden||!g.crossTileID||_?null:i[g.crossTileID];if(b){var w=new e.pointGeometry(g.anchorX,g.anchorY),x=f(w),k=ct(w,n?u:s,x),E=ht(o.cameraToCenterDistance,k.signedDistanceFromCamera),S=a.evaluateSizeForFeature(t.textSizeData,c,g)*E/e.ONE_EM;n&&(S*=t.tilePixelRatio/l);for(var T=b.width,A=b.height,C=rn(b.anchor,T,A,b.textOffset,b.textScale,S),I=n?ct(w.add(C),s,x).point:k.point.add(r?C.rotate(-o.angle):C),R=t.allowVerticalPlacement&&g.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,M=0;M<g.numGlyphs;M++)e.addDynamicAttributes(p,I,R);h&&g.associatedIconIndex>=0&&(v[g.associatedIconIndex]={shiftedAnchor:I,angle:R})}else bt(g.numGlyphs,p)}if(h){y.clear();for(var P=t.icon.placedSymbolArray,O=0;O<P.length;O++){var L=P.get(O);if(L.hidden)bt(L.numGlyphs,y);else{var D=v[O];if(D)for(var B=0;B<L.numGlyphs;B++)e.addDynamicAttributes(y,D.shiftedAnchor,D.angle);else bt(L.numGlyphs,y)}}t.icon.dynamicLayoutVertexBuffer.updateData(y)}t.text.dynamicLayoutVertexBuffer.updateData(p)}function an(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function on(t,r,n,i,a,o,s,u,l,c,h,d){var p,y=t.context,v=y.gl,m=t.transform,g="map"===u,_="map"===l,b=g&&"point"!==n.layout.get("symbol-placement"),w=g&&!_&&!b,x=void 0!==n.layout.get("symbol-sort-key").constantOr(1),k=!1,E=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),S=n.layout.get("text-variable-anchor"),T=[],A=t.terrain&&_?["PITCH_WITH_MAP_TERRAIN"]:null,C=f(i);try{var I=function(){var i=p.value,u=r.getTile(i),l=u.getBucket(n);if(!l)return"continue";var h=a?l.text:l.icon;if(!h||!h.segments.get().length)return"continue";var d=h.programConfigurations.get(n.id),y=a||l.sdfIcons,E=a?l.textSizeData:l.iconSizeData,C=_||0!==m.pitch,I=t.useProgram(an(y,a,l),d,A),R=e.evaluateSizeForZoom(E,m.zoom),M=void 0,P=void 0,O=void 0,L=void 0,D=[0,0],B=null;if(a){if(P=u.glyphAtlasTexture,O=v.LINEAR,M=u.glyphAtlasTexture.size,l.iconsInText){D=u.imageAtlasTexture.size,B=u.imageAtlasTexture;var N="composite"===E.kind||"camera"===E.kind;L=C||t.options.rotating||t.options.zooming||N?v.LINEAR:v.NEAREST}}else{var z=1!==n.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;P=u.imageAtlasTexture,O=y||t.options.rotating||t.options.zooming||z||C?v.LINEAR:v.NEAREST,M=u.imageAtlasTexture.size}var F=V(u,1,t.transform.zoom),j=ut(i.projMatrix,_,g,t.transform,F),U=t.terrain&&_&&b?e.invert(new Float32Array(16),j):tn,q=lt(i.projMatrix,_,g,t.transform,F),G=S&&l.hasTextData(),K="none"!==n.layout.get("icon-text-fit")&&G&&l.hasIconData();if(b){var H=m.elevation;dt(l,i.projMatrix,t,a,j,q,_,c,H?function(e){return H.getAtTileOffset(i,e.x,e.y)}:null)}var W=t.translatePosMatrix(i.projMatrix,u,o,s),Z=b||a&&S||K?tn:j,Y=t.translatePosMatrix(q,u,o,s,!0),X=y&&0!==n.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1),Q={program:I,buffers:h,uniformValues:y?l.iconsInText?Xr(E.kind,R,w,_,t,W,Z,Y,M,D):Yr(E.kind,R,w,_,t,W,Z,Y,a,M,!0):Zr(E.kind,R,w,_,t,W,Z,Y,a,M),atlasTexture:P,atlasTextureIcon:B,atlasInterpolation:O,atlasInterpolationIcon:L,isSDF:y,hasHalo:X,tile:u,labelPlaneMatrixInv:U};if(x&&l.canOverlap){k=!0;var J,$=h.segments.get(),ee=f($);try{for(ee.s();!(J=ee.n()).done;){var te=J.value;T.push({segments:new e.SegmentVector([te]),sortKey:te.sortKey,state:Q})}}catch(re){ee.e(re)}finally{ee.f()}}else T.push({segments:h.segments,sortKey:0,state:Q})};for(C.s();!(p=C.n()).done;)I()}catch(D){C.e(D)}finally{C.f()}k&&T.sort((function(e,t){return e.sortKey-t.sortKey}));for(var R=0,M=T;R<M.length;R++){var P=M[R],O=P.state;if(t.terrain&&t.terrain.setupElevationDraw(O.tile,O.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:O.labelPlaneMatrixInv}),y.activeTexture.set(v.TEXTURE0),O.atlasTexture.bind(O.atlasInterpolation,v.CLAMP_TO_EDGE),O.atlasTextureIcon&&(y.activeTexture.set(v.TEXTURE1),O.atlasTextureIcon&&O.atlasTextureIcon.bind(O.atlasInterpolationIcon,v.CLAMP_TO_EDGE)),O.isSDF){var L=O.uniformValues;O.hasHalo&&(L.u_is_halo=1,sn(O.buffers,P.segments,n,t,O.program,E,h,d,L)),L.u_is_halo=0}sn(O.buffers,P.segments,n,t,O.program,E,h,d,O.uniformValues)}}function sn(t,r,n,i,a,o,s,u,l){var c=i.context;a.draw(c,c.gl.TRIANGLES,o,s,u,e.CullFaceMode.disabled,l,n.id,t.layoutVertexBuffer,t.indexBuffer,r,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer)}function un(t,r,n,i,a,o,s){var u,l,c,h,d,p=t.context.gl,y=n.paint.get("fill-pattern"),v=y&&y.constantOr(1),m=n.getCrossfadeParameters();s?(l=v&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",u=p.LINES):(l=v?"fillPattern":"fill",u=p.TRIANGLES);var g,_=f(i);try{for(_.s();!(g=_.n()).done;){var b=g.value,w=r.getTile(b);if(!v||w.patternsLoaded()){var x=w.getBucket(n);if(x){t.prepareDrawTile(b);var k=x.programConfigurations.get(n.id),E=t.useProgram(l,k);v&&(t.context.activeTexture.set(p.TEXTURE0),w.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),k.updatePaintBuffers(m));var S=y.constantOr(null);if(S&&w.imageAtlas){var T=w.imageAtlas,A=T.patternPositions[S.to.toString()],C=T.patternPositions[S.from.toString()];A&&C&&k.setConstantPatternPositions(A,C)}var I=t.translatePosMatrix(b.projMatrix,w,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(s){h=x.indexBuffer2,d=x.segments2;var R=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[p.drawingBufferWidth,p.drawingBufferHeight];c="fillOutlinePattern"===l&&v?Or(I,t,m,w,R):Pr(I,R)}else h=x.indexBuffer,d=x.segments,c=v?Mr(I,t,m,w):Rr(I);t.prepareDrawProgram(t.context,E,b.toUnwrapped()),E.draw(t.context,u,a,t.stencilModeForClipping(b),o,e.CullFaceMode.disabled,c,n.id,x.layoutVertexBuffer,h,d,n.paint,t.transform.zoom,k)}}}}catch(M){_.e(M)}finally{_.f()}}function ln(t,r,n,i,a,o,s){var u,l=t.context,c=l.gl,h=n.paint.get("fill-extrusion-pattern"),d=h.constantOr(1),p=n.getCrossfadeParameters(),y=n.paint.get("fill-extrusion-opacity"),v=f(i);try{for(v.s();!(u=v.n()).done;){var m=u.value,g=r.getTile(m),_=g.getBucket(n);if(_){var b=_.programConfigurations.get(n.id),w=t.useProgram(d?"fillExtrusionPattern":"fillExtrusion",b);if(t.terrain){var x=t.terrain;if(!_.enableTerrain)continue;if(x.setupElevationDraw(g,w,{useMeterToDem:!0}),cn(l,r,m,_,n,x),!_.centroidVertexBuffer){var k=w.attributes.a_centroid_pos;void 0!==k&&c.vertexAttrib2f(k,0,0)}}d&&(t.context.activeTexture.set(c.TEXTURE0),g.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),b.updatePaintBuffers(p));var E=h.constantOr(null);if(E&&g.imageAtlas){var S=g.imageAtlas,T=S.patternPositions[E.to.toString()],A=S.patternPositions[E.from.toString()];T&&A&&b.setConstantPatternPositions(T,A)}var C=t.translatePosMatrix(m.projMatrix,g,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),I=n.paint.get("fill-extrusion-vertical-gradient"),R=d?Ir(C,t,I,y,m,p,g):Cr(C,t,I,y);t.prepareDrawProgram(l,w,m.toUnwrapped()),w.draw(l,l.gl.TRIANGLES,a,o,s,e.CullFaceMode.backCCW,R,n.id,_.layoutVertexBuffer,_.indexBuffer,_.segments,n.paint,t.transform.zoom,b,t.terrain?_.centroidVertexBuffer:null)}}}catch(M){v.e(M)}finally{v.f()}}function cn(t,r,n,i,a,o){for(var s,u,l,c=[function(t){var r=t.canonical.x-1,n=t.wrap;return r<0&&(r=(1<<t.canonical.z)-1,n--),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,r,t.canonical.y)},function(t){var r=t.canonical.x+1,n=t.wrap;return r===1<<t.canonical.z&&(r=0,n++),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,r,t.canonical.y)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1)},function(t){return new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)}],h=function(e){var t,n,i,o=r.getSource().maxzoom,s=function(e){var t=r.getTileByID(e);if(t&&t.hasData())return t.getBucket(a)};return(e.overscaledZ===e.canonical.z||e.overscaledZ>=o)&&(t=s(e.key)),e.overscaledZ>=o&&(n=s(e.calculateScaledKey(e.overscaledZ+1))),e.overscaledZ>o&&(i=s(e.calculateScaledKey(e.overscaledZ-1))),t||n||i},f=[0,0,0],d=function(t,r){return f[0]=Math.min(t.min.y,r.min.y),f[1]=Math.max(t.max.y,r.max.y),f[2]=e.EXTENT-r.min.x>t.max.x?r.min.x-e.EXTENT:t.max.x,f},p=function(t,r){return f[0]=Math.min(t.min.x,r.min.x),f[1]=Math.max(t.max.x,r.max.x),f[2]=e.EXTENT-r.min.y>t.max.y?r.min.y-e.EXTENT:t.max.y,f},y=[function(e,t){return d(e,t)},function(e,t){return d(t,e)},function(e,t){return p(e,t)},function(e,t){return p(t,e)}],v=new e.pointGeometry(0,0),m=function(t,r,i,a,c){var h=[[a?i:t,a?t:i,0],[a?i:r,a?r:i,0]],f=c<0?e.EXTENT+c:c,d=[a?f:(t+r)/2,a?(t+r)/2:f,0];return 0===i&&c<0||0!==i&&c>0?o.getForTilePoints(l,[d],!0,u):h.push(d),o.getForTilePoints(n,h,!0,s),Math.max(h[0][2],h[1][2],d[2])/o.exaggeration()},g=0;g<4;g++){var _=i.borders[g];if(0===_.length&&(i.borderDone[g]=!0),!i.borderDone[g]){var b=l=c[g](n),w=h(b);if(w&&w.enableTerrain&&(u=o.findDEMTileFor(b))&&u.dem){if(!s){var x=o.findDEMTileFor(n);if(!x||!x.dem)return;s=x}for(var k=(g<2?1:5)-g,E=w.borders[k],S=0,T=0;T<_.length;T++){for(var A=i.featuresOnBorder[_[T]],C=A.borders[g],I=void 0;S<E.length&&!((I=w.featuresOnBorder[E[S]]).borders[k][1]>C[0]+3);)w.borderDone[k]||w.encodeCentroid(void 0,I,!1),S++;if(I&&S<E.length){for(var R=S,M=0;!(I.borders[k][0]>C[1]-3)&&(M++,++S!==E.length);)I=w.featuresOnBorder[E[S]];if(I=w.featuresOnBorder[E[R]],A.intersectsCount()>1||I.intersectsCount()>1||1!==M){1!==M&&(S=R),i.encodeCentroid(void 0,A,!1),w.borderDone[k]||w.encodeCentroid(void 0,I,!1);continue}var P=y[g](A,I),O=g%2?e.EXTENT-1:0;v.x=m(P[0],Math.min(e.EXTENT-1,P[1]),O,g<2,P[2]),v.y=0,i.encodeCentroid(v,A,!1),w.borderDone[k]||w.encodeCentroid(v,I,!1)}else i.encodeCentroid(void 0,A,!1)}i.borderDone[g]=i.needsCentroidUpdate=!0,w.borderDone[k]||(w.borderDone[k]=w.needsCentroidUpdate=!0)}}}(i.needsCentroidUpdate||!i.centroidVertexBuffer&&0!==i.centroidVertexArray.length)&&i.uploadCentroid(t)}var hn=new e.Color(1,0,0,1),fn=new e.Color(0,1,0,1),dn=new e.Color(0,0,1,1),pn=new e.Color(1,0,1,1),yn=new e.Color(0,1,1,1);function vn(e,t,r,n){gn(e,0,t+r/2,e.transform.width,r,n)}function mn(e,t,r,n){gn(e,t-r/2,0,r,e.transform.height,n)}function gn(t,r,n,i,a,o){var s=t.context,u=s.gl;u.enable(u.SCISSOR_TEST),u.scissor(r*e.exported.devicePixelRatio,n*e.exported.devicePixelRatio,i*e.exported.devicePixelRatio,a*e.exported.devicePixelRatio),s.clear({color:o}),u.disable(u.SCISSOR_TEST)}function _n(t,r,n){var i=t.context,a=i.gl,o=n.projMatrix,s=t.useProgram("debug"),u=r.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(u,s);var l=e.DepthMode.disabled,c=e.StencilMode.disabled,h=t.colorModeForRenderPass(),f="$debug";i.activeTexture.set(a.TEXTURE0),t.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),s.draw(i,a.LINE_STRIP,l,c,h,e.CullFaceMode.disabled,Nr(o,e.Color.red),f,t.debugBuffer,t.tileBorderIndexBuffer,t.debugSegments);var d=u.latestRawTileData,p=Math.floor((d&&d.byteLength||0)/1024),y=r.getTile(n).tileSize,v=512/Math.min(y,512)*(n.overscaledZ/t.transform.zoom)*.5,m=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(m+=" => ".concat(n.overscaledZ)),function(e,t){e.initDebugOverlayCanvas();var r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,"".concat(m," ").concat(p,"kb")),s.draw(i,a.TRIANGLES,l,c,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,Nr(o,e.Color.transparent,v),f,t.debugBuffer,t.quadTriangleIndexBuffer,t.debugSegments)}var bn=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]).members;function wn(e,t,r,n){e.emplaceBack(t,r,n)}var xn=function t(r){v(this,t),this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,wn(this.vertexArray,-1,-1,1),wn(this.vertexArray,1,-1,1),wn(this.vertexArray,-1,1,1),wn(this.vertexArray,1,1,1),wn(this.vertexArray,-1,-1,-1),wn(this.vertexArray,1,-1,-1),wn(this.vertexArray,-1,1,-1),wn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=r.createVertexBuffer(this.vertexArray,bn),this.indexBuffer=r.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)};function kn(t,r,n,i,a,o){var s=t.gl,u=r.paint.get("sky-atmosphere-color"),l=r.paint.get("sky-atmosphere-halo-color"),c=r.paint.get("sky-atmosphere-sun-intensity"),h=function(e,t,r,n,i){return{u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:r,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[i.r,i.g,i.b,i.a],u_luminance:5e-5}}(e.fromMat4([],i),a,c,u,l);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+o,r.skyboxTexture,0),n.draw(t,s.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,h,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}var En={symbol:function(t,r,n,i,a){if("translucent"===t.renderPass){var o=e.StencilMode.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,r,n,i,a,o,s){var u,l=r.transform,c="map"===a,h="map"===o,d=f(t);try{var p=function(){var t=u.value,a=i.getTile(t),o=a.getBucket(n);if(!o||!o.text||!o.text.segments.get().length)return"continue";var f=e.evaluateSizeForZoom(o.textSizeData,l.zoom),d=V(a,1,r.transform.zoom),p=ut(t.projMatrix,h,c,r.transform,d),y="none"!==n.layout.get("icon-text-fit")&&o.hasIconData();if(f){var v=Math.pow(2,l.zoom-a.tileID.overscaledZ),m=l.elevation;nn(o,c,h,s,e.symbolSize,l,p,t.projMatrix,v,f,y,m?function(e){return m.getAtTileOffset(t,e.x,e.y)}:function(e){return 0})}};for(d.s();!(u=d.n()).done;)p()}catch(y){d.e(y)}finally{d.f()}}(i,t,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),a),0!==n.paint.get("icon-opacity").constantOr(1)&&on(t,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),o,s),0!==n.paint.get("text-opacity").constantOr(1)&&on(t,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),o,s),r.map.showCollisionBoxes&&(en(t,r,n,i,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),en(t,r,n,i,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))}},circle:function(t,r,n,i){if("translucent"===t.renderPass){var a=n.paint.get("circle-opacity"),o=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),u=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0!==a.constantOr(1)||0!==o.constantOr(1)&&0!==s.constantOr(1)){for(var l=t.context,c=l.gl,h=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),d=e.StencilMode.disabled,p=t.colorModeForRenderPass(),y=[],v=0;v<i.length;v++){var m=i[v],g=r.getTile(m),_=g.getBucket(n);if(_){var b=_.programConfigurations.get(n.id),w=Dr(n),x={programConfiguration:b,program:t.useProgram("circle",b,w),layoutVertexBuffer:_.layoutVertexBuffer,indexBuffer:_.indexBuffer,uniformValues:Lr(t,m,g,n),tile:g};if(u){var k,E=_.segments.get(),S=f(E);try{for(S.s();!(k=S.n()).done;){var T=k.value;y.push({segments:new e.SegmentVector([T]),sortKey:T.sortKey,state:x})}}catch(z){S.e(z)}finally{S.f()}}else y.push({segments:_.segments,sortKey:0,state:x})}}u&&y.sort((function(e,t){return e.sortKey-t.sortKey}));for(var A=0,C=y;A<C.length;A++){var I=C[A],R=I.state,M=R.programConfiguration,P=R.program,O=R.layoutVertexBuffer,L=R.indexBuffer,D=R.uniformValues,B=R.tile,N=I.segments;t.terrain&&t.terrain.setupElevationDraw(B,P,{useDepthForOcclusion:!0}),t.prepareDrawProgram(l,P,B.tileID.toUnwrapped()),P.draw(l,c.TRIANGLES,h,d,p,e.CullFaceMode.disabled,D,n.id,O,L,N,n.paint,t.transform.zoom,M)}}}},heatmap:function(t,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var a=t.context,o=a.gl,s=e.StencilMode.disabled,u=new e.ColorMode([o.ONE,o.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r){var n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var i=r.heatmapFbo;if(i)n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),e.bindFramebuffer.set(i.framebuffer);else{var a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),i=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4,!1),function(e,t,r,n){var i=e.gl;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t.width/4,t.height/4,0,i.RGBA,e.extRenderToTextureHalfFloat?e.extTextureHalfFloat.HALF_FLOAT_OES:i.UNSIGNED_BYTE,null),n.colorAttachment.set(r)}(e,t,a,i)}}(a,t,n),a.clear({color:e.Color.transparent});for(var l=0;l<i.length;l++){var c=i[l];if(!r.hasRenderableParent(c)){var h=r.getTile(c),f=h.getBucket(n);if(f){var d=f.programConfigurations.get(n.id),p=t.useProgram("heatmap",d),y=t.transform.zoom;t.terrain&&t.terrain.setupElevationDraw(h,p),t.prepareDrawProgram(a,p,c.toUnwrapped()),p.draw(a,o.TRIANGLES,e.DepthMode.disabled,s,u,e.CullFaceMode.disabled,zr(c.projMatrix,h,y,n.paint.get("heatmap-intensity")),n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,n.paint,t.transform.zoom,d)}}}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){var n=t.context,i=n.gl,a=r.heatmapFbo;if(a){n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);var o=r.colorRampTexture;o||(o=r.colorRampTexture=new e.Texture(n,r.colorRamp,i.RGBA)),o.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,i.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,function(e,t,r,n){return{u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}}(0,r),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}}(t,n))},line:function(t,r,n,i){if("translucent"===t.renderPass){var a=n.paint.get("line-opacity"),o=n.paint.get("line-width");if(0!==a.constantOr(1)&&0!==o.constantOr(1)){var s,u=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),l=t.colorModeForRenderPass(),c=n.paint.get("line-dasharray"),h=c.constantOr(1),d=n.layout.get("line-cap"),p=n.paint.get("line-pattern"),y=p.constantOr(1),v=n.paint.get("line-gradient"),m=n.getCrossfadeParameters(),g=y?"linePattern":h?"lineSDF":v?"lineGradient":"line",_=t.context,b=_.gl,w=f(i);try{for(w.s();!(s=w.n()).done;){var x=s.value,k=r.getTile(x);if(!y||k.patternsLoaded()){var E=k.getBucket(n);if(E){t.prepareDrawTile(x);var S=E.programConfigurations.get(n.id),T=t.useProgram(g,S),A=p.constantOr(null);if(A&&k.imageAtlas){var C=k.imageAtlas,I=C.patternPositions[A.to.toString()],R=C.patternPositions[A.from.toString()];I&&R&&S.setConstantPatternPositions(I,R)}var M=c.constantOr(null),P=d.constantOr(null);if(!y&&M&&P&&k.lineAtlas){var O=k.lineAtlas,L=O.getDash(M.to,P),D=O.getDash(M.from,P);L&&D&&S.setConstantPatternPositions(L,D)}var B=t.terrain?x.projMatrix:null,N=y?Ur(t,k,n,m,B):h?Vr(t,k,n,m,B):v?jr(t,k,n,B,E.lineClipsArray.length):Fr(t,k,n,B);if(y)_.activeTexture.set(b.TEXTURE0),k.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),S.updatePaintBuffers(m);else if(h)_.activeTexture.set(b.TEXTURE0),k.lineAtlasTexture.bind(b.LINEAR,b.REPEAT),S.updatePaintBuffers(m);else if(v){var z=E.gradients[n.id],F=z.texture;if(n.gradientVersion!==z.version){var j=256;if(n.stepInterpolant){var U=r.getSource().maxzoom,V=x.canonical.z===U?Math.ceil(1<<t.transform.maxZoom-x.canonical.z):1;j=e.clamp(e.nextPowerOfTwo(E.maxLineLength/e.EXTENT*1024*V),256,_.maxTextureSize)}z.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:j,image:z.gradient||void 0,clips:E.lineClipsArray}),z.texture?z.texture.update(z.gradient):z.texture=new e.Texture(_,z.gradient,b.RGBA),z.version=n.gradientVersion,F=z.texture}_.activeTexture.set(b.TEXTURE0),F.bind(n.stepInterpolant?b.NEAREST:b.LINEAR,b.CLAMP_TO_EDGE)}t.prepareDrawProgram(_,T,x.toUnwrapped()),T.draw(_,b.TRIANGLES,u,t.stencilModeForClipping(x),l,e.CullFaceMode.disabled,N,n.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,n.paint,t.transform.zoom,S,E.layoutVertexBuffer2)}}}}catch(q){w.e(q)}finally{w.f()}}}},fill:function(t,r,n,i){var a=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=t.colorModeForRenderPass(),u=n.paint.get("fill-pattern"),l=t.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===a.constantOr(e.Color.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(t.renderPass===l){var c=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);un(t,r,n,i,c,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){var h=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);un(t,r,n,i,h,s,!0)}}},"fill-extrusion":function(t,r,n,i){var a=n.paint.get("fill-extrusion-opacity");if(0!==a&&"translucent"===t.renderPass){var o=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==a||n.paint.get("fill-extrusion-pattern").constantOr(1))ln(t,r,n,i,o,e.StencilMode.disabled,e.ColorMode.disabled),ln(t,r,n,i,o,t.stencilModeFor3D(),t.colorModeForRenderPass());else{var s=t.colorModeForRenderPass();ln(t,r,n,i,o,e.StencilMode.disabled,s)}}},hillshade:function(t,r,n,i){if("offscreen"===t.renderPass||"translucent"===t.renderPass){var a,o=t.context,s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),u=t.colorModeForRenderPass(),l=t.terrain&&t.terrain.renderingToTexture,c="translucent"!==t.renderPass||l?[{},i]:t.stencilConfigForOverlap(i),d=h(c,2),p=d[0],y=d[1],v=f(y);try{for(v.s();!(a=v.n()).done;){var m=a.value,g=r.getTile(m);if(g.needsHillshadePrepare&&"offscreen"===t.renderPass)pr(t,g,n,s,e.StencilMode.disabled,u);else if("translucent"===t.renderPass){var _=l&&t.terrain?t.terrain.stencilModeForRTTOverlap(m):p[m.overscaledZ];fr(t,m,g,n,s,_,u)}}}catch(b){v.e(b)}finally{v.f()}o.viewport.set([0,0,t.width,t.height])}},raster:function(t,r,n,i,a,o){if("translucent"===t.renderPass&&0!==n.paint.get("raster-opacity")&&i.length){var s,u=t.context,l=u.gl,c=r.getSource(),d=t.useProgram("raster"),p=t.colorModeForRenderPass(),y=t.terrain&&t.terrain.renderingToTexture,v=c instanceof Ne||y?[{},i]:t.stencilConfigForOverlap(i),m=h(v,2),g=m[0],_=m[1],b=_[_.length-1].overscaledZ,w=!t.options.moving,x=f(_);try{for(x.s();!(s=x.n()).done;){var k=s.value,E=y?e.DepthMode.disabled:t.depthModeForSublayer(k.overscaledZ-b,1===n.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,l.LESS),S=k.toUnwrapped(),T=r.getTile(k);if(!y||T&&T.hasData()){var A=y?k.projMatrix:t.transform.calculateProjMatrix(S,w),C=t.terrain&&y?t.terrain.stencilModeForRTTOverlap(k):g[k.overscaledZ],I=o?0:n.paint.get("raster-fade-duration");T.registerFadeDuration(I);var R=r.findLoadedParent(k,0),M=wr(T,R,r,t.transform,I),P=void 0,O=void 0;t.terrain&&t.terrain.prepareDrawTile(k);var L="nearest"===n.paint.get("raster-resampling")?l.NEAREST:l.LINEAR;u.activeTexture.set(l.TEXTURE0),T.texture.bind(L,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),u.activeTexture.set(l.TEXTURE1),R?(R.texture.bind(L,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST),P=Math.pow(2,R.tileID.overscaledZ-T.tileID.overscaledZ),O=[T.tileID.canonical.x*P%1,T.tileID.canonical.y*P%1]):T.texture.bind(L,l.CLAMP_TO_EDGE,l.LINEAR_MIPMAP_NEAREST);var D=Kr(A,O||[0,0],P||1,M,n);t.prepareDrawProgram(u,d,S),c instanceof Ne?d.draw(u,l.TRIANGLES,E,e.StencilMode.disabled,p,e.CullFaceMode.disabled,D,n.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments):d.draw(u,l.TRIANGLES,E,C,p,e.CullFaceMode.disabled,D,n.id,t.rasterBoundsBuffer,t.quadTriangleIndexBuffer,t.rasterBoundsSegments)}}}catch(B){x.e(B)}finally{x.f()}}},background:function(t,r,n,i){var a=n.paint.get("background-color"),o=n.paint.get("background-opacity");if(0!==o){var s=t.context,u=s.gl,l=t.transform,c=l.tileSize,h=n.paint.get("background-pattern");if(!t.isPatternMissing(h)){var d=!h&&1===a.a&&1===o&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass===d){var p=e.StencilMode.disabled,y=t.depthModeForSublayer(0,"opaque"===d?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),v=t.colorModeForRenderPass(),m=t.useProgram(h?"backgroundPattern":"background"),g=i||l.coveringTiles({tileSize:c});h&&(s.activeTexture.set(u.TEXTURE0),t.imageManager.bind(t.context));var _,b=n.getCrossfadeParameters(),w=f(g);try{for(w.s();!(_=w.n()).done;){var x=_.value,k=x.toUnwrapped(),E=i?x.projMatrix:t.transform.calculateProjMatrix(k);t.prepareDrawTile(x);var S=h?Jr(E,o,t,h,{tileID:x,tileSize:c},b):Qr(E,o,a);t.prepareDrawProgram(s,m,k),m.draw(s,u.TRIANGLES,y,p,v,e.CullFaceMode.disabled,S,n.id,t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments)}}catch(T){w.e(T)}finally{w.f()}}}}},sky:function(t,r,n){var i=n.paint.get("sky-opacity");if(0!==i){var a=t.context,o=n.paint.get("sky-type"),s=new e.DepthMode(a.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),u=t.frameCounter/1e3%1;"atmosphere"===o?"offscreen"===t.renderPass?n.needsSkyboxCapture(t)&&(function(t,r,n,i){var a=t.context,o=a.gl,s=r.skyboxFbo;if(!s){s=r.skyboxFbo=a.createFramebuffer(32,32,!1),r.skyboxGeometry=new xn(a),r.skyboxTexture=a.gl.createTexture(),o.bindTexture(o.TEXTURE_CUBE_MAP,r.skyboxTexture),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR);for(var u=0;u<6;++u)o.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X+u,0,o.RGBA,32,32,0,o.RGBA,o.UNSIGNED_BYTE,null)}a.bindFramebuffer.set(s.framebuffer),a.viewport.set([0,0,32,32]);var l=r.getCenter(t,!0),c=t.useProgram("skyboxCapture"),h=new Float64Array(16);e.identity(h),e.rotateY(h,h,.5*-Math.PI),kn(a,r,c,h,l,0),e.identity(h),e.rotateY(h,h,.5*Math.PI),kn(a,r,c,h,l,1),e.identity(h),e.rotateX(h,h,.5*-Math.PI),kn(a,r,c,h,l,2),e.identity(h),e.rotateX(h,h,.5*Math.PI),kn(a,r,c,h,l,3),e.identity(h),kn(a,r,c,h,l,4),e.identity(h),e.rotateY(h,h,Math.PI),kn(a,r,c,h,l,5),a.viewport.set([0,0,t.width,t.height])}(t,n),n.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,r,n,i,a){var o=t.context,s=o.gl,u=t.transform,l=t.useProgram("skybox");o.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,r.skyboxTexture);var c=function(e,t,r,n,i){return{u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:n,u_temporal_offset:i}}(u.skyboxMatrix,r.getCenter(t,!1),0,i,a);t.prepareDrawProgram(o,l),l.draw(o,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,c,"skybox",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(t,n,s,i,u):"gradient"===o&&"sky"===t.renderPass&&function(t,r,n,i,a){var o=t.context,s=o.gl,u=t.transform,l=t.useProgram("skyboxGradient");r.skyboxGeometry||(r.skyboxGeometry=new xn(o)),o.activeTexture.set(s.TEXTURE0);var c=r.colorRampTexture;c||(c=r.colorRampTexture=new e.Texture(o,r.colorRamp,s.RGBA)),c.bind(s.LINEAR,s.CLAMP_TO_EDGE);var h=function(t,r,n,i,a){return{u_matrix:t,u_color_ramp:0,u_center_direction:r,u_radius:e.degToRad(n),u_opacity:i,u_temporal_offset:a}}(u.skyboxMatrix,r.getCenter(t,!1),r.paint.get("sky-gradient-radius"),i,a);t.prepareDrawProgram(o,l),l.draw(o,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skyboxGradient",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(t,n,s,i,u)}},debug:function(e,t,r){for(var n=0;n<r.length;n++)_n(e,t,r[n])},custom:function(t,r,n){var i=t.context,a=n.implementation;if("offscreen"===t.renderPass){var o=a.prerender;o&&(t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),o.call(a,i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState())}else if("translucent"===t.renderPass){t.setCustomLayerDefaults(),i.setColorMode(t.colorModeForRenderPass()),i.setStencilMode(e.StencilMode.disabled);var s="3d"===a.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);i.setDepthMode(s),a.render(i.gl,t.transform.customLayerMatrix()),i.setDirty(),t.setBaseState(),i.bindFramebuffer.set(null)}}},Sn=function(){function t(r,n){v(this,t),this.context=new Le(r),this.transform=n,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Yt,this.gpuTimers={},this.frameCounter=0}return m(t,[{key:"updateTerrain",value:function(e,t){var r=!!e&&!!e.terrain;if(r||this._terrain&&this._terrain.enabled){this._terrain||(this._terrain=new Er(this,e));var n=this._terrain;this.transform.elevation=r?n:null,n.update(e,this.transform,t)}}},{key:"_updateFog",value:function(e){var t=e.fog;if(!t||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)this.transform.fogCullDistSq=null;else{var r=t.getFovAdjustedRange(this.transform._fov),n=h(r,2),i=n[0],a=n[1];if(i>a)this.transform.fogCullDistSq=null;else{var o=i+.78*(a-i);this.transform.fogCullDistSq=o*o}}}},{key:"resize",value:function(t,r){if(this.width=t*e.exported.devicePixelRatio,this.height=r*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style){var n,i=f(this.style.order);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.style._layers[a].resize()}}catch(o){i.e(o)}finally{i.f()}}}},{key:"setup",value:function(){var t=this.context,r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var i=new e.StructArrayLayout4i8;i.emplaceBack(0,0,0,0),i.emplaceBack(e.EXTENT,0,e.EXTENT,0),i.emplaceBack(0,e.EXTENT,0,e.EXTENT),i.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(i,Be.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var a=new e.StructArrayLayout2i4;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(-1,1),a.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(a,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var o=new e.StructArrayLayout1ui2;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(o);var s=new e.StructArrayLayout3ui6;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,{width:1,height:1,data:new Uint8Array([0,0,0,0])},t.gl.RGBA),this.identityMat=e.create$1();var u=this.context.gl;this.stencilClearMode=new e.StencilMode({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO),this.loadTimeStamps.push(e.window.performance.now())}},{key:"clearStencil",value:function(){var t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(t,r.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,br(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}},{key:"_renderTileClippingMasks",value:function(t,r,n){if(r&&this.currentStencilSource!==r.id&&t.isTileClipped()&&n&&n.length){this.currentStencilSource=r.id;var i=this.context,a=i.gl;this.nextStencilID+n.length>256&&this.clearStencil(),i.setColorMode(e.ColorMode.disabled),i.setDepthMode(e.DepthMode.disabled);var o=this.useProgram("clippingMask");this._tileClippingMaskIDs={};var s,u=f(n);try{for(u.s();!(s=u.n()).done;){var l=s.value,c=this._tileClippingMaskIDs[l.key]=this.nextStencilID++;o.draw(i,a.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:a.ALWAYS,mask:0},c,255,a.KEEP,a.KEEP,a.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,br(l.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}catch(h){u.e(h)}finally{u.f()}}}},{key:"stencilModeFor3D",value:function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var t=this.nextStencilID++,r=this.context.gl;return new e.StencilMode({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}},{key:"stencilModeForClipping",value:function(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);var r=this.context.gl;return new e.StencilMode({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}},{key:"stencilConfigForOverlap",value:function(t){var r=this.context.gl,i=t.sort((function(e,t){return t.overscaledZ-e.overscaledZ})),a=i[i.length-1].overscaledZ,o=i[0].overscaledZ-a+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();for(var s={},u=0;u<o;u++)s[u+a]=new e.StencilMode({func:r.GEQUAL,mask:255},u+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=o,[s,i]}return[n({},a,e.StencilMode.disabled),i]}},{key:"colorModeForRenderPass",value:function(){var t=this.context.gl;if(this._showOverdrawInspector){var r=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}},{key:"depthModeForSublayer",value:function(t,r,n){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;var i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(n||this.context.gl.LEQUAL,r,[i,i])}},{key:"opaquePassEnabledForLayer",value:function(){return this.currentLayer<this.opaquePassCutoff}},{key:"render",value:function(t,r){var n=this;this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();var i=this.style.order,a=this.style._sourceCaches;for(var o in a){var s=a[o];s.used&&s.prepare(this.context)}var u={},l={},c={};for(var h in a){var d=a[h];u[h]=d.getVisibleCoordinates(),l[h]=u[h].slice().reverse(),c[h]=d.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var p=0;p<i.length;p++)if(this.style._layers[i[p]].is3D()){this.opaquePassCutoff=p;break}if(this.terrain&&(this.terrain.updateTileBinding(c),this.opaquePassCutoff=0),e.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";var y,v=f(i);try{for(v.s();!(y=v.n()).done;){var m=y.value,g=this.style._layers[m],_=t._getLayerSourceCache(g);if(g.hasOffscreenPass()&&!g.isHidden(this.transform.zoom)){var b=_?l[_.id]:void 0;("custom"===g.type||g.isSky()||b&&b.length)&&this.renderLayer(this,_,g,b)}}}catch(M){v.e(M)}finally{v.f()}this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);var w=e.Color.transparent;if(this.style.fog&&(w=this.style.fog.properties.get("color")),this.context.clear({color:r.showOverdrawInspector?e.Color.black:w,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=i.length-1;this.currentLayer>=0;this.currentLayer--){var x=this.style._layers[i[this.currentLayer]],k=t._getLayerSourceCache(x);if(!x.isSky()){var E=k?l[k.id]:void 0;this._renderTileClippingMasks(x,k,E),this.renderLayer(this,k,x,E)}}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<i.length;this.currentLayer++){var S=this.style._layers[i[this.currentLayer]],T=t._getLayerSourceCache(S);S.isSky()&&this.renderLayer(this,T,S,T?l[T.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<i.length;){var A=this.style._layers[i[this.currentLayer]],C=t._getLayerSourceCache(A);if(A.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(A)){if(A.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer)}else{var I=C?("symbol"===A.type?c:l)[C.id]:void 0;this._renderTileClippingMasks(A,C,C?u[C.id]:void 0),this.renderLayer(this,C,A,I),++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){var R=null;e.values(this.style._layers).forEach((function(e){var r=t._getLayerSourceCache(e);r&&!e.isHidden(n.transform.zoom)&&(!R||R.getSource().maxzoom<r.getSource().maxzoom)&&(R=r)})),R&&this.options.showTileBoundaries&&En.debug(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(e){var t=e.transform.padding;vn(e,e.transform.height-(t.top||0),3,hn),vn(e,t.bottom||0,3,fn),mn(e,t.left||0,3,dn),mn(e,e.transform.width-(t.right||0),3,pn);var r=e.transform.centerPoint;!function(e,t,r,n){gn(e,t-1,r-10,2,20,n),gn(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,yn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%e.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}}},{key:"renderLayer",value:function(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"sky"===r.type||"custom"===r.type||n&&n.length)&&(this.id=r.id,this.gpuTimingStart(r),En[r.type](e,t,r,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}},{key:"gpuTimingStart",value:function(e){if(this.options.gpuTiming){var t=this.context.extTimerQuery,r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),r.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}}},{key:"gpuTimingEnd",value:function(){if(this.options.gpuTiming){var e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}}},{key:"collectGpuTimers",value:function(){var e=this.gpuTimers;return this.gpuTimers={},e}},{key:"queryGpuTimers",value:function(e){var t={};for(var r in e){var n=e[r],i=this.context.extTimerQuery,a=i.getQueryObjectEXT(n.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n.query),t[r]=a}return t}},{key:"translatePosMatrix",value:function(t,r,n,i,a){if(!n[0]&&!n[1])return t;var o=a?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(o){var s=Math.sin(o),u=Math.cos(o);n=[n[0]*u-n[1]*s,n[0]*s+n[1]*u]}var l=[a?n[0]:V(r,n[0],this.transform.zoom),a?n[1]:V(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return e.translate(c,t,l),c}},{key:"saveTileTexture",value:function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}},{key:"getTileTexture",value:function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null}},{key:"isPatternMissing",value:function(e){if(!e)return!1;if(!e.from||!e.to)return!0;var t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}},{key:"currentGlobalDefines",value:function(){var e=this.terrain&&this.terrain.renderingToTexture,t=this.style&&this.style.fog,r=[];return this.terrain&&!this.terrain.renderingToTexture&&r.push("TERRAIN"),t&&!e&&0!==t.getOpacity(this.transform.pitch)&&r.push("FOG"),e&&r.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&r.push("OVERDRAW_INSPECTOR"),r}},{key:"useProgram",value:function(e,t,r){this.cache=this.cache||{};var n=r||[],i=this.currentGlobalDefines().concat(n),a=Tr.cacheKey(e,i,t);return this.cache[a]||(this.cache[a]=new Tr(this.context,e,ur[e],t,$r[e],i)),this.cache[a]}},{key:"setCustomLayerDefaults",value:function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}},{key:"setBaseState",value:function(){var e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}},{key:"initDebugOverlayCanvas",value:function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}},{key:"destroy",value:function(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}},{key:"prepareDrawTile",value:function(e){this.terrain&&this.terrain.prepareDrawTile(e)}},{key:"prepareDrawProgram",value:function(e,t,r){if(!this.terrain||!this.terrain.renderingToTexture){var n=this.style.fog;if(n){var i=n.getOpacity(this.transform.pitch);0!==i&&t.setFogUniformValues(e,function(e,t,r,n){var i=t.properties.get("color"),a=e.frameCounter/1e3%1,o=[i.r/i.a,i.g/i.a,i.b/i.a,n];return{u_fog_matrix:r?e.transform.calculateFogTileMatrix(r):e.identityMat,u_fog_range:t.getFovAdjustedRange(e.transform._fov),u_fog_color:o,u_fog_horizon_blend:t.properties.get("horizon-blend"),u_fog_temporal_offset:a}}(this,n,r,i))}}}},{key:"setTileLoadedFlag",value:function(e){this.tileLoaded=e}},{key:"saveCanvasCopy",value:function(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}},{key:"canvasCopy",value:function(){var e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}},{key:"getCanvasCopiesAndTimestamps",value:function(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}},{key:"averageElevationNeedsEasing",value:function(){if(!this.transform._elevation)return!1;var e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}},{key:"terrain",get:function(){return this._terrain&&this._terrain.enabled?this._terrain:null}}]),t}(),Tn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(v(this,t),isNaN(e)||e<0||isNaN(r)||r<0||isNaN(n)||n<0||isNaN(i)||i<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=n,this.right=i}return m(t,[{key:"interpolate",value:function(t,r,n){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,n)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,n)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,n)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,n)),this}},{key:"getCenter",value:function(t,r){var n=e.clamp((this.left+t-this.right)/2,0,t),i=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.pointGeometry(n,i)}},{key:"equals",value:function(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}},{key:"clone",value:function(){return new t(this.top,this.bottom,this.left,this.right)}},{key:"toJSON",value:function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}]),t}();function An(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}function Cn(e,t,r){e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]}function In(t,r){var n=An(t,3);e.fromQuat(t,r),Cn(t,3,n)}function Rn(e,t){Cn(e,3,[t[0],t[1],t[2],1])}function Mn(t,r){var n=e.identity$1([]);return e.rotateZ$1(n,n,-r),e.rotateX$1(n,n,-t),n}function Pn(t,r){var n=[t[0],t[1],0],i=[r[0],r[1],0];if(e.length(n)>=1e-15){var a=e.normalize([],n);e.scale(i,a,e.dot(i,a)),r[0]=i[0],r[1]=i[1]}var o=e.cross([],r,t);if(e.len(o)<1e-15)return null;var s=Math.atan2(-o[1],o[0]);return Mn(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}var On=function(){function t(e,r){v(this,t),this.position=e,this.orientation=r}return m(t,[{key:"lookAtPoint",value:function(t,r){if(this.orientation=null,this.position){var n=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,i=this.position,a=e.MercatorCoordinate.fromLngLat(t,n),o=[a.x-i.x,a.y-i.y,a.z-i.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=Pn(o,r)}}},{key:"setPitchBearing",value:function(t,r){this.orientation=Mn(e.degToRad(t),e.degToRad(-r))}},{key:"position",get:function(){return this._position},set:function(t){this._position=this._renderWorldCopies?function(t){if(t){var r=Array.isArray(t)?new e.MercatorCoordinate(t[0],t[1],t[2]):t;return r.x=e.wrap(r.x,0,1),r}}(t):t}}]),t}(),Ln=function(){function t(r,n){v(this,t),this._transform=e.identity([]),this._orientation=e.identity$1([]),n&&(this._orientation=n,In(this._transform,this._orientation)),r&&Rn(this._transform,r)}return m(t,[{key:"getPitchBearing",value:function(){var e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}},{key:"setPitchBearing",value:function(e,t){this._orientation=Mn(e,t),In(this._transform,this._orientation)}},{key:"forward",value:function(){var e=An(this._transform,2);return[-e[0],-e[1],-e[2]]}},{key:"up",value:function(){var e=An(this._transform,1);return[-e[0],-e[1],-e[2]]}},{key:"right",value:function(){var e=An(this._transform,0);return[e[0],e[1],e[2]]}},{key:"getCameraToWorld",value:function(t,r){var n=new Float64Array(16);return e.invert(n,this.getWorldToCamera(t,r)),n}},{key:"getWorldToCameraPosition",value:function(t,r,n){var i=this.position;e.scale(i,i,-t);var a=new Float64Array(16);return e.fromScaling(a,[n,n,n]),e.translate(a,a,i),a[10]*=r,a}},{key:"getWorldToCamera",value:function(t,r){var n=new Float64Array(16),i=new Float64Array(4),a=this.position;return e.conjugate(i,this._orientation),e.scale(a,a,-t),e.fromQuat(n,i),e.translate(n,n,a),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=r,n[9]*=r,n[10]*=r,n[11]*=r,n}},{key:"getCameraToClipPerspective",value:function(t,r,n,i){var a=new Float64Array(16);return e.perspective(a,t,r,n,i),a}},{key:"getDistanceToElevation",value:function(t){var r=0===t?0:e.mercatorZfromAltitude(t,this.position[1]),n=this.forward();return(r-this.position[2])/n[2]}},{key:"clone",value:function(){return new t(c(this.position),c(this.orientation))}},{key:"mercatorPosition",get:function(){var t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}},{key:"position",get:function(){var e=An(this._transform,3);return[e[0],e[1],e[2]]},set:function(e){Rn(this._transform,e)}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e,In(this._transform,this._orientation)}}]),t}(),Dn=function(){function t(r,n,i,a,o){v(this,t),this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===o||o,this._minZoom=r||0,this._maxZoom=n||22,this._minPitch=null==i?0:i,this._maxPitch=null==a?60:a,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Tn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new Ln,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}return m(t,[{key:"clone",value:function(){var e=new t(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._cameraZoom=this._cameraZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e}},{key:"updateElevation",value:function(e){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),e&&this._constrainCameraAltitude(),this._calcMatrices()}},{key:"_setZoom",value:function(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}},{key:"_updateCenterElevation",value:function(){if(!this._elevation)return!1;var t=this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(this.center),-1);return-1===t?(this._cameraZoom=null,!1):(this._centerAltitude=t,!0)}},{key:"_updateCameraOnTerrain",value:function(){var t=this.cameraToCenterDistance/this.worldSize,r=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(r+t)}},{key:"sampleAverageElevation",value:function(){if(!this._elevation)return 0;for(var t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop(),i=0,a=0,o=0;o<r.length;o++){var s=new e.pointGeometry(r[o][0]*this.width,n+r[o][1]*(this.height-n)),u=t.pointCoordinate(s);if(u){var l=1/Math.hypot(u[0]-this._camera.position[0],u[1]-this._camera.position[1]);i+=u[3]*l,a+=l}}return 0===a?NaN:i/a}},{key:"_updateZoomFromElevation",value:function(){if(null!=this._cameraZoom&&this._elevation){var t=this._cameraZoom,r=this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(this.center)),n=e.mercatorZfromAltitude(r,this.center.lat),i=this._mercatorZfromZoom(t),a=this._mercatorZfromZoom(this._maxZoom),o=Math.max(i-n,a);this._setZoom(this._zoomFromMercatorZ(o))}}},{key:"computeZoomRelativeTo",value:function(t){var r,n=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));r=t.z<this._camera.position[2]?[n.x,n.y,n.z]:[t.x,t.y,t.z];var i=e.length(e.sub([],this._camera.position,r));return e.clamp(this._zoomFromMercatorZ(i),this._minZoom,this._maxZoom)}},{key:"setFreeCameraOptions",value:function(t){if(this.height&&(t.position||t.orientation)){this._updateCameraState();var r=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){var n=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}}},{key:"getFreeCameraOptions",value:function(){this._updateCameraState();var t=this._camera.position,r=new On;return r.position=new e.MercatorCoordinate(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this._renderWorldCopies,r}},{key:"_setCameraOrientation",value:function(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);var r=e.transformQuat([],[0,0,-1],t),n=e.transformQuat([],[0,-1,0],t);if(n[2]<0)return!1;var i=Pn(r,n);return!!i&&(this._camera.orientation=i,!0)}},{key:"_setCameraPosition",value:function(t){var r=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,i=this.cameraToCenterDistance;t[2]=e.clamp(t[2],i/n,i/r),this._camera.position=t}},{key:"isPaddingEqual",value:function(e){return this._edgeInsets.equals(e)}},{key:"interpolatePadding",value:function(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}},{key:"coveringZoomLevel",value:function(e){var t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}},{key:"getVisibleUnwrappedCoordinates",value:function(t){var r=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var n=this.pointCoordinate(new e.pointGeometry(0,0)),i=this.pointCoordinate(new e.pointGeometry(this.width,0)),a=this.pointCoordinate(new e.pointGeometry(this.width,this.height)),o=this.pointCoordinate(new e.pointGeometry(0,this.height)),s=Math.floor(Math.min(n.x,i.x,a.x,o.x)),u=Math.floor(Math.max(n.x,i.x,a.x,o.x)),l=1,c=s-l;c<=u+l;c++)0!==c&&r.push(new e.UnwrappedTileID(c,t));return r}},{key:"coveringTiles",value:function(t){var r=this,n=this.coveringZoomLevel(t),i=n,a=this.elevation&&!t.isTerrainDEM;if(void 0!==t.minzoom&&n<t.minzoom)return[];void 0!==t.maxzoom&&n>t.maxzoom&&(n=t.maxzoom);var o=e.MercatorCoordinate.fromLngLat(this.center),s=1<<n,u=[s*o.x,s*o.y,0],l=T.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),h=this.pointCoordinate(this.getCameraPoint()),f=s*e.mercatorZfromAltitude(1,this.center.lat),d=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),p=[s*h.x,s*h.y,d],y=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?n:0,m=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,g=t.isTerrainDEM?-m:this._elevation?this._elevation.getMinElevationBelowMSL():0,_=function(e){return{aabb:new A([e*s,0,g],[(e+1)*s,s,m]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}},b=[],w=[],x=n,k=t.reparseOverscaled?i:n,E=function(e){if(r._elevation&&e.tileID){var t=r._elevation.getMinMaxForTile(e.tileID),n=e.aabb;t?(n.min[2]=t.min,n.max[2]=t.max,n.center[2]=(n.min[2]+n.max[2])/2):(e.shouldSplit=I(e),e.shouldSplit||(n.min[2]=n.max[2]=n.center[2]=r._centerAltitude))}},S=function(e){return e*e},C=S((d-this._centerAltitude)*f),I=function(e){if(e.zoom<v)return!0;if(e.zoom===x)return!1;if(null!=e.shouldSplit)return e.shouldSplit;var t=e.aabb.distanceX(p),r=e.aabb.distanceY(p),n=C;a&&(n=S(e.aabb.distanceZ(p)*f));var i=t*t+r*r+n;return i<S((1<<x-e.zoom)*y*function(e,t){if(t*S(.707)<e)return 1;var r=Math.sqrt(t/e);return r/(1.4144271570014144+(Math.pow(1.1,r-1.4144271570014144+1)-1)/(1.1-1)-1)}(Math.max(n,C),i))};if(this._renderWorldCopies)for(var R=1;R<=3;R++)b.push(_(-R)),b.push(_(R));for(b.push(_(0));b.length>0;){var M=b.pop(),P=M.x,O=M.y,L=M.fullyVisible;if(!L){var D=M.aabb.intersects(l);if(0===D)continue;L=2===D}if(M.zoom!==x&&I(M))for(var B=0;B<4;B++){var N=(P<<1)+B%2,z=(O<<1)+(B>>1),F={aabb:M.aabb.quadrant(B),zoom:M.zoom+1,x:N,y:z,wrap:M.wrap,fullyVisible:L,tileID:void 0,shouldSplit:void 0};a&&(F.tileID=new e.OverscaledTileID(M.zoom+1===x?k:M.zoom+1,M.wrap,M.zoom+1,N,z),E(F)),b.push(F)}else{var j=M.zoom===x?k:M.zoom;if(t.minzoom&&t.minzoom>j)continue;var U=u[0]-(.5+P+(M.wrap<<M.zoom))*(1<<n-M.zoom),V=u[1]-.5-O,q=M.tileID?M.tileID:new e.OverscaledTileID(j,M.wrap,M.zoom,P,O);w.push({tileID:q,distanceSq:U*U+V*V})}}if(this.fogCullDistSq){var G=this.fogCullDistSq;w.splice.apply(w,[0,w.length].concat(c(w.filter((function(t){var n=[0,0,0,1],i=[e.EXTENT,e.EXTENT,0,1],o=r.calculateFogTileMatrix(t.tileID.toUnwrapped());e.transformMat4(n,n,o),e.transformMat4(i,i,o);var s=e.getAABBPointSquareDist(n,i);if(0===s)return!0;var u=!1,l=r.horizonLineFromTop();if(s>G&&0!==l){var c,h=r.calculateProjMatrix(t.tileID.toUnwrapped());a&&r._elevation&&(c=r._elevation.getMinMaxForTile(t.tileID)),c||(c={min:g,max:m});var f=e.furthestTileCorner(r.bearing),d=[f[0]*e.EXTENT,f[1]*e.EXTENT,c.max];e.transformMat4$1(d,d,h),u=(1-d[1])*r.height*.5<l}return s<G||u})))))}return w.sort((function(e,t){return e.distanceSq-t.distanceSq})).map((function(e){return e.tileID}))}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}},{key:"zoomScale",value:function(e){return Math.pow(2,e)}},{key:"scaleZoom",value:function(e){return Math.log(e)/Math.LN2}},{key:"project",value:function(t){var r=e.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.pointGeometry(e.mercatorXfromLng(t.lng)*this.worldSize,e.mercatorYfromLat(r)*this.worldSize)}},{key:"unproject",value:function(t){return new e.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}},{key:"setLocationAtPoint",value:function(t,r){var n=this.pointCoordinate(r),i=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(t),o=new e.MercatorCoordinate(a.x-(n.x-i.x),a.y-(n.y-i.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"setLocation",value:function(e){this.center=this.coordinateLocation(e),this._renderWorldCopies&&(this.center=this.center.wrap())}},{key:"locationPoint",value:function(e){return this._coordinatePoint(this.locationCoordinate(e),!1)}},{key:"locationPoint3D",value:function(e){return this._coordinatePoint(this.locationCoordinate(e),!0)}},{key:"pointLocation",value:function(e){return this.coordinateLocation(this.pointCoordinate(e))}},{key:"pointLocation3D",value:function(e){return this.coordinateLocation(this.pointCoordinate3D(e))}},{key:"locationCoordinate",value:function(t){return e.MercatorCoordinate.fromLngLat(t)}},{key:"coordinateLocation",value:function(e){return e.toLngLat()}},{key:"pointRayIntersection",value:function(t,r){var n=null!=r?r:this._centerAltitude,i=[t.x,t.y,0,1],a=[t.x,t.y,1,1];e.transformMat4(i,i,this.pixelMatrixInverse),e.transformMat4(a,a,this.pixelMatrixInverse);var o=a[3];e.scale$2(i,i,1/i[3]),e.scale$2(a,a,1/o);var s=i[2],u=a[2];return{p0:i,p1:a,t:s===u?0:(n-s)/(u-s)}}},{key:"screenPointToMercatorRay",value:function(t){var r=[t.x,t.y,0,1],n=[t.x,t.y,1,1];return e.transformMat4(r,r,this.pixelMatrixInverse),e.transformMat4(n,n,this.pixelMatrixInverse),e.scale$2(r,r,1/r[3]),e.scale$2(n,n,1/n[3]),r[2]=e.mercatorZfromAltitude(r[2],this._center.lat)*this.worldSize,n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,e.scale$2(r,r,1/this.worldSize),e.scale$2(n,n,1/this.worldSize),new S([r[0],r[1],r[2]],e.normalize([],e.sub([],n,r)))}},{key:"rayIntersectionCoordinate",value:function(t){var r=t.p0,n=t.p1,i=t.t,a=e.mercatorZfromAltitude(r[2],this._center.lat),o=e.mercatorZfromAltitude(n[2],this._center.lat);return new e.MercatorCoordinate(e.number(r[0],n[0],i)/this.worldSize,e.number(r[1],n[1],i)/this.worldSize,e.number(a,o,i))}},{key:"pointCoordinate",value:function(t){var r=this.horizonLineFromTop(!1),n=new e.pointGeometry(t.x,Math.max(r,t.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(n))}},{key:"pointCoordinate3D",value:function(t){if(!this.elevation)return this.pointCoordinate(t);var r=this.elevation,n=this.elevation.pointCoordinate(t);if(n)return new e.MercatorCoordinate(n[0],n[1],n[2]);var i=0,a=this.horizonLineFromTop();if(t.y>a)return this.pointCoordinate(t);for(var o=.02*a,s=t.clone(),u=0;u<10&&a-i>o;u++){s.y=e.number(i,a,.66);var l=r.pointCoordinate(s);l?(a=s.y,n=l):i=s.y}return n?new e.MercatorCoordinate(n[0],n[1],n[2]):this.pointCoordinate(t)}},{key:"isPointAboveHorizon",value:function(e){if(this.elevation)return!this.elevation.pointCoordinate(e);var t=this.horizonLineFromTop();return e.y<t}},{key:"_coordinatePoint",value:function(t,r){var n=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,i=[t.x*this.worldSize,t.y*this.worldSize,n+t.toAltitude(),1];return e.transformMat4(i,i,this.pixelMatrix),i[3]>0?new e.pointGeometry(i[0]/i[3],i[1]/i[3]):new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}},{key:"getBounds",value:function(){return this._terrainEnabled()?this._getBounds3D():(new e.LngLatBounds).extend(this.pointLocation(new e.pointGeometry(this._edgeInsets.left,this._edgeInsets.top))).extend(this.pointLocation(new e.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top))).extend(this.pointLocation(new e.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom))).extend(this.pointLocation(new e.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom)))}},{key:"_getBounds3D",value:function(){var t=this,r=this.elevation,n=r.visibleDemTiles.reduce((function(e,t){if(t.dem){var r=t.dem.tree;e.min=Math.min(e.min,r.minimums[0]),e.max=Math.max(e.max,r.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});n.min*=r.exaggeration(),n.max*=r.exaggeration();var i=this.horizonLineFromTop();return[new e.pointGeometry(0,i),new e.pointGeometry(this.width,i),new e.pointGeometry(this.width,this.height),new e.pointGeometry(0,this.height)].reduce((function(e,r){return e.extend(t.coordinateLocation(t.rayIntersectionCoordinate(t.pointRayIntersection(r,n.min)))).extend(t.coordinateLocation(t.rayIntersectionCoordinate(t.pointRayIntersection(r,n.max))))}),new e.LngLatBounds)}},{key:"horizonLineFromTop",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,r=this.height/2-.97*t;return e?Math.max(0,r):r}},{key:"getMaxBounds",value:function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}},{key:"setMaxBounds",value:function(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}},{key:"calculatePosMatrix",value:function(t,r){var n=t.canonical,i=r/this.zoomScale(n.z),a=n.x+Math.pow(2,n.z)*t.wrap,o=e.identity(new Float64Array(16));return e.translate(o,o,[a*i,n.y*i,0]),e.scale$1(o,o,[i/e.EXTENT,i/e.EXTENT,1]),o}},{key:"calculateFogTileMatrix",value:function(t){var r=t.key,n=this._fogTileMatrixCache;if(n[r])return n[r];var i=this.calculatePosMatrix(t,this.cameraWorldSize);return e.multiply(i,this.worldToFogMatrix,i),n[r]=new Float32Array(i),n[r]}},{key:"calculateProjMatrix",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.key,i=r?this._alignedProjMatrixCache:this._projMatrixCache;if(i[n])return i[n];var a=this.calculatePosMatrix(t,this.worldSize);return e.multiply(a,r?this.alignedProjMatrix:this.projMatrix,a),i[n]=new Float32Array(a),i[n]}},{key:"customLayerMatrix",value:function(){return this.mercatorMatrix.slice()}},{key:"recenterOnTerrain",value:function(){if(this._elevation){var t=this._elevation;this._updateCameraState();var r=this._camera.position,n=this._camera.forward();if(!(r[2]<=0||n[2]>=0)){var i=e.mercatorZfromAltitude(1,this._center.lat);r[2]/=i,n[2]/=i,e.normalize(n,n);var a=t.raycast(r,n,t.exaggeration());if(a){var o=e.scaleAndAdd([],r,n,a),s=new e.MercatorCoordinate(o[0],o[1],e.mercatorZfromAltitude(o[2],e.latFromMercatorY(o[1]))),u=this._camera.position,l=s.z+e.length([s.x-u[0],s.y-u[1],s.z-u[2]]);this._cameraZoom=this._zoomFromMercatorZ(l),this._centerAltitude=s.toAltitude(),this._center=s.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}}}},{key:"_constrainCameraAltitude",value:function(){if(this._elevation){var t=this._elevation;this._updateCameraState();var r=t.getAtPointOrZero(this._camera.mercatorPosition),n=this._minimumHeightOverTerrain()*Math.cos(e.degToRad(this._maxPitch)),i=e.mercatorZfromAltitude(r,this._center.lat),a=this._camera.position[2]-i;if(a<n){var o=e.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),s=this._camera.mercatorPosition,u=[o.x-s.x,o.y-s.y,o.z-s.z],l=e.length(u);u[2]-=n-a;var c=e.length(u);if(0===c)return;e.scale(u,u,l/c),this._camera.position=[o.x-u[0],o.y-u[1],o.z-u[2]],this._camera.orientation=Pn(u,this._camera.up()),this._updateStateFromCamera()}}}},{key:"_constrain",value:function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,r,n,i,a=-90,o=90,s=-180,u=180,l=this.size,c=this._unmodified;if(this.latRange){var h=this.latRange;a=e.mercatorYfromLat(h[1])*this.worldSize,t=(o=e.mercatorYfromLat(h[0])*this.worldSize)-a<l.y?l.y/(o-a):0}if(this.lngRange){var f=this.lngRange;s=e.mercatorXfromLng(f[0])*this.worldSize,r=(u=e.mercatorXfromLng(f[1])*this.worldSize)-s<l.x?l.x/(u-s):0}var d=this.point,p=Math.max(r||0,t||0);if(p)return this.center=this.unproject(new e.pointGeometry(r?(u+s)/2:d.x,t?(o+a)/2:d.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var y=d.y,v=l.y/2;y-v<a&&(i=a+v),y+v>o&&(i=o-v)}if(this.lngRange){var m=d.x,g=l.x/2;m-g<s&&(n=s+g),m+g>u&&(n=u-g)}void 0===n&&void 0===i||(this.center=this.unproject(new e.pointGeometry(void 0!==n?n:d.x,void 0!==i?i:d.y))),this._constrainCameraAltitude(),this._unmodified=c,this._constraining=!1}}},{key:"_minZoomForBounds",value:function(){var t=this,r=function(e,r){return Math.log2(e/(t.tileSize*Math.abs(r[1]-r[0])))},n=0;if(this.latRange){var i=this.latRange;n=r(this.height,[e.mercatorYfromLat(i[0]),e.mercatorYfromLat(i[1])])}var a=0;if(this.lngRange){var o=this.lngRange;a=r(this.width,[e.mercatorXfromLng(o[0]),e.mercatorXfromLng(o[1])])}return Math.max(n,a)}},{key:"_maxCameraBoundsDistance",value:function(){return this._mercatorZfromZoom(this._minZoomForBounds())}},{key:"_calcMatrices",value:function(){if(this.height){var t=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var r=this.pixelsPerMeter;this._updateCameraState();var n=Math.PI/2+this._pitch,i=this.fovAboveCenter,a=this.elevation?this.elevation.getMinElevationBelowMSL()*r:0,o=(this._camera.position[2]*this.worldSize-a)/Math.cos(this._pitch),s=Math.sin(i)*o/Math.sin(e.clamp(Math.PI-n-i,.01,Math.PI-.01)),u=this.point,l=u.x,c=u.y,h=Math.cos(Math.PI/2-this._pitch)*s+o,f=Math.min(1.01*h,o*(1/this._horizonShift)),d=this.height/50,p=this._camera.getWorldToCamera(this.worldSize,r),y=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,d,f);y[8]=2*-t.x/this.width,y[9]=2*t.y/this.height;var v=e.mul$1([],y,p);this.mercatorMatrix=e.scale$1([],v,[this.worldSize,this.worldSize,this.worldSize/r]),this.projMatrix=v,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);var m=new Float32Array(16);e.identity(m),e.scale$1(m,m,[1,-1,1]),e.rotateX(m,m,this._pitch),e.rotateZ(m,m,this.angle);var g=e.perspective(new Float32Array(16),this._fov,this.width/this.height,d,f),_=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;g[8]=2*-t.x/this.width,g[9]=2*(t.y+_)/this.height,this.skyboxMatrix=e.multiply(m,g,m);var b=this.width%2/2,w=this.height%2/2,x=Math.cos(this.angle),k=Math.sin(this.angle),E=l-Math.round(l)+x*b+k*w,S=c-Math.round(c)+x*w+k*b,T=new Float64Array(v);if(e.translate(T,T,[E>.5?E-1:E,S>.5?S-1:S,0]),this.alignedProjMatrix=T,v=e.create$1(),e.scale$1(v,v,[this.width/2,-this.height/2,1]),e.translate(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=e.create$1(),e.scale$1(v,v,[1,-1,1]),e.translate(v,v,[-1,-1,0]),e.scale$1(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),!(v=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._projMatrixCache={},this._alignedProjMatrixCache={}}}},{key:"_calcFogMatrices",value:function(){this._fogTileMatrixCache={};var t=this.cameraWorldSize,r=this.cameraPixelsPerMeter,n=this._camera.position,i=1/this.height,a=[t,t,r];e.scale(a,a,i),e.scale(n,n,-1),e.multiply$1(n,n,a);var o=e.create$1();e.translate(o,o,n),e.scale$1(o,o,a),this.mercatorFogMatrix=o,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,i)}},{key:"_updateCameraState",value:function(){if(this.height){this._camera.setPitchBearing(this._pitch,this.angle);var t=this._camera.forward(),r=this.cameraToCenterDistance,n=this.point,i=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-e.mercatorZfromAltitude(this._centerAltitude,this.center.lat),a=this.cameraToCenterDistance/i;this._camera.position=[n.x/this.worldSize-t[0]*r/a,n.y/this.worldSize-t[1]*r/a,e.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-t[2]*r/a]}}},{key:"_translateCameraConstrained",value:function(t){var r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=t[2],i=1;n>0&&(i=Math.min((r-this._camera.position[2])/n,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,i),this._updateStateFromCamera()}},{key:"_updateStateFromCamera",value:function(){var t=this._camera.position,r=this._camera.forward(),n=this._camera.getPitchBearing(),i=n.pitch,a=n.bearing,o=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat),s=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),u=Math.max((t[2]-o)/Math.cos(i),s),l=this._zoomFromMercatorZ(u);e.scaleAndAdd(t,t,r,u),this._pitch=e.clamp(i,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(a,-Math.PI,Math.PI),this._setZoom(e.clamp(l,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new e.MercatorCoordinate(t[0],t[1],t[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}},{key:"_worldSizeFromZoom",value:function(e){return Math.pow(2,e)*this.tileSize}},{key:"_mercatorZfromZoom",value:function(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}},{key:"_minimumHeightOverTerrain",value:function(){var e=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(e)}},{key:"_zoomFromMercatorZ",value:function(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}},{key:"_terrainEnabled",value:function(){return!!this._elevation}},{key:"isHorizonVisibleForPoints",value:function(t,r){for(var n=Math.min(t.x,r.x),i=Math.max(t.x,r.x),a=Math.min(t.y,r.y),o=Math.max(t.y,r.y),s=[new e.pointGeometry(n,a),new e.pointGeometry(i,o),new e.pointGeometry(n,o),new e.pointGeometry(i,a)],u=this._renderWorldCopies?-3:0,l=this._renderWorldCopies?4:1,c=0,h=s;c<h.length;c++){var f=h[c],d=this.pointRayIntersection(f);if(d.t<0)return!0;var p=this.rayIntersectionCoordinate(d);if(p.x<u||p.y<0||p.x>l||p.y>1)return!0}return!1}},{key:"isHorizonVisible",value:function(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.isHorizonVisibleForPoints(new e.pointGeometry(0,0),new e.pointGeometry(this.width,this.height))}},{key:"zoomDeltaToMovement",value:function(t,r){var n=e.length(e.sub([],this._camera.position,t)),i=this._zoomFromMercatorZ(n)+r;return n-this._mercatorZfromZoom(i)}},{key:"getCameraPoint",value:function(){var t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.pointGeometry(0,t))}},{key:"elevation",get:function(){return this._elevation},set:function(e){this._elevation!==e&&(this._elevation=e,e?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}},{key:"minZoom",get:function(){return this._minZoom},set:function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}},{key:"maxZoom",get:function(){return this._maxZoom},set:function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}},{key:"minPitch",get:function(){return this._minPitch},set:function(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}},{key:"maxPitch",get:function(){return this._maxPitch},set:function(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}},{key:"renderWorldCopies",get:function(){return this._renderWorldCopies},set:function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}},{key:"worldSize",get:function(){return this.tileSize*this.scale}},{key:"cameraWorldSize",get:function(){var e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}},{key:"pixelsPerMeter",get:function(){return e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}},{key:"cameraPixelsPerMeter",get:function(){return e.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}},{key:"centerOffset",get:function(){return this.centerPoint._sub(this.size._div(2))}},{key:"size",get:function(){return new e.pointGeometry(this.width,this.height)}},{key:"bearing",get:function(){return-this.angle/Math.PI*180},set:function(t){var r,n=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=(r=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r),function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*-s+a*u,e[3]=i*-s+o*u}(this.rotationMatrix,this.rotationMatrix,this.angle))}},{key:"pitch",get:function(){return this._pitch/Math.PI*180},set:function(t){var r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}},{key:"fov",get:function(){return this._fov/Math.PI*180},set:function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}},{key:"averageElevation",get:function(){return this._averageElevation},set:function(e){this._averageElevation=e,this._calcFogMatrices()}},{key:"zoom",get:function(){return this._zoom},set:function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}},{key:"center",get:function(){return this._center},set:function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}},{key:"padding",get:function(){return this._edgeInsets.toJSON()},set:function(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}},{key:"centerPoint",get:function(){return this._edgeInsets.getCenter(this.width,this.height)}},{key:"fovAboveCenter",get:function(){return this._fov*(.5+this.centerOffset.y/this.height)}},{key:"unmodified",get:function(){return this._unmodified}},{key:"point",get:function(){return this.project(this.center)}}]),t}();function Bn(e,t){var r=!1,n=null,i=function i(){n=null,r&&(e(),n=setTimeout(i,t),r=!1)};return function(){return r=!0,n||i(),n}}var Nn=function(){function t(r){v(this,t),this._hashName=r&&encodeURIComponent(r),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Bn(this._updateHashUnthrottled.bind(this),300)}return m(t,[{key:"addTo",value:function(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}},{key:"remove",value:function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}},{key:"getHashString",value:function(t){var r=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,i),o=Math.round(r.lng*a)/a,s=Math.round(r.lat*a)/a,u=this._map.getBearing(),l=this._map.getPitch(),c="";if(c+=t?"/".concat(o,"/").concat(s,"/").concat(n):"".concat(n,"/").concat(s,"/").concat(o),(u||l)&&(c+="/"+Math.round(10*u)/10),l&&(c+="/".concat(Math.round(l))),this._hashName){var h=this._hashName,f=!1,d=e.window.location.hash.slice(1).split("&").map((function(e){var t=e.split("=")[0];return t===h?(f=!0,"".concat(t,"=").concat(c)):e})).filter((function(e){return e}));return f||d.push("".concat(h,"=").concat(c)),"#".concat(d.join("&"))}return"#".concat(c)}},{key:"_getCurrentHash",value:function(){var t,r=this,n=e.window.location.hash.replace("#","");return this._hashName?(n.split("&").map((function(e){return e.split("=")})).forEach((function(e){e[0]===r._hashName&&(t=e)})),(t&&t[1]||"").split("/")):n.split("/")}},{key:"_onHashChange",value:function(){var e=this._getCurrentHash();if(e.length>=3&&!e.some((function(e){return isNaN(e)}))){var t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1}},{key:"_updateHashUnthrottled",value:function(){var t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}]),t}(),zn={linearity:.3,easing:e.bezier(0,0,.3,1)},Fn=e.extend({deceleration:2500,maxSpeed:1400},zn),jn=e.extend({deceleration:20,maxSpeed:1400},zn),Un=e.extend({deceleration:1e3,maxSpeed:360},zn),Vn=e.extend({deceleration:1e3,maxSpeed:90},zn),qn=function(){function t(e){v(this,t),this._map=e,this.clear()}return m(t,[{key:"clear",value:function(){this._inertiaBuffer=[]}},{key:"record",value:function(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}},{key:"_drainInertiaBuffer",value:function(){for(var t=this._inertiaBuffer,r=e.exported.now();t.length>0&&r-t[0].time>160;)t.shift()}},{key:"_onMoveEnd",value:function(t){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){var r,n={zoom:0,bearing:0,pitch:0,pan:new e.pointGeometry(0,0),pinchAround:void 0,around:void 0},i=f(this._inertiaBuffer);try{for(i.s();!(r=i.n()).done;){var a=r.value.settings;n.zoom+=a.zoomDelta||0,n.bearing+=a.bearingDelta||0,n.pitch+=a.pitchDelta||0,a.panDelta&&n.pan._add(a.panDelta),a.around&&(n.around=a.around),a.pinchAround&&(n.pinchAround=a.pinchAround)}}catch(p){i.e(p)}finally{i.f()}var o=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,s={};if(n.pan.mag()){var u=Kn(n.pan.mag(),o,e.extend({},Fn,t||{}));s.offset=n.pan.mult(u.amount/n.pan.mag()),s.center=this._map.transform.center,Gn(s,u)}if(n.zoom){var l=Kn(n.zoom,o,jn);s.zoom=this._map.transform.zoom+l.amount,Gn(s,l)}if(n.bearing){var c=Kn(n.bearing,o,Un);s.bearing=this._map.transform.bearing+e.clamp(c.amount,-179,179),Gn(s,c)}if(n.pitch){var h=Kn(n.pitch,o,Vn);s.pitch=this._map.transform.pitch+h.amount,Gn(s,h)}if(s.zoom||s.bearing){var d=void 0===n.pinchAround?n.around:n.pinchAround;s.around=d?this._map.unproject(d):this._map.getCenter()}return this.clear(),e.extend(s,{noMoveStart:!0})}}}]),t}();function Gn(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Kn(t,r,n){var i=n.maxSpeed,a=n.linearity,o=n.deceleration,s=e.clamp(t*a/(r/1e3),-i,i),u=Math.abs(s)/(o*a);return{easing:n.easing,duration:1e3*u,amount:s*(u/2)}}var Hn=function(t){p(n,t);var r=y(n);function n(t,i,a){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};v(this,n);var u=g.mousePos(i.getCanvasContainer(),a),l=i.unproject(u);return(o=r.call(this,t,e.extend({point:u,lngLat:l,originalEvent:a},s)))._defaultPrevented=!1,o.target=i,o}return m(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),Wn=function(t){p(n,t);var r=y(n);function n(t,i,a){var o;v(this,n);var s="touchend"===t?a.changedTouches:a.touches,u=g.touchPos(i.getCanvasContainer(),s),l=u.map((function(e){return i.unproject(e)})),c=u.reduce((function(e,t,r,n){return e.add(t.div(n.length))}),new e.pointGeometry(0,0));return(o=r.call(this,t,{points:u,point:c,lngLats:l,lngLat:i.unproject(c),originalEvent:a}))._defaultPrevented=!1,o}return m(n,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),n}(e.Event),Zn=function(e){p(r,e);var t=y(r);function r(e,n,i){var a;return v(this,r),(a=t.call(this,e,{originalEvent:i}))._defaultPrevented=!1,a}return m(r,[{key:"preventDefault",value:function(){this._defaultPrevented=!0}},{key:"defaultPrevented",get:function(){return this._defaultPrevented}}]),r}(e.Event),Yn=function(){function e(t,r){v(this,e),this._map=t,this._clickTolerance=r.clickTolerance}return m(e,[{key:"reset",value:function(){delete this._mousedownPos}},{key:"wheel",value:function(e){return this._firePreventable(new Zn(e.type,this._map,e))}},{key:"mousedown",value:function(e,t){return this._mousedownPos=t,this._firePreventable(new Hn(e.type,this._map,e))}},{key:"mouseup",value:function(e){this._map.fire(new Hn(e.type,this._map,e))}},{key:"click",value:function(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Hn(e.type,this._map,e))}},{key:"dblclick",value:function(e){return this._firePreventable(new Hn(e.type,this._map,e))}},{key:"mouseover",value:function(e){this._map.fire(new Hn(e.type,this._map,e))}},{key:"mouseout",value:function(e){this._map.fire(new Hn(e.type,this._map,e))}},{key:"touchstart",value:function(e){return this._firePreventable(new Wn(e.type,this._map,e))}},{key:"touchmove",value:function(e){this._map.fire(new Wn(e.type,this._map,e))}},{key:"touchend",value:function(e){this._map.fire(new Wn(e.type,this._map,e))}},{key:"touchcancel",value:function(e){this._map.fire(new Wn(e.type,this._map,e))}},{key:"_firePreventable",value:function(e){if(this._map.fire(e),e.defaultPrevented)return{}}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),e}(),Xn=function(){function e(t){v(this,e),this._map=t}return m(e,[{key:"reset",value:function(){this._delayContextMenu=!1,delete this._contextMenuEvent}},{key:"mousemove",value:function(e){this._map.fire(new Hn(e.type,this._map,e))}},{key:"mousedown",value:function(){this._delayContextMenu=!0}},{key:"mouseup",value:function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Hn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}},{key:"contextmenu",value:function(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new Hn(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}},{key:"isEnabled",value:function(){return!0}},{key:"isActive",value:function(){return!1}},{key:"enable",value:function(){}},{key:"disable",value:function(){}}]),e}(),Qn=function(){function t(e,r){v(this,t),this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}return m(t,[{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active}},{key:"enable",value:function(){this.isEnabled()||(this._enabled=!0)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"mousedown",value:function(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(g.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}},{key:"mousemoveWindow",value:function(e,t){var r=this;if(this._active){var n=t;if(!(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)){var i=this._startPos;this._lastPos=n,this._box||(this._box=g.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var a=Math.min(i.x,n.x),o=Math.max(i.x,n.x),s=Math.min(i.y,n.y),u=Math.max(i.y,n.y);this._map._requestDomTask((function(){r._box&&(g.setTransform(r._box,"translate(".concat(a,"px,").concat(s,"px)")),r._box.style.width=o-a+"px",r._box.style.height=u-s+"px")}))}}}},{key:"mouseupWindow",value:function(t,r){var n=this;if(this._active&&0===t.button){var i=this._startPos,a=r;if(this.reset(),g.suppressClick(),i.x!==a.x||i.y!==a.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:function(e){return e.fitScreenCoordinates(i,a,n._map.getBearing(),{linear:!1})}};this._fireEvent("boxzoomcancel",t)}}},{key:"keydown",value:function(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}},{key:"reset",value:function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(g.remove(this._box),this._box=null),g.enableDrag(),delete this._startPos,delete this._lastPos}},{key:"_fireEvent",value:function(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))}}]),t}();function Jn(e,t){for(var r={},n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}var $n=function(){function t(e){v(this,t),this.reset(),this.numTouches=e.numTouches}return m(t,[{key:"reset",value:function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}},{key:"touchstart",value:function(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){var r,n=new e.pointGeometry(0,0),i=f(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;n._add(a)}}catch(o){i.e(o)}finally{i.f()}return n.div(t.length)}(r),this.touches=Jn(n,r)))}},{key:"touchmove",value:function(e,t,r){if(!this.aborted&&this.centroid){var n=Jn(r,t);for(var i in this.touches){var a=this.touches[i],o=n[i];(!o||o.dist(a)>30)&&(this.aborted=!0)}}}},{key:"touchend",value:function(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){var n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}}]),t}(),ei=function(){function e(t){v(this,e),this.singleTap=new $n(t),this.numTaps=t.numTaps,this.reset()}return m(e,[{key:"reset",value:function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}},{key:"touchstart",value:function(e,t,r){this.singleTap.touchstart(e,t,r)}},{key:"touchmove",value:function(e,t,r){this.singleTap.touchmove(e,t,r)}},{key:"touchend",value:function(e,t,r){var n=this.singleTap.touchend(e,t,r);if(n){var i=e.timeStamp-this.lastTime<500,a=!this.lastTap||this.lastTap.dist(n)<30;if(i&&a||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}]),e}(),ti=function(){function e(){v(this,e),this._zoomIn=new ei({numTouches:1,numTaps:2}),this._zoomOut=new ei({numTouches:2,numTaps:1}),this.reset()}return m(e,[{key:"reset",value:function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}},{key:"touchstart",value:function(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}},{key:"touchmove",value:function(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}},{key:"touchend",value:function(e,t,r){var n=this,i=this._zoomIn.touchend(e,t,r),a=this._zoomOut.touchend(e,t,r);return i?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(i)},{originalEvent:e})}}):a?(this._active=!0,e.preventDefault(),setTimeout((function(){return n.reset()}),0),{cameraAnimation:function(t){return t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(a)},{originalEvent:e})}}):void 0}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),ri={0:1,2:2},ni=function(){function e(t){v(this,e),this.reset(),this._clickTolerance=t.clickTolerance||1}return m(e,[{key:"reset",value:function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}},{key:"_correctButton",value:function(e,t){return!1}},{key:"_move",value:function(e,t){return{}}},{key:"mousedown",value:function(e,t){if(!this._lastPoint){var r=g.mouseButton(e);this._correctButton(e,r)&&(this._lastPoint=t,this._eventButton=r)}}},{key:"mousemoveWindow",value:function(e,t){var r=this._lastPoint;if(r)if(e.preventDefault(),function(e,t){var r=ri[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(r,t)}},{key:"mouseupWindow",value:function(e){this._lastPoint&&g.mouseButton(e)===this._eventButton&&(this._moved&&g.suppressClick(),this.reset())}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),ii=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"mousedown",value:function(e,t){o(s(r.prototype),"mousedown",this).call(this,e,t),this._lastPoint&&(this._active=!0)}},{key:"_correctButton",value:function(e,t){return 0===t&&!e.ctrlKey}},{key:"_move",value:function(e,t){return{around:t,panDelta:t.sub(e)}}}]),r}(ni),ai=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),r}(ni),oi=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"_correctButton",value:function(e,t){return 0===t&&e.ctrlKey||2===t}},{key:"_move",value:function(e,t){var r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}}},{key:"contextmenu",value:function(e){e.preventDefault()}}]),r}(ni),si=function(){function t(e){v(this,t),this._minTouches=1,this._clickTolerance=e.clickTolerance||1,this.reset()}return m(t,[{key:"reset",value:function(){this._active=!1,this._touches={},this._sum=new e.pointGeometry(0,0)}},{key:"touchstart",value:function(e,t,r){return this._calculateTransform(e,t,r)}},{key:"touchmove",value:function(e,t,r){if(this._active&&!(r.length<this._minTouches))return e.preventDefault(),this._calculateTransform(e,t,r)}},{key:"touchend",value:function(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()}},{key:"touchcancel",value:function(){this.reset()}},{key:"_calculateTransform",value:function(t,r,n){n.length>0&&(this._active=!0);var i=Jn(n,r),a=new e.pointGeometry(0,0),o=new e.pointGeometry(0,0),s=0;for(var u in i){var l=i[u],c=this._touches[u];c&&(a._add(l),o._add(l.sub(c)),s++,i[u]=l)}if(this._touches=i,!(s<this._minTouches)&&o.mag()){var h=o.div(s);return this._sum._add(h),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:h}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),t}(),ui=function(){function e(){v(this,e),this.reset()}return m(e,[{key:"reset",value:function(){this._active=!1,delete this._firstTwoTouches}},{key:"_start",value:function(e){}},{key:"_move",value:function(e,t,r){return{}}},{key:"touchstart",value:function(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}},{key:"touchmove",value:function(e,t,r){if(this._firstTwoTouches){e.preventDefault();var n=h(this._firstTwoTouches,2),i=n[0],a=n[1],o=li(r,t,i),s=li(r,t,a);if(o&&s){var u=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],u,e)}}}},{key:"touchend",value:function(e,t,r){if(this._firstTwoTouches){var n=h(this._firstTwoTouches,2),i=n[0],a=n[1],o=li(r,t,i),s=li(r,t,a);o&&s||(this._active&&g.suppressClick(),this.reset())}}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}();function li(e,t,r){for(var n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function ci(e,t){return Math.log(e/t)/Math.LN2}var hi=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"reset",value:function(){o(s(r.prototype),"reset",this).call(this),delete this._distance,delete this._startDistance}},{key:"_start",value:function(e){this._startDistance=this._distance=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ci(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ci(this._distance,r),pinchAround:t}}}]),r}(ui);function fi(e,t){return 180*e.angleWith(t)/Math.PI}var di=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"reset",value:function(){o(s(r.prototype),"reset",this).call(this),delete this._minDiameter,delete this._startVector,delete this._vector}},{key:"_start",value:function(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}},{key:"_move",value:function(e,t){var r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:fi(this._vector,r),pinchAround:t}}},{key:"_isBelowThreshold",value:function(e){this._minDiameter=Math.min(this._minDiameter,e.mag());var t=25/(Math.PI*this._minDiameter)*360,r=fi(e,this._startVector);return Math.abs(r)<t}}]),r}(ui);function pi(e){return Math.abs(e.y)>Math.abs(e.x)}var yi=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return m(r,[{key:"reset",value:function(){o(s(r.prototype),"reset",this).call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints}},{key:"_start",value:function(e){this._lastPoints=e,pi(e[0].sub(e[1]))&&(this._valid=!1)}},{key:"_move",value:function(e,t,r){var n=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(n,i,r.timeStamp),this._valid)return this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+i.y)/2*-.5}}},{key:"gestureBeginsVertically",value:function(e,t,r){if(void 0!==this._valid)return this._valid;var n=e.mag()>=2,i=t.mag()>=2;if(n||i){if(!n||!i)return void 0===this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;var a=e.y>0==t.y>0;return pi(e)&&pi(t)&&a}}}]),r}(ui),vi={panStep:100,bearingStep:15,pitchStep:10},mi=function(){function e(){v(this,e);var t=vi;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}return m(e,[{key:"reset",value:function(){this._active=!1}},{key:"keydown",value:function(e){var t=this;if(!(e.altKey||e.ctrlKey||e.metaKey)){var r=0,n=0,i=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?i=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?i=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(n=0,i=0),{cameraAnimation:function(s){var u=s.getZoom();s.easeTo({duration:300,easeId:"keyboardHandler",easing:gi,zoom:r?Math.round(u)+r*(e.shiftKey?2:1):u,bearing:s.getBearing()+n*t._bearingStep,pitch:s.getPitch()+i*t._pitchStep,offset:[-a*t._panStep,-o*t._panStep],center:s.getCenter()},{originalEvent:e})}}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}},{key:"disableRotation",value:function(){this._rotationDisabled=!0}},{key:"enableRotation",value:function(){this._rotationDisabled=!1}}]),e}();function gi(e){return e*(2-e)}var _i=4.000244140625,bi=function(){function t(r,n){v(this,t),this._map=r,this._el=r.getCanvasContainer(),this._handler=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout"],this)}return m(t,[{key:"setZoomRate",value:function(e){this._defaultZoomRate=e}},{key:"setWheelZoomRate",value:function(e){this._wheelZoomRate=e}},{key:"isEnabled",value:function(){return!!this._enabled}},{key:"isActive",value:function(){return!!this._active||void 0!==this._finishTimeout}},{key:"isZooming",value:function(){return!!this._zooming}},{key:"enable",value:function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)}},{key:"disable",value:function(){this.isEnabled()&&(this._enabled=!1)}},{key:"wheel",value:function(t){if(this.isEnabled()){var r=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,n=e.exported.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%_i==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}}},{key:"_onTimeout",value:function(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}},{key:"_start",value:function(e){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var t=g.mousePos(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}}},{key:"renderFrame",value:function(){var t=this;if(this._frameId&&(this._frameId=null,this.isActive())){var r=this._map.transform,n=function(){return r._terrainEnabled()?r.computeZoomRelativeTo(t._aroundCoord):r.zoom};if(0!==this._delta){var i="wheel"===this._type&&Math.abs(this._delta)>_i?this._wheelZoomRate:this._defaultZoomRate,a=2/(1+Math.exp(-Math.abs(this._delta*i)));this._delta<0&&0!==a&&(a=1/a);var o=n(),s=Math.pow(2,o),u="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):s;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(u*a))),"wheel"===this._type&&(this._startZoom=n(),this._easing=this._smoothOutEasing(200)),this._delta=0}var l,c="number"==typeof this._targetZoom?this._targetZoom:n(),h=this._startZoom,f=this._easing,d=!1;if("wheel"===this._type&&h&&f){var p=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),y=f(p);l=e.number(h,c,y),p<1?this._frameId||(this._frameId=!0):d=!0}else l=c,d=!0;return this._active=!0,d&&(this._active=!1,this._finishTimeout=setTimeout((function(){t._zooming=!1,t._handler._triggerRenderFrame(),delete t._targetZoom,delete t._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!d,zoomDelta:l-n(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}}},{key:"_smoothOutEasing",value:function(t){var r=e.ease;if(this._prevEase){var n=this._prevEase,i=(e.exported.now()-n.start)/n.duration,a=n.easing(i+.01)-n.easing(i),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.0729-o*o);r=e.bezier(o,s,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:r},r}},{key:"reset",value:function(){this._active=!1}}]),t}(),wi=function(){function e(t,r){v(this,e),this._clickZoom=t,this._tapZoom=r}return m(e,[{key:"enable",value:function(){this._clickZoom.enable(),this._tapZoom.enable()}},{key:"disable",value:function(){this._clickZoom.disable(),this._tapZoom.disable()}},{key:"isEnabled",value:function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}},{key:"isActive",value:function(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}]),e}(),xi=function(){function e(){v(this,e),this.reset()}return m(e,[{key:"reset",value:function(){this._active=!1}},{key:"dblclick",value:function(e,t){return e.preventDefault(),{cameraAnimation:function(r){r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),ki=function(){function e(){v(this,e),this._tap=new ei({numTouches:1,numTaps:1}),this.reset()}return m(e,[{key:"reset",value:function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}},{key:"touchstart",value:function(e,t,r){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))}},{key:"touchmove",value:function(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;var n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}},{key:"touchend",value:function(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)}},{key:"touchcancel",value:function(){this.reset()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this.reset()}},{key:"isEnabled",value:function(){return this._enabled}},{key:"isActive",value:function(){return this._active}}]),e}(),Ei=function(){function e(t,r,n){v(this,e),this._el=t,this._mousePan=r,this._touchPan=n}return m(e,[{key:"enable",value:function(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}},{key:"disable",value:function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}},{key:"isEnabled",value:function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}},{key:"isActive",value:function(){return this._mousePan.isActive()||this._touchPan.isActive()}}]),e}(),Si=function(){function e(t,r,n){v(this,e),this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=n}return m(e,[{key:"enable",value:function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}},{key:"disable",value:function(){this._mouseRotate.disable(),this._mousePitch.disable()}},{key:"isEnabled",value:function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}},{key:"isActive",value:function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}]),e}(),Ti=function(){function e(t,r,n,i){v(this,e),this._el=t,this._touchZoom=r,this._touchRotate=n,this._tapDragZoom=i,this._rotationDisabled=!1,this._enabled=!0}return m(e,[{key:"enable",value:function(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}},{key:"disable",value:function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}},{key:"isEnabled",value:function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}},{key:"isActive",value:function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}},{key:"disableRotation",value:function(){this._rotationDisabled=!0,this._touchRotate.disable()}},{key:"enableRotation",value:function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}]),e}(),Ai=function(e){return e.zoom||e.drag||e.pitch||e.rotate},Ci=function(e){p(r,e);var t=y(r);function r(){return v(this,r),t.apply(this,arguments)}return r}(e.Event),Ii=function(){function t(){v(this,t),this.constants=[1,1,.01],this.radius=0}return m(t,[{key:"setup",value:function(t,r){var n=e.sub([],r,t);this.radius=e.length(n[2]<0?e.div([],n,this.constants):[n[0],n[1],0])}},{key:"projectRay",value:function(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$2(t,t,this.constants);var r=e.scale([],t,this.radius);if(r[2]>0){var n=e.scale([],[0,0,1],e.dot(r,[0,0,1])),i=e.scale([],e.normalize([],[r[0],r[1],0]),this.radius),a=e.add([],r,e.scale([],e.sub([],e.add([],i,n),r),2));r[0]=a[0],r[1]=a[1]}return r}}]),t}();function Ri(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}var Mi=function(){function t(r,n){v(this,t),this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new qn(r),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Ii,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(n),e.bindAll(["handleEvent","handleWindowEvent"],this);var i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[e.window,"blur",void 0]];var a,o=f(this._listeners);try{for(o.s();!(a=o.n()).done;){var s=h(a.value,3),u=s[0],l=s[1],c=s[2];g.addEventListener(u,l,u===e.window.document?this.handleWindowEvent:this.handleEvent,c)}}catch(d){o.e(d)}finally{o.f()}}return m(t,[{key:"destroy",value:function(){var t,r=f(this._listeners);try{for(r.s();!(t=r.n()).done;){var n=h(t.value,3),i=n[0],a=n[1],o=n[2];g.removeEventListener(i,a,i===e.window.document?this.handleWindowEvent:this.handleEvent,o)}}catch(s){r.e(s)}finally{r.f()}}},{key:"_addDefaultHandlers",value:function(e){var t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new Yn(t,e));var n=t.boxZoom=new Qn(t,e);this._add("boxZoom",n);var i=new ti,a=new xi;t.doubleClickZoom=new wi(a,i),this._add("tapZoom",i),this._add("clickZoom",a);var o=new ki;this._add("tapDragZoom",o);var s=t.touchPitch=new yi;this._add("touchPitch",s);var u=new ai(e),l=new oi(e);t.dragRotate=new Si(e,u,l),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",l,["mouseRotate"]);var c=new ii(e),h=new si(e);t.dragPan=new Ei(r,c,h),this._add("mousePan",c),this._add("touchPan",h,["touchZoom","touchRotate"]);var f=new di,d=new hi;t.touchZoomRotate=new Ti(r,d,f,o),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Xn(t));var p=t.scrollZoom=new bi(t,this);this._add("scrollZoom",p,["mousePan"]);var y=t.keyboard=new mi;this._add("keyboard",y);for(var v=0,m=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];v<m.length;v++){var g=m[v];e.interactive&&e[g]&&t[g].enable(e[g])}}},{key:"_add",value:function(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}},{key:"stop",value:function(e){if(!this._updatingCamera){var t,r=f(this._handlers);try{for(r.s();!(t=r.n()).done;)t.value.handler.reset()}catch(n){r.e(n)}finally{r.f()}this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}},{key:"isActive",value:function(){var e,t=f(this._handlers);try{for(t.s();!(e=t.n()).done;)if(e.value.handler.isActive())return!0}catch(r){t.e(r)}finally{t.f()}return!1}},{key:"isZooming",value:function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}},{key:"isRotating",value:function(){return!!this._eventsInProgress.rotate}},{key:"isMoving",value:function(){return Boolean(Ai(this._eventsInProgress))||this.isZooming()}},{key:"_blockedByActive",value:function(e,t,r){for(var n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}},{key:"handleWindowEvent",value:function(e){this.handleEvent(e,"".concat(e.type,"Window"))}},{key:"_getMapTouches",value:function(e){var t,r=[],n=f(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this._el.contains(i.target)&&r.push(i)}}catch(a){n.e(a)}finally{n.f()}return r}},{key:"handleEvent",value:function(e,t){if("blur"!==e.type){this._updatingCamera=!0;var r,n="renderFrame"===e.type,i=n?void 0:e,a={needsRenderFrame:!1},o={},s={},u=e.touches?this._getMapTouches(e.touches):void 0,l=u?g.touchPos(this._el,u):n?void 0:g.mousePos(this._el,e),c=f(this._handlers);try{for(c.s();!(r=c.n()).done;){var h=r.value,d=h.handlerName,p=h.handler,y=h.allowed;if(p.isEnabled()){var v=void 0;this._blockedByActive(s,y,d)?p.reset():p[t||e.type]&&(v=p[t||e.type](e,l,u),this.mergeHandlerResult(a,o,v,d,i),v&&v.needsRenderFrame&&this._triggerRenderFrame()),(v||p.isActive())&&(s[d]=p)}}}catch(w){c.e(w)}finally{c.f()}var m={};for(var _ in this._previousActiveHandlers)s[_]||(m[_]=i);this._previousActiveHandlers=s,(Object.keys(m).length||Ri(a))&&(this._changes.push([a,o,m]),this._triggerRenderFrame()),(Object.keys(s).length||Ri(a))&&this._map._stop(!0),this._updatingCamera=!1;var b=a.cameraAnimation;b&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],b(this._map))}else this.stop(!0)}},{key:"mergeHandlerResult",value:function(t,r,n,i,a){if(n){e.extend(t,n);var o={handlerName:i,originalEvent:n.originalEvent||a};void 0!==n.zoomDelta&&(r.zoom=o),void 0!==n.panDelta&&(r.drag=o),void 0!==n.pitchDelta&&(r.pitch=o),void 0!==n.bearingDelta&&(r.rotate=o)}}},{key:"_applyChanges",value:function(){var t,r={},n={},i={},a=f(this._changes);try{for(a.s();!(t=a.n()).done;){var o=h(t.value,3),s=o[0],u=o[1],l=o[2];s.panDelta&&(r.panDelta=(r.panDelta||new e.pointGeometry(0,0))._add(s.panDelta)),s.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+s.zoomDelta),s.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+s.bearingDelta),s.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+s.pitchDelta),void 0!==s.around&&(r.around=s.around),void 0!==s.aroundCoord&&(r.aroundCoord=s.aroundCoord),void 0!==s.pinchAround&&(r.pinchAround=s.pinchAround),s.noInertia&&(r.noInertia=s.noInertia),e.extend(n,u),e.extend(i,l)}}catch(c){a.e(c)}finally{a.f()}this._updateMapTransform(r,n,i),this._changes=[]}},{key:"_updateMapTransform",value:function(t,r,n){var i=this,a=this._map,o=a.transform,s=function(e){return[e.x,e.y,e.z]};if(function(e){var t=i._eventsInProgress.drag;return t&&!i._handlersById[t.handlerName].isActive()}()&&!Ri(t)){var u=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",u!==o.zoom&&this._map._update(!0)}if(!Ri(t))return this._fireEvents(r,n,!0);var l=t.panDelta,c=t.zoomDelta,h=t.bearingDelta,f=t.pitchDelta,d=t.around,p=t.aroundCoord,y=t.pinchAround;void 0!==y&&(d=y),r.drag&&!i._eventsInProgress.drag&&d&&(this._dragOrigin=s(o.pointCoordinate3D(d)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",a._stop(!0),d=d||a.transform.centerPoint,h&&(o.bearing+=h),f&&(o.pitch+=f),o._updateCameraState();var v=[0,0,0];if(l){var m=o.screenPointToMercatorRay(d),g=o.screenPointToMercatorRay(d.sub(l)),_=this._trackingEllipsoid.projectRay(m.dir),b=this._trackingEllipsoid.projectRay(g.dir);v[0]=b[0]-_[0],v[1]=b[1]-_[1]}var w=o.zoom,x=[0,0,0];if(c){var k=s(p||o.pointCoordinate3D(d)),E={dir:e.normalize([],e.sub([],k,o._camera.position))},S=o.screenPointToMercatorRay(o.centerPoint);if(E.dir[2]<0){var T=e.altitudeFromMercatorZ(k[2],k[1]),A=o.rayIntersectionCoordinate(o.pointRayIntersection(o.centerPoint,T)),C=o.zoomDeltaToMovement(s(A),c)*(S.dir[2]/E.dir[2]);e.scale(x,E.dir,C)}else if(o._terrainEnabled()){var I=o.zoomDeltaToMovement(k,c);e.scale(x,E.dir,I)}}var R=e.add(v,v,x);o._translateCameraConstrained(R),c&&Math.abs(o.zoom-w)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,n,!0)}},{key:"_fireEvents",value:function(t,r,n){var i=this,a=Ai(this._eventsInProgress),o=Ai(t),s={};for(var u in t){var l=t[u].originalEvent;this._eventsInProgress[u]||(s["".concat(u,"start")]=l),this._eventsInProgress[u]=t[u]}for(var c in!a&&o&&this._fireEvent("movestart",o.originalEvent),s)this._fireEvent(c,s[c]);for(var h in o&&this._fireEvent("move",o.originalEvent),t){var f=t[h].originalEvent;this._fireEvent(h,f)}var d,p={};for(var y in this._eventsInProgress){var v=this._eventsInProgress[y],m=v.handlerName,g=v.originalEvent;this._handlersById[m].isActive()||(delete this._eventsInProgress[y],d=r[m]||g,p["".concat(y,"end")]=d)}for(var _ in p)this._fireEvent(_,p[_]);var b=Ai(this._eventsInProgress);if(n&&(a||o)&&!b){this._updatingCamera=!0;var w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),x=function(e){return 0!==e&&-i._bearingSnap<e&&e<i._bearingSnap};w?(x(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:d})):(this._map.fire(new e.Event("moveend",{originalEvent:d})),x(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}},{key:"_fireEvent",value:function(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))}},{key:"_requestFrame",value:function(){var e=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add((function(t){delete e._frameId,e.handleEvent(new Ci("renderFrame",{timeStamp:t})),e._applyChanges()}))}},{key:"_triggerRenderFrame",value:function(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}]),t}(),Pi=function(t){p(n,t);var r=y(n);function n(t,a){var o;return v(this,n),(o=r.call(this))._moving=!1,o._zooming=!1,o.transform=t,o._bearingSnap=a.bearingSnap,e.bindAll(["_renderFrameCallback"],i(o)),o}return m(n,[{key:"getCenter",value:function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}},{key:"setCenter",value:function(e,t){return this.jumpTo({center:e},t)}},{key:"panBy",value:function(t,r,n){return t=e.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)}},{key:"panTo",value:function(t,r,n){return this.easeTo(e.extend({center:t},r),n)}},{key:"getZoom",value:function(){return this.transform.zoom}},{key:"setZoom",value:function(e,t){return this.jumpTo({zoom:e},t),this}},{key:"zoomTo",value:function(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)}},{key:"zoomIn",value:function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}},{key:"zoomOut",value:function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}},{key:"getBearing",value:function(){return this.transform.bearing}},{key:"setBearing",value:function(e,t){return this.jumpTo({bearing:e},t),this}},{key:"getPadding",value:function(){return this.transform.padding}},{key:"setPadding",value:function(e,t){return this.jumpTo({padding:e},t),this}},{key:"rotateTo",value:function(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)}},{key:"resetNorth",value:function(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this}},{key:"resetNorthPitch",value:function(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this}},{key:"snapToNorth",value:function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}},{key:"getPitch",value:function(){return this.transform.pitch}},{key:"setPitch",value:function(e,t){return this.jumpTo({pitch:e},t),this}},{key:"cameraForBounds",value:function(t,r){t=e.LngLatBounds.convert(t);var n=r&&r.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),n,r)}},{key:"_extendCameraOptions",value:function(t){var r={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){var n=t.padding;t.padding={top:n,bottom:n,right:n,left:n}}return t.padding=e.extend(r,t.padding),t}},{key:"_cameraForBoxAndBearing",value:function(t,r,n,i){var a=this._extendCameraOptions(i),o=this.transform,s=o.padding,u=o.project(e.LngLat.convert(t)),l=o.project(e.LngLat.convert(r)),c=u.rotate(-e.degToRad(n)),h=l.rotate(-e.degToRad(n)),f=new e.pointGeometry(Math.max(c.x,h.x),Math.max(c.y,h.y)),d=new e.pointGeometry(Math.min(c.x,h.x),Math.min(c.y,h.y)),p=f.sub(d),y=(o.width-(s.left+s.right+a.padding.left+a.padding.right))/p.x,v=(o.height-(s.top+s.bottom+a.padding.top+a.padding.bottom))/p.y;if(!(v<0||y<0)){var m=Math.min(o.scaleZoom(o.scale*Math.min(y,v)),a.maxZoom),g="number"==typeof a.offset.x?new e.pointGeometry(a.offset.x,a.offset.y):e.pointGeometry.convert(a.offset),_=new e.pointGeometry((a.padding.left-a.padding.right)/2,(a.padding.top-a.padding.bottom)/2).rotate(n*Math.PI/180),b=g.add(_).mult(o.scale/o.zoomScale(m));return{center:o.unproject(u.add(l).div(2).sub(b)),zoom:m,bearing:n}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}},{key:"_cameraForBox",value:function(t,r,n,i,a){var o=this._extendCameraOptions(a);n=n||0,i=i||0,t=e.LngLat.convert(t),r=e.LngLat.convert(r);var s=this.transform.clone();s.padding=o.padding;var u=this.getFreeCameraOptions(),l=new e.LngLat(.5*(t.lng+r.lng),.5*(t.lat+r.lat)),c=.5*(n+i);if(!(s._camera.position[2]<e.mercatorZfromAltitude(c,l.lat))){u.lookAtPoint(l),s.setFreeCameraOptions(u);var h,f,d=e.MercatorCoordinate.fromLngLat(t),p=e.MercatorCoordinate.fromLngLat(r),y=s.pointRayIntersection(s.centerPoint,c),v=[(h=s.rayIntersectionCoordinate(y)).x,h.y,h.z],m=s.screenPointToMercatorRay(s.centerPoint),g=0;do{var _=Math.floor(s.zoom),b=1<<_,w=Math.min(b*d.x,b*p.x),x=Math.min(b*d.y,b*p.y),k=Math.max(b*d.x,b*p.x),E=Math.max(b*d.y,b*p.y),S=new A([w,x,n],[k,E,i]),C=T.fromInvProjectionMatrix(s.invProjMatrix,s.worldSize,_);if(2!==S.intersects(C)){f&&(s._camera.position=e.scaleAndAdd([],s._camera.position,m.dir,-f),s._updateStateFromCamera());break}var I=e.sub([],s._camera.position,v);f=.5*e.length(I),s._camera.position=e.scaleAndAdd([],s._camera.position,m.dir,f);try{s._updateStateFromCamera()}catch(t){return void e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++g<10);return{center:s.center,zoom:s.zoom,bearing:s.bearing,pitch:s.pitch}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}},{key:"fitBounds",value:function(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}},{key:"_raycastElevationBox",value:function(t,r){var n=this.transform.elevation;if(n){var i=new e.pointGeometry(t.x,r.y),a=new e.pointGeometry(r.x,t.y),o=n.pointCoordinate(t);if(o){var s=n.pointCoordinate(r);if(s){var u=n.pointCoordinate(i);if(u){var l=n.pointCoordinate(a);if(l){var c=new e.MercatorCoordinate(o[0],o[1]).toLngLat(),h=new e.MercatorCoordinate(s[0],s[1]).toLngLat(),f=new e.MercatorCoordinate(u[0],u[1]).toLngLat(),d=new e.MercatorCoordinate(l[0],l[1]).toLngLat(),p=Math.min(c.lng,Math.min(h.lng,Math.min(f.lng,d.lng))),y=Math.min(c.lat,Math.min(h.lat,Math.min(f.lat,d.lat))),v=Math.max(c.lng,Math.max(h.lng,Math.max(f.lng,d.lng))),m=Math.max(c.lat,Math.max(h.lat,Math.max(f.lat,d.lat))),g=Math.min(o[3],Math.min(s[3],Math.min(u[3],l[3]))),_=Math.max(o[3],Math.max(s[3],Math.max(u[3],l[3])));return{minLngLat:new e.LngLat(p,y),maxLngLat:new e.LngLat(v,m),minAltitude:g,maxAltitude:_}}}}}}}},{key:"fitScreenCoordinates",value:function(t,r,n,i,a){var o,s,u,l,c=e.pointGeometry.convert(t),h=e.pointGeometry.convert(r),f=this._raycastElevationBox(c,h);if(f)o=f.minLngLat,s=f.maxLngLat,u=f.minAltitude,l=f.maxAltitude;else{if(this.transform.isHorizonVisibleForPoints(c,h))return this;o=this.transform.pointLocation(c),s=this.transform.pointLocation(h)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(e.pointGeometry.convert(t)),this.transform.pointLocation(e.pointGeometry.convert(r)),n,i):this._cameraForBox(o,s,u,l,i),i,a)}},{key:"_fitInternal",value:function(t,r,n){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}},{key:"jumpTo",value:function(t,r){this.stop();var n=this.transform,i=!1,a=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(a=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),i&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),a&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),o&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))}},{key:"getFreeCameraOptions",value:function(){return this.transform.getFreeCameraOptions()}},{key:"setFreeCameraOptions",value:function(t,r){this.stop();var n=this.transform,i=n.zoom,a=n.pitch,o=n.bearing;n.setFreeCameraOptions(t);var s=i!==n.zoom,u=a!==n.pitch,l=o!==n.bearing;return this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),s&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),l&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),u&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r)),this}},{key:"easeTo",value:function(t,r){var n=this;this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.exported.prefersReducedMotion)&&(t.duration=0);var i=this.transform,a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),u=this.getPadding(),l="zoom"in t?+t.zoom:a,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,h="pitch"in t?+t.pitch:s,f="padding"in t?t.padding:i.padding,d=e.pointGeometry.convert(t.offset),p=i.centerPoint.add(d),y=i.pointLocation(p),v=e.LngLat.convert(t.center||y);this._normalizeCenter(v);var m,g,_=i.project(y),b=i.project(v).sub(_),w=i.zoomScale(l-a);t.around&&(m=e.LngLat.convert(t.around),g=i.locationPoint(m));var x={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||l!==a,this._rotating=this._rotating||o!==c,this._pitching=this._pitching||h!==s,this._padding=!i.isPaddingEqual(f),this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,x),this._ease((function(t){if(n._zooming&&(i.zoom=e.number(a,l,t)),n._rotating&&(i.bearing=e.number(o,c,t)),n._pitching&&(i.pitch=e.number(s,h,t)),n._padding&&(i.interpolatePadding(u,f,t),p=i.centerPoint.add(d)),m)i.setLocationAtPoint(m,g);else{var y=i.zoomScale(i.zoom-a),v=l>a?Math.min(2,w):Math.max(.5,w),x=Math.pow(v,1-t),k=i.unproject(_.add(b.mult(t*x)).mult(y));i.setLocationAtPoint(i.renderWorldCopies?k.wrap():k,p)}n._fireMoveEvents(r)}),(function(e){i.recenterOnTerrain(),n._afterEase(r,e)}),t),this}},{key:"_prepareEase",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,this.transform.cameraElevationReference="sea",r||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}},{key:"_fireMoveEvents",value:function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}},{key:"_afterEase",value:function(t,r){if(!this._easeId||!r||this._easeId!==r){delete this._easeId,this.transform.cameraElevationReference="ground";var n=this._zooming,i=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),i&&this.fire(new e.Event("rotateend",t)),a&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}}},{key:"flyTo",value:function(t,r){var n=this;if(!t.essential&&e.exported.prefersReducedMotion){var i=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(i,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var a=this.transform,o=this.getZoom(),s=this.getBearing(),u=this.getPitch(),l=this.getPadding(),c="zoom"in t?e.clamp(+t.zoom,a.minZoom,a.maxZoom):o,h="bearing"in t?this._normalizeBearing(t.bearing,s):s,f="pitch"in t?+t.pitch:u,d="padding"in t?t.padding:a.padding,p=a.zoomScale(c-o),y=e.pointGeometry.convert(t.offset),v=a.centerPoint.add(y),m=a.pointLocation(v),g=e.LngLat.convert(t.center||m);this._normalizeCenter(g);var _=a.project(m),b=a.project(g).sub(_),w=t.curve,x=Math.max(a.width,a.height),k=x/p,E=b.mag();if("minZoom"in t){var S=e.clamp(Math.min(t.minZoom,o,c),a.minZoom,a.maxZoom),T=x/a.zoomScale(S-o);w=Math.sqrt(T/E*2)}var A=w*w;function C(e){var t=(k*k-x*x+(e?-1:1)*A*A*E*E)/(2*(e?k:x)*A*E);return Math.log(Math.sqrt(t*t+1)-t)}function I(e){return(Math.exp(e)-Math.exp(-e))/2}function R(e){return(Math.exp(e)+Math.exp(-e))/2}var M=C(0),P=function(e){return R(M)/R(M+w*e)},O=function(e){return x*((R(M)*(I(t=M+w*e)/R(t))-I(M))/A)/E;var t},L=(C(1)-M)/w;if(Math.abs(E)<1e-6||!isFinite(L)){if(Math.abs(x-k)<1e-6)return this.easeTo(t,r);var D=k<x?-1:1;L=Math.abs(Math.log(k/x))/w,O=function(){return 0},P=function(e){return Math.exp(D*w*e)}}return t.duration="duration"in t?+t.duration:1e3*L/("screenSpeed"in t?+t.screenSpeed/w:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=s!==h,this._pitching=f!==u,this._padding=!a.isPaddingEqual(d),this._prepareEase(r,!1),this._ease((function(t){var i=t*L,p=1/P(i);a.zoom=1===t?c:o+a.scaleZoom(p),n._rotating&&(a.bearing=e.number(s,h,t)),n._pitching&&(a.pitch=e.number(u,f,t)),n._padding&&(a.interpolatePadding(l,d,t),v=a.centerPoint.add(y));var m=1===t?g:a.unproject(_.add(b.mult(O(i))).mult(p));a.setLocationAtPoint(a.renderWorldCopies?m.wrap():m,v),a._updateCenterElevation(),n._fireMoveEvents(r)}),(function(){return n._afterEase(r)}),t),this}},{key:"isEasing",value:function(){return!!this._easeFrameId}},{key:"stop",value:function(){return this._stop()}},{key:"_stop",value:function(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){var n=this.handlers;n&&n.stop(!1)}return this}},{key:"_ease",value:function(t,r,n){!1===n.animate||0===n.duration?(t(1),r()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}},{key:"_renderFrameCallback",value:function(){var t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}},{key:"_normalizeBearing",value:function(t,r){t=e.wrap(t,-180,180);var n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t}},{key:"_normalizeCenter",value:function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}}}]),n}(e.Evented),Oi=function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};v(this,t),this.options=r,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}return m(t,[{key:"getDefaultPosition",value:function(){return"bottom-right"}},{key:"onAdd",value:function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=g.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=g.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}},{key:"onRemove",value:function(){g.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}},{key:"_setElementTitle",value:function(e,t){var r=this._map._getUIString("AttributionControl.".concat(t));e.title=r,e.setAttribute("aria-label",r)}},{key:"_toggleAttribution",value:function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}},{key:"_updateEditLink",value:function(){var t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));var r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){var n=r.reduce((function(e,t,n){return t.value&&(e+="".concat(t.key,"=").concat(t.value).concat(n<r.length-1?"&":"")),e}),"?");t.href="".concat(e.config.FEEDBACK_URL,"/").concat(n).concat(this._map._hash?this._map._hash.getHashString(!0):""),t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}},{key:"_updateData",value:function(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}},{key:"_updateAttributions",value:function(){if(this._map.style){var e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((function(e){return"string"!=typeof e?"":e}))):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var r=this._map.style._sourceCaches;for(var n in r){var i=r[n];if(i.used){var a=i.getSource();a.attribution&&e.indexOf(a.attribution)<0&&e.push(a.attribution)}}e.sort((function(e,t){return e.length-t.length}));var o=(e=e.filter((function(t,r){for(var n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0}))).join(" | ");o!==this._attribHTML&&(this._attribHTML=o,e.length?(this._innerContainer.innerHTML=o,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}}},{key:"_updateCompact",value:function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}]),t}(),Li=function(){function t(){v(this,t),e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)}return m(t,[{key:"onAdd",value:function(e){this._map=e,this._container=g.create("div","mapboxgl-ctrl");var t=g.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}},{key:"onRemove",value:function(){g.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}},{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_updateLogo",value:function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}},{key:"_logoRequired",value:function(){if(!this._map.style)return!0;var e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(var t in e){var r=e[t].getSource();if(r.hasOwnProperty("mapbox_logo")&&!r.mapbox_logo)return!1}return!0}},{key:"_updateCompact",value:function(){var e=this._container.children;if(e.length){var t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}]),t}(),Di=function(){function e(){v(this,e),this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return m(e,[{key:"add",value:function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}},{key:"remove",value:function(e){var t,r=this._currentlyRunning,n=r?this._queue.concat(r):this._queue,i=f(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.id===e)return void(a.cancelled=!0)}}catch(o){i.e(o)}finally{i.f()}}},{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this._currentlyRunning=this._queue;this._queue=[];var r,n=f(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(!i.cancelled&&(i.callback(e),this._cleared))break}}catch(a){n.e(a)}finally{n.f()}this._cleared=!1,this._currentlyRunning=!1}},{key:"clear",value:function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}]),e}();function Bi(t,r,n){if(t=new e.LngLat(t.lng,t.lat),r){var i=new e.LngLat(t.lng-360,t.lat),a=new e.LngLat(t.lng+360,t.lat),o=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),s=n.locationPoint(t).distSqr(r),u=r.x<0||r.y<0||r.x>n.width||r.y>n.height;n.locationPoint(i).distSqr(r)<s&&(u||Math.abs(i.lng-n.center.lng)<o)?t=i:n.locationPoint(a).distSqr(r)<s&&(u||Math.abs(a.lng-n.center.lng)<o)&&(t=a)}for(;Math.abs(t.lng-n.center.lng)>180;){var l=n.locationPoint(t);if(l.x>=0&&l.y>=0&&l.x<=n.width&&l.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}var Ni={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function zi(e,t,r){var n=e.classList;for(var i in Ni)n.remove("mapboxgl-".concat(r,"-anchor-").concat(i));n.add("mapboxgl-".concat(r,"-anchor-").concat(t))}var Fi=function(t){p(n,t);var r=y(n);function n(t,a){var o;if(v(this,n),o=r.call(this),(t instanceof e.window.HTMLElement||a)&&(t=e.extend({element:t},a)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],i(o)),o._anchor=t&&t.anchor||"center",o._color=t&&t.color||"#3FB1CE",o._scale=t&&t.scale||1,o._draggable=t&&t.draggable||!1,o._clickTolerance=t&&t.clickTolerance||0,o._isDragging=!1,o._state="inactive",o._rotation=t&&t.rotation||0,o._rotationAlignment=t&&t.rotationAlignment||"auto",o._pitchAlignment=t&&t.pitchAlignment&&"auto"!==t.pitchAlignment?t.pitchAlignment:o._rotationAlignment,t&&t.element)o._element=t.element,o._offset=e.pointGeometry.convert(t&&t.offset||[0,0]);else{o._defaultMarker=!0,o._element=g.create("div"),o._element.setAttribute("aria-label","Map marker");var s=g.createNS("http://www.w3.org/2000/svg","svg"),l=41,c=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height","".concat(l,"px")),s.setAttributeNS(null,"width","".concat(c,"px")),s.setAttributeNS(null,"viewBox","0 0 ".concat(c," ").concat(l));var h=g.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"stroke","none"),h.setAttributeNS(null,"stroke-width","1"),h.setAttributeNS(null,"fill","none"),h.setAttributeNS(null,"fill-rule","evenodd");var f=g.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill-rule","nonzero");var d=g.createNS("http://www.w3.org/2000/svg","g");d.setAttributeNS(null,"transform","translate(3.0, 29.0)"),d.setAttributeNS(null,"fill","#000000");for(var p=0,y=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];p<y.length;p++){var m=y[p],_=g.createNS("http://www.w3.org/2000/svg","ellipse");_.setAttributeNS(null,"opacity","0.04"),_.setAttributeNS(null,"cx","10.5"),_.setAttributeNS(null,"cy","5.80029008"),_.setAttributeNS(null,"rx",m.rx),_.setAttributeNS(null,"ry",m.ry),d.appendChild(_)}var b=g.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"fill",o._color);var w=g.createNS("http://www.w3.org/2000/svg","path");w.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),b.appendChild(w);var x=g.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"opacity","0.25"),x.setAttributeNS(null,"fill","#000000");var k=g.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),x.appendChild(k);var E=g.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"transform","translate(6.0, 7.0)"),E.setAttributeNS(null,"fill","#FFFFFF");var S=g.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(8.0, 8.0)");var T=g.createNS("http://www.w3.org/2000/svg","circle");T.setAttributeNS(null,"fill","#000000"),T.setAttributeNS(null,"opacity","0.25"),T.setAttributeNS(null,"cx","5.5"),T.setAttributeNS(null,"cy","5.5"),T.setAttributeNS(null,"r","5.4999962");var A=g.createNS("http://www.w3.org/2000/svg","circle");A.setAttributeNS(null,"fill","#FFFFFF"),A.setAttributeNS(null,"cx","5.5"),A.setAttributeNS(null,"cy","5.5"),A.setAttributeNS(null,"r","5.4999962"),S.appendChild(T),S.appendChild(A),f.appendChild(d),f.appendChild(b),f.appendChild(x),f.appendChild(E),f.appendChild(S),s.appendChild(f),s.setAttributeNS(null,"height",l*o._scale+"px"),s.setAttributeNS(null,"width",c*o._scale+"px"),o._element.appendChild(s),o._offset=e.pointGeometry.convert(t&&t.offset||[0,-14])}return o._element.classList.add("mapboxgl-marker"),o._element.addEventListener("dragstart",(function(e){e.preventDefault()})),o._element.addEventListener("mousedown",(function(e){e.preventDefault()})),zi(o._element,o._anchor,"marker"),o._popup=null,u(o)}return m(n,[{key:"addTo",value:function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}},{key:"remove",value:function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),g.remove(this._element),this._popup&&this._popup.remove(),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}},{key:"getElement",value:function(){return this._element}},{key:"setPopup",value:function(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){var t=38.1,r=13.5,n=Math.sqrt(Math.pow(r,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-r,-1*(t-r)]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}},{key:"_onKeyPress",value:function(e){var t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()}},{key:"_onMapClick",value:function(e){var t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()}},{key:"getPopup",value:function(){return this._popup}},{key:"togglePopup",value:function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this}},{key:"_evaluateOpacity",value:function(){var e=this._pos?this._pos.sub(this._transformedOffset()):null;if(this._withinScreenBounds(e)){var t=this._map.unproject(e),r=!1;if(this._map.getTerrain()){var n=this._map.getFreeCameraOptions();if(n.position){var i=n.position.toLngLat();r=i.distanceTo(t)<.9*i.distanceTo(this._lngLat)}}var a=(1-this._map._queryFogOpacity(t))*(r?.2:1);this._element.style.opacity="".concat(a),this._popup&&this._popup._setOpacity("".concat(a)),this._fadeTimer=null}else this._clearFadeTimer()}},{key:"_clearFadeTimer",value:function(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}},{key:"_withinScreenBounds",value:function(e){var t=this._map.transform;return!!e&&e.x>=0&&e.x<t.width&&e.y>=0&&e.y<t.height}},{key:"_update",value:function(e){var t=this;if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Bi(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());var r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r="rotateZ(".concat(this._rotation,"deg)"):"map"===this._rotationAlignment&&(r="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));var n="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?n="rotateX(0deg)":"map"===this._pitchAlignment&&(n="rotateX(".concat(this._map.getPitch(),"deg)")),e&&"moveend"!==e.type||(this._pos=this._pos.round()),this._map._requestDomTask((function(){t._map&&(t._element&&t._pos&&t._anchor&&g.setTransform(t._element,"".concat(Ni[t._anchor]," translate(").concat(t._pos.x,"px, ").concat(t._pos.y,"px) ").concat(n," ").concat(r)),!t._map.getTerrain()&&!t._map.getFog()||t._fadeTimer||(t._fadeTimer=setTimeout(t._evaluateOpacity.bind(t),60)))}))}}},{key:"_transformedOffset",value:function(){if(!this._defaultMarker)return this._offset;var e=this._map.transform,t=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&t._rotate(e.angle),"map"===this._pitchAlignment&&(t.y*=Math.cos(e._pitch)),t}},{key:"getOffset",value:function(){return this._offset}},{key:"setOffset",value:function(t){return this._offset=e.pointGeometry.convert(t),this._update(),this}},{key:"_onMove",value:function(t){if(!this._isDragging){var r=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag")))}},{key:"_onUp",value:function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}},{key:"_addDragHandler",value:function(e){this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}},{key:"setDraggable",value:function(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}},{key:"isDraggable",value:function(){return this._draggable}},{key:"setRotation",value:function(e){return this._rotation=e||0,this._update(),this}},{key:"getRotation",value:function(){return this._rotation}},{key:"setRotationAlignment",value:function(e){return this._rotationAlignment=e||"auto",this._update(),this}},{key:"getRotationAlignment",value:function(){return this._rotationAlignment}},{key:"setPitchAlignment",value:function(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}},{key:"getPitchAlignment",value:function(){return this._pitchAlignment}}]),n}(e.Evented),ji=function(){function t(e){v(this,t),this.jumpTo(e)}return m(t,[{key:"getValue",value:function(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;var r=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}},{key:"isEasing",value:function(e){return e>=this._startTime&&e<=this._endTime}},{key:"jumpTo",value:function(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}},{key:"easeTo",value:function(e,t,r){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+r}}]),t}(),Ui={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Vi=e.window,qi=Vi.HTMLImageElement,Gi=Vi.HTMLElement,Ki=Vi.ImageBitmap,Hi={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Wi(e){e.parentNode&&e.parentNode.removeChild(e)}var Zi,Yi={showCompass:!0,showZoom:!0,visualizePitch:!1},Xi=function(){function t(r,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];v(this,t),this._clickTolerance=10,this.element=n,this.mouseRotate=new ai({clickTolerance:r.dragRotate._mouseRotate._clickTolerance}),this.map=r,i&&(this.mousePitch=new oi({clickTolerance:r.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener(n,"mousedown",this.mousedown),g.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),g.addEventListener(n,"touchmove",this.touchmove),g.addEventListener(n,"touchend",this.touchend),g.addEventListener(n,"touchcancel",this.reset)}return m(t,[{key:"down",value:function(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),g.disableDrag()}},{key:"move",value:function(e,t){var r=this.map,n=this.mouseRotate.mousemoveWindow(e,t);if(n&&n.bearingDelta&&r.setBearing(r.getBearing()+n.bearingDelta),this.mousePitch){var i=this.mousePitch.mousemoveWindow(e,t);i&&i.pitchDelta&&r.setPitch(r.getPitch()+i.pitchDelta)}}},{key:"off",value:function(){var e=this.element;g.removeEventListener(e,"mousedown",this.mousedown),g.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),g.removeEventListener(e,"touchmove",this.touchmove),g.removeEventListener(e,"touchend",this.touchend),g.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}},{key:"offTemp",value:function(){g.enableDrag(),g.removeEventListener(e.window,"mousemove",this.mousemove),g.removeEventListener(e.window,"mouseup",this.mouseup)}},{key:"mousedown",value:function(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:function(){return t.preventDefault()}}),g.mousePos(this.element,t)),g.addEventListener(e.window,"mousemove",this.mousemove),g.addEventListener(e.window,"mouseup",this.mouseup)}},{key:"mousemove",value:function(e){this.move(e,g.mousePos(this.element,e))}},{key:"mouseup",value:function(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}},{key:"touchstart",value:function(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=g.touchPos(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return e.preventDefault()}},this._startPos))}},{key:"touchmove",value:function(e){1!==e.targetTouches.length?this.reset():(this._lastPos=g.touchPos(this.element,e.targetTouches)[0],this.move({preventDefault:function(){return e.preventDefault()}},this._lastPos))}},{key:"touchend",value:function(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}},{key:"reset",value:function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}]),t}(),Qi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ji=0,$i=!1,ea={maxWidth:100,unit:"metric"};function ta(e,t,r){var n=r&&r.maxWidth||100,i=e._container.clientHeight/2,a=e.unproject([0,i]),o=e.unproject([n,i]),s=a.distanceTo(o);if(r&&"imperial"===r.unit){var u=3.2808*s;u>5280?ra(t,n,u/5280,e._getUIString("ScaleControl.Miles"),e):ra(t,n,u,e._getUIString("ScaleControl.Feet"),e)}else r&&"nautical"===r.unit?ra(t,n,s/1852,e._getUIString("ScaleControl.NauticalMiles"),e):s>=1e3?ra(t,n,s/1e3,e._getUIString("ScaleControl.Kilometers"),e):ra(t,n,s,e._getUIString("ScaleControl.Meters"),e)}function ra(e,t,r,n,i){var a=function(e){var t=Math.pow(10,"".concat(Math.floor(e)).length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){var t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r))}(r),o=a/r;i._requestDomTask((function(){e.style.width=t*o+"px",e.innerHTML="".concat(a,"&nbsp;").concat(n)}))}var na={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ia=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function aa(t){if(t){if("number"==typeof t){var r=Math.round(Math.sqrt(.5*Math.pow(t,2)));return{center:new e.pointGeometry(0,0),top:new e.pointGeometry(0,t),"top-left":new e.pointGeometry(r,r),"top-right":new e.pointGeometry(-r,r),bottom:new e.pointGeometry(0,-t),"bottom-left":new e.pointGeometry(r,-r),"bottom-right":new e.pointGeometry(-r,-r),left:new e.pointGeometry(t,0),right:new e.pointGeometry(-t,0)}}if(t instanceof e.pointGeometry||Array.isArray(t)){var n=e.pointGeometry.convert(t);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:e.pointGeometry.convert(t.center||[0,0]),top:e.pointGeometry.convert(t.top||[0,0]),"top-left":e.pointGeometry.convert(t["top-left"]||[0,0]),"top-right":e.pointGeometry.convert(t["top-right"]||[0,0]),bottom:e.pointGeometry.convert(t.bottom||[0,0]),"bottom-left":e.pointGeometry.convert(t["bottom-left"]||[0,0]),"bottom-right":e.pointGeometry.convert(t["bottom-right"]||[0,0]),left:e.pointGeometry.convert(t.left||[0,0]),right:e.pointGeometry.convert(t.right||[0,0])}}return aa(new e.pointGeometry(0,0))}var oa={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:function(r){p(c,r);var l=y(c);function c(t){var r;if(v(this,c),null!=(t=e.extend({},Hi,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if((r=l.call(this,new Dn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t))._interactive=t.interactive,r._maxTileCacheSize=t.maxTileCacheSize,r._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,r._preserveDrawingBuffer=t.preserveDrawingBuffer,r._antialias=t.antialias,r._trackResize=t.trackResize,r._bearingSnap=t.bearingSnap,r._refreshExpiredTiles=t.refreshExpiredTiles,r._fadeDuration=t.fadeDuration,r._isInitialLoad=!0,r._crossSourceCollisions=t.crossSourceCollisions,r._crossFadingFactor=1,r._collectResourceTiming=t.collectResourceTiming,r._optimizeForTerrain=t.optimizeForTerrain,r._renderTaskQueue=new Di,r._domRenderTaskQueue=new Di,r._controls=[],r._markers=[],r._mapId=e.uniqueId(),r._locale=e.extend({},Ui,t.locale),r._clickTolerance=t.clickTolerance,r._averageElevationLastSampledAt=-1/0,r._averageElevation=new ji(0),r._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),r._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(r._container=e.window.document.getElementById(t.container),!r._container)throw new Error("Container '".concat(t.container,"' not found."))}else{if(!(t.container instanceof Gi))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");r._container=t.container}if(t.maxBounds&&r.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],i(r)),r._setupContainer(),r._setupPainter(),void 0===r.painter)throw new Error("Failed to initialize WebGL.");return r.on("move",(function(){return r._update(!1)})),r.on("moveend",(function(){return r._update(!1)})),r.on("zoom",(function(){return r._update(!0)})),void 0!==e.window&&(e.window.addEventListener("online",r._onWindowOnline,!1),e.window.addEventListener("resize",r._onWindowResize,!1),e.window.addEventListener("orientationchange",r._onWindowResize,!1)),r.handlers=new Mi(i(r),t),r._hash=t.hash&&new Nn("string"==typeof t.hash&&t.hash||void 0).addTo(i(r)),r._hash&&r._hash._onHashChange()||(r.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(r.resize(),r.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),r.resize(),r._localFontFamily=t.localFontFamily,r._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&r.setStyle(t.style,{localFontFamily:r._localFontFamily,localIdeographFontFamily:r._localIdeographFontFamily}),t.attributionControl&&r.addControl(new Oi({customAttribution:t.customAttribution})),r._logoControl=new Li,r.addControl(r._logoControl,t.logoPosition),r.on("style.load",(function(){r.transform.unmodified&&r.jumpTo(r.style.stylesheet)})),r.on("data",(function(t){r._update("style"===t.dataType),r.fire(new e.Event("".concat(t.dataType,"data"),t))})),r.on("dataloading",(function(t){r.fire(new e.Event("".concat(t.dataType,"dataloading"),t))})),u(r)}return m(c,[{key:"_getMapId",value:function(){return this._mapId}},{key:"addControl",value:function(t,r){if(void 0===r&&(r=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var n=t.onAdd(this);this._controls.push(t);var i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}},{key:"removeControl",value:function(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var r=this._controls.indexOf(t);return r>-1&&this._controls.splice(r,1),t.onRemove(this),this}},{key:"hasControl",value:function(e){return this._controls.indexOf(e)>-1}},{key:"getContainer",value:function(){return this._container}},{key:"getCanvasContainer",value:function(){return this._canvasContainer}},{key:"getCanvas",value:function(){return this._canvas}},{key:"resize",value:function(t){var r=this._containerDimensions(),n=r[0],i=r[1];this._resizeCanvas(n,i),this.transform.resize(n,i),this.painter.resize(n,i);var a=!this._moving;return a&&(this.stop(),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t))),this.fire(new e.Event("resize",t)),a&&this.fire(new e.Event("moveend",t)),this}},{key:"getBounds",value:function(){return this.transform.getBounds()}},{key:"getMaxBounds",value:function(){return this.transform.getMaxBounds()}},{key:"setMaxBounds",value:function(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}},{key:"setMinZoom",value:function(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}},{key:"getMinZoom",value:function(){return this.transform.minZoom}},{key:"setMaxZoom",value:function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}},{key:"getMaxZoom",value:function(){return this.transform.maxZoom}},{key:"setMinPitch",value:function(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}},{key:"getMinPitch",value:function(){return this.transform.minPitch}},{key:"setMaxPitch",value:function(e){if((e=null==e?85:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}},{key:"getMaxPitch",value:function(){return this.transform.maxPitch}},{key:"getRenderWorldCopies",value:function(){return this.transform.renderWorldCopies}},{key:"setRenderWorldCopies",value:function(e){return this.transform.renderWorldCopies=e,this._update()}},{key:"project",value:function(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}},{key:"unproject",value:function(t){return this.transform.pointLocation3D(e.pointGeometry.convert(t))}},{key:"isMoving",value:function(){return this._moving||this.handlers&&this.handlers.isMoving()}},{key:"isZooming",value:function(){return this._zooming||this.handlers&&this.handlers.isZooming()}},{key:"isRotating",value:function(){return this._rotating||this.handlers&&this.handlers.isRotating()}},{key:"_createDelegatedListener",value:function(e,t,r){var i=this;if("mouseenter"===e||"mouseover"===e){var a=!1,o=function(n){var o=i.getLayer(t)?i.queryRenderedFeatures(n.point,{layers:[t]}):[];o.length?a||(a=!0,r.call(i,new Hn(e,i,n.originalEvent,{features:o}))):a=!1};return{layer:t,listener:r,delegates:{mousemove:o,mouseout:function(){a=!1}}}}if("mouseleave"===e||"mouseout"===e){var s=!1,u=function(n){(i.getLayer(t)?i.queryRenderedFeatures(n.point,{layers:[t]}):[]).length?s=!0:s&&(s=!1,r.call(i,new Hn(e,i,n.originalEvent)))},l=function(t){s&&(s=!1,r.call(i,new Hn(e,i,t.originalEvent)))};return{layer:t,listener:r,delegates:{mousemove:u,mouseout:l}}}var c=function(e){var n=i.getLayer(t)?i.queryRenderedFeatures(e.point,{layers:[t]}):[];n.length&&(e.features=n,r.call(i,e),delete e.features)};return{layer:t,listener:r,delegates:n({},e,c)}}},{key:"on",value:function(e,t,r){if(void 0===r)return o(s(c.prototype),"on",this).call(this,e,t);var n=this._createDelegatedListener(e,t,r);for(var i in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n),n.delegates)this.on(i,n.delegates[i]);return this}},{key:"once",value:function(e,t,r){if(void 0===r)return o(s(c.prototype),"once",this).call(this,e,t);var n=this._createDelegatedListener(e,t,r);for(var i in n.delegates)this.once(i,n.delegates[i]);return this}},{key:"off",value:function(e,t,r){var n=this;return void 0===r?o(s(c.prototype),"off",this).call(this,e,t):(this._delegatedListeners&&this._delegatedListeners[e]&&function(i){for(var a=n._delegatedListeners[e],o=0;o<a.length;o++){var s=a[o];if(s.layer===t&&s.listener===r){for(var u in s.delegates)n.off(u,s.delegates[u]);return a.splice(o,1),n}}}(),this)}},{key:"queryRenderedFeatures",value:function(t,r){return this.style?(void 0!==r||void 0===t||t instanceof e.pointGeometry||Array.isArray(t)||(r=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}},{key:"querySourceFeatures",value:function(e,t){return this.style.querySourceFeatures(e,t)}},{key:"queryTerrainElevation",value:function(t,r){var n=this.transform.elevation;return n?(r=e.extend({},{exaggerated:!0},r),n.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,r.exaggerated)):null}},{key:"setStyle",value:function(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(t,r))}},{key:"_getUIString",value:function(e){var t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}},{key:"_updateStyle",value:function(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),e&&(this.style=new tr(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}},{key:"_lazyInitEmptyStyle",value:function(){this.style||(this.style=new tr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}},{key:"_diffStyle",value:function(t,r){var n=this;if("string"==typeof t){var i=this._requestManager.normalizeStyleURL(t),a=this._requestManager.transformRequest(i,e.ResourceType.Style);e.getJSON(a,(function(t,i){t?n.fire(new e.ErrorEvent(t)):i&&n._updateDiff(i,r)}))}else"object"==typeof t&&this._updateDiff(t,r)}},{key:"_updateDiff",value:function(t,r){try{this.style.setState(t)&&this._update(!0)}catch(a){e.warnOnce("Unable to perform style diff: ".concat(a.message||a.error||a,".  Rebuilding the style from scratch.")),this._updateStyle(t,r)}}},{key:"getStyle",value:function(){if(this.style)return this.style.serialize()}},{key:"isStyleLoaded",value:function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")}},{key:"addSource",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}},{key:"isSourceLoaded",value:function(t){var r=this.style&&this.style._getSourceCaches(t);if(0!==r.length)return r.every((function(e){return e.loaded()}));this.fire(new e.ErrorEvent(new Error("There is no source with ID '".concat(t,"'"))))}},{key:"areTilesLoaded",value:function(){var e=this.style&&this.style._sourceCaches;for(var t in e){var r=e[t]._tiles;for(var n in r){var i=r[n];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0}},{key:"addSourceType",value:function(e,t,r){return this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)}},{key:"removeSource",value:function(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}},{key:"getSource",value:function(e){return this.style.getSource(e)}},{key:"addImage",value:function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.pixelRatio,a=void 0===i?1:i,o=n.sdf,s=void 0!==o&&o,u=n.stretchX,l=n.stretchY,c=n.content;if(this._lazyInitEmptyStyle(),r instanceof qi||Ki&&r instanceof Ki){var h=e.exported.getImageData(r),f=h.width,d=h.height,p=h.data;this.style.addImage(t,{data:new e.RGBAImage({width:f,height:d},p),pixelRatio:a,stretchX:u,stretchY:l,content:c,sdf:s,version:0})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var y=r.width,v=r.height,m=r.data,g=r;this.style.addImage(t,{data:new e.RGBAImage({width:y,height:v},new Uint8Array(m)),pixelRatio:a,stretchX:u,stretchY:l,content:c,sdf:s,version:0,userImage:g}),g.onAdd&&g.onAdd(this,t)}}},{key:"updateImage",value:function(t,r){var n=this.style.getImage(t);if(!n)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var i=r instanceof qi||Ki&&r instanceof Ki?e.exported.getImageData(r):r,a=i.width,o=i.height,s=i.data;return void 0===a||void 0===o?this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):a!==n.data.width||o!==n.data.height?this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(n.data.replace(s,!(r instanceof qi||Ki&&r instanceof Ki)),void this.style.updateImage(t,n))}},{key:"hasImage",value:function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}},{key:"removeImage",value:function(e){this.style.removeImage(e)}},{key:"loadImage",value:function(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),(function(t,n){r(t,n instanceof qi?e.exported.getImageData(n):n)}))}},{key:"listImages",value:function(){return this.style.listImages()}},{key:"addLayer",value:function(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}},{key:"moveLayer",value:function(e,t){return this.style.moveLayer(e,t),this._update(!0)}},{key:"removeLayer",value:function(e){return this.style.removeLayer(e),this._update(!0)}},{key:"getLayer",value:function(e){return this.style.getLayer(e)}},{key:"setLayerZoomRange",value:function(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}},{key:"setFilter",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,r),this._update(!0)}},{key:"getFilter",value:function(e){return this.style.getFilter(e)}},{key:"setPaintProperty",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,r,n),this._update(!0)}},{key:"getPaintProperty",value:function(e,t){return this.style.getPaintProperty(e,t)}},{key:"setLayoutProperty",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}},{key:"getLayoutProperty",value:function(e,t){return this.style.getLayoutProperty(e,t)}},{key:"setLight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}},{key:"getLight",value:function(){return this.style.getLight()}},{key:"setTerrain",value:function(e){return this._lazyInitEmptyStyle(),this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}},{key:"getTerrain",value:function(){return this.style?this.style.getTerrain():null}},{key:"setFog",value:function(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}},{key:"getFog",value:function(){return this.style?this.style.getFog():null}},{key:"_queryFogOpacity",value:function(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}},{key:"setFeatureState",value:function(e,t){return this.style.setFeatureState(e,t),this._update()}},{key:"removeFeatureState",value:function(e,t){return this.style.removeFeatureState(e,t),this._update()}},{key:"getFeatureState",value:function(e){return this.style.getFeatureState(e)}},{key:"_containerDimensions",value:function(){var e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}},{key:"_detectMissingCSS",value:function(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}},{key:"_setupContainer",value:function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=g.create("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();var t=this._canvasContainer=g.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=g.create("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var n=this._controlContainer=g.create("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(e){i[e]=g.create("div","mapboxgl-ctrl-".concat(e),n)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}},{key:"_resizeCanvas",value:function(t,r){var n=e.exported.devicePixelRatio||1;this._canvas.width=n*t,this._canvas.height=n*r,this._canvas.style.width="".concat(t,"px"),this._canvas.style.height="".concat(r,"px")}},{key:"_addMarker",value:function(e){this._markers.push(e)}},{key:"_removeMarker",value:function(e){var t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}},{key:"_setupPainter",value:function(){var r=this,n=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",n)||this._canvas.getContext("experimental-webgl",n);i?(e.storeAuthState(i,!0),this.painter=new Sn(i,this.transform),this.on("data",(function(e){"source"===e.dataType&&r.painter.setTileLoadedFlag(!0)})),e.exported$1.testSupport(i)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}},{key:"_contextLost",value:function(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}},{key:"_contextRestored",value:function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}},{key:"_onMapScroll",value:function(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}},{key:"loaded",value:function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}},{key:"_update",value:function(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}},{key:"_requestRenderFrame",value:function(e){return this._update(),this._renderTaskQueue.add(e)}},{key:"_cancelRenderFrame",value:function(e){this._renderTaskQueue.remove(e)}},{key:"_requestDomTask",value:function(e){!this.isMoving()&&this.loaded()?e():this._domRenderTaskQueue.add(e)}},{key:"_render",value:function(t){var r,n=this,i=this.painter.context.extTimerQuery,a=e.exported.now();this.listens("gpu-timing-frame")&&(r=i.createQueryEXT(),i.beginQueryEXT(i.TIME_ELAPSED_EXT,r));var o=this._updateAverageElevation(a);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),!this._removed){var s=!1,u=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;var l=this.transform.zoom,c=e.exported.now();this.style.zoomHistory.update(l,c);var h=new e.EvaluationParameters(l,{now:c,fadeDuration:u,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),f=h.crossFadingFactor();1===f&&f===this._crossFadingFactor||(s=!0,this._crossFadingFactor=f),this.style.update(h)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,u,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:u,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var d=e.exported.now()-a;i.endQueryEXT(i.TIME_ELAPSED_EXT,r),setTimeout((function(){var t=i.getQueryObjectEXT(r,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(r),n.fire(new e.Event("gpu-timing-frame",{cpuTime:d,gpuTime:t}))}),50)}if(this.listens("gpu-timing-layer")){var p=this.painter.collectGpuTimers();setTimeout((function(){var t=n.painter.queryGpuTimers(p);n.fire(new e.Event("gpu-timing-layer",{layerTimes:t}))}),50)}var y=this._sourcesDirty||this._styleDirty||this._placementDirty||o;if(y||this._repaint)this.triggerRepaint();else{var v=!this.isMoving()&&this.loaded();if(v&&(o=this._updateAverageElevation(a,!0)),o)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){var m=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:m})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||y||(this._fullyLoaded=!0,this._authenticate()),this}}},{key:"_updateAverageElevation",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=function(e){return t.transform.averageElevation=e,t._update(!1),!0};if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&n(0);if((r||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){var i=this.transform.averageElevation,a=this.transform.sampleAverageElevation();isNaN(a)?a=0:this._averageElevationLastSampledAt=e;var o=Math.abs(i-a);if(o>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(a),n(a);this._averageElevation.easeTo(a,e,300)}else if(o>1e-4)return this._averageElevation.jumpTo(a),n(a)}return!!this._averageElevation.isEasing(e)&&n(this._averageElevation.getValue(e))}},{key:"_authenticate",value:function(){var t=this;e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(r){if(r&&(r.message===e.AUTH_ERR_MSG||401===r.status)){var n=t.painter.context.gl;e.storeAuthState(n,!1),t._logoControl instanceof Li&&t._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),t._silenceAuthErrors||t.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(function(){}))}},{key:"_updateTerrain",value:function(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}},{key:"_calculateSpeedIndex",value:function(){var e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());var r=this.painter.context.gl,n=r.createFramebuffer();function i(e){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);var t=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,t),t}return r.bindFramebuffer(r.FRAMEBUFFER,n),this._canvasPixelComparison(i(e),t.canvasCopies.map(i),t.timeStamps)}},{key:"_canvasPixelComparison",value:function(e,t,r){for(var n=r[1]-r[0],i=e.length/4,a=0;a<t.length;a++){for(var o=t[a],s=0,u=0;u<o.length;u+=4)o[u]===e[u]&&o[u+1]===e[u+1]&&o[u+2]===e[u+2]&&o[u+3]===e[u+3]&&(s+=1);n+=(r[a+2]-r[a+1])*(1-s/i)}return n}},{key:"remove",value:function(){this._hash&&this._hash.remove();var t,r=f(this._controls);try{for(r.s();!(t=r.n()).done;)t.value.onRemove(this)}catch(i){r.e(i)}finally{r.f()}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),Wi(this._canvasContainer),Wi(this._controlContainer),Wi(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}},{key:"triggerRepaint",value:function(){this._triggerFrame(!0)}},{key:"_triggerFrame",value:function(t){var r=this;this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame((function(e){var t=!!r._renderNextFrame;r._frame=null,r._renderNextFrame=null,t&&r._render(e)})))}},{key:"_onWindowOnline",value:function(){this._update()}},{key:"_onWindowResize",value:function(e){this._trackResize&&this.resize({originalEvent:e})._update()}},{key:"_setCacheLimits",value:function(t,r){e.setCacheLimits(t,r)}},{key:"showTileBoundaries",get:function(){return!!this._showTileBoundaries},set:function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}},{key:"showTerrainWireframe",get:function(){return!!this._showTerrainWireframe},set:function(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}},{key:"speedIndexTiming",get:function(){return!!this._speedIndexTiming},set:function(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}},{key:"showPadding",get:function(){return!!this._showPadding},set:function(e){this._showPadding!==e&&(this._showPadding=e,this._update())}},{key:"showCollisionBoxes",get:function(){return!!this._showCollisionBoxes},set:function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}},{key:"showOverdrawInspector",get:function(){return!!this._showOverdrawInspector},set:function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}},{key:"repaint",get:function(){return!!this._repaint},set:function(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}},{key:"vertices",get:function(){return!!this._vertices},set:function(e){this._vertices=e,this._update()}},{key:"version",get:function(){return e.version}}]),c}(Pi),NavigationControl:function(){function t(r){var n=this;v(this,t),this.options=e.extend({},Yi,r),this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(e){return n._map.zoomIn({},{originalEvent:e})})),g.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(e){return n._map.zoomOut({},{originalEvent:e})})),g.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(e){n.options.visualizePitch?n._map.resetNorthPitch({},{originalEvent:e}):n._map.resetNorth({},{originalEvent:e})})),this._compassIcon=g.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}return m(t,[{key:"_updateZoomButtons",value:function(){var e=this._map.getZoom(),t=e===this._map.getMaxZoom(),r=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=r,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",r.toString())}},{key:"_rotateCompassArrow",value:function(){var e=this,t=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._map._requestDomTask((function(){e._compassIcon&&(e._compassIcon.style.transform=t)}))}},{key:"onAdd",value:function(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xi(this._map,this._compass,this.options.visualizePitch)),this._container}},{key:"onRemove",value:function(){g.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}},{key:"_createButton",value:function(e,t){var r=g.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}},{key:"_setButtonTitle",value:function(e,t){var r=this._map._getUIString("NavigationControl.".concat(t));e.title=r,e.setAttribute("aria-label",r)}}]),t}(),GeolocateControl:function(t){p(n,t);var r=y(n);function n(t){var a;return v(this,n),(a=r.call(this)).options=e.extend({},Qi,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],i(a)),a._onDeviceOrientationListener=a._onDeviceOrientation.bind(i(a)),a._updateMarkerRotationThrottled=Bn(a._updateMarkerRotation,20),a}return m(n,[{key:"onAdd",value:function(t){var r;return this._map=t,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==Zi?r(Zi):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((function(e){Zi="denied"!==e.state,r(Zi)})):(Zi=!!e.window.navigator.geolocation,r(Zi)),this._container}},{key:"onRemove",value:function(){void 0!==this._geolocationWatchID&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),g.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ji=0,$i=!1}},{key:"_isOutOfMapMaxBounds",value:function(e){var t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}},{key:"_setErrorState",value:function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}},{key:"_onSuccess",value:function(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}},{key:"_updateCamera",value:function(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,i=this._map.getBearing(),a=e.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(n),a,{geolocateSource:!0})}},{key:"_updateMarker",value:function(t){if(t){var r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}},{key:"_updateCircleRadius",value:function(){var e=this._map._container.clientHeight/2,t=this._map.unproject([0,e]),r=this._map.unproject([100,e]),n=t.distanceTo(r)/100,i=Math.ceil(2*this._accuracy/n);this._circleElement.style.width="".concat(i,"px"),this._circleElement.style.height="".concat(i,"px")}},{key:"_onZoom",value:function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}},{key:"_updateMarkerRotation",value:function(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}},{key:"_onError",value:function(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&$i)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}},{key:"_finish",value:function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}},{key:"_setupUI",value:function(t){var r=this;if(this._container.addEventListener("contextmenu",(function(e){return e.preventDefault()})),this._geolocateButton=g.create("button","mapboxgl-ctrl-geolocate",this._container),g.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{var i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=g.create("div","mapboxgl-user-location"),this._dotElement.appendChild(g.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(g.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Fi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=g.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Fi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(t){t.geolocateSource||"ACTIVE_LOCK"!==r._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new e.Event("trackuserlocationend")))}))}},{key:"_onDeviceOrientation",value:function(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}},{key:"trigger",value:function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ji--,$i=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ji>1?(t={maximumAge:6e5,timeout:0},$i=!0):(t=this.options.positionOptions,$i=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}},{key:"_addDeviceOrientationListener",value:function(){var t=this,r=function(){e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",t._onDeviceOrientationListener)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((function(e){"granted"===e&&r()})).catch(console.error):r()}},{key:"_clearWatch",value:function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}}]),n}(e.Evented),AttributionControl:Oi,ScaleControl:function(){function t(r){v(this,t),this.options=e.extend({},ea,r),e.bindAll(["_onMove","setUnit"],this)}return m(t,[{key:"getDefaultPosition",value:function(){return"bottom-left"}},{key:"_onMove",value:function(){ta(this._map,this._container,this.options)}},{key:"onAdd",value:function(e){return this._map=e,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}},{key:"onRemove",value:function(){g.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},{key:"setUnit",value:function(e){this.options.unit=e,ta(this._map,this._container,this.options)}}]),t}(),FullscreenControl:function(){function t(r){v(this,t),this._fullscreen=!1,r&&r.container&&(r.container instanceof e.window.HTMLElement?this._container=r.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}return m(t,[{key:"onAdd",value:function(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}},{key:"onRemove",value:function(){g.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_checkFullscreenSupport",value:function(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}},{key:"_setupUI",value:function(){var t=this._fullscreenButton=g.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);g.create("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden",!0),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}},{key:"_updateTitle",value:function(){var e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}},{key:"_getTitle",value:function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}},{key:"_isFullscreen",value:function(){return this._fullscreen}},{key:"_changeIcon",value:function(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}},{key:"_onClickFullscreen",value:function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}}]),t}(),Popup:function(t){p(n,t);var r=y(n);function n(t){var a;return v(this,n),(a=r.call(this)).options=e.extend(Object.create(na),t),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],i(a)),a}return m(n,[{key:"addTo",value:function(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this}},{key:"isOpen",value:function(){return!!this._map}},{key:"remove",value:function(){return this._content&&g.remove(this._content),this._container&&(g.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this}},{key:"getLngLat",value:function(){return this._lngLat}},{key:"setLngLat",value:function(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}},{key:"trackPointer",value:function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}},{key:"getElement",value:function(){return this._container}},{key:"setText",value:function(t){return this.setDOMContent(e.window.document.createTextNode(t))}},{key:"setHTML",value:function(t){var r,n=e.window.document.createDocumentFragment(),i=e.window.document.createElement("body");for(i.innerHTML=t;r=i.firstChild;)n.appendChild(r);return this.setDOMContent(n)}},{key:"getMaxWidth",value:function(){return this._container&&this._container.style.maxWidth}},{key:"setMaxWidth",value:function(e){return this.options.maxWidth=e,this._update(),this}},{key:"setDOMContent",value:function(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=g.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}},{key:"addClassName",value:function(e){this._container&&this._container.classList.add(e)}},{key:"removeClassName",value:function(e){this._container&&this._container.classList.remove(e)}},{key:"setOffset",value:function(e){return this.options.offset=e,this._update(),this}},{key:"toggleClassName",value:function(e){if(this._container)return this._container.classList.toggle(e)}},{key:"_createCloseButton",value:function(){this.options.closeButton&&(this._closeButton=g.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}},{key:"_onMouseUp",value:function(e){this._update(e.point)}},{key:"_onMouseMove",value:function(e){this._update(e.point)}},{key:"_onDrag",value:function(e){this._update(e.point)}},{key:"_update",value:function(e){var t=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=g.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=g.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(e){return t._container.classList.add(e)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Bi(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||e)){var r=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat),n=this.options.anchor,i=aa(this.options.offset);if(!n){var a,o=this._container.offsetWidth,s=this._container.offsetHeight;a=r.y+i.bottom.y<s?["top"]:r.y>this._map.transform.height-s?["bottom"]:[],r.x<o/2?a.push("left"):r.x>this._map.transform.width-o/2&&a.push("right"),n=0===a.length?"bottom":a.join("-")}var u=r.add(i[n]).round();this._map._requestDomTask((function(){t._container&&n&&(g.setTransform(t._container,"".concat(Ni[n]," translate(").concat(u.x,"px,").concat(u.y,"px)")),zi(t._container,n,"popup"))}))}}},{key:"_focusFirstElement",value:function(){if(this.options.focusAfterOpen&&this._container){var e=this._container.querySelector(ia);e&&e.focus()}}},{key:"_onClose",value:function(){this.remove()}},{key:"_setOpacity",value:function(e){this._content&&(this._content.style.opacity=e),this._tip&&(this._tip.style.opacity=e)}}]),n}(e.Evented),Marker:Fi,Style:tr,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.pointGeometry,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:On,Evented:e.Evented,config:e.config,prewarm:function(){Ze().acquire(He)},clearPrewarmedResources:function(){var e=Ke;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(He),Ke=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return We.workerCount},set workerCount(e){We.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage:function(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return oa})),r}()},function(e,t,r){"use strict";var n=r(1108),i=r(10).Buffer,a=r(795),o=r(91),s=r(876),u=r(874),l=r(313),c=Symbol.for("nodejs.util.inspect.custom"),h=l.proto((function(e){if(!(this instanceof h))return new h(e);if(null==e&&(e=""),e instanceof i)this.buffer=n.fromBuffer(e);else if("string"===typeof e||e instanceof String){if(e.length>0&&"/"!==e.charAt(0))throw new Error('multiaddr "'.concat(e,'" must start with a "/"'));this.buffer=n.fromString(e)}else{if(!(e.buffer&&e.protos&&e.protoCodes))throw new Error("addr must be a string, Buffer, or another Multiaddr");this.buffer=n.fromBuffer(e.buffer)}}),{className:"Multiaddr",symbolName:"@multiformats/js-multiaddr/multiaddr"});h.prototype.toString=function(){return n.bufferToString(this.buffer)},h.prototype.toJSON=h.prototype.toString,h.prototype.toOptions=function(){var e={},t=this.toString().split("/");return e.family="ip4"===t[1]?"ipv4":"ipv6",e.host=t[2],e.transport=t[3],e.port=parseInt(t[4]),e},h.prototype[c]=function(){return"<Multiaddr "+this.buffer.toString("hex")+" - "+n.bufferToString(this.buffer)+">"},h.prototype.inspect=function(){return"<Multiaddr "+this.buffer.toString("hex")+" - "+n.bufferToString(this.buffer)+">"},h.prototype.protos=function(){return this.protoCodes().map((function(e){return Object.assign({},a(e))}))},h.prototype.protoCodes=function(){for(var e=[],t=this.buffer,r=0;r<t.length;){var i=o.decode(t,r),s=o.decode.bytes,u=a(i);r+=n.sizeForAddr(u,t.slice(r+s))+s,e.push(i)}return e},h.prototype.protoNames=function(){return this.protos().map((function(e){return e.name}))},h.prototype.tuples=function(){return n.bufferToTuples(this.buffer)},h.prototype.stringTuples=function(){var e=n.bufferToTuples(this.buffer);return n.tuplesToStringTuples(e)},h.prototype.encapsulate=function(e){return e=h(e),h(this.toString()+e.toString())},h.prototype.decapsulate=function(e){e=e.toString();var t=this.toString(),r=t.lastIndexOf(e);if(r<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return h(t.slice(0,r))},h.prototype.decapsulateCode=function(e){for(var t=this.tuples(),r=t.length-1;r>=0;r--)if(t[r][0]===e)return h(n.tuplesToBuffer(t.slice(0,r)));return this},h.prototype.getPeerId=function(){var e=null;try{e=this.stringTuples().filter((function(e){if(e[0]===a.names.ipfs.code)return!0})).pop()[1],e=s.encode("base58btc",new u(e).multihash).toString().slice(1)}catch(t){e=null}return e},h.prototype.getPath=function(){var e=null;try{e=this.stringTuples().filter((function(e){if(a(e[0]).path)return!0}))[0][1]}catch(t){e=null}return e},h.prototype.equals=function(e){return this.buffer.equals(e.buffer)},h.prototype.nodeAddress=function(){var e=this.protoCodes(),t=this.protoNames(),r=this.toString().split("/").slice(1);if(r.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(4!==e[0]&&41!==e[0]&&54!==e[0]&&55!==e[0])throw new Error("no protocol with name: \"'".concat(t[0],'\'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".'));if("tcp"!==r[2]&&"udp"!==r[2])throw new Error("no protocol with name: \"'".concat(t[1],'\'". Must have a valid transport protocol: "{tcp, udp}".'));return{family:41===e[0]||55===e[0]?6:4,address:r[1],port:parseInt(r[3])}},h.fromNodeAddress=function(e,t){if(!e)throw new Error("requires node address object");if(!t)throw new Error("requires transport protocol");var r;switch(e.family){case"IPv4":r="ip4";break;case"IPv6":r="ip6";break;default:throw Error("Invalid addr family. Got '".concat(e.family,"' instead of 'IPv4' or 'IPv6'"))}return h("/"+[r,e.address,t,e.port].join("/"))},h.prototype.isThinWaistAddress=function(e){var t=(e||this).protos();return 2===t.length&&((4===t[0].code||41===t[0].code)&&(6===t[1].code||273===t[1].code))},h.protocols=a,h.isName=function(e){return!!h.isMultiaddr(e)&&e.protos().some((function(e){return e.resolvable}))},h.resolve=function(e){return h.isMultiaddr(e)&&h.isName(e)?Promise.reject(new Error("not implemented yet")):Promise.reject(Error("not a valid name"))},e.exports=h},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(10).Buffer,o=r(875),s=r(1118),u=r(316),l=r(94),c=r(1122),h=r(313)(function(){function e(t,r,i,l){if(n(this,e),h.isCID(t)){var c=t;return this.version=c.version,this.codec=c.codec,this.multihash=a.from(c.multihash),void(this.multibaseName=c.multibaseName||(0===c.version?"base58btc":"base32"))}if("string"===typeof t){var f=s.isEncoded(t);if(f){var d=s.decode(t);this.version=parseInt(d.slice(0,1).toString("hex"),16),this.codec=u.getCodec(d.slice(1)),this.multihash=u.rmPrefix(d.slice(1)),this.multibaseName=f}else this.version=0,this.codec="dag-pb",this.multihash=o.fromB58String(t),this.multibaseName="base58btc";return e.validateCID(this),void Object.defineProperty(this,"string",{value:t})}if(a.isBuffer(t)){var p=t.slice(0,1),y=parseInt(p.toString("hex"),16);if(1===y){var v=t;this.version=y,this.codec=u.getCodec(v.slice(1)),this.multihash=u.rmPrefix(v.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=t,this.multibaseName="base58btc";e.validateCID(this)}else this.version=t,this.codec=r,this.multihash=i,this.multibaseName=l||(0===t?"base58btc":"base32"),e.validateCID(this)}return i(e,[{key:"toV0",value:function(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");var e=o.decode(this.multihash),t=e.name,r=e.length;if("sha2-256"!==t)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==r)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new h(0,this.codec,this.multihash)}},{key:"toV1",value:function(){return new h(1,this.codec,this.multihash)}},{key:"toBaseEncodedString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.multibaseName;if(this.string&&e===this.multibaseName)return this.string;var t=null;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=o.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=s.encode(e,this.buffer).toString()}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(){return"CID("+this.toString()+")"}},{key:"toString",value:function(e){return this.toBaseEncodedString(e)}},{key:"toJSON",value:function(){return{codec:this.codec,version:this.version,hash:this.multihash}}},{key:"equals",value:function(e){return this.codec===e.codec&&this.version===e.version&&this.multihash.equals(e.multihash)}},{key:"buffer",get:function(){var e=this._buffer;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");e=a.concat([a.from("01","hex"),u.getCodeVarint(this.codec),this.multihash])}Object.defineProperty(this,"_buffer",{value:e})}return e}},{key:"prefix",get:function(){return a.concat([a.from("0".concat(this.version),"hex"),u.getCodeVarint(this.codec),o.prefix(this.multihash)])}}],[{key:"validateCID",value:function(e){var t=c.checkCIDComponents(e);if(t)throw new Error(t)}}]),e}(),{className:"CID",symbolName:"@ipld/js-cid/CID"});h.codecs=l,e.exports=h},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1113),a=r(91),o=r(1117).names,s={};for(var u in o)s[o[u]]=u;function l(e){t.decode(e)}t.names=o,t.codes=Object.freeze(s),t.toHexString=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return e.toString("hex")},t.fromHexString=function(e){return n.from(e,"hex")},t.toB58String=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return i.encode("base58btc",e).toString().slice(1)},t.fromB58String=function(e){var t=e;return n.isBuffer(e)&&(t=e.toString()),i.decode("z"+t)},t.decode=function(e){if(!n.isBuffer(e))throw new Error("multihash must be a Buffer");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");var r=a.decode(e);if(!t.isValidCode(r))throw new Error("multihash unknown function code: 0x".concat(r.toString(16)));e=e.slice(a.decode.bytes);var i=a.decode(e);if(i<0)throw new Error("multihash invalid length: ".concat(i));if((e=e.slice(a.decode.bytes)).length!==i)throw new Error("multihash length inconsistent: 0x".concat(e.toString("hex")));return{code:r,name:s[r],length:i,digest:e}},t.encode=function(e,r,i){if(!e||void 0===r)throw new Error("multihash encode requires at least two args: digest, code");var o=t.coerceCode(r);if(!n.isBuffer(e))throw new Error("digest should be a Buffer");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");return n.concat([n.from(a.encode(o)),n.from(a.encode(i)),e])},t.coerceCode=function(e){var r=e;if("string"===typeof e){if(void 0===o[e])throw new Error("Unrecognized hash function named: ".concat(e));r=o[e]}if("number"!==typeof r)throw new Error("Hash function code should be a number. Got: ".concat(r));if(void 0===s[r]&&!t.isAppCode(r))throw new Error("Unrecognized function code: ".concat(r));return r},t.isAppCode=function(e){return e>0&&e<16},t.isValidCode=function(e){return!!t.isAppCode(e)||!!s[e]},t.validate=l,t.prefix=function(e){return l(e),e.slice(0,2)}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1123);function a(e,t){if(!t)throw new Error("requires an encoded buffer");var r=o(e),i=n.from(r.code);return function(e,t){o(e).decode(t.toString())}(r.name,t),n.concat([i,t])}function o(e){var t;if(i.names[e])t=i.names[e];else{if(!i.codes[e])throw new Error("Unsupported encoding");t=i.codes[e]}if(!t.isImplemented())throw new Error("Base "+e+" is not implemented yet");return t}(t=e.exports=a).encode=function(e,t){var r=o(e);return a(r.name,n.from(r.encode(t)))},t.decode=function(e){n.isBuffer(e)&&(e=e.toString());var t=e.substring(0,1);"string"===typeof(e=e.substring(1,e.length))&&(e=n.from(e));var r=o(t);return n.from(r.decode(e.toString()))},t.isEncoded=function(e){n.isBuffer(e)&&(e=e.toString());if("[object String]"!==Object.prototype.toString.call(e))return!1;var t=e.substring(0,1);try{return o(t).name}catch(r){return!1}},t.names=Object.freeze(Object.keys(i.names)),t.codes=Object.freeze(Object.keys(i.codes))},function(e,t,r){"use strict";(function(t){var n=r(91);function i(e){return parseInt(e.toString("hex"),16)}function a(e){var r=e.toString(16);return r.length%2===1&&(r="0"+r),t.from(r,"hex")}e.exports={numberToBuffer:a,bufferToNumber:i,varintBufferEncode:function(e){return t.from(n.encode(i(e)))},varintBufferDecode:function(e){return a(n.decode(e))},varintEncode:function(e){return t.from(n.encode(e))}}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(665);r(667),e.exports=n.cipher=n.cipher||{},n.cipher.algorithms=n.cipher.algorithms||{},n.cipher.createCipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})},n.cipher.createDecipher=function(e,t){var r=e;if("string"===typeof r&&(r=n.cipher.getAlgorithm(r))&&(r=r()),!r)throw new Error("Unsupported algorithm: "+e);return new n.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})},n.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),n.cipher.algorithms[e]=t},n.cipher.getAlgorithm=function(e){return(e=e.toUpperCase())in n.cipher.algorithms?n.cipher.algorithms[e]:null};var i=n.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};i.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=n.util.createBuffer(),this.output=e.output||n.util.createBuffer(),this.mode.start(t)},i.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},i.prototype.finish=function(e){!e||"ECB"!==this.mode.name&&"CBC"!==this.mode.name||(this.mode.pad=function(t){return e(this.blockSize,t,!1)},this.mode.unpad=function(t){return e(this.blockSize,t,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t))&&(this._finish=!0,this.update(),!(this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))&&!(this.mode.afterFinish&&!this.mode.afterFinish(this.output,t)))}},function(e,t,r){var n=r(665);r(667),n.cipher=n.cipher||{};var i=e.exports=n.cipher.modes=n.cipher.modes||{};function a(e,t){if("string"===typeof e&&(e=n.util.createBuffer(e)),n.util.isArray(e)&&e.length>4){var r=e;e=n.util.createBuffer();for(var i=0;i<r.length;++i)e.putByte(r[i])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!n.util.isArray(e)){var a=[],o=t/4;for(i=0;i<o;++i)a.push(e.getInt32());e=a}return e}function o(e){e[e.length-1]=e[e.length-1]+1&4294967295}function s(e){return[e/4294967296|0,4294967295&e]}i.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.ecb.prototype.start=function(e){},i.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])},i.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},i.cbc.prototype.start=function(e){if(null===e.iv){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else{if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._prev=this._iv.slice(0)}},i.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock},i.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)},i.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0},i.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return!(n>this.blockSize<<2)&&(e.truncate(n),!0)},i.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(0===e.length())return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0)e.read-=this.blockSize;else for(i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}},i.ofb.prototype.decrypt=i.ofb.prototype.encrypt,i.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0},i.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=a(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},i.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}o(this._inBlock)},i.ctr.prototype.decrypt=i.ctr.prototype.encrypt,i.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=n.util.createBuffer(),this._partialBytes=0,this._R=3774873600},i.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t,r=n.util.createBuffer(e.iv);if(this._cipherLength=0,t="additionalData"in e?n.util.createBuffer(e.additionalData):n.util.createBuffer(),this._tagLength="tagLength"in e?e.tagLength:128,this._tag=null,e.decrypt&&(this._tag=n.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var i=r.length();if(12===i)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(s(8*i)))}this._inBlock=this._j0.slice(0),o(this._inBlock),this._partialBytes=0,t=n.util.createBuffer(t),this._aDataLength=s(8*t.length());var a=t.length()%this.blockSize;for(a&&t.fillWithByte(0,this.blockSize-a),this._s=[0,0,0,0];t.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()])},i.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(0===n)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),0===this._partialBytes&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),o(this._inBlock)},i.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),o(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize},i.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=n.util.createBuffer();var i=this._aDataLength.concat(s(8*this._cipherLength));this._s=this.ghash(this._hashSubkey,this._s,i);var a=[];this.cipher.encrypt(this._j0,a);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^a[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r},i.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){e[i/32|0]&1<<31-i%32&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r},i.gcm.prototype.pow=function(e,t){for(var r=1&e[3],n=3;n>0;--n)t[n]=e[n]>>>1|(1&e[n-1])<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)},i.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=e[r/8|0]>>>4*(7-r%8)&15,i=this._m[r][n];t[0]^=i[0],t[1]^=i[1],t[2]^=i[2],t[3]^=i[3]}return t},i.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)},i.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,a=new Array(i),o=0;o<i;++o){var s=[0,0,0,0],u=(n-1-o%n)*t;s[o/n|0]=1<<t-1<<u,a[o]=this.generateSubHashTable(this.multiply(s,e),t)}return a},i.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var o=1;o<a;++o){var s=i[a],u=i[o];i[a+o]=[s[0]^u[0],s[1]^u[1],s[2]^u[2],s[3]^u[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var l=i[a^n];i[a]=[e[0]^l[0],e[1]^l[1],e[2]^l[2],e[3]^l[3]]}return i}},function(e,t,r){var n=r(665);r(697),r(667);var i=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=i,i.create=function(){o||(a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),o=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,a=0;a<r;++a)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(a,o){"utf8"===o&&(a=n.util.encodeUtf8(a));var u=a.length;i.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var l=i.fullMessageLength.length-1;l>=0;--l)i.fullMessageLength[l]+=u[1],u[1]=u[0]+(i.fullMessageLength[l]/4294967296>>>0),i.fullMessageLength[l]=i.fullMessageLength[l]>>>0,u[0]=u[1]/4294967296>>>0;return t.putBytes(a),s(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var u,l=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;o.putBytes(a.substr(0,i.blockLength-l));for(var c=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)c+=(u=8*i.fullMessageLength[h+1])/4294967296>>>0,o.putInt32(c>>>0),c=u>>>0;o.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};s(f,r,o);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},i};var a=null,o=!1;function s(e,t,r){for(var n,i,a,o,s,u,l,c=r.length();c>=64;){for(i=e.h0,a=e.h1,o=e.h2,s=e.h3,u=e.h4,l=0;l<16;++l)n=r.getInt32(),t[l]=n,n=(i<<5|i>>>27)+(s^a&(o^s))+u+1518500249+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;l<20;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(i<<5|i>>>27)+(s^a&(o^s))+u+1518500249+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;l<32;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(i<<5|i>>>27)+(a^o^s)+u+1859775393+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;l<40;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(i<<5|i>>>27)+(a^o^s)+u+1859775393+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;l<60;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(i<<5|i>>>27)+(a&o|s&(a^o))+u+2400959708+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;l<80;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(i<<5|i>>>27)+(a^o^s)+u+3395469782+n,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+o|0,e.h3=e.h3+s|0,e.h4=e.h4+u|0,c-=64}}},function(e,t,r){var n=r(665);function i(e,t){n.cipher.registerAlgorithm(e,(function(){return new n.des.Algorithm(e,t)}))}r(878),r(879),r(667),e.exports=n.des=n.des||{},n.des.startEncrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!1,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createEncryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!1,mode:t})},n.des.startDecrypting=function(e,t,r,n){var i=p({key:e,output:r,decrypt:!0,mode:n||(null===t?"ECB":"CBC")});return i.start(t),i},n.des.createDecryptionCipher=function(e,t){return p({key:e,output:null,decrypt:!0,mode:t})},n.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(e,t){return d(r._keys,e,t,!1)},decrypt:function(e,t){return d(r._keys,e,t,!0)}}}),r._init=!1},n.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=n.util.createBuffer(e.key);if(0===this.name.indexOf("3DES")&&24!==t.length())throw new Error("Invalid Triple-DES key size: "+8*t.length());this._keys=function(e){for(var t,r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],n=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],i=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],a=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],u=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],h=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],y=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],v=e.length()>8?3:1,m=[],g=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],_=0,b=0;b<v;b++){var w=e.getInt32(),x=e.getInt32();w^=(t=252645135&(w>>>4^x))<<4,w^=t=65535&((x^=t)>>>-16^w),w^=(t=858993459&(w>>>2^(x^=t<<-16)))<<2,w^=t=65535&((x^=t)>>>-16^w),w^=(t=1431655765&(w>>>1^(x^=t<<-16)))<<1,w^=t=16711935&((x^=t)>>>8^w),t=(w^=(t=1431655765&(w>>>1^(x^=t<<8)))<<1)<<8|(x^=t)>>>20&240,w=x<<24|x<<8&16711680|x>>>8&65280|x>>>24&240,x=t;for(var k=0;k<g.length;++k){g[k]?(w=w<<2|w>>>26,x=x<<2|x>>>26):(w=w<<1|w>>>27,x=x<<1|x>>>27),x&=-15;var E=r[(w&=-15)>>>28]|n[w>>>24&15]|i[w>>>20&15]|a[w>>>16&15]|o[w>>>12&15]|s[w>>>8&15]|u[w>>>4&15],S=l[x>>>28]|c[x>>>24&15]|h[x>>>20&15]|f[x>>>16&15]|d[x>>>12&15]|p[x>>>8&15]|y[x>>>4&15];t=65535&(S>>>16^E),m[_++]=E^t,m[_++]=S^t<<16}}return m}(t),this._init=!0}},i("DES-ECB",n.cipher.modes.ecb),i("DES-CBC",n.cipher.modes.cbc),i("DES-CFB",n.cipher.modes.cfb),i("DES-OFB",n.cipher.modes.ofb),i("DES-CTR",n.cipher.modes.ctr),i("3DES-ECB",n.cipher.modes.ecb),i("3DES-CBC",n.cipher.modes.cbc),i("3DES-CFB",n.cipher.modes.cfb),i("3DES-OFB",n.cipher.modes.ofb),i("3DES-CTR",n.cipher.modes.ctr);var a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],s=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],c=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],f=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function d(e,t,r,n){var i,d,p=32===e.length?3:9;i=3===p?n?[30,-2,-2]:[0,32,2]:n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var y=t[0],v=t[1];y^=(d=252645135&(y>>>4^v))<<4,y^=(d=65535&(y>>>16^(v^=d)))<<16,y^=d=858993459&((v^=d)>>>2^y),y^=d=16711935&((v^=d<<2)>>>8^y),y=(y^=(d=1431655765&(y>>>1^(v^=d<<8)))<<1)<<1|y>>>31,v=(v^=d)<<1|v>>>31;for(var m=0;m<p;m+=3){for(var g=i[m+1],_=i[m+2],b=i[m];b!=g;b+=_){var w=v^e[b],x=(v>>>4|v<<28)^e[b+1];d=y,y=v,v=d^(o[w>>>24&63]|u[w>>>16&63]|c[w>>>8&63]|f[63&w]|a[x>>>24&63]|s[x>>>16&63]|l[x>>>8&63]|h[63&x])}d=y,y=v,v=d}v=v>>>1|v<<31,v^=d=1431655765&((y=y>>>1|y<<31)>>>1^v),v^=(d=16711935&(v>>>8^(y^=d<<1)))<<8,v^=(d=858993459&(v>>>2^(y^=d)))<<2,v^=d=65535&((y^=d)>>>16^v),v^=d=252645135&((y^=d<<16)>>>4^v),y^=d<<4,r[0]=y,r[1]=v}function p(e){var t,r="DES-"+((e=e||{}).mode||"CBC").toUpperCase(),i=(t=e.decrypt?n.cipher.createDecipher(r,e.key):n.cipher.createCipher(r,e.key)).start;return t.start=function(e,r){var a=null;r instanceof n.util.ByteBuffer&&(a=r,r={}),(r=r||{}).output=a,r.iv=e,i.call(t,r)},t}},function(e,t,r){(function(t){var n=r(665);r(883),r(697),r(667);var i,a=n.pkcs5=n.pkcs5||{};n.util.isNodejs&&!n.options.usePureJavaScript&&(i=r(801)),e.exports=n.pbkdf2=a.pbkdf2=function(e,r,a,o,s,u){if("function"===typeof s&&(u=s,s=null),n.util.isNodejs&&!n.options.usePureJavaScript&&i.pbkdf2&&(null===s||"object"!==typeof s)&&(i.pbkdf2Sync.length>4||!s||"sha1"===s))return"string"!==typeof s&&(s="sha1"),e=t.from(e,"binary"),r=t.from(r,"binary"),u?4===i.pbkdf2Sync.length?i.pbkdf2(e,r,a,o,(function(e,t){if(e)return u(e);u(null,t.toString("binary"))})):i.pbkdf2(e,r,a,o,s,(function(e,t){if(e)return u(e);u(null,t.toString("binary"))})):4===i.pbkdf2Sync.length?i.pbkdf2Sync(e,r,a,o).toString("binary"):i.pbkdf2Sync(e,r,a,o,s).toString("binary");if("undefined"!==typeof s&&null!==s||(s="sha1"),"string"===typeof s){if(!(s in n.md.algorithms))throw new Error("Unknown hash algorithm: "+s);s=n.md[s].create()}var l=s.digestLength;if(o>4294967295*l){var c=new Error("Derived key is too long.");if(u)return u(c);throw c}var h=Math.ceil(o/l),f=o-(h-1)*l,d=n.hmac.create();d.start(s,e);var p,y,v,m="";if(!u){for(var g=1;g<=h;++g){d.start(null,null),d.update(r),d.update(n.util.int32ToBytes(g)),p=v=d.digest().getBytes();for(var _=2;_<=a;++_)d.start(null,null),d.update(v),y=d.digest().getBytes(),p=n.util.xorBytes(p,y,l),v=y;m+=g<h?p:p.substr(0,f)}return m}g=1;function b(){if(g>h)return u(null,m);d.start(null,null),d.update(r),d.update(n.util.int32ToBytes(g)),p=v=d.digest().getBytes(),_=2,w()}function w(){if(_<=a)return d.start(null,null),d.update(v),y=d.digest().getBytes(),p=n.util.xorBytes(p,y,l),v=y,++_,n.util.setImmediate(w);m+=g<h?p:p.substr(0,f),++g,b()}b()}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(665);r(697),r(667),(e.exports=n.hmac=n.hmac||{}).create=function(){var e=null,t=null,r=null,i=null,a={start:function(a,o){if(null!==a)if("string"===typeof a){if(!((a=a.toLowerCase())in n.md.algorithms))throw new Error('Unknown hash algorithm "'+a+'"');t=n.md.algorithms[a].create()}else t=a;if(null===o)o=e;else{if("string"===typeof o)o=n.util.createBuffer(o);else if(n.util.isArray(o)){var s=o;o=n.util.createBuffer();for(var u=0;u<s.length;++u)o.putByte(s[u])}var l=o.length();l>t.blockLength&&(t.start(),t.update(o.bytes()),o=t.digest()),r=n.util.createBuffer(),i=n.util.createBuffer(),l=o.length();for(u=0;u<l;++u){s=o.at(u);r.putByte(54^s),i.putByte(92^s)}if(l<t.blockLength)for(s=t.blockLength-l,u=0;u<s;++u)r.putByte(54),i.putByte(92);e=o,r=r.bytes(),i=i.bytes()}t.start(),t.update(r)},update:function(e){t.update(e)},getMac:function(){var e=t.digest().bytes();return t.start(),t.update(i),t.update(e),t.digest()}};return a.digest=a.getMac,a}},function(e,t,r){"use strict";(function(t){var n=r(127),i=r(1158);function a(e,t,r,i){if("function"===typeof r&&(i=r,r=void 0),!i)throw new Error("Missing callback");a.digest(e,t,r,(function(e,a){if(e)return i(e);i(null,n.encode(a,t,r))}))}e.exports=a,a.Buffer=t,a.multihash=n,a.digest=function(e,t,r,n){if("function"===typeof r&&(n=r,r=void 0),!n)throw new Error("Missing callback");var i,o=n;r&&(o=function(e,t){if(e)return n(e);n(null,t.slice(0,r))});try{i=a.createHash(t)}catch(s){return o(s)}i(e,o)},a.createHash=function(e){if(e=n.coerceCode(e),!a.functions[e])throw new Error("multihash function "+e+" not yet supported");return a.functions[e]},a.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(a.functions)}).call(this,r(10).Buffer)},function(e,t,r){e.exports=r(1159)},function(e,t,r){"use strict";(function(e,r){t.toCallback=function(t){return function(r,n){var i;try{i=t(r)}catch(a){return void e.nextTick(n,a)}e.nextTick(n,null,i)}},t.toBuf=function(e,t){return function(n){var i=e(n,t);return r.from(i,"hex")}},t.fromString=function(e,t){return function(n){var i=r.isBuffer(n)?n.toString():n;return e(i,t)}},t.fromNumberTo32BitBuf=function(e,t){return function(n){for(var i=e(n,t),a=new Array(4),o=0;o<4;o++)a[o]=255&i,i>>=8;return r.from(a)}}}).call(this,r(21),r(10).Buffer)},function(e,t,r){(function(t,n){var i,a=r(1161),o=r(888);function s(e,t){return"function"!==typeof t?e:e.then((function(e){i((function(){t(null,e)}))}),(function(e){i((function(){t(e)}))}))}function u(e){return s(this,e)}function l(e){if(e&&o(e)){e.nodeify=u;var t=e.then;return e.then=function(){return l(t.apply(this,arguments))},e}"function"===typeof e?e.prototype.nodeify=u:a.prototype.nodeify=u}function c(e){if(!(this instanceof c))return new c(e);a.call(this,e),l(this)}i="function"===typeof t?t:"object"===typeof n&&n&&n.nextTick?n.nextTick:function(e){setTimeout(e,0)},e.exports=s,s.extend=l,s.Promise=c,c.prototype=Object.create(a.prototype),c.prototype.constructor=c}).call(this,r(173).setImmediate,r(21))},function(e,t){e.exports=function(e){return e&&"function"===typeof e.then}},function(e,t,r){(function(t){function r(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){var r;if(e instanceof Uint8Array)r=e;else if(e instanceof t)r=new Uint8Array(e);else{if("string"!==typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");r=new Uint8Array(t.from(e,"utf8"))}return r},toHex:function(e){return Array.prototype.map.call(e,(function(e){return(e<16?"0":"")+e.toString(16)})).join("")},debugPrint:function(e,t,n){for(var i="\n"+e+" = ",a=0;a<t.length;a+=2){if(32===n)i+=r(t[a]).toUpperCase(),i+=" ",i+=r(t[a+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=r(t[a+1]).toUpperCase(),i+=r(t[a]).toUpperCase()}a%6===4?i+="\n"+new Array(e.length+4).join(" "):a<t.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){for(var n=(new Date).getTime(),i=new Uint8Array(t),a=0;a<t;a++)i[a]=a%256;var o=(new Date).getTime();for(console.log("Generated random input in "+(o-n)+"ms"),n=o,a=0;a<r;a++){var s=e(i),u=(new Date).getTime(),l=u-n;n=u,console.log("Hashed in "+l+"ms: "+s.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(n,i){Object.defineProperty(t,"__esModule",{value:!0});var a,o=r(803);a=o.hasNextTick?n.nextTick:o.hasSetImmediate?i:o.fallback,t.default=(0,o.wrap)(a),e.exports=t.default}).call(this,r(21),r(173).setImmediate)},function(e,t,r){"use strict";var n=r(1166);e.exports=function(e){if(!e||"number"!==typeof e)throw new Error("first argument must be a Number bigger than 0");return n(e)}},function(e,t,r){"use strict";(function(e){var n=r(177).bignum;t.toBase64=function(t,r){return t.toArrayLike(e,"be",r).toString("base64").replace(/(=*)$/,"").replace(/\+/g,"-").replace(/\//g,"_")},t.toBn=function(t){return new n(e.from(t,"base64"))}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(665);r(800),r(696),r(881),r(697),r(1172),r(703),r(802),r(894),r(742),r(667);var i=n.asn1,a=e.exports=n.pki=n.pki||{},o=a.oids,s={};s.CN=o.commonName,s.commonName="CN",s.C=o.countryName,s.countryName="C",s.L=o.localityName,s.localityName="L",s.ST=o.stateOrProvinceName,s.stateOrProvinceName="ST",s.O=o.organizationName,s.organizationName="O",s.OU=o.organizationalUnitName,s.organizationalUnitName="OU",s.E=o.emailAddress,s.emailAddress="E";var u=n.pki.rsa.publicKeyValidator,l={name:"Certificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:i.Class.UNIVERSAL,type:i.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:i.Class.UNIVERSAL,type:i.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},u,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},c={name:"rsapss",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:i.Class.UNIVERSAL,type:i.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:i.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:i.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:i.Class.UNIVERSAL,type:i.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},h={name:"CertificationRequestInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},u,{name:"CertificationRequestInfo.attributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0}]}]}]},f={name:"CertificationRequest",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[h,{name:"CertificationRequest.signatureAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:i.Class.UNIVERSAL,type:i.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};function d(e,t){"string"===typeof t&&(t={shortName:t});for(var r,n=null,i=0;null===n&&i<e.attributes.length;++i)r=e.attributes[i],(t.type&&t.type===r.type||t.name&&t.name===r.name||t.shortName&&t.shortName===r.shortName)&&(n=r);return n}a.RDNAttributesAsArray=function(e,t){for(var r,n,a,u=[],l=0;l<e.value.length;++l){r=e.value[l];for(var c=0;c<r.value.length;++c)a={},n=r.value[c],a.type=i.derToOid(n.value[0].value),a.value=n.value[1].value,a.valueTagClass=n.value[1].type,a.type in o&&(a.name=o[a.type],a.name in s&&(a.shortName=s[a.name])),t&&(t.update(a.type),t.update(a.value)),u.push(a)}return u},a.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],u=i.derToOid(n.value[0].value),l=n.value[1].value,c=0;c<l.length;++c){var h={};if(h.type=u,h.value=l[c].value,h.valueTagClass=l[c].type,h.type in o&&(h.name=o[h.type],h.name in s&&(h.shortName=s[h.name])),h.type===o.extensionRequest){h.extensions=[];for(var f=0;f<h.value.length;++f)h.extensions.push(a.certificateExtensionFromAsn1(h.value[f]))}t.push(h)}return t};var p=function(e,t,r){var n={};if(e!==o["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:o.sha1},mgf:{algorithmOid:o.mgf1,hash:{algorithmOid:o.sha1}},saltLength:20});var a={},s=[];if(!i.validate(t,c,a,s)){var u=new Error("Cannot read RSASSA-PSS parameter block.");throw u.errors=s,u}return void 0!==a.hashOid&&(n.hash=n.hash||{},n.hash.algorithmOid=i.derToOid(a.hashOid)),void 0!==a.maskGenOid&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=i.derToOid(a.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=i.derToOid(a.maskGenHashOid)),void 0!==a.saltLength&&(n.saltLength=a.saltLength.charCodeAt(0)),n};function y(e){for(var t,r,a=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),o=e.attributes,s=0;s<o.length;++s){var u=(t=o[s]).value,l=i.Type.PRINTABLESTRING;"valueTagClass"in t&&(l=t.valueTagClass)===i.Type.UTF8&&(u=n.util.encodeUtf8(u)),r=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.type).getBytes()),i.create(i.Class.UNIVERSAL,l,!1,u)])]),a.value.push(r)}return a}function v(e){for(var t,r=0;r<e.length;++r){if("undefined"===typeof(t=e[r]).name&&(t.type&&t.type in a.oids?t.name=a.oids[t.type]:t.shortName&&t.shortName in s&&(t.name=a.oids[s[t.shortName]])),"undefined"===typeof t.type){if(!t.name||!(t.name in a.oids))throw(u=new Error("Attribute type not specified.")).attribute=t,u;t.type=a.oids[t.name]}if("undefined"===typeof t.shortName&&t.name&&t.name in s&&(t.shortName=s[t.name]),t.type===o.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=i.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var n=0;n<t.extensions.length;++n)t.value.push(a.certificateExtensionToAsn1(m(t.extensions[n])))}var u;if("undefined"===typeof t.value)throw(u=new Error("Attribute value not specified.")).attribute=t,u}}function m(e,t){if(t=t||{},"undefined"===typeof e.name&&e.id&&e.id in a.oids&&(e.name=a.oids[e.id]),"undefined"===typeof e.id){if(!e.name||!(e.name in a.oids))throw(w=new Error("Extension ID not specified.")).extension=e,w;e.id=a.oids[e.name]}if("undefined"!==typeof e.value)return e;if("keyUsage"===e.name){var r=0,s=0,u=0;e.digitalSignature&&(s|=128,r=7),e.nonRepudiation&&(s|=64,r=6),e.keyEncipherment&&(s|=32,r=5),e.dataEncipherment&&(s|=16,r=4),e.keyAgreement&&(s|=8,r=3),e.keyCertSign&&(s|=4,r=2),e.cRLSign&&(s|=2,r=1),e.encipherOnly&&(s|=1,r=0),e.decipherOnly&&(u|=128,r=7);var l=String.fromCharCode(r);0!==u?l+=String.fromCharCode(s)+String.fromCharCode(u):0!==s&&(l+=String.fromCharCode(s)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,l)}else if("basicConstraints"===e.name)e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.pathLenConstraint).getBytes()));else if("extKeyUsage"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);var c=e.value.value;for(var h in e)!0===e[h]&&(h in o?c.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o[h]).getBytes())):-1!==h.indexOf(".")&&c.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(h).getBytes())))}else if("nsCertType"===e.name){r=0,s=0;e.client&&(s|=128,r=7),e.server&&(s|=64,r=6),e.email&&(s|=32,r=5),e.objsign&&(s|=16,r=4),e.reserved&&(s|=8,r=3),e.sslCA&&(s|=4,r=2),e.emailCA&&(s|=2,r=1),e.objCA&&(s|=1,r=0);l=String.fromCharCode(r);0!==s&&(l+=String.fromCharCode(s)),e.value=i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,l)}else if("subjectAltName"===e.name||"issuerAltName"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);for(var f=0;f<e.altNames.length;++f){l=(g=e.altNames[f]).value;if(7===g.type&&g.ip){if(null===(l=n.util.bytesFromIP(g.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===g.type&&(l=g.oid?i.oidToDer(i.oidToDer(g.oid)):i.oidToDer(l));e.value.value.push(i.create(i.Class.CONTEXT_SPECIFIC,g.type,!1,l))}}else if("nsComment"===e.name&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=i.create(i.Class.UNIVERSAL,i.Type.IA5STRING,!1,e.comment)}else if("subjectKeyIdentifier"===e.name&&t.cert){var d=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=d.toHex(),e.value=i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,d.getBytes())}else if("authorityKeyIdentifier"===e.name&&t.cert){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);c=e.value.value;if(e.keyIdentifier){var p=!0===e.keyIdentifier?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;c.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!1,p))}if(e.authorityCertIssuer){var v=[i.create(i.Class.CONTEXT_SPECIFIC,4,!0,[y(!0===e.authorityCertIssuer?t.cert.issuer:e.authorityCertIssuer)])];c.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,v))}if(e.serialNumber){var m=n.util.hexToBytes(!0===e.serialNumber?t.cert.serialNumber:e.serialNumber);c.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!1,m))}}else if("cRLDistributionPoints"===e.name){e.value=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);c=e.value.value;var g,_=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]),b=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);for(f=0;f<e.altNames.length;++f){l=(g=e.altNames[f]).value;if(7===g.type&&g.ip){if(null===(l=n.util.bytesFromIP(g.ip)))throw(w=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.')).extension=e,w}else 8===g.type&&(l=g.oid?i.oidToDer(i.oidToDer(g.oid)):i.oidToDer(l));b.value.push(i.create(i.Class.CONTEXT_SPECIFIC,g.type,!1,l))}_.value.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[b])),c.push(_)}var w;if("undefined"===typeof e.value)throw(w=new Error("Extension value not specified.")).extension=e,w;return e}function g(e,t){switch(e){case o["RSASSA-PSS"]:var r=[];return void 0!==t.hash.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])),void 0!==t.mgf.algorithmOid&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(t.mgf.hash.algorithmOid).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")])])])),void 0!==t.saltLength&&r.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(t.saltLength).getBytes())])),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,r);default:return i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")}}function _(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[]);if(0===e.attributes.length)return t;for(var r=e.attributes,a=0;a<r.length;++a){var o=r[a],s=o.value,u=i.Type.UTF8;"valueTagClass"in o&&(u=o.valueTagClass),u===i.Type.UTF8&&(s=n.util.encodeUtf8(s));var l=!1;"valueConstructed"in o&&(l=o.valueConstructed);var c=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(o.type).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,u,l,s)])]);t.value.push(c)}return t}a.certificateFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE"!==o.type&&"X509 CERTIFICATE"!==o.type&&"TRUSTED CERTIFICATE"!==o.type){var s=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw s.headerType=o.type,s}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=i.fromDer(o.body,r);return a.certificateFromAsn1(u,t)},a.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:i.toDer(a.certificateToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},a.publicKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PUBLIC KEY"!==t.type&&"RSA PUBLIC KEY"!==t.type){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert public key from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return a.publicKeyFromAsn1(o)},a.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:i.toDer(a.publicKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},a.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:i.toDer(a.publicKeyToRSAPublicKey(e)).getBytes()};return n.pem.encode(r,{maxline:t})},a.getPublicKeyFingerprint=function(e,t){var r,o=(t=t||{}).md||n.md.sha1.create();switch(t.type||"RSAPublicKey"){case"RSAPublicKey":r=i.toDer(a.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":r=i.toDer(a.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}o.start(),o.update(r);var s=o.digest();if("hex"===t.encoding){var u=s.toHex();return t.delimiter?u.match(/.{2}/g).join(t.delimiter):u}if("binary"===t.encoding)return s.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return s},a.certificationRequestFromPem=function(e,t,r){var o=n.pem.decode(e)[0];if("CERTIFICATE REQUEST"!==o.type){var s=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw s.headerType=o.type,s}if(o.procType&&"ENCRYPTED"===o.procType.type)throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var u=i.fromDer(o.body,r);return a.certificationRequestFromAsn1(u,t)},a.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:i.toDer(a.certificationRequestToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},a.createCertificate=function(){var e={version:2,serialNumber:"00",signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return d(e.issuer,t)},e.issuer.addField=function(t){v([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return d(e.subject,t)},e.subject.addField=function(t){v([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){v(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){v(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)m(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){"string"===typeof t&&(t={name:t});for(var r,n=null,i=0;null===n&&i<e.extensions.length;++i)r=e.extensions[i],(t.id&&r.id===t.id||t.name&&r.name===t.name)&&(n=r);return n},e.sign=function(t,r){e.md=r||n.md.sha1.create();var s=o[e.md.algorithm+"WithRSAEncryption"];if(!s){var u=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw u.algorithm=e.md.algorithm,u}e.signatureOid=e.siginfo.algorithmOid=s,e.tbsCertificate=a.getTBSCertificate(e);var l=i.toDer(e.tbsCertificate);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var s=t.issuer,u=e.subject;throw(y=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.")).expectedIssuer=s.attributes,y.actualIssuer=u.attributes,y}var l=t.md;if(null===l){if(t.signatureOid in o)switch(o[t.signatureOid]){case"sha1WithRSAEncryption":l=n.md.sha1.create();break;case"md5WithRSAEncryption":l=n.md.md5.create();break;case"sha256WithRSAEncryption":l=n.md.sha256.create();break;case"sha384WithRSAEncryption":l=n.md.sha384.create();break;case"sha512WithRSAEncryption":l=n.md.sha512.create();break;case"RSASSA-PSS":l=n.md.sha256.create()}if(null===l)throw(y=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=t.signatureOid,y;var c=t.tbsCertificate||a.getTBSCertificate(t),h=i.toDer(c);l.update(h.getBytes())}if(null!==l){var f;switch(t.signatureOid){case o.sha1WithRSAEncryption:f=void 0;break;case o["RSASSA-PSS"]:var d,p,y;if(void 0===(d=o[t.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[d])throw(y=new Error("Unsupported MGF hash function.")).oid=t.signatureParameters.mgf.hash.algorithmOid,y.name=d,y;if(void 0===(p=o[t.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[p])throw(y=new Error("Unsupported MGF function.")).oid=t.signatureParameters.mgf.algorithmOid,y.name=p,y;if(p=n.mgf[p].create(n.md[d].create()),void 0===(d=o[t.signatureParameters.hash.algorithmOid])||void 0===n.md[d])throw{message:"Unsupported RSASSA-PSS hash function.",oid:t.signatureParameters.hash.algorithmOid,name:d};f=n.pss.create(n.md[d].create(),p,t.signatureParameters.saltLength)}r=e.publicKey.verify(l.digest().getBytes(),t.signature,f)}return r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){var a,o;r=!0;for(var s=0;r&&s<n.attributes.length;++s)a=n.attributes[s],o=i.attributes[s],a.type===o.type&&a.value===o.value||(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return a.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=o.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var i=e.extensions[r];if(i.id===t){var a=e.generateSubjectKeyIdentifier().getBytes();return n.util.hexToBytes(i.subjectKeyIdentifier)===a}}return!1},e},a.certificateFromAsn1=function(e,t){var r={},s=[];if(!i.validate(e,l,r,s))throw(f=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.")).errors=s,f;if(i.derToOid(r.publicKeyOid)!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var u=a.createCertificate();u.version=r.certVersion?r.certVersion.charCodeAt(0):0;var c=n.util.createBuffer(r.certSerialNumber);u.serialNumber=c.toHex(),u.signatureOid=n.asn1.derToOid(r.certSignatureOid),u.signatureParameters=p(u.signatureOid,r.certSignatureParams,!0),u.siginfo.algorithmOid=n.asn1.derToOid(r.certinfoSignatureOid),u.siginfo.parameters=p(u.siginfo.algorithmOid,r.certinfoSignatureParams,!1),u.signature=r.certSignature;var h=[];if(void 0!==r.certValidity1UTCTime&&h.push(i.utcTimeToDate(r.certValidity1UTCTime)),void 0!==r.certValidity2GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity2GeneralizedTime)),void 0!==r.certValidity3UTCTime&&h.push(i.utcTimeToDate(r.certValidity3UTCTime)),void 0!==r.certValidity4GeneralizedTime&&h.push(i.generalizedTimeToDate(r.certValidity4GeneralizedTime)),h.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(h.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(u.validity.notBefore=h[0],u.validity.notAfter=h[1],u.tbsCertificate=r.tbsCertificate,t){var f;if(u.md=null,u.signatureOid in o)switch(o[u.signatureOid]){case"sha1WithRSAEncryption":u.md=n.md.sha1.create();break;case"md5WithRSAEncryption":u.md=n.md.md5.create();break;case"sha256WithRSAEncryption":u.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":u.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":u.md=n.md.sha512.create();break;case"RSASSA-PSS":u.md=n.md.sha256.create()}if(null===u.md)throw(f=new Error("Could not compute certificate digest. Unknown signature OID.")).signatureOid=u.signatureOid,f;var y=i.toDer(u.tbsCertificate);u.md.update(y.getBytes())}var m=n.md.sha1.create();u.issuer.getField=function(e){return d(u.issuer,e)},u.issuer.addField=function(e){v([e]),u.issuer.attributes.push(e)},u.issuer.attributes=a.RDNAttributesAsArray(r.certIssuer,m),r.certIssuerUniqueId&&(u.issuer.uniqueId=r.certIssuerUniqueId),u.issuer.hash=m.digest().toHex();var g=n.md.sha1.create();return u.subject.getField=function(e){return d(u.subject,e)},u.subject.addField=function(e){v([e]),u.subject.attributes.push(e)},u.subject.attributes=a.RDNAttributesAsArray(r.certSubject,g),r.certSubjectUniqueId&&(u.subject.uniqueId=r.certSubjectUniqueId),u.subject.hash=g.digest().toHex(),r.certExtensions?u.extensions=a.certificateExtensionsFromAsn1(r.certExtensions):u.extensions=[],u.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),u},a.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(a.certificateExtensionFromAsn1(n.value[i]));return t},a.certificateExtensionFromAsn1=function(e){var t={};if(t.id=i.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===i.Type.BOOLEAN?(t.critical=0!==e.value[1].value.charCodeAt(0),t.value=e.value[2].value):t.value=e.value[1].value,t.id in o)if(t.name=o[t.id],"keyUsage"===t.name){var r=0,a=0;(u=i.fromDer(t.value)).value.length>1&&(r=u.value.charCodeAt(1),a=u.value.length>2?u.value.charCodeAt(2):0),t.digitalSignature=128===(128&r),t.nonRepudiation=64===(64&r),t.keyEncipherment=32===(32&r),t.dataEncipherment=16===(16&r),t.keyAgreement=8===(8&r),t.keyCertSign=4===(4&r),t.cRLSign=2===(2&r),t.encipherOnly=1===(1&r),t.decipherOnly=128===(128&a)}else if("basicConstraints"===t.name){(u=i.fromDer(t.value)).value.length>0&&u.value[0].type===i.Type.BOOLEAN?t.cA=0!==u.value[0].value.charCodeAt(0):t.cA=!1;var s=null;u.value.length>0&&u.value[0].type===i.Type.INTEGER?s=u.value[0].value:u.value.length>1&&(s=u.value[1].value),null!==s&&(t.pathLenConstraint=i.derToInteger(s))}else if("extKeyUsage"===t.name)for(var u=i.fromDer(t.value),l=0;l<u.value.length;++l){var c=i.derToOid(u.value[l].value);c in o?t[o[c]]=!0:t[c]=!0}else if("nsCertType"===t.name){r=0;(u=i.fromDer(t.value)).value.length>1&&(r=u.value.charCodeAt(1)),t.client=128===(128&r),t.server=64===(64&r),t.email=32===(32&r),t.objsign=16===(16&r),t.reserved=8===(8&r),t.sslCA=4===(4&r),t.emailCA=2===(2&r),t.objCA=1===(1&r)}else if("subjectAltName"===t.name||"issuerAltName"===t.name){var h;t.altNames=[];u=i.fromDer(t.value);for(var f=0;f<u.value.length;++f){var d={type:(h=u.value[f]).type,value:h.value};switch(t.altNames.push(d),h.type){case 1:case 2:case 6:break;case 7:d.ip=n.util.bytesToIP(h.value);break;case 8:d.oid=i.derToOid(h.value)}}}else if("subjectKeyIdentifier"===t.name){u=i.fromDer(t.value);t.subjectKeyIdentifier=n.util.bytesToHex(u.value)}return t},a.certificationRequestFromAsn1=function(e,t){var r={},s=[];if(!i.validate(e,f,r,s))throw(l=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.")).errors=s,l;if(i.derToOid(r.publicKeyOid)!==a.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var u=a.createCertificationRequest();if(u.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,u.signatureOid=n.asn1.derToOid(r.csrSignatureOid),u.signatureParameters=p(u.signatureOid,r.csrSignatureParams,!0),u.siginfo.algorithmOid=n.asn1.derToOid(r.csrSignatureOid),u.siginfo.parameters=p(u.siginfo.algorithmOid,r.csrSignatureParams,!1),u.signature=r.csrSignature,u.certificationRequestInfo=r.certificationRequestInfo,t){var l;if(u.md=null,u.signatureOid in o)switch(o[u.signatureOid]){case"sha1WithRSAEncryption":u.md=n.md.sha1.create();break;case"md5WithRSAEncryption":u.md=n.md.md5.create();break;case"sha256WithRSAEncryption":u.md=n.md.sha256.create();break;case"sha384WithRSAEncryption":u.md=n.md.sha384.create();break;case"sha512WithRSAEncryption":u.md=n.md.sha512.create();break;case"RSASSA-PSS":u.md=n.md.sha256.create()}if(null===u.md)throw(l=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=u.signatureOid,l;var c=i.toDer(u.certificationRequestInfo);u.md.update(c.getBytes())}var h=n.md.sha1.create();return u.subject.getField=function(e){return d(u.subject,e)},u.subject.addField=function(e){v([e]),u.subject.attributes.push(e)},u.subject.attributes=a.RDNAttributesAsArray(r.certificationRequestInfoSubject,h),u.subject.hash=h.digest().toHex(),u.publicKey=a.publicKeyFromAsn1(r.subjectPublicKeyInfo),u.getAttribute=function(e){return d(u,e)},u.addAttribute=function(e){v([e]),u.attributes.push(e)},u.attributes=a.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),u},a.createCertificationRequest=function(){var e={version:0,signatureOid:null,signature:null,siginfo:{}};return e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return d(e.subject,t)},e.subject.addField=function(t){v([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return d(e,t)},e.addAttribute=function(t){v([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){v(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){v(t),e.attributes=t},e.sign=function(t,r){e.md=r||n.md.sha1.create();var s=o[e.md.algorithm+"WithRSAEncryption"];if(!s){var u=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw u.algorithm=e.md.algorithm,u}e.signatureOid=e.siginfo.algorithmOid=s,e.certificationRequestInfo=a.getCertificationRequestInfo(e);var l=i.toDer(e.certificationRequestInfo);e.md.update(l.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(null===r){if(e.signatureOid in o)switch(o[e.signatureOid]){case"sha1WithRSAEncryption":r=n.md.sha1.create();break;case"md5WithRSAEncryption":r=n.md.md5.create();break;case"sha256WithRSAEncryption":r=n.md.sha256.create();break;case"sha384WithRSAEncryption":r=n.md.sha384.create();break;case"sha512WithRSAEncryption":r=n.md.sha512.create();break;case"RSASSA-PSS":r=n.md.sha256.create()}if(null===r)throw(f=new Error("Could not compute certification request digest. Unknown signature OID.")).signatureOid=e.signatureOid,f;var s=e.certificationRequestInfo||a.getCertificationRequestInfo(e),u=i.toDer(s);r.update(u.getBytes())}if(null!==r){var l;switch(e.signatureOid){case o.sha1WithRSAEncryption:break;case o["RSASSA-PSS"]:var c,h,f;if(void 0===(c=o[e.signatureParameters.mgf.hash.algorithmOid])||void 0===n.md[c])throw(f=new Error("Unsupported MGF hash function.")).oid=e.signatureParameters.mgf.hash.algorithmOid,f.name=c,f;if(void 0===(h=o[e.signatureParameters.mgf.algorithmOid])||void 0===n.mgf[h])throw(f=new Error("Unsupported MGF function.")).oid=e.signatureParameters.mgf.algorithmOid,f.name=h,f;if(h=n.mgf[h].create(n.md[c].create()),void 0===(c=o[e.signatureParameters.hash.algorithmOid])||void 0===n.md[c])throw(f=new Error("Unsupported RSASSA-PSS hash function.")).oid=e.signatureParameters.hash.algorithmOid,f.name=c,f;l=n.pss.create(n.md[c].create(),h,e.signatureParameters.saltLength)}t=e.publicKey.verify(r.digest().getBytes(),e.signature,l)}return t},e};var b=new Date("1950-01-01T00:00:00Z"),w=new Date("2050-01-01T00:00:00Z");function x(e){return e>=b&&e<w?i.create(i.Class.UNIVERSAL,i.Type.UTCTIME,!1,i.dateToUtcTime(e)):i.create(i.Class.UNIVERSAL,i.Type.GENERALIZEDTIME,!1,i.dateToGeneralizedTime(e))}a.getTBSCertificate=function(e){var t=x(e.validity.notBefore),r=x(e.validity.notAfter),o=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,n.util.hexToBytes(e.serialNumber)),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.siginfo.algorithmOid).getBytes()),g(e.siginfo.algorithmOid,e.siginfo.parameters)]),y(e.issuer),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,r]),y(e.subject),a.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,1,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&o.value.push(i.create(i.Class.CONTEXT_SPECIFIC,2,!0,[i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&o.value.push(a.certificateExtensionsToAsn1(e.extensions)),o},a.getCertificationRequestInfo=function(e){return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(e.version).getBytes()),y(e.subject),a.publicKeyToAsn1(e.publicKey),_(e)])},a.distinguishedNameToAsn1=function(e){return y(e)},a.certificateToAsn1=function(e){var t=e.tbsCertificate||a.getTBSCertificate(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),g(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},a.certificateExtensionsToAsn1=function(e){var t=i.create(i.Class.CONTEXT_SPECIFIC,3,!0,[]),r=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(a.certificateExtensionToAsn1(e[n]));return t},a.certificateExtensionToAsn1=function(e){var t=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[]);t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.id).getBytes())),e.critical&&t.value.push(i.create(i.Class.UNIVERSAL,i.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return"string"!==typeof e.value&&(r=i.toDer(r).getBytes()),t.value.push(i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,r)),t},a.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||a.getCertificationRequestInfo(e);return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[t,i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(e.signatureOid).getBytes()),g(e.signatureOid,e.signatureParameters)]),i.create(i.Class.UNIVERSAL,i.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])},a.createCaStore=function(e){var t={certs:{}};function r(e){return o(e),t.certs[e.hash]||null}function o(e){if(!e.hash){var t=n.md.sha1.create();e.attributes=a.RDNAttributesAsArray(y(e),t),e.hash=t.digest().toHex()}}if(t.getIssuer=function(e){return r(e.issuer)},t.addCertificate=function(e){if("string"===typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))if(e.subject.hash in t.certs){var r=t.certs[e.subject.hash];n.util.isArray(r)||(r=[r]),r.push(e),t.certs[e.subject.hash]=r}else t.certs[e.subject.hash]=e},t.hasCertificate=function(e){"string"===typeof e&&(e=n.pki.certificateFromPem(e));var t=r(e.subject);if(!t)return!1;n.util.isArray(t)||(t=[t]);for(var o=i.toDer(a.certificateToAsn1(e)).getBytes(),s=0;s<t.length;++s){if(o===i.toDer(a.certificateToAsn1(t[s])).getBytes())return!0}return!1},t.listAllCertificates=function(){var e=[];for(var r in t.certs)if(t.certs.hasOwnProperty(r)){var i=t.certs[r];if(n.util.isArray(i))for(var a=0;a<i.length;++a)e.push(i[a]);else e.push(i)}return e},t.removeCertificate=function(e){var s;if("string"===typeof e&&(e=n.pki.certificateFromPem(e)),o(e.subject),!t.hasCertificate(e))return null;var u=r(e.subject);if(!n.util.isArray(u))return s=t.certs[e.subject.hash],delete t.certs[e.subject.hash],s;for(var l=i.toDer(a.certificateToAsn1(e)).getBytes(),c=0;c<u.length;++c){l===i.toDer(a.certificateToAsn1(u[c])).getBytes()&&(s=u[c],u.splice(c,1))}return 0===u.length&&delete t.certs[e.subject.hash],s},e)for(var s=0;s<e.length;++s){var u=e[s];t.addCertificate(u)}return t},a.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"},a.verifyCertificateChain=function(e,t,r){"function"===typeof r&&(r={verify:r}),r=r||{};var i=(t=t.slice(0)).slice(0),o=r.validityCheckDate;"undefined"===typeof o&&(o=new Date);var s=!0,u=null,l=0;do{var c=t.shift(),h=null,f=!1;if(o&&(o<c.validity.notBefore||o>c.validity.notAfter)&&(u={message:"Certificate is not valid yet or has expired.",error:a.certificateError.certificate_expired,notBefore:c.validity.notBefore,notAfter:c.validity.notAfter,now:o}),null===u){if(null===(h=t[0]||e.getIssuer(c))&&c.isIssuer(c)&&(f=!0,h=c),h){var d=h;n.util.isArray(d)||(d=[d]);for(var p=!1;!p&&d.length>0;){h=d.shift();try{p=h.verify(c)}catch(x){}}p||(u={message:"Certificate signature is invalid.",error:a.certificateError.bad_certificate})}null!==u||h&&!f||e.hasCertificate(c)||(u={message:"Certificate is not trusted.",error:a.certificateError.unknown_ca})}if(null===u&&h&&!c.isIssuer(h)&&(u={message:"Certificate issuer is invalid.",error:a.certificateError.bad_certificate}),null===u)for(var y={keyUsage:!0,basicConstraints:!0},v=0;null===u&&v<c.extensions.length;++v){var m=c.extensions[v];m.critical&&!(m.name in y)&&(u={message:"Certificate has an unsupported critical extension.",error:a.certificateError.unsupported_certificate})}if(null===u&&(!s||0===t.length&&(!h||f))){var g=c.getExtension("basicConstraints"),_=c.getExtension("keyUsage");if(null!==_&&(_.keyCertSign&&null!==g||(u={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:a.certificateError.bad_certificate})),null!==u||null===g||g.cA||(u={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:a.certificateError.bad_certificate}),null===u&&null!==_&&"pathLenConstraint"in g)l-1>g.pathLenConstraint&&(u={message:"Certificate basicConstraints pathLenConstraint violated.",error:a.certificateError.bad_certificate})}var b=null===u||u.error,w=r.verify?r.verify(b,l,i):b;if(!0!==w)throw!0===b&&(u={message:"The application rejected the certificate.",error:a.certificateError.bad_certificate}),(w||0===w)&&("object"!==typeof w||n.util.isArray(w)?"string"===typeof w&&(u.error=w):(w.message&&(u.message=w.message),w.error&&(u.error=w.error))),u;u=null,s=!1,++l}while(t.length>0);return!0}},function(e,t,r){var n=r(665);r(704),r(667),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,i=e.mgf,a=r.digestLength,o=e.salt||null;if("string"===typeof o&&(o=n.util.createBuffer(o)),"saltLength"in e)t=e.saltLength;else{if(null===o)throw new Error("Salt length not specified or specific salt not given.");t=o.length()}if(null!==o&&o.length()!==t)throw new Error("Given salt length does not match length of given salt.");var s=e.prng||n.random,u={encode:function(e,u){var l,c,h=u-1,f=Math.ceil(h/8),d=e.digest().getBytes();if(f<a+t+2)throw new Error("Message is too long to encrypt.");c=null===o?s.getBytesSync(t):o.bytes();var p=new n.util.ByteBuffer;p.fillWithByte(0,8),p.putBytes(d),p.putBytes(c),r.start(),r.update(p.getBytes());var y=r.digest().getBytes(),v=new n.util.ByteBuffer;v.fillWithByte(0,f-t-a-2),v.putByte(1),v.putBytes(c);var m=v.getBytes(),g=f-a-1,_=i.generate(y,g),b="";for(l=0;l<g;l++)b+=String.fromCharCode(m.charCodeAt(l)^_.charCodeAt(l));var w=65280>>8*f-h&255;return(b=String.fromCharCode(b.charCodeAt(0)&~w)+b.substr(1))+y+String.fromCharCode(188)},verify:function(e,o,s){var u,l=s-1,c=Math.ceil(l/8);if(o=o.substr(-c),c<a+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==o.charCodeAt(c-1))throw new Error("Encoded message does not end in 0xBC.");var h=c-a-1,f=o.substr(0,h),d=o.substr(h,a),p=65280>>8*c-l&255;if(0!==(f.charCodeAt(0)&p))throw new Error("Bits beyond keysize not zero as expected.");var y=i.generate(d,h),v="";for(u=0;u<h;u++)v+=String.fromCharCode(f.charCodeAt(u)^y.charCodeAt(u));v=String.fromCharCode(v.charCodeAt(0)&~p)+v.substr(1);var m=c-a-t-2;for(u=0;u<m;u++)if(0!==v.charCodeAt(u))throw new Error("Leftmost octets not zero as expected");if(1!==v.charCodeAt(m))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var g=v.substr(-t),_=new n.util.ByteBuffer;return _.fillWithByte(0,8),_.putBytes(e),_.putBytes(g),r.start(),r.update(_.getBytes()),d===r.digest().getBytes()}};return u}},function(e,t,r){"use strict";(function(t){var n=r(127),i=r(1180);function a(e,t,r,i){if("function"===typeof r&&(i=r,r=void 0),!i)throw new Error("Missing callback");a.digest(e,t,r,(function(e,a){if(e)return i(e);i(null,n.encode(a,t,r))}))}e.exports=a,a.Buffer=t,a.multihash=n,a.digest=function(e,t,r,n){if("function"===typeof r&&(n=r,r=void 0),!n)throw new Error("Missing callback");var i,o=n;r&&(o=function(e,t){if(e)return n(e);n(null,t.slice(0,r))});try{i=a.createHash(t)}catch(s){return o(s)}i(e,o)},a.createHash=function(e){if(e=n.coerceCode(e),!a.functions[e])throw new Error("multihash function "+e+" not yet supported");return a.functions[e]},a.functions={17:i.sha1,18:i.sha2256,19:i.sha2512,20:i.sha3512,21:i.sha3384,22:i.sha3256,23:i.sha3224,24:i.shake128,25:i.shake256,26:i.keccak224,27:i.keccak256,28:i.keccak384,29:i.keccak512,34:i.murmur3128,35:i.murmur332,86:i.dblSha2256},i.addBlake(a.functions),a.validate=function(e,r,i){a(e,n.decode(r).name,(function(e,n){if(e)return i(e);i(e,0===t.compare(r,n))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(e,r){t.toCallback=function(t){return function(r,n){var i;try{i=t(r)}catch(a){return void e.nextTick(n,a)}e.nextTick(n,null,i)}},t.toBuf=function(e,t){return function(n){var i=e(n,t);return r.from(i,"hex")}},t.fromString=function(e,t){return function(n){var i=r.isBuffer(n)?n.toString():n;return e(i,t)}},t.fromNumberTo32BitBuf=function(e,t){return function(n){for(var i=e(n,t),a=new Array(4),o=0;o<4;o++)a[o]=255&i,i>>=8;return r.from(a)}}}).call(this,r(21),r(10).Buffer)},function(e){e.exports=JSON.parse('{"COMPRESSED_TYPE_INVALID":"compressed should be a boolean","EC_PRIVATE_KEY_TYPE_INVALID":"private key should be a Buffer","EC_PRIVATE_KEY_LENGTH_INVALID":"private key length is invalid","EC_PRIVATE_KEY_RANGE_INVALID":"private key range is invalid","EC_PRIVATE_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting private key is invalid","EC_PRIVATE_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PRIVATE_KEY_EXPORT_DER_FAIL":"couldn\'t export to DER format","EC_PRIVATE_KEY_IMPORT_DER_FAIL":"couldn\'t import from DER format","EC_PUBLIC_KEYS_TYPE_INVALID":"public keys should be an Array","EC_PUBLIC_KEYS_LENGTH_INVALID":"public keys Array should have at least 1 element","EC_PUBLIC_KEY_TYPE_INVALID":"public key should be a Buffer","EC_PUBLIC_KEY_LENGTH_INVALID":"public key length is invalid","EC_PUBLIC_KEY_PARSE_FAIL":"the public key could not be parsed or is invalid","EC_PUBLIC_KEY_CREATE_FAIL":"private was invalid, try again","EC_PUBLIC_KEY_TWEAK_ADD_FAIL":"tweak out of range or resulting public key is invalid","EC_PUBLIC_KEY_TWEAK_MUL_FAIL":"tweak out of range","EC_PUBLIC_KEY_COMBINE_FAIL":"the sum of the public keys is not valid","ECDH_FAIL":"scalar was invalid (zero or overflow)","ECDSA_SIGNATURE_TYPE_INVALID":"signature should be a Buffer","ECDSA_SIGNATURE_LENGTH_INVALID":"signature length is invalid","ECDSA_SIGNATURE_PARSE_FAIL":"couldn\'t parse signature","ECDSA_SIGNATURE_PARSE_DER_FAIL":"couldn\'t parse DER signature","ECDSA_SIGNATURE_SERIALIZE_DER_FAIL":"couldn\'t serialize signature to DER format","ECDSA_SIGN_FAIL":"nonce generation function failed or private key is invalid","ECDSA_RECOVER_FAIL":"couldn\'t recover public key from signature","MSG32_TYPE_INVALID":"message should be a Buffer","MSG32_LENGTH_INVALID":"message length is invalid","OPTIONS_TYPE_INVALID":"options should be an Object","OPTIONS_DATA_TYPE_INVALID":"options.data should be a Buffer","OPTIONS_DATA_LENGTH_INVALID":"options.data length is invalid","OPTIONS_NONCEFN_TYPE_INVALID":"options.noncefn should be a Function","RECOVERY_ID_TYPE_INVALID":"recovery should be a Number","RECOVERY_ID_VALUE_INVALID":"recovery should have value between -1 and 4","TWEAK_TYPE_INVALID":"tweak should be a Buffer","TWEAK_LENGTH_INVALID":"tweak length is invalid"}')},function(e,t,r){"use strict";var n=r(17).Buffer,i=r(765),a=r(899);function o(e,t){null===e&&null===t?(this.x=this.y=null,this.inf=!0):(this.x=e,this.y=t,this.inf=!1)}o.fromPublicKey=function(e){var t,r,n=e[0];return 33!==e.length||2!==n&&3!==n?65!==e.length||4!==n&&6!==n&&7!==n?null:(t=i.fromBuffer(e.slice(1,33)),r=i.fromBuffer(e.slice(33,65)),t.ucmp(i.p)>=0||r.ucmp(i.p)>=0?null:6!==n&&7!==n||r.isOdd()===(7===n)?0!==t.redSqr().redMul(t).redIAdd7().ucmp(r.redSqr())?null:new o(t,r):null):(t=i.fromBuffer(e.slice(1,33))).ucmp(i.p)>=0||null===(r=t.redSqr().redMul(t).redIAdd7().redSqrt())?null:(3===n!==r.isOdd()&&(r=r.redNeg()),new o(t,r))},o.prototype.toPublicKey=function(e){var t,r=this.x,i=this.y;return e?((t=n.alloc(33))[0]=i.isOdd()?3:2,r.toBuffer().copy(t,1)):((t=n.alloc(65))[0]=4,r.toBuffer().copy(t,1),i.toBuffer().copy(t,33)),t},o.fromECJPoint=function(e){if(e.inf)return new o(null,null);var t=e.z.redInvm(),r=t.redSqr();return new o(e.x.redMul(r),e.y.redMul(r).redMul(t))},o.prototype.toECJPoint=function(){return this.inf?new a(null,null,null):new a(this.x,this.y,a.one)},o.prototype.neg=function(){return this.inf?this:new o(this.x,this.y.redNeg())},o.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(0===this.x.ucmp(e.x))return 0===this.y.ucmp(e.y)?this.dbl():new o(null,null);var t=this.y.redSub(e.y);t.isZero()||(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x);return new o(r,t.redMul(this.x.redSub(r)).redISub(this.y))},o.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.isZero())return new o(null,null);var t=this.x.redSqr(),r=t.redAdd(t).redIAdd(t).redMul(e.redInvm()),n=r.redSqr().redISub(this.x.redAdd(this.x));return new o(n,r.redMul(this.x.redSub(n)).redISub(this.y))},o.prototype.mul=function(e){for(var t=this._getNAFPoints(4),r=t.points,n=e.getNAF(t.wnd),i=new a(null,null,null),s=n.length-1;s>=0;s--){for(var u=0;s>=0&&0===n[s];s--,++u);if(s>=0&&(u+=1),i=i.dblp(u),s<0)break;var l=n[s];i=l>0?i.mixedAdd(r[l-1>>1]):i.mixedAdd(r[-l-1>>1].neg())}return o.fromECJPoint(i)},o.prototype._getNAFPoints1=function(){return{wnd:1,points:[this]}},o.prototype._getNAFPoints=function(e){var t=new Array((1<<e)-1);t[0]=this;for(var r=this.dbl(),n=1;n<t.length;++n)t[n]=t[n-1].add(r);return{wnd:e,points:t}},e.exports=o},function(e,t,r){"use strict";var n=r(765);function i(e,t,r){null===e&&null===t&&null===r?(this.x=i.one,this.y=i.one,this.z=i.zero):(this.x=e,this.y=t,this.z=r),this.zOne=this.z===i.one}i.zero=n.fromNumber(0),i.one=n.fromNumber(1),i.prototype.neg=function(){return this.inf?this:new i(this.x,this.y.redNeg(),this.z)},i.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),a=e.x.redMul(r),o=this.y.redMul(t).redMul(e.z),s=e.y.redMul(r).redMul(this.z),u=n.redSub(a),l=o.redSub(s);if(u.isZero())return l.isZero()?this.dbl():new i(null,null,null);var c=u.redSqr(),h=n.redMul(c),f=c.redMul(u),d=l.redSqr().redIAdd(f).redISub(h).redISub(h);return new i(d,l.redMul(h.redISub(d)).redISub(o.redMul(f)),this.z.redMul(e.z).redMul(u))},i.prototype.mixedAdd=function(e){if(this.inf)return e.toECJPoint();if(e.inf)return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),a=this.y,o=e.y.redMul(t).redMul(this.z),s=r.redSub(n),u=a.redSub(o);if(s.isZero())return u.isZero()?this.dbl():new i(null,null,null);var l=s.redSqr(),c=r.redMul(l),h=l.redMul(s),f=u.redSqr().redIAdd(h).redISub(c).redISub(c);return new i(f,u.redMul(c.redISub(f)).redISub(a.redMul(h)),this.z.redMul(s))},i.prototype.dbl=function(){if(this.inf)return this;var e,t,r;if(this.zOne){var n=this.x.redSqr(),a=this.y.redSqr(),o=a.redSqr(),s=this.x.redAdd(a).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var u=n.redAdd(n).redIAdd(n),l=u.redSqr().redISub(s).redISub(s),c=o.redIAdd(o).redIAdd(o).redIAdd(o);e=l,t=u.redMul(s.redISub(l)).redISub(c),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),f=this.y.redSqr(),d=f.redSqr(),p=this.x.redAdd(f).redSqr().redISub(h).redISub(d);p=p.redIAdd(p);var y=h.redAdd(h).redIAdd(h),v=y.redSqr(),m=d.redIAdd(d).redIAdd(d).redIAdd(d);e=v.redISub(p).redISub(p),t=y.redMul(p.redISub(e)).redISub(m),r=(r=this.y.redMul(this.z)).redIAdd(r)}return new i(e,t,r)},i.prototype.dblp=function(e){if(0===e||this.inf)return this;for(var t=this,r=0;r<e;r++)t=t.dbl();return t},Object.defineProperty(i.prototype,"inf",{enumerable:!0,get:function(){return this.z.isZero()}}),e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(803),a=(n=i)&&n.__esModule?n:{default:n};t.default=a.default,e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(t=(0,a.default)(t||i.default),!(0,n.default)(e))return t(new Error("First argument to waterfall must be an array of functions"));if(!e.length)return t();var r=0;function l(t){var n=(0,u.default)(e[r++]);t.push((0,s.default)(c)),n.apply(null,t)}function c(n){if(n||r===e.length)return t.apply(null,arguments);l((0,o.default)(arguments,1))}l([])};var n=l(r(132)),i=l(r(133)),a=l(r(902)),o=l(r(764)),s=l(r(806)),u=l(r(807));function l(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){if(null!==e){var t=e;e=null,t.apply(this,arguments)}}},e.exports=t.default},function(e,t,r){"use strict";var n=r(688);e.exports={ensureMultiaddr:function(e){return n.isMultiaddr(e)?e:n(e)}}},function(e,t,r){"use strict";var n=r(662),i=r(744),a=r(680),o=r(809).isSource,s=r(707),u=r(745),l=r(1259);e.exports=function(e){var t=u(e,"add"),r=n((function(e,r,n){"function"===typeof r&&(n=r,r=null);var o=a(n);r||(r={}),r.converter=s;try{l(e)}catch(f){return o(f)}var u=[].concat(e),c=t({qs:r}),h=i((function(e){return o(null,e)}));c.once("error",o),c.pipe(h),u.forEach((function(e){return c.write(e)})),c.end()}));return function(){var e=Array.from(arguments);return 1===e.length&&o(e[0])&&e.push({}),r.apply(null,e)}}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(906),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1205);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1206),y=r(907),v=r(908).getHighWaterMark,m=r(705).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(706),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(706),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1208)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1209)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(705).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(906),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(907),f=r(908).getHighWaterMark,d=r(705).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(706),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(706));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(705).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(706);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t){var r=Object.prototype.toString;function n(e){return"function"===typeof e.constructor?e.constructor.name:null}e.exports=function(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;if("boolean"===t)return"boolean";if("string"===t)return"string";if("number"===t)return"number";if("symbol"===t)return"symbol";if("function"===t)return"GeneratorFunction"===n(e)?"generatorfunction":"function";if(function(e){return Array.isArray?Array.isArray(e):e instanceof Array}(e))return"array";if(function(e){if(e.constructor&&"function"===typeof e.constructor.isBuffer)return e.constructor.isBuffer(e);return!1}(e))return"buffer";if(function(e){try{if("number"===typeof e.length&&"function"===typeof e.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(e))return"arguments";if(function(e){return e instanceof Date||"function"===typeof e.toDateString&&"function"===typeof e.getDate&&"function"===typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"===typeof e.message&&e.constructor&&"number"===typeof e.constructor.stackTraceLimit}(e))return"error";if(function(e){return e instanceof RegExp||"string"===typeof e.flags&&"boolean"===typeof e.ignoreCase&&"boolean"===typeof e.multiline&&"boolean"===typeof e.global}(e))return"regexp";switch(n(e)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(e){return"function"===typeof e.throw&&"function"===typeof e.return&&"function"===typeof e.next}(e))return"generator";switch(t=r.call(e)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(913),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1239);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1240),y=r(914),v=r(915).getHighWaterMark,m=r(708).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(709),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(709),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1242)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1243)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(708).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(913),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(914),f=r(915).getHighWaterMark,d=r(708).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(709),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(709));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(708).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(709);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){"use strict";e.exports={supportsFileReader:"undefined"!==typeof self&&"FileReader"in self}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(920),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1248);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1249),y=r(921),v=r(922).getHighWaterMark,m=r(710).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(711),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(711),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1251)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1252)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(710).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(920),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(921),f=r(922).getHighWaterMark,d=r(710).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(711),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(711));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(710).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(711);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=self.location?self.location.protocol+"//"+self.location.host:"",o=self.URL,s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a;n(this,e),this.super=new o(t,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}return i(e,[{key:"createObjectURL",value:function(e){return this.super.createObjectURL(e)}},{key:"revokeObjectURL",value:function(e){this.super.revokeObjectURL(e)}},{key:"toJSON",value:function(){return this.super.toJSON()}},{key:"toString",value:function(){return this.super.toString()}},{key:"format",value:function(){return this.toString()}},{key:"hash",get:function(){return this.super.hash},set:function(e){this.super.hash=e}},{key:"host",get:function(){return this.super.host},set:function(e){this.super.host=e}},{key:"hostname",get:function(){return this.super.hostname},set:function(e){this.super.hostname=e}},{key:"href",get:function(){return this.super.href},set:function(e){this.super.href=e}},{key:"origin",get:function(){return this.super.origin},set:function(e){this.super.origin=e}},{key:"password",get:function(){return this.super.password},set:function(e){this.super.password=e}},{key:"pathname",get:function(){return this.super.pathname},set:function(e){this.super.pathname=e}},{key:"port",get:function(){return this.super.port},set:function(e){this.super.port=e}},{key:"protocol",get:function(){return this.super.protocol},set:function(e){this.super.protocol=e}},{key:"search",get:function(){return this.super.search},set:function(e){this.super.search=e}},{key:"searchParams",get:function(){return this.super.searchParams},set:function(e){this.super.searchParams=e}},{key:"username",get:function(){return this.super.username},set:function(e){this.super.username=e}}]),e}();e.exports={URLWithLegacySupport:s,URLSearchParams:self.URLSearchParams,defaultBase:a,format:function(e){if("string"===typeof e)return new o(e).toString();if(!(e instanceof o)){var t=e.username&&e.password?"".concat(e.username,":").concat(e.password,"@"):"",r=e.auth?e.auth+"@":"",n=e.port?":"+e.port:"",i=e.protocol?e.protocol+"//":"",a=e.host||"",s=e.hostname||"",u=e.search||(e.query?"?"+e.query:""),l=e.hash||"",c=e.pathname||"",h=e.path||c+u;return"".concat(i).concat(t||r).concat(a||s+n).concat(h).concat(l)}}}},function(e,t,r){var n=r(1267),i=n,a=self.URL;e.exports={http:n,https:i,getRequest:function(e,t){var r="http:";"string"===typeof e?r=new a(e).protocol:e.protocol&&(r=e.protocol);return"http:"===r?n.request(e,t):i.request(e,t)}}},function(e,t){function r(e){return"function"===typeof e}e.exports={fetch:"fetch"in self&&r(self.fecth),writableStream:"WritableStream"in self&&r(self.WritableStream),abortController:"AbortController"in self&&r(self.AbortController),arrayBuffer:"ArrayBuffer"in self}},function(e,t,r){(function(t,n){var i=r(927),a=r(14),o=r(929),s=function(e,r,a){var s=this;if(o.Readable.call(this),this._mode=r,this.headers={},this.rawHeaders=[],this.trailers={},this.rawTrailers=[],this.on("end",(function(){t.nextTick((function(){return s.emit("close")}))})),this._fetchResponse=e,this.url=e.url,this.statusCode=e.status,this.statusMessage=e.statusText,e.headers.forEach((function(e,t){s.headers[t.toLowerCase()]=e,s.rawHeaders.push(t,e)})),i.writableStream){var u=new WritableStream({write:function(e){return new Promise((function(t,r){s._destroyed?r():s.push(n.from(e))?t():s._resumeFetch=t}))},close:function(){clearTimeout(a),s._destroyed||s.push(null)},abort:function(e){s._destroyed||s.emit("error",e)}});try{return void e.body.pipeTo(u).catch((function(e){console.log(e),self.clearTimeout(a),s._destroyed||s.emit("error",e)}))}catch(c){}}var l=e.body.getReader();!function e(t){l.read().then((function(r){if(!t._destroyed){if(r.done)return clearTimeout(a),void t.push(null);t.push(n.from(r.value)),e(t)}})).catch((function(e){clearTimeout(a),t._destroyed||t.emit("error",e)}))}(this)};a(s,o.Readable),s.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},e.exports=s}).call(this,r(21),r(10).Buffer)},function(e,t,r){(t=e.exports=r(930)).Stream=t,t.Readable=t,t.Writable=r(934),t.Duplex=r(713),t.Transform=r(935),t.PassThrough=r(1274),t.finished=r(814),t.pipeline=r(1275)},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(931),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1269);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1270),y=r(932),v=r(933).getHighWaterMark,m=r(712).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(713),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(713),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1272)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1273)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(712).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(931),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(932),f=r(933).getHighWaterMark,d=r(712).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(713),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(713));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(712).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(713);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(937),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1279);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1280),y=r(938),v=r(939).getHighWaterMark,m=r(714).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(715),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(715),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1282)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1283)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(714).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(937),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(938),f=r(939).getHighWaterMark,d=r(714).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(715),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(715));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(714).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(715);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t){e.exports=function(){var e,t,r,n,i=function(i,a){e?e(i,a):i?(n=i,r=a):t=a};return i.resolve=function(i){if(e)throw new Error("already resolved");if(!(e=i))throw new Error("no read cannot resolve!"+e);t&&i(null,t),r&&i(n,r)},i.abort=function(e){i.resolve((function(t,r){r(e||!0)}))},i}},function(e,t){e.exports=function(e){var t,r=!1;function n(n){if(!n)throw new Error("must be passed a readable");t=n,r&&e(t)}return n.resolve=n.ready=n.start=function(i){return r=!0,e=i||e,t&&e(t),n},n}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(945),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1295);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1296),y=r(946),v=r(947).getHighWaterMark,m=r(716).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(717),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(717),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1298)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1299)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(716).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(945),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(946),f=r(947).getHighWaterMark,d=r(716).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(717),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(717));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(716).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(717);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){(function(e){var r=e.alloc,n="0".charCodeAt(0),i=e.from("ustar\0","binary"),a=e.from("00","binary"),o=e.from("ustar ","binary"),s=e.from(" \0","binary"),u=parseInt("7777",8),l=257,c=function(e,t,r,n){for(;r<n;r++)if(e[r]===t)return r;return n},h=function(e){for(var t=256,r=0;r<148;r++)t+=e[r];for(var n=156;n<512;n++)t+=e[n];return t},f=function(e,t){return(e=e.toString(8)).length>t?"7777777777777777777".slice(0,t)+" ":"0000000000000000000".slice(0,t-e.length)+e+" "};var d=function(e,t,r){if(128&(e=e.slice(t,t+r))[t=0])return function(e){var t;if(128===e[0])t=!0;else{if(255!==e[0])return null;t=!1}for(var r=[],n=e.length-1;n>0;n--){var i=e[n];t?r.push(i):r.push(255-i)}var a=0,o=r.length;for(n=0;n<o;n++)a+=r[n]*Math.pow(256,n);return t?a:-1*a}(e);for(;t<e.length&&32===e[t];)t++;for(var n=(i=c(e,32,t,e.length),a=e.length,o=e.length,"number"!==typeof i?o:(i=~~i)>=a?a:i>=0||(i+=a)>=0?i:0);t<n&&0===e[t];)t++;return n===t?0:parseInt(e.slice(t,n).toString(),8);var i,a,o},p=function(e,t,r,n){return e.slice(t,c(e,0,t,t+r)).toString(n)},y=function(t){var r=e.byteLength(t),n=Math.floor(Math.log(r)/Math.log(10))+1;return r+n>=Math.pow(10,n)&&n++,r+n+t};t.decodeLongPath=function(e,t){return p(e,0,e.length,t)},t.encodePax=function(t){var r="";t.name&&(r+=y(" path="+t.name+"\n")),t.linkname&&(r+=y(" linkpath="+t.linkname+"\n"));var n=t.pax;if(n)for(var i in n)r+=y(" "+i+"="+n[i]+"\n");return e.from(r)},t.decodePax=function(e){for(var t={};e.length;){for(var r=0;r<e.length&&32!==e[r];)r++;var n=parseInt(e.slice(0,r).toString(),10);if(!n)return t;var i=e.slice(r+1,n-1).toString(),a=i.indexOf("=");if(-1===a)return t;t[i.slice(0,a)]=i.slice(a+1),e=e.slice(n)}return t},t.encode=function(t){var o=r(512),s=t.name,c="";if(5===t.typeflag&&"/"!==s[s.length-1]&&(s+="/"),e.byteLength(s)!==s.length)return null;for(;e.byteLength(s)>100;){var d=s.indexOf("/");if(-1===d)return null;c+=c?"/"+s.slice(0,d):s.slice(0,d),s=s.slice(d+1)}return e.byteLength(s)>100||e.byteLength(c)>155||t.linkname&&e.byteLength(t.linkname)>100?null:(o.write(s),o.write(f(t.mode&u,6),100),o.write(f(t.uid,6),108),o.write(f(t.gid,6),116),o.write(f(t.size,11),124),o.write(f(t.mtime.getTime()/1e3|0,11),136),o[156]=n+function(e){switch(e){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72}return 0}(t.type),t.linkname&&o.write(t.linkname,157),i.copy(o,l),a.copy(o,263),t.uname&&o.write(t.uname,265),t.gname&&o.write(t.gname,297),o.write(f(t.devmajor||0,6),329),o.write(f(t.devminor||0,6),337),c&&o.write(c,345),o.write(f(h(o),6),148),o)},t.decode=function(e,t,r){var a=0===e[156]?0:e[156]-n,u=p(e,0,100,t),c=d(e,100,8),f=d(e,108,8),y=d(e,116,8),v=d(e,124,12),m=d(e,136,12),g=function(e){switch(e){case 0:return"file";case 1:return"link";case 2:return"symlink";case 3:return"character-device";case 4:return"block-device";case 5:return"directory";case 6:return"fifo";case 7:return"contiguous-file";case 72:return"pax-header";case 55:return"pax-global-header";case 27:return"gnu-long-link-path";case 28:case 30:return"gnu-long-path"}return null}(a),_=0===e[157]?null:p(e,157,100,t),b=p(e,265,32),w=p(e,297,32),x=d(e,329,8),k=d(e,337,8),E=h(e);if(256===E)return null;if(E!==d(e,148,8))throw new Error("Invalid tar header. Maybe the tar is corrupted or it needs to be gunzipped?");if(0===i.compare(e,l,263))e[345]&&(u=p(e,345,155,t)+"/"+u);else if(0===o.compare(e,l,263)&&0===s.compare(e,263,265));else if(!r)throw new Error("Invalid tar header: unknown format.");return 0===a&&u&&"/"===u[u.length-1]&&(a=5),{name:u,mode:c,uid:f,gid:y,size:v,mtime:new Date(1e3*m),type:g,linkname:_,uname:b,gname:w,devmajor:x,devminor:k}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(1309);e.exports=function(){return{"api-path":"/api/v0/","user-agent":"/node-".concat(n.name,"/").concat(n.version,"/"),host:"localhost",port:"5001",protocol:"http"}}},function(e,t,r){"use strict";(function(t){var n=r(67),i=r(1310),a=r(823).encode,o=r(746),s=r(825),u=r(675),l=r(680),c=r(926).getRequest,h=r(698),f=r(1341),d=r(1342)("ipfs-http-client:request");function p(e){return e.headers["content-type"]&&0===e.headers["content-type"].indexOf("application/json")}function y(e,t){return function(r){var n=Boolean(r.headers["x-stream-output"]),i=Boolean(r.headers["x-chunked-output"]),a=p(r);if(r.req?d(r.req.method,"".concat(r.req.getHeaders().host).concat(r.req.path),r.statusCode,r.statusMessage):d(r.url,r.statusCode,r.statusMessage),r.statusCode>=400||!r.statusCode)return function(e,t){var r=new Error("Server responded with ".concat(e.statusCode));if(r.statusCode=e.statusCode,!p(e))return h(e,(function(e,n){n&&n.length&&(r.message=n.toString()),t(r)}));f(e,(function(e,n){if(e)return t(e);n&&(r.code=n.Code,r.message=n.Message||n.toString(),r.type=n.Type),t(r)}))}(r,t);if(n&&!e)return t(null,r);if(i&&a){var o=s.parse();return u(r,o),r.on("end",(function(){var e=r.trailers["x-stream-error"];if(e){try{e=JSON.parse(e)}catch(t){e={Message:e}}o.emit("error",new Error(e.Message))}})),t(null,o)}return a?f(r,t):h(r,t)}}e.exports=function(e){var r=function(r,s){return"object"!==typeof r?s(new Error("no options were passed")):function(e,r,s){s=l(s),r.qs=r.qs||{},Array.isArray(r.path)&&(r.path=r.path.join("/")),r.args&&!Array.isArray(r.args)&&(r.args=[r.args]),r.args&&(r.qs.arg=r.args),r.progress&&(r.qs.progress=!0),r.qs.r&&(r.qs.recursive=r.qs.r,delete r.qs.r),r.qs["stream-channels"]=!0,r.stream&&(r.buffer=!1),delete r.qs.followSymlinks;var u=Object.assign({},e.headers);if(o&&(u["User-Agent"]=e["user-agent"]),r.multipart){if(!r.multipartBoundary)return s(new Error("No multipartBoundary"));u["Content-Type"]="multipart/form-data; boundary=".concat(r.multipartBoundary)}var h=i.stringify(r.qs,{arrayFormat:"repeat",encoder:function(e){if(t.isBuffer(e)){var r,i="",o=n(e);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(s>=65&&s<=90||s>=97&&s<=122||s>=48&&s<=57||45===s||46===s||95===s||126===s)i+=String.fromCharCode(s);else{var u=s.toString(16),l=1===u.length?"0".concat(u):u;i+="%".concat(l)}}}catch(c){o.e(c)}finally{o.f()}return i}return a(e)}}),f={hostname:e.host,path:"".concat(e["api-path"]).concat(r.path,"?").concat(h),port:e.port,method:"POST",headers:u,protocol:"".concat(e.protocol,":")},d=c(f,y(r.buffer,s));return d.on("error",(function(e){s(e)})),r.stream||d.end(),d}(e,r,s)};return r.andTransform=function(e,t,n){return r(e,(function(e,r){if(e)return n(e);t(r,n)}))},r}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(954),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1324);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1325),y=r(955),v=r(956).getHighWaterMark,m=r(718).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(719),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(719),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1327)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1328)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(718).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(954),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(955),f=r(956).getHighWaterMark,d=r(718).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(719),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(719));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(718).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(719);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,r){"use strict";(function(t,n){var i;e.exports=S,S.ReadableState=E;r(29).EventEmitter;var a=function(e,t){return e.listeners(t).length},o=r(960),s=r(10).Buffer,u=t.Uint8Array||function(){};var l,c=r(1333);l=c&&c.debuglog?c.debuglog("stream"):function(){};var h,f,d,p=r(1334),y=r(961),v=r(962).getHighWaterMark,m=r(720).codes,g=m.ERR_INVALID_ARG_TYPE,_=m.ERR_STREAM_PUSH_AFTER_EOF,b=m.ERR_METHOD_NOT_IMPLEMENTED,w=m.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(14)(S,o);var x=y.errorOrDestroy,k=["error","close","destroy","pause","resume"];function E(e,t,n){i=i||r(721),e=e||{},"boolean"!==typeof n&&(n=t instanceof i),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=v(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=r(66).StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function S(e){if(i=i||r(721),!(this instanceof S))return new S(e);var t=this instanceof i;this._readableState=new E(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),o.call(this)}function T(e,t,r,n,i){l("readableAddChunk",t);var a,o=e._readableState;if(null===t)o.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,t.sync?R(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,M(e)))}(e,o);else if(i||(a=function(e,t){var r;n=t,s.isBuffer(n)||n instanceof u||"string"===typeof t||void 0===t||e.objectMode||(r=new g("chunk",["string","Buffer","Uint8Array"],t));var n;return r}(o,t)),a)x(e,a);else if(o.objectMode||t&&t.length>0)if("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),n)o.endEmitted?x(e,new w):A(e,o,t,!0);else if(o.ended)x(e,new _);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?A(e,o,t,!1):P(e,o)):A(e,o,t,!1)}else n||(o.reading=!1,P(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&R(e)),P(e,t)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),S.prototype.destroy=y.destroy,S.prototype._undestroy=y.undestroy,S.prototype._destroy=function(e,t){t(e)},S.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=s.from(e,t),t=""),r=!0),T(this,e,t,!1,r)},S.prototype.unshift=function(e){return T(this,e,null,!0,!1)},S.prototype.isPaused=function(){return!1===this._readableState.flowing},S.prototype.setEncoding=function(e){h||(h=r(66).StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,i="";null!==n;)i+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var C=1073741824;function I(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=C?e=C:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function R(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(M,e))}function M(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,N(e)}function P(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(O,e,t))}function O(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var r=t.length;if(l("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function L(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function B(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function z(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r);var r}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var r=t._writableState;(!r||r.autoDestroy&&r.finished)&&t.destroy()}}function U(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}S.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):R(this),null;if(0===(e=I(e,t))&&t.ended)return 0===t.length&&F(this),null;var n,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=I(r,t))),null===(n=e>0?z(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&F(this)),null!==n&&this.emit("data",n),n},S.prototype._read=function(e){x(this,new b("_read()"))},S.prototype.pipe=function(e,t){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=e;break;case 1:i.pipes=[i.pipes,e];break;default:i.pipes.push(e)}i.pipesCount+=1,l("pipe count=%d opts=%j",i.pipesCount,t);var o=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:v;function s(t,n){l("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",y),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),r.removeListener("end",u),r.removeListener("end",v),r.removeListener("data",f),h=!0,!i.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}i.endEmitted?n.nextTick(o):r.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,N(e))}}(r);e.on("drain",c);var h=!1;function f(t){l("ondata");var n=e.write(t);l("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===e||i.pipesCount>1&&-1!==U(i.pipes,e))&&!h&&(l("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function d(t){l("onerror",t),v(),e.removeListener("error",d),0===a(e,"error")&&x(e,t)}function p(){e.removeListener("finish",y),v()}function y(){l("onfinish"),e.removeListener("close",p),v()}function v(){l("unpipe"),r.unpipe(e)}return r.on("data",f),function(e,t,r){if("function"===typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",d),e.once("close",p),e.once("finish",y),e.emit("pipe",r),i.flowing||(l("pipe resume"),r.resume()),e},S.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,{hasUnpiped:!1});return this}var o=U(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},S.prototype.on=function(e,t){var r=o.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,l("on readable",i.length,i.reading),i.length?R(this):i.reading||n.nextTick(D,this))),r},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(e,t){var r=o.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(L,this),r},S.prototype.removeAllListeners=function(e){var t=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(L,this),t},S.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(B,e,t))}(this,e)),e.paused=!1,this},S.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},S.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),r.decoder&&(i=r.decoder.write(i)),!r.objectMode||null!==i&&void 0!==i)&&((r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<k.length;a++)e.on(k[a],this.emit.bind(this,k[a]));return this._read=function(t){l("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(S.prototype[Symbol.asyncIterator]=function(){return void 0===f&&(f=r(1336)),f(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),S._fromList=z,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(S.from=function(e,t){return void 0===d&&(d=r(1337)),d(S,e,t)})}).call(this,r(22),r(21))},function(e,t,r){e.exports=r(29).EventEmitter},function(e,t,r){"use strict";(function(t){function r(e,t){i(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,a){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(a?a(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(i,this,e)):t.nextTick(i,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!a&&e?o._writableState?o._writableState.errorEmitted?t.nextTick(n,o):(o._writableState.errorEmitted=!0,t.nextTick(r,o,e)):t.nextTick(r,o,e):a?(t.nextTick(n,o),a(e)):t.nextTick(n,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var r=e._readableState,n=e._writableState;r&&r.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,r(21))},function(e,t,r){"use strict";var n=r(720).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var a=function(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}(t,i,r);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new n(i?r:"highWaterMark",a);return Math.floor(a)}return e.objectMode?16:16384}}},function(e,t,r){"use strict";(function(t,n){function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var a;e.exports=S,S.WritableState=E;var o={deprecate:r(128)},s=r(960),u=r(10).Buffer,l=t.Uint8Array||function(){};var c,h=r(961),f=r(962).getHighWaterMark,d=r(720).codes,p=d.ERR_INVALID_ARG_TYPE,y=d.ERR_METHOD_NOT_IMPLEMENTED,v=d.ERR_MULTIPLE_CALLBACK,m=d.ERR_STREAM_CANNOT_PIPE,g=d.ERR_STREAM_DESTROYED,_=d.ERR_STREAM_NULL_VALUES,b=d.ERR_STREAM_WRITE_AFTER_END,w=d.ERR_UNKNOWN_ENCODING,x=h.errorOrDestroy;function k(){}function E(e,t,o){a=a||r(721),e=e||{},"boolean"!==typeof o&&(o=t instanceof a),this.objectMode=!!e.objectMode,o&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=f(this,e,"writableHighWaterMark",o),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,i=r.sync,a=r.writecb;if("function"!==typeof a)throw new v;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,i,a){--t.pendingcb,r?(n.nextTick(a,i),n.nextTick(M,e,t),e._writableState.errorEmitted=!0,x(e,i)):(a(i),e._writableState.errorEmitted=!0,x(e,i),M(e,t))}(e,r,i,t,a);else{var o=I(r)||e.destroyed;o||r.corked||r.bufferProcessing||!r.bufferedRequest||C(e,r),i?n.nextTick(A,e,r,o,a):A(e,r,o,a)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function S(e){var t=this instanceof(a=a||r(721));if(!t&&!c.call(S,this))return new S(e);this._writableState=new E(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),s.call(this)}function T(e,t,r,n,i,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new g("write")):r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function A(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),M(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,a=new Array(n),o=t.corkedRequestsFree;o.entry=r;for(var s=0,u=!0;r;)a[s]=r,r.isBuf||(u=!1),r=r.next,s+=1;a.allBuffers=u,T(e,t,!0,t.length,a,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,c=r.encoding,h=r.callback;if(T(e,t,!1,t.objectMode?1:l.length,l,c,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function I(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final((function(r){t.pendingcb--,r&&x(e,r),t.prefinished=!0,e.emit("prefinish"),M(e,t)}))}function M(e,t){var r=I(t);if(r&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(R,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var i=e._readableState;(!i||i.autoDestroy&&i.endEmitted)&&e.destroy()}return r}r(14)(S,s),E.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(E.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return!!c.call(this,e)||this===S&&(e&&e._writableState instanceof E)}})):c=function(e){return e instanceof this},S.prototype.pipe=function(){x(this,new m)},S.prototype.write=function(e,t,r){var i,a=this._writableState,o=!1,s=!a.objectMode&&(i=e,u.isBuffer(i)||i instanceof l);return s&&!u.isBuffer(e)&&(e=function(e){return u.from(e)}(e)),"function"===typeof t&&(r=t,t=null),s?t="buffer":t||(t=a.defaultEncoding),"function"!==typeof r&&(r=k),a.ending?function(e,t){var r=new b;x(e,r),n.nextTick(t,r)}(this,r):(s||function(e,t,r,i){var a;return null===r?a=new _:"string"===typeof r||t.objectMode||(a=new p("chunk",["string","Buffer"],r)),!a||(x(e,a),n.nextTick(i,a),!1)}(this,a,e,r))&&(a.pendingcb++,o=function(e,t,r,n,i,a){if(!r){var o=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=u.from(t,r));return t}(t,n,i);n!==o&&(r=!0,i="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else T(e,t,!1,s,n,i,a);return l}(this,a,s,e,t,r)),o},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||C(this,e))},S.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new w(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),S.prototype._write=function(e,t,r){r(new y("_write()"))},S.prototype._writev=null,S.prototype.end=function(e,t,r){var i=this._writableState;return"function"===typeof e?(r=e,e=null,t=null):"function"===typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||function(e,t,r){t.ending=!0,M(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,i,r),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),S.prototype.destroy=h.destroy,S.prototype._undestroy=h.undestroy,S.prototype._destroy=function(e,t){t(e)}}).call(this,r(22),r(21))},function(e,t,r){"use strict";e.exports=c;var n=r(720).codes,i=n.ERR_METHOD_NOT_IMPLEMENTED,a=n.ERR_MULTIPLE_CALLBACK,o=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=r(721);function l(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(null===n)return this.emit("error",new a);r.writechunk=null,r.writecb=null,null!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function c(e){if(!(this instanceof c))return new c(e);u.call(this,e),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",h)}function h(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(t,r){f(e,t,r)}))}function f(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new s;if(e._transformState.transforming)throw new o;return e.push(null)}r(14)(c,u),c.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},c.prototype._transform=function(e,t,r){r(new i("_transform()"))},c.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},c.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},c.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t){e.exports=function(e,t,r){e(t),r&&r(!0===t?null:t)}},function(e,t,r){"use strict";var n=r(1350),i=r(1356),a=r(1362);for(var o in(t=e.exports=r(767)).pull=t,n)t[o]=n[o];for(var o in a)t[o]=a[o];for(var o in i)t[o]=i[o]},function(e,t,r){"use strict";var n=r(965);e.exports=function(e,t){return function(r,i){if(r)return n(i,r,t);if(null!=e){var a=e;e=null,i(null,a)}else i(!0)}}},function(e,t,r){var n=r(748);function i(e){return e}e.exports=function(e){return"object"===typeof e&&"function"===typeof e.test?function(t){return e.test(t)}:n(e)||i}},function(e,t,r){"use strict";function n(e){return e}var i=r(748),a=r(830);e.exports=function(e,t){e=i(e)||n;var r={};return a((function(n){var i=e(n);return r[i]?!!t:(r[i]=!0,!t)}))}},function(e,t,r){"use strict";e.exports=function(e){var t=e.pop(),r={};return Array.isArray(e[e.length-1])||"object"!==typeof e[e.length-1]||(r=e.pop()),{callback:t,sources:1===e.length&&Array.isArray(e[0])?e[0]:e,opts:r}}},function(e,t,r){"use strict";var n=r(672),i=n.Transform,a=n.PassThrough,o=r(675),s=r(825),u=r(766),l=function(e){return{name:e.Name,type:e.Type,size:e.Size,hash:e.Hash}};e.exports=function(e){return function(t,r){r=r||{};var n=new i({objectMode:!0,transform:function(e,t,r){r(null,l(e))}}),c=new a({objectMode:!0});return e({path:"files/ls",args:t,qs:Object.assign({},r,{stream:!0})},(function(e,t){if(e)return c.destroy(e);if(u(t)){var r=s.parse();o(t,r,n,c)}else{(t.Entries||[]).forEach((function(e){c.write(l(e))})),c.end()}})),c}}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{get:r(1386)(t),stat:r(1387)(t),put:r(1388)(t)}}},function(e,t,r){"use strict";(function(t){var n=r(18),i=r(19),a=r(168),o=r(313),s=function(){function e(r,i){if(n(this,e),!r||!t.isBuffer(r))throw new Error("first argument  must be a buffer");if(!i||!a.isCID(i))throw new Error("second argument must be a CID");this._data=r,this._cid=i}return i(e,[{key:"data",get:function(){return this._data},set:function(e){throw new Error("Tried to change an immutable block")}},{key:"cid",get:function(){return this._cid},set:function(e){throw new Error("Tried to change an immutable block")}}]),e}();e.exports=o(s,{className:"Block",symbolName:"@ipfs/js-ipfs-block/block"})}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(67);e.exports={addEnumerableGetters:function(e,t){var r,i=n(t);try{for(i.s();!(r=i.n()).done;){for(var a=r.value,o=void 0,s=e;void 0===o;){if(null===(s=Object.getPrototypeOf(s)))throw new Error("no getter named '".concat(a,"' found"));o=Object.getOwnPropertyDescriptor(s,a)}if(void 0===o.get)throw new Error("no getter named '".concat(a,"' found"));Object.defineProperty(e,a,{enumerable:!0,get:o.get})}}catch(u){i.e(u)}finally{i.f()}},hidePrivateFields:function(e){for(var t in e)"_"===t[0]&&Object.defineProperty(e,t,{enumerable:!1})}}},function(e,t,r){"use strict";(function(t){var n=r(91);function i(e){return parseInt(e.toString("hex"),16)}function a(e){var r=e.toString(16);return r.length%2===1&&(r="0"+r),t.from(r,"hex")}e.exports={numberToBuffer:a,bufferToNumber:i,varintBufferEncode:function(e){return t.from(n.encode(i(e)))},varintBufferDecode:function(e){return a(n.decode(e))},varintEncode:function(e){return t.from(n.encode(e))}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";e.exports=function(e,t,r){var n,i=e instanceof Error?e:new Error(e);if("object"===typeof t?r=t:null!=t&&(i.code=t),r)for(n in r)i[n]=r[n];return i}},function(e,t,r){e.exports=r(1406)},function(e,t,r){"use strict";t.util=r(979),t.resolver=r(1435),t.codec=t.util.codec,t.defaultHashAlg=t.util.defaultHashAlg},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(321),o=r(1414),s=r(10).Buffer,u=r(316),l=r(983),c=r(985),h=r(1433);function f(e){var t;try{t=h(e)}catch(r){t=!1}if(t)throw new Error("The object passed has circular references");return function e(t){if(!t||t instanceof Uint8Array||"string"===typeof t)return t;if(Array.isArray(t))return t.map(e);if(c.isCID(t))return"string"===typeof(r=t)?r=new c(r).buffer:c.isCID(r)&&(r=r.buffer),new o.Tagged(42,s.concat([s.from("00","hex"),r]));var r,n=Object.keys(t);if(n.length>0){var i={};return n.forEach((function(r){"object"===typeof t[r]?i[r]=e(t[r]):i[r]=t[r]})),i}return t}(e)}(t=e.exports).codec=u.DAG_CBOR,t.defaultHashAlg=u.SHA2_256;var d=a({},42,(function(e){return e=e.slice(1),new c(e)})),p=65536,y=67108864,v=y,m=null;t.configureDecoder=function(e){var t=d;e?("number"===typeof e.size&&(p=e.size),"number"===typeof e.maxSize&&(v=e.maxSize),e.tags&&(t=Object.assign({},d,e&&e.tags))):(p=65536,v=y);var r={tags:t,size:p};m=new o.Decoder(r),p=r.size},t.configureDecoder(),t.serialize=function(e){var t=f(e);return o.encode(t)},t.deserialize=function(e){if(e.length>p&&e.length<=v&&t.configureDecoder({size:e.length}),e.length>p)throw new Error("Data is too large to deserialize with current decoder");return m.decodeFirst(e)},t.cid=function(){var e=i(n.mark((function e(r,i){var a,o,s,h,f;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={cidVersion:1,hashAlg:t.defaultHashAlg},o=Object.assign(a,i),e.next=4,l(r,o.hashAlg);case 4:return s=e.sent,h=u.print[t.codec],f=new c(o.cidVersion,h,s),e.abrupt("return",f);case 8:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},function(e,t,r){"use strict";(function(t){var n=r(18),i=r(19),a=r(10).Buffer,o=r(327),s=r(12).BigNumber,u=r(1416),l=r(831),c=r(774),h=r(981),f=r(982),d=r(813).URL,p=function(){function e(r){n(this,e),!(r=r||{}).size||r.size<65536?r.size=65536:r.size=l.nextPowerOf2(r.size),this._heap=new ArrayBuffer(r.size),this._heap8=new Uint8Array(this._heap),this._buffer=a.from(this._heap),this._reset(),this._knownTags=Object.assign({0:function(e){return new Date(e)},1:function(e){return new Date(1e3*e)},2:function(e){return l.arrayBufferToBignumber(e)},3:function(e){return c.NEG_ONE.minus(l.arrayBufferToBignumber(e))},4:function(e){return c.TEN.pow(e[0]).times(e[1])},5:function(e){return c.TWO.pow(e[0]).times(e[1])},32:function(e){return new d(e)},35:function(e){return new RegExp(e)}},r.tags),this.parser=u(t,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}return i(e,[{key:"_closeParent",value:function(){var e=this._parents.pop();if(e.length>0)throw new Error("Missing ".concat(e.length," elements"));switch(e.type){case c.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case c.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case c.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case c.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case c.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case c.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length))}this._currentParent&&this._currentParent.type===c.PARENT.TAG&&this._dec()}},{key:"_dec",value:function(){var e=this._currentParent;e.length<0||(e.length--,0===e.length&&this._closeParent())}},{key:"_push",value:function(e,t){var r=this._currentParent;switch(r.values++,r.type){case c.PARENT.ARRAY:case c.PARENT.BYTE_STRING:case c.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=e:this._ref.push(e),this._dec();break;case c.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=e,r.tmpKey=null,this._dec()):(r.tmpKey=e,"string"!==typeof r.tmpKey&&(r.type=c.PARENT.MAP,r.ref=l.buildMap(r.ref)));break;case c.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,e),r.tmpKey=null,this._dec()):r.tmpKey=e;break;case c.PARENT.TAG:this._ref.push(e),t||this._dec();break;default:throw new Error("Unknown parent type")}}},{key:"_createParent",value:function(e,t,r){this._parents[this._depth]={type:t,length:r,ref:e,values:0,tmpKey:null}}},{key:"_reset",value:function(){this._res=[],this._parents=[{type:c.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}},{key:"createTag",value:function(e,t){var r=this._knownTags[e];return r?r(t):new f(e,t)}},{key:"createMap",value:function(e,t){return e}},{key:"createObject",value:function(e,t){return e}},{key:"createArray",value:function(e,t){return e}},{key:"createByteString",value:function(e,t){return a.concat(e)}},{key:"createByteStringFromHeap",value:function(e,t){return e===t?a.alloc(0):a.from(this._heap.slice(e,t))}},{key:"createInt",value:function(e){return e}},{key:"createInt32",value:function(e,t){return l.buildInt32(e,t)}},{key:"createInt64",value:function(e,t,r,n){return l.buildInt64(e,t,r,n)}},{key:"createFloat",value:function(e){return e}},{key:"createFloatSingle",value:function(e,t,r,n){return o.read([e,t,r,n],0,!1,23,4)}},{key:"createFloatDouble",value:function(e,t,r,n,i,a,s,u){return o.read([e,t,r,n,i,a,s,u],0,!1,52,8)}},{key:"createInt32Neg",value:function(e,t){return-1-l.buildInt32(e,t)}},{key:"createInt64Neg",value:function(e,t,r,n){var i=l.buildInt32(e,t),a=l.buildInt32(r,n);return i>c.MAX_SAFE_HIGH?c.NEG_ONE.minus(new s(i).times(c.SHIFT32).plus(a)):-1-(i*c.SHIFT32+a)}},{key:"createTrue",value:function(){return!0}},{key:"createFalse",value:function(){return!1}},{key:"createNull",value:function(){return null}},{key:"createUndefined",value:function(){}},{key:"createInfinity",value:function(){return 1/0}},{key:"createInfinityNeg",value:function(){return-1/0}},{key:"createNaN",value:function(){return NaN}},{key:"createNaNNeg",value:function(){return NaN}},{key:"createUtf8String",value:function(e,t){return e.join("")}},{key:"createUtf8StringFromHeap",value:function(e,t){return e===t?"":this._buffer.toString("utf8",e,t)}},{key:"createSimpleUnassigned",value:function(e){return new h(e)}},{key:"pushInt",value:function(e){this._push(this.createInt(e))}},{key:"pushInt32",value:function(e,t){this._push(this.createInt32(e,t))}},{key:"pushInt64",value:function(e,t,r,n){this._push(this.createInt64(e,t,r,n))}},{key:"pushFloat",value:function(e){this._push(this.createFloat(e))}},{key:"pushFloatSingle",value:function(e,t,r,n){this._push(this.createFloatSingle(e,t,r,n))}},{key:"pushFloatDouble",value:function(e,t,r,n,i,a,o,s){this._push(this.createFloatDouble(e,t,r,n,i,a,o,s))}},{key:"pushInt32Neg",value:function(e,t){this._push(this.createInt32Neg(e,t))}},{key:"pushInt64Neg",value:function(e,t,r,n){this._push(this.createInt64Neg(e,t,r,n))}},{key:"pushTrue",value:function(){this._push(this.createTrue())}},{key:"pushFalse",value:function(){this._push(this.createFalse())}},{key:"pushNull",value:function(){this._push(this.createNull())}},{key:"pushUndefined",value:function(){this._push(this.createUndefined())}},{key:"pushInfinity",value:function(){this._push(this.createInfinity())}},{key:"pushInfinityNeg",value:function(){this._push(this.createInfinityNeg())}},{key:"pushNaN",value:function(){this._push(this.createNaN())}},{key:"pushNaNNeg",value:function(){this._push(this.createNaNNeg())}},{key:"pushArrayStart",value:function(){this._createParent([],c.PARENT.ARRAY,-1)}},{key:"pushArrayStartFixed",value:function(e){this._createArrayStartFixed(e)}},{key:"pushArrayStartFixed32",value:function(e,t){var r=l.buildInt32(e,t);this._createArrayStartFixed(r)}},{key:"pushArrayStartFixed64",value:function(e,t,r,n){var i=l.buildInt64(e,t,r,n);this._createArrayStartFixed(i)}},{key:"pushObjectStart",value:function(){this._createObjectStartFixed(-1)}},{key:"pushObjectStartFixed",value:function(e){this._createObjectStartFixed(e)}},{key:"pushObjectStartFixed32",value:function(e,t){var r=l.buildInt32(e,t);this._createObjectStartFixed(r)}},{key:"pushObjectStartFixed64",value:function(e,t,r,n){var i=l.buildInt64(e,t,r,n);this._createObjectStartFixed(i)}},{key:"pushByteStringStart",value:function(){this._parents[this._depth]={type:c.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}},{key:"pushByteString",value:function(e,t){this._push(this.createByteStringFromHeap(e,t))}},{key:"pushUtf8StringStart",value:function(){this._parents[this._depth]={type:c.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}},{key:"pushUtf8String",value:function(e,t){this._push(this.createUtf8StringFromHeap(e,t))}},{key:"pushSimpleUnassigned",value:function(e){this._push(this.createSimpleUnassigned(e))}},{key:"pushTagStart",value:function(e){this._parents[this._depth]={type:c.PARENT.TAG,length:1,ref:[e]}}},{key:"pushTagStart4",value:function(e,t){this.pushTagStart(l.buildInt32(e,t))}},{key:"pushTagStart8",value:function(e,t,r,n){this.pushTagStart(l.buildInt64(e,t,r,n))}},{key:"pushTagUnassigned",value:function(e){this._push(this.createTag(e))}},{key:"pushBreak",value:function(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}},{key:"_createObjectStartFixed",value:function(e){0!==e?this._createParent({},c.PARENT.OBJECT,e):this._push(this.createObject({}))}},{key:"_createArrayStartFixed",value:function(e){0!==e?this._createParent(new Array(e),c.PARENT.ARRAY,e):this._push(this.createArray([]))}},{key:"_decode",value:function(e){if(0===e.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(e);var t=this.parser.parse(e.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(t>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}},{key:"decodeFirst",value:function(e){return this._decode(e),this._res[0]}},{key:"decodeAll",value:function(e){return this._decode(e),this._res}},{key:"_depth",get:function(){return this._parents.length}},{key:"_currentParent",get:function(){return this._parents[this._depth-1]}},{key:"_ref",get:function(){return this._currentParent.ref}}],[{key:"decode",value:function(t,r){return"string"===typeof t&&(t=a.from(t,r||"hex")),new e({size:t.length}).decodeFirst(t)}},{key:"decodeAll",value:function(t,r){return"string"===typeof t&&(t=a.from(t,r||"hex")),new e({size:t.length}).decodeAll(t)}}]),e}();p.decodeFirst=p.decode,e.exports=p}).call(this,r(22))},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(774),o=a.MT,s=a.SIMPLE,u=a.SYMS,l=function(){function e(t){if(n(this,e),"number"!==typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}return i(e,[{key:"toString",value:function(){return"simple("+this.value+")"}},{key:"inspect",value:function(){return"simple("+this.value+")"}},{key:"encodeCBOR",value:function(e){return e._pushInt(this.value,o.SIMPLE_FLOAT)}}],[{key:"isSimple",value:function(t){return t instanceof e}},{key:"decode",value:function(t,r){switch(null==r&&(r=!0),t){case s.FALSE:return!1;case s.TRUE:return!0;case s.NULL:return r?null:u.NULL;case s.UNDEFINED:return r?void 0:u.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return u.BREAK;default:return new e(t)}}}]),e}();e.exports=l},function(e,t,r){"use strict";var n=r(18),i=r(19),a=function(){function e(t,r,i){if(n(this,e),this.tag=t,this.value=r,this.err=i,"number"!==typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}return i(e,[{key:"toString",value:function(){return"".concat(this.tag,"(").concat(JSON.stringify(this.value),")")}},{key:"encodeCBOR",value:function(e){return e._pushTag(this.tag),e.pushAny(this.value)}},{key:"convert",value:function(t){var r,n;if("function"!==typeof(n=null!=t?t[this.tag]:void 0)&&"function"!==typeof(n=e["_tag"+this.tag]))return this;try{return n.call(e,this.value)}catch(i){return r=i,this.err=r,this}}}]),e}();e.exports=a},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(1418),s=r(984),u=r(1424);function l(e,t,r){return c.apply(this,arguments)}function c(){return(c=i(n.mark((function e(t,r,i){var a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.digest(t,r,i);case 2:return a=e.sent,e.abrupt("return",s.encode(a,r,i));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l.Buffer=a,l.multihash=s,l.digest=function(){var e=i(n.mark((function e(t,r,i){var a,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.createHash(r),e.next=3,a(t);case 3:return o=e.sent,e.abrupt("return",i?o.slice(0,i):o);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),l.createHash=function(e){if(!e)throw o(new Error("hash algorithm must be specified"),"ERR_HASH_ALGORITHM_NOT_SPECIFIED");if(e=s.coerceCode(e),!l.functions[e])throw o(new Error("multihash function '".concat(e,"' not yet supported")),"ERR_HASH_ALGORITHM_NOT_SUPPORTED");return l.functions[e]},l.functions={0:u.identity,17:u.sha1,18:u.sha2256,19:u.sha2512,20:u.sha3512,21:u.sha3384,22:u.sha3256,23:u.sha3224,24:u.shake128,25:u.shake256,26:u.keccak224,27:u.keccak256,28:u.keccak384,29:u.keccak512,34:u.murmur3128,35:u.murmur332,86:u.dblSha2256},u.addBlake(l.functions),l.validate=function(){var e=i(n.mark((function e(t,r){var i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t,s.decode(r).name);case 2:return i=e.sent,e.abrupt("return",0===a.compare(r,i));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),e.exports=l},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1419),a=r(91),o=r(1423).names,s={};for(var u in o)s[o[u]]=u;function l(e){t.decode(e)}t.names=o,t.codes=Object.freeze(s),t.toHexString=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return e.toString("hex")},t.fromHexString=function(e){return n.from(e,"hex")},t.toB58String=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return i.encode("base58btc",e).toString().slice(1)},t.fromB58String=function(e){var t=e;return n.isBuffer(e)&&(t=e.toString()),i.decode("z"+t)},t.decode=function(e){if(!n.isBuffer(e))throw new Error("multihash must be a Buffer");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");var r=a.decode(e);if(!t.isValidCode(r))throw new Error("multihash unknown function code: 0x".concat(r.toString(16)));e=e.slice(a.decode.bytes);var i=a.decode(e);if(i<0)throw new Error("multihash invalid length: ".concat(i));if((e=e.slice(a.decode.bytes)).length!==i)throw new Error("multihash length inconsistent: 0x".concat(e.toString("hex")));return{code:r,name:s[r],length:i,digest:e}},t.encode=function(e,r,i){if(!e||void 0===r)throw new Error("multihash encode requires at least two args: digest, code");var o=t.coerceCode(r);if(!n.isBuffer(e))throw new Error("digest should be a Buffer");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");return n.concat([n.from(a.encode(o)),n.from(a.encode(i)),e])},t.coerceCode=function(e){var r=e;if("string"===typeof e){if(void 0===o[e])throw new Error("Unrecognized hash function named: ".concat(e));r=o[e]}if("number"!==typeof r)throw new Error("Hash function code should be a number. Got: ".concat(r));if(void 0===s[r]&&!t.isAppCode(r))throw new Error("Unrecognized function code: ".concat(r));return r},t.isAppCode=function(e){return e>0&&e<16},t.isValidCode=function(e){return!!t.isAppCode(e)||!!s[e]},t.validate=l,t.prefix=function(e){return l(e),e.slice(0,2)}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(10).Buffer,o=r(986),s=r(987),u=r(316),l=r(94),c=r(1432),h=r(313)(function(){function e(t,r,i,l){if(n(this,e),h.isCID(t)){var c=t;return this.version=c.version,this.codec=c.codec,this.multihash=a.from(c.multihash),void(this.multibaseName=c.multibaseName||(0===c.version?"base58btc":"base32"))}if("string"===typeof t){var f=s.isEncoded(t);if(f){var d=s.decode(t);this.version=parseInt(d.slice(0,1).toString("hex"),16),this.codec=u.getCodec(d.slice(1)),this.multihash=u.rmPrefix(d.slice(1)),this.multibaseName=f}else this.version=0,this.codec="dag-pb",this.multihash=o.fromB58String(t),this.multibaseName="base58btc";return e.validateCID(this),void Object.defineProperty(this,"string",{value:t})}if(a.isBuffer(t)){var p=t.slice(0,1),y=parseInt(p.toString("hex"),16);if(1===y){var v=t;this.version=y,this.codec=u.getCodec(v.slice(1)),this.multihash=u.rmPrefix(v.slice(1)),this.multibaseName="base32"}else this.version=0,this.codec="dag-pb",this.multihash=t,this.multibaseName="base58btc";e.validateCID(this)}else this.version=t,this.codec=r,this.multihash=i,this.multibaseName=l||(0===t?"base58btc":"base32"),e.validateCID(this)}return i(e,[{key:"toV0",value:function(){if("dag-pb"!==this.codec)throw new Error("Cannot convert a non dag-pb CID to CIDv0");var e=o.decode(this.multihash),t=e.name,r=e.length;if("sha2-256"!==t)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");if(32!==r)throw new Error("Cannot convert non 32 byte multihash CID to CIDv0");return new h(0,this.codec,this.multihash)}},{key:"toV1",value:function(){return new h(1,this.codec,this.multihash)}},{key:"toBaseEncodedString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.multibaseName;if(this.string&&e===this.multibaseName)return this.string;var t=null;if(0===this.version){if("base58btc"!==e)throw new Error("not supported with CIDv0, to support different bases, please migrate the instance do CIDv1, you can do that through cid.toV1()");t=o.toB58String(this.multihash)}else{if(1!==this.version)throw new Error("unsupported version");t=s.encode(e,this.buffer).toString()}return e===this.multibaseName&&Object.defineProperty(this,"string",{value:t}),t}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(){return"CID("+this.toString()+")"}},{key:"toString",value:function(e){return this.toBaseEncodedString(e)}},{key:"toJSON",value:function(){return{codec:this.codec,version:this.version,hash:this.multihash}}},{key:"equals",value:function(e){return this.codec===e.codec&&this.version===e.version&&this.multihash.equals(e.multihash)}},{key:"buffer",get:function(){var e=this._buffer;if(!e){if(0===this.version)e=this.multihash;else{if(1!==this.version)throw new Error("unsupported version");e=a.concat([a.from("01","hex"),u.getCodeVarint(this.codec),this.multihash])}Object.defineProperty(this,"_buffer",{value:e})}return e}},{key:"prefix",get:function(){return a.concat([a.from("0".concat(this.version),"hex"),u.getCodeVarint(this.codec),o.prefix(this.multihash)])}}],[{key:"validateCID",value:function(e){var t=c.checkCIDComponents(e);if(t)throw new Error(t)}}]),e}(),{className:"CID",symbolName:"@ipld/js-cid/CID"});h.codecs=l,e.exports=h},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(987),a=r(91),o=r(1431).names,s={};for(var u in o)s[o[u]]=u;function l(e){t.decode(e)}t.names=o,t.codes=Object.freeze(s),t.toHexString=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return e.toString("hex")},t.fromHexString=function(e){return n.from(e,"hex")},t.toB58String=function(e){if(!n.isBuffer(e))throw new Error("must be passed a buffer");return i.encode("base58btc",e).toString().slice(1)},t.fromB58String=function(e){var t=e;return n.isBuffer(e)&&(t=e.toString()),i.decode("z"+t)},t.decode=function(e){if(!n.isBuffer(e))throw new Error("multihash must be a Buffer");if(e.length<2)throw new Error("multihash too short. must be > 2 bytes.");var r=a.decode(e);if(!t.isValidCode(r))throw new Error("multihash unknown function code: 0x".concat(r.toString(16)));e=e.slice(a.decode.bytes);var i=a.decode(e);if(i<0)throw new Error("multihash invalid length: ".concat(i));if((e=e.slice(a.decode.bytes)).length!==i)throw new Error("multihash length inconsistent: 0x".concat(e.toString("hex")));return{code:r,name:s[r],length:i,digest:e}},t.encode=function(e,r,i){if(!e||void 0===r)throw new Error("multihash encode requires at least two args: digest, code");var o=t.coerceCode(r);if(!n.isBuffer(e))throw new Error("digest should be a Buffer");if(null==i&&(i=e.length),i&&e.length!==i)throw new Error("digest length should be equal to specified length.");return n.concat([n.from(a.encode(o)),n.from(a.encode(i)),e])},t.coerceCode=function(e){var r=e;if("string"===typeof e){if(void 0===o[e])throw new Error("Unrecognized hash function named: ".concat(e));r=o[e]}if("number"!==typeof r)throw new Error("Hash function code should be a number. Got: ".concat(r));if(void 0===s[r]&&!t.isAppCode(r))throw new Error("Unrecognized function code: ".concat(r));return r},t.isAppCode=function(e){return e>0&&e<16},t.isValidCode=function(e){return!!t.isAppCode(e)||!!s[e]},t.validate=l,t.prefix=function(e){return l(e),e.slice(0,2)}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1428);function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");var r=a(e);return function(e,t){a(e).decode(t.toString())}(r.name,t),n.concat([r.codeBuf,t])}).encode=function(e,t){var r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},t.decode=function(e){n.isBuffer(e)&&(e=e.toString());var t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());var r=a(e[0]);return n.from(r.decode(e.substring(1)))},t.isEncoded=function(e){if(n.isBuffer(e)&&(e=e.toString()),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return n.isBuffer(e)&&(e=e.toString()),a(e[0])},t.names=Object.freeze(i.names),t.codes=Object.freeze(i.codes)},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return n((function(e){t({path:"shutdown"},e)}))}},function(e,t,r){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t){if(e){if("string"===typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}r.d(t,"g",(function(){return Ir})),r.d(t,"c",(function(){return fn})),r.d(t,"e",(function(){return xn})),r.d(t,"a",(function(){return On})),r.d(t,"b",(function(){return jn})),r.d(t,"d",(function(){return Yn})),r.d(t,"f",(function(){return ei}));var s=r(669),u=r(0),l=r(57);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done)&&(a.push(n.value),!t||a.length!==t);o=!0);}catch(u){s=!0,i=u}finally{try{o||null==r.return||r.return()}finally{if(s)throw i}}return a}}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=r(51),f=r(25),d=r(3),p=r(5),y=1e-6,v="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});!function(){var e=function(){var e=new v(4);return v!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}()}();function m(e,t){var r,n,i,a=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}([],t,e);return r=a,n=a,i=1/a[3],r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=n[3]*i,a}function g(e,t){var r=e%t;return r<0?t+r:r}function _(e,t,r){return r*t+(1-r)*e}var b=Math.log2||function(e){return Math.log(e)*Math.LOG2E};function w(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],y=t[12],v=t[13],m=t[14],g=t[15],_=r[0],b=r[1],w=r[2],x=r[3];return e[0]=_*n+b*s+w*h+x*y,e[1]=_*i+b*u+w*f+x*v,e[2]=_*a+b*l+w*d+x*m,e[3]=_*o+b*c+w*p+x*g,_=r[4],b=r[5],w=r[6],x=r[7],e[4]=_*n+b*s+w*h+x*y,e[5]=_*i+b*u+w*f+x*v,e[6]=_*a+b*l+w*d+x*m,e[7]=_*o+b*c+w*p+x*g,_=r[8],b=r[9],w=r[10],x=r[11],e[8]=_*n+b*s+w*h+x*y,e[9]=_*i+b*u+w*f+x*v,e[10]=_*a+b*l+w*d+x*m,e[11]=_*o+b*c+w*p+x*g,_=r[12],b=r[13],w=r[14],x=r[15],e[12]=_*n+b*s+w*h+x*y,e[13]=_*i+b*u+w*f+x*v,e[14]=_*a+b*l+w*d+x*m,e[15]=_*o+b*c+w*p+x*g,e}function x(e,t,r){var n,i,a,o,s,u,l,c,h,f,d,p,y=r[0],v=r[1],m=r[2];return t===e?(e[12]=t[0]*y+t[4]*v+t[8]*m+t[12],e[13]=t[1]*y+t[5]*v+t[9]*m+t[13],e[14]=t[2]*y+t[6]*v+t[10]*m+t[14],e[15]=t[3]*y+t[7]*v+t[11]*m+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],u=t[5],l=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=u,e[6]=l,e[7]=c,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=n*y+s*v+h*m+t[12],e[13]=i*y+u*v+f*m+t[13],e[14]=a*y+l*v+d*m+t[14],e[15]=o*y+c*v+p*m+t[15]),e}function k(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function E(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],v=e[13],m=e[14],g=e[15],_=t[0],b=t[1],w=t[2],x=t[3],k=t[4],E=t[5],S=t[6],T=t[7],A=t[8],C=t[9],I=t[10],R=t[11],M=t[12],P=t[13],O=t[14],L=t[15];return Math.abs(r-_)<=y*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(n-b)<=y*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-w)<=y*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(a-x)<=y*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-k)<=y*Math.max(1,Math.abs(o),Math.abs(k))&&Math.abs(s-E)<=y*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(u-S)<=y*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(l-T)<=y*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(c-A)<=y*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(h-C)<=y*Math.max(1,Math.abs(h),Math.abs(C))&&Math.abs(f-I)<=y*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(d-R)<=y*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(p-M)<=y*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(v-P)<=y*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(m-O)<=y*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(g-L)<=y*Math.max(1,Math.abs(g),Math.abs(L))}function S(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function T(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function A(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function C(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}var I=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e};!function(){var e=function(){var e=new v(2);return v!=Float32Array&&(e[0]=0,e[1]=0),e}()}();function R(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}var M=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e};!function(){var e=function(){var e=new v(3);return v!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}()}();function P(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var O=Math.PI,L=O/4,D=O/180,B=180/O,N=512;function z(e){return Math.pow(2,e)}function F(e){return b(e)}function j(e){var t=Object(f.a)(e,2),r=t[0],n=t[1];P(Number.isFinite(r)),P(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");var i=n*D;return[N*(r*D+O)/(2*O),N*(O+Math.log(Math.tan(L+.5*i)))/(2*O)]}function U(e){var t=Object(f.a)(e,2),r=t[0],n=t[1],i=r/N*(2*O)-O,a=2*(Math.atan(Math.exp(n/N*(2*O)-O))-L);return[i*B,a*B]}function V(e){var t=e.latitude,r=e.longitude,n=e.highPrecision,i=void 0!==n&&n;P(Number.isFinite(t)&&Number.isFinite(r));var a={},o=Math.cos(t*D),s=512/360,u=s/o,l=12790407194604047e-21/o;if(a.unitsPerMeter=[l,l,l],a.metersPerUnit=[1/l,1/l,1/l],a.unitsPerDegree=[s,u,l],a.degreesPerUnit=[.703125,1/u,1/l],i){var c=D*Math.tan(t*D)/o,h=s*c/2,f=12790407194604047e-21*c,d=f/u*l;a.unitsPerDegree2=[0,h,f],a.unitsPerMeter2=[d,0,d]}return a}function q(e){var t,r,n=e.height,i=e.pitch,a=e.bearing,o=e.altitude,s=e.scale,u=e.center,l=void 0===u?null:u,c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return x(c,c,[0,0,-o]),function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],f=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+c*n,e[6]=s*i+h*n,e[7]=u*i+f*n,e[8]=l*i-a*n,e[9]=c*i-o*n,e[10]=h*i-s*n,e[11]=f*i-u*n}(c,c,-i*D),function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],u=t[3],l=t[4],c=t[5],h=t[6],f=t[7];t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+c*n,e[2]=s*i+h*n,e[3]=u*i+f*n,e[4]=l*i-a*n,e[5]=c*i-o*n,e[6]=h*i-s*n,e[7]=f*i-u*n}(c,c,a*D),k(c,c,[s/=n,s,s]),l&&x(c,c,((t=[])[0]=-(r=l)[0],t[1]=-r[1],t[2]=-r[2],t)),c}function G(e){var t=e.width,r=e.height,n=e.pitch,i=function(e){var t=e.width,r=e.height,n=e.fovy,i=void 0===n?K(1.5):n,a=e.altitude,o=e.pitch,s=void 0===o?0:o,u=e.nearZMultiplier,l=void 0===u?1:u,c=e.farZMultiplier,h=void 0===c?1:c;void 0!==a&&(i=K(a));var f=.5*i*D,d=H(i),p=s*D,y=Math.sin(f)*d/Math.sin(Math.min(Math.max(Math.PI/2-p-f,.01),Math.PI-.01));return{fov:2*f,aspect:t/r,focalDistance:d,near:l,far:(Math.sin(p)*y+d)*h}}({width:t,height:r,altitude:e.altitude,fovy:e.fovy,pitch:n,nearZMultiplier:e.nearZMultiplier,farZMultiplier:e.farZMultiplier});return function(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}([],i.fov,i.aspect,i.near,i.far)}function K(e){return 2*Math.atan(.5/e)*B}function H(e){return.5/Math.tan(.5*e*D)}function W(e,t){var r=Object(f.a)(e,3),n=r[0],i=r[1],a=r[2],o=void 0===a?0:a;return P(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(o)),m(t,[n,i,o,1])}function Z(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Object(f.a)(e,3),i=n[0],a=n[1],o=n[2];if(P(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(o)){var s=m(t,[i,a,o,1]);return s}var u=m(t,[i,a,0,1]),l=m(t,[i,a,1,1]),c=u[2],h=l[2],d=c===h?0:((r||0)-c)/(h-c);return C([],u,l,d)}function Y(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=void 0===i?0:i,o=e.maxZoom,s=void 0===o?24:o,u=e.padding,l=void 0===u?0:u,c=e.offset,h=void 0===c?[0,0]:c,d=Object(f.a)(n,2),p=Object(f.a)(d[0],2),y=p[0],v=p[1],m=Object(f.a)(d[1],2),g=m[0],_=m[1];if(Number.isFinite(l)){l={top:l,bottom:l,left:l,right:l}}else P(Number.isFinite(l.top)&&Number.isFinite(l.bottom)&&Number.isFinite(l.left)&&Number.isFinite(l.right));var w=new $({width:t,height:r,longitude:0,latitude:0,zoom:0}),x=w.project([y,_]),k=w.project([g,v]),E=[Math.max(Math.abs(k[0]-x[0]),a),Math.max(Math.abs(k[1]-x[1]),a)],S=[t-l.left-l.right-2*Math.abs(h[0]),r-l.top-l.bottom-2*Math.abs(h[1])];P(S[0]>0&&S[1]>0);var T=S[0]/E[0],A=S[1]/E[1],C=(l.right-l.left)/2/T,I=(l.bottom-l.top)/2/A,R=[(k[0]+x[0])/2+C,(k[1]+x[1])/2+I],M=w.unproject(R),O=Math.min(s,w.zoom+b(Math.abs(Math.min(T,A))));return P(Number.isFinite(O)),{longitude:M[0],latitude:M[1],zoom:O}}var X=Math.PI/180;function Q(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e.width,a=e.height,o=e.unproject,s={targetZ:n},u=o([0,a],s),l=o([i,a],s),c=e.fovy?.5*e.fovy*X:Math.atan(.5/e.altitude),h=(90-e.pitch)*X;return c>h-.01?(t=J(e,0,n),r=J(e,i,n)):(t=o([0,0],s),r=o([i,0],s)),[u,l,r,t]}function J(e,t,r){var n=e.pixelUnprojectionMatrix,i=m(n,[t,0,1,1]),a=m(n,[t,e.height,1,1]),o=U(C([],i,a,(r*e.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2])));return o[2]=r,o}var $=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:1,height:1},r=t.width,n=t.height,i=t.latitude,a=void 0===i?0:i,o=t.longitude,s=void 0===o?0:o,u=t.zoom,l=void 0===u?0:u,c=t.pitch,h=void 0===c?0:c,f=t.bearing,p=void 0===f?0:f,y=t.altitude,v=void 0===y?null:y,m=t.fovy,g=void 0===m?null:m,_=t.position,b=void 0===_?null:_,w=t.nearZMultiplier,x=void 0===w?.02:w,k=t.farZMultiplier,E=void 0===k?1.01:k;Object(d.a)(this,e),r=r||1,n=n||1,null===g&&null===v?g=K(v=1.5):null===g?g=K(v):null===v&&(v=H(g));var S=z(l);v=Math.max(.75,v);var T=V({longitude:s,latitude:a}),A=j([s,a]);A[2]=0,b&&R(A,A,M([],b,T.unitsPerMeter)),this.projectionMatrix=G({width:r,height:n,pitch:h,fovy:g,nearZMultiplier:x,farZMultiplier:E}),this.viewMatrix=q({height:n,scale:S,center:A,pitch:h,bearing:p,altitude:v}),this.width=r,this.height=n,this.scale=S,this.latitude=a,this.longitude=s,this.zoom=l,this.pitch=h,this.bearing=p,this.altitude=v,this.fovy=g,this.center=A,this.meterOffset=b||[0,0,0],this.distanceScales=T,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}return Object(p.a)(e,[{key:"_initMatrices",value:function(){var e=this.width,t=this.height,r=this.projectionMatrix,n=this.viewMatrix,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];w(i,i,r),w(i,i,n),this.viewProjectionMatrix=i;var a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];k(a,a,[e/2,-t/2,1]),x(a,a,[1,-1,0]),w(a,a,i);var o=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=t[6],l=t[7],c=t[8],h=t[9],f=t[10],d=t[11],p=t[12],y=t[13],v=t[14],m=t[15],g=r*s-n*o,_=r*u-i*o,b=r*l-a*o,w=n*u-i*s,x=n*l-a*s,k=i*l-a*u,E=c*y-h*p,S=c*v-f*p,T=c*m-d*p,A=h*v-f*y,C=h*m-d*y,I=f*m-d*v,R=g*I-_*C+b*A+w*T-x*S+k*E;return R?(R=1/R,e[0]=(s*I-u*C+l*A)*R,e[1]=(i*C-n*I-a*A)*R,e[2]=(y*k-v*x+m*w)*R,e[3]=(f*x-h*k-d*w)*R,e[4]=(u*T-o*I-l*S)*R,e[5]=(r*I-i*T+a*S)*R,e[6]=(v*b-p*k-m*_)*R,e[7]=(c*k-f*b+d*_)*R,e[8]=(o*C-s*T+l*E)*R,e[9]=(n*T-r*C-a*E)*R,e[10]=(p*x-y*b+m*g)*R,e[11]=(h*b-c*x-d*g)*R,e[12]=(s*S-o*A-u*E)*R,e[13]=(r*A-n*S+i*E)*R,e[14]=(y*_-p*w-v*g)*R,e[15]=(c*w-h*_+f*g)*R,e):null}([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a);if(!o)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=a,this.pixelUnprojectionMatrix=o}},{key:"equals",value:function(t){return t instanceof e&&(t.width===this.width&&t.height===this.height&&E(t.projectionMatrix,this.projectionMatrix)&&E(t.viewMatrix,this.viewMatrix))}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=void 0===r||r,i=this.projectPosition(e),a=W(i,this.pixelProjectionMatrix),o=Object(f.a)(a,2),s=o[0],u=o[1],l=n?u:this.height-u;return 2===e.length?[s,l]:[s,l,a[2]]}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.topLeft,n=void 0===r||r,i=t.targetZ,a=void 0===i?void 0:i,o=Object(f.a)(e,3),s=o[0],u=o[1],l=o[2],c=n?u:this.height-u,h=a&&a*this.distanceScales.unitsPerMeter[2],d=Z([s,c,l],this.pixelUnprojectionMatrix,h),p=this.unprojectPosition(d),y=Object(f.a)(p,3),v=y[0],m=y[1],g=y[2];return Number.isFinite(l)?[v,m,g]:Number.isFinite(a)?[v,m,a]:[v,m]}},{key:"projectPosition",value:function(e){var t=j(e),r=Object(f.a)(t,2);return[r[0],r[1],(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}},{key:"unprojectPosition",value:function(e){var t=U(e),r=Object(f.a)(t,2);return[r[0],r[1],(e[2]||0)*this.distanceScales.metersPerUnit[2]]}},{key:"projectFlat",value:function(e){return j(e)}},{key:"unprojectFlat",value:function(e){return U(e)}},{key:"getMapCenterByLngLatPosition",value:function(e){var t,r,n=e.lngLat,i=Z(e.pos,this.pixelUnprojectionMatrix),a=S([],j(n),((t=[])[0]=-(r=i)[0],t[1]=-r[1],t));return U(S([],this.center,a))}},{key:"getLocationAtPoint",value:function(e){var t=e.lngLat,r=e.pos;return this.getMapCenterByLngLatPosition({lngLat:t,pos:r})}},{key:"fitBounds",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.width,i=this.height,a=Y(Object.assign({width:n,height:i,bounds:t},r)),o=a.longitude,s=a.latitude,u=a.zoom;return new e({width:n,height:i,longitude:o,latitude:s,zoom:u})}},{key:"getBounds",value:function(e){var t=this.getBoundingRegion(e),r=Math.min.apply(Math,Object(h.a)(t.map((function(e){return e[0]})))),n=Math.max.apply(Math,Object(h.a)(t.map((function(e){return e[0]}))));return[[r,Math.min.apply(Math,Object(h.a)(t.map((function(e){return e[1]}))))],[n,Math.max.apply(Math,Object(h.a)(t.map((function(e){return e[1]}))))]]}},{key:"getBoundingRegion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Q(this,e.z||0)}}]),e}(),ee=85.05113,te=-85.05113;var re=r(137),ne=.01,ie=["longitude","latitude","zoom"],ae={curve:1.414,speed:1.2};function oe(e,t,r){var n=(r=Object.assign({},ae,r)).curve,i=e.zoom,a=[e.longitude,e.latitude],o=z(i),s=t.zoom,u=[t.longitude,t.latitude],l=z(s-i),c=j(a),h=j(u),f=I([],h,c),d=Math.max(e.width,e.height),p=d/l,y=A(f)*o,v=Math.max(y,ne),m=n*n,g=(p*p-d*d+m*m*v*v)/(2*d*m*v),_=(p*p-d*d-m*m*v*v)/(2*p*m*v),b=Math.log(Math.sqrt(g*g+1)-g),w=Math.log(Math.sqrt(_*_+1)-_);return{startZoom:i,startCenterXY:c,uDelta:f,w0:d,u1:y,S:(w-b)/n,rho:n,rho2:m,r0:b,r1:w}}var se=r(1097),ue=r(1098),le=r(872),ce=r.n(le),he=r(686),fe=r(687);function de(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function pe(e,t){if(e===t)return!0;if(de(e)&&de(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!pe(e[r],t[r]))return!1;return!0}return Math.abs(e-t)<=1e-7}function ye(e,t,r){return Math.max(t,Math.min(r,e))}function ve(e,t,r){return de(e)?e.map((function(e,n){return ve(e,t[n],r)})):r*t+(1-r)*e}function me(e,t){if(!e)throw new Error(t||"react-map-gl: assertion failed.")}function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var be={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},we=0,xe=0,ke=1.5,Ee=function(){function e(t){var r=t.width,n=t.height,i=t.latitude,a=t.longitude,o=t.zoom,s=t.bearing,u=void 0===s?xe:s,l=t.pitch,c=void 0===l?we:l,h=t.altitude,f=void 0===h?ke:h,d=t.maxZoom,p=void 0===d?be.maxZoom:d,y=t.minZoom,v=void 0===y?be.minZoom:y,m=t.maxPitch,g=void 0===m?be.maxPitch:m,_=t.minPitch,b=void 0===_?be.minPitch:_,w=t.transitionDuration,x=t.transitionEasing,k=t.transitionInterpolator,E=t.transitionInterruption,S=t.startPanLngLat,T=t.startZoomLngLat,A=t.startRotatePos,C=t.startBearing,I=t.startPitch,R=t.startZoom;Object(he.a)(this,e),me(Number.isFinite(r),"`width` must be supplied"),me(Number.isFinite(n),"`height` must be supplied"),me(Number.isFinite(a),"`longitude` must be supplied"),me(Number.isFinite(i),"`latitude` must be supplied"),me(Number.isFinite(o),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:r,height:n,latitude:i,longitude:a,zoom:o,bearing:u,pitch:c,altitude:f,maxZoom:p,minZoom:v,maxPitch:g,minPitch:b,transitionDuration:w,transitionEasing:x,transitionInterpolator:k,transitionInterruption:E}),this._state={startPanLngLat:S,startZoomLngLat:T,startRotatePos:A,startBearing:C,startPitch:I,startZoom:R}}return Object(fe.a)(e,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(t)})}},{key:"pan",value:function(e){var t=e.pos,r=e.startPos,n=this._state.startPanLngLat||this._unproject(r);if(!n)return this;var i=c(this._calculateNewLngLat({startPanLngLat:n,pos:t}),2),a=i[0],o=i[1];return this._getUpdatedMapState({longitude:a,latitude:o})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(e){var t,r=e.pos,n=e.deltaAngleX,i=void 0===n?0:n,a=e.deltaAngleY,o=void 0===a?0:a,s=this._state,u=s.startRotatePos,l=s.startBearing,c=s.startPitch;return Number.isFinite(l)&&Number.isFinite(c)?(t=r?this._calculateNewPitchAndBearing(_e(_e({},this._getRotationParams(r,u)),{},{startBearing:l,startPitch:c})):{bearing:l+i,pitch:c+o},this._getUpdatedMapState(t)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(e){var t=e.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(e){var t=e.pos,r=e.startPos,n=e.scale;me(n>0,"`scale` must be a positive number");var i=this._state,a=i.startZoom,o=i.startZoomLngLat;Number.isFinite(a)||(a=this._viewportProps.zoom,o=this._unproject(r)||this._unproject(t)),me(o,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var s=this._calculateNewZoom({scale:n,startZoom:a||0}),u=c(new $(Object.assign({},this._viewportProps,{zoom:s})).getMapCenterByLngLatPosition({lngLat:o,pos:t}),2),l=u[0],h=u[1];return this._getUpdatedMapState({zoom:s,longitude:l,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(t){return new e(Object.assign({},this._viewportProps,this._state,t))}},{key:"_applyConstraints",value:function(e){var t=e.maxZoom,r=e.minZoom,n=e.zoom;e.zoom=ye(n,r,t);var i=e.maxPitch,a=e.minPitch,o=e.pitch;return e.pitch=ye(o,a,i),Object.assign(e,function(e){var t=e.width,r=e.height,n=e.longitude,i=e.latitude,a=e.zoom,o=e.pitch,s=void 0===o?0:o,u=e.bearing,l=void 0===u?0:u;(n<-180||n>180)&&(n=g(n+180,360)-180),(l<-180||l>180)&&(l=g(l+180,360)-180);var c=new $({width:t,height:r,longitude:n,latitude:i,zoom:a}),h=c.project([n,ee])[1],f=c.project([n,te])[1],d=0;return f-h<r&&(a+=b(r/(f-h)),h=(c=new $({width:t,height:r,longitude:n,latitude:i,zoom:a})).project([n,ee])[1],f=c.project([n,te])[1]),h>0?d=h:f<r&&(d=f-r),d&&(i=c.unproject([t/2,r/2+d])[1]),{width:t,height:r,longitude:n,latitude:i,zoom:a,pitch:s,bearing:l}}(e)),e}},{key:"_unproject",value:function(e){var t=new $(this._viewportProps);return e&&t.unproject(e)}},{key:"_calculateNewLngLat",value:function(e){var t=e.startPanLngLat,r=e.pos;return new $(this._viewportProps).getMapCenterByLngLatPosition({lngLat:t,pos:r})}},{key:"_calculateNewZoom",value:function(e){var t=e.scale,r=e.startZoom,n=this._viewportProps,i=n.maxZoom,a=n.minZoom;return ye(r+Math.log2(t),a,i)}},{key:"_calculateNewPitchAndBearing",value:function(e){var t=e.deltaScaleX,r=e.deltaScaleY,n=e.startBearing,i=e.startPitch;r=ye(r,-1,1);var a=this._viewportProps,o=a.minPitch,s=a.maxPitch,u=i;return r>0?u=i+r*(s-i):r<0&&(u=i-r*(o-i)),{pitch:u,bearing:n+180*t}}},{key:"_getRotationParams",value:function(e,t){var r=e[0]-t[0],n=e[1]-t[1],i=e[1],a=t[1],o=this._viewportProps,s=o.width,u=o.height,l=r/s,c=0;return n>0?Math.abs(u-a)>5&&(c=n/(a-u)*1.2):n<0&&a>5&&(c=1-i/a),{deltaScaleX:l,deltaScaleY:c=Math.min(1,Math.max(-1,c))}}}]),e}();function Se(e){return e[0].toLowerCase()+e.slice(1)}function Te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ae(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Te(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Te(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ce=Object(u.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),Ie=Ce.Provider;Ce.Provider=function(e){var t=e.value,r=e.children,n=c(Object(u.useState)(null),2),i=n[0],a=n[1],o=Object(u.useContext)(Ce);return t=Ae(Ae({setMap:a},o),{},{map:o&&o.map||i},t),u.createElement(Ie,{value:t},r)};var Re=Ce,Me="undefined"!==typeof window?u.useLayoutEffect:u.useEffect;function Pe(e,t){var r=t.longitude,n=t.latitude;return e&&e.queryTerrainElevation&&e.queryTerrainElevation([r,n])||0}function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Le(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var De="A valid API access token is required to use Mapbox data";function Be(e){var t=e.map,r=e.props,n=e.width,i=e.height,a=Le(Le(Le({},r),r.viewState),{},{width:n,height:i});return a.position=[0,0,Pe(t,a)],new $(a)}var Ne={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},ze=Object.assign({},ue.a.propTypes,{width:l.oneOfType([l.number,l.string]),height:l.oneOfType([l.number,l.string]),onResize:l.func,disableTokenWarning:l.bool,visible:l.bool,className:l.string,style:l.object,visibilityConstraints:l.object}),Fe=Object.assign({},ue.a.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:be});function je(){return u.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},u.createElement("h3",{key:"header"},De),u.createElement("div",{key:"text"},"For information on setting up your basemap, read"),u.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var Ue=Object(u.forwardRef)((function(e,t){var r=c(Object(u.useState)(!0),2),n=r[0],i=r[1],a=c(Object(u.useState)({width:0,height:0}),2),o=a[0],s=a[1],l=Object(u.useRef)(null),h=Object(u.useRef)(null),f=Object(u.useRef)(null),d=Object(u.useRef)(null),p=Object(u.useContext)(Re);Me((function(){if(Ue.supported()){var t=new ue.a(Le(Le(Le({},e),o),{},{mapboxgl:ce.a,container:h.current,onError:function(t){401===(t.error&&t.error.status||t.status)&&n&&(console.error(De),i(!1)),e.onError(t)}}));l.current=t,p&&p.setMap&&p.setMap(t.getMap());var r=new se.a((function(t){if(t[0].contentRect){var r=t[0].contentRect,n=r.width,i=r.height;s({width:n,height:i}),e.onResize({width:n,height:i})}}));return r.observe(f.current),function(){t.finalize(),l.current=null,r.disconnect()}}}),[]),Me((function(){l.current&&l.current.setProps(Le(Le({},e),o))}));var y=l.current&&l.current.getMap();Object(u.useImperativeHandle)(t,(function(){return function(e){return{getMap:function(){return e.current&&e.current.getMap()},queryRenderedFeatures:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.current&&e.current.getMap();return n&&n.queryRenderedFeatures(t,r)}}}(l)}),[]);var v=Object(u.useCallback)((function(e){var t=e.target;t===d.current&&t.scrollTo(0,0)}),[]),m=y&&u.createElement(Ie,{value:Le(Le({},p),{},{viewport:p.viewport||Be(Le({map:y,props:e},o)),map:y,container:p.container||f.current})},u.createElement("div",{key:"map-overlays",className:"overlays",ref:d,style:Ne,onScroll:v},e.children)),g=e.className,_=e.width,b=e.height,w=e.style,x=e.visibilityConstraints,k=Object.assign({position:"relative"},w,{width:_,height:b}),E=e.visible&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:be;for(var r in t){var n=r.slice(0,3),i=Se(r.slice(3));if("min"===n&&e[i]<t[r])return!1;if("max"===n&&e[i]>t[r])return!1}return!0}(e.viewState||e,x),S=Object.assign({},Ne,{visibility:E?"inherit":"hidden"});return u.createElement("div",{key:"map-container",ref:f,style:k},u.createElement("div",{key:"map-mapbox",ref:h,style:S,className:g}),m,!n&&!e.disableTokenWarning&&u.createElement(je,null))}));Ue.supported=function(){return ce.a&&ce.a.supported()},Ue.propTypes=ze,Ue.defaultProps=Fe;var Ve=Ue;function qe(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return Ge(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ge(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function Ge(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ke=function(){function e(){Object(he.a)(this,e),Object(s.a)(this,"propNames",[])}return Object(fe.a)(e,[{key:"arePropsEqual",value:function(e,t){var r,n=qe(this.propNames||[]);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(!pe(e[i],t[i]))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}},{key:"initializeProps",value:function(e,t){return{start:e,end:t}}},{key:"interpolateProps",value:function(e,t,r){me(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(e,t){return t.transitionDuration}}]),e}();function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ze(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}var Ye=r(1103),Xe=r.n(Ye);function Qe(e,t){return!t||"object"!==Xe()(t)&&"function"!==typeof t?He(e):t}function Je(e){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $e={longitude:1,bearing:1};function et(e){return Number.isFinite(e)||Array.isArray(e)}function tt(e,t,r){return function(e){return e in $e}(e)&&Math.abs(r-t)>180&&(r=r<0?r+360:r-360),r}function rt(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return nt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nt(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function it(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Je(e);if(t){var i=Je(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Qe(this,r)}}var at=["longitude","latitude","zoom","bearing","pitch"],ot=["latitude","longitude","zoom","width","height"],st=["bearing","pitch"],ut={speed:1.2,curve:1.414};!function(e){Ze(r,e);var t=it(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(he.a)(this,r),e=t.call(this),Object(s.a)(He(e),"propNames",at),e.props=Object.assign({},ut,n),e}Object(fe.a)(r,[{key:"initializeProps",value:function(e,t){var r,n={},i={},a=rt(ot);try{for(a.s();!(r=a.n()).done;){var o=r.value,s=e[o],u=t[o];me(et(s)&&et(u),"".concat(o," must be supplied for transition")),n[o]=s,i[o]=tt(o,s,u)}}catch(p){a.e(p)}finally{a.f()}var l,c=rt(st);try{for(c.s();!(l=c.n()).done;){var h=l.value,f=e[h]||0,d=t[h]||0;n[h]=f,i[h]=tt(h,f,d)}}catch(p){c.e(p)}finally{c.f()}return{start:n,end:i}}},{key:"interpolateProps",value:function(e,t,r){var n,i=function(e,t,r){var n={},i=oe(e,t,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),a=i.startZoom,o=i.startCenterXY,s=i.uDelta,u=i.w0,l=i.u1,c=i.S,h=i.rho,f=i.rho2,d=i.r0;if(l<ne){var p,y=Object(re.a)(ie);try{for(y.s();!(p=y.n()).done;){var v=p.value,m=e[v],g=t[v];n[v]=_(m,g,r)}}catch(C){y.e(C)}finally{y.f()}return n}var b=r*c,w=Math.cosh(d)/Math.cosh(d+h*b),x=u*((Math.cosh(d)*Math.tanh(d+h*b)-Math.sinh(d))/f)/l,k=a+F(1/w),E=T([],s,x);S(E,E,o);var A=U(E);return n.longitude=A[0],n.latitude=A[1],n.zoom=k,n}(e,t,r,this.props),a=rt(st);try{for(a.s();!(n=a.n()).done;){var o=n.value;i[o]=ve(e[o],t[o],r)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"getDuration",value:function(e,t){var r=t.transitionDuration;return"auto"===r&&(r=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n=Object.assign({},ae,n),a=i.screenSpeed,o=i.speed,s=i.maxDuration,u=oe(e,t,n),l=u.S,c=u.rho,h=1e3*l;return r=Number.isFinite(a)?h/(a/c):h/o,Number.isFinite(s)&&r>s?0:r}(e,t,this.props)),r}}])}(Ke);function lt(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return ct(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ct(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ht(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Je(e);if(t){var i=Je(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Qe(this,r)}}var ft=["longitude","latitude","zoom","bearing","pitch"],dt=function(e){Ze(r,e);var t=ht(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(he.a)(this,r),e=t.call(this),Array.isArray(n)&&(n={transitionProps:n}),e.propNames=n.transitionProps||ft,n.around&&(e.around=n.around),e}return Object(fe.a)(r,[{key:"initializeProps",value:function(e,t){var r={},n={};if(this.around){r.around=this.around;var i=new $(e).unproject(this.around);Object.assign(n,t,{around:new $(t).project(i),aroundLngLat:i})}var a,o=lt(this.propNames);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=e[s],l=t[s];me(et(u)&&et(l),"".concat(s," must be supplied for transition")),r[s]=u,n[s]=tt(s,u,l)}}catch(c){o.e(c)}finally{o.f()}return{start:r,end:n}}},{key:"interpolateProps",value:function(e,t,r){var n,i={},a=lt(this.propNames);try{for(a.s();!(n=a.n()).done;){var o=n.value;i[o]=ve(e[o],t[o],r)}}catch(h){a.e(h)}finally{a.f()}if(t.around){var s=c(new $(Object.assign({},t,i)).getMapCenterByLngLatPosition({lngLat:t.aroundLngLat,pos:ve(e.around,t.around,r)}),2),u=s[0],l=s[1];i.longitude=u,i.latitude=l}return i}}]),r}(Ke),pt=function(){};var yt=1,vt=2,mt=3,gt=4,_t={transitionDuration:0,transitionEasing:function(e){return e},transitionInterpolator:new dt,transitionInterruption:yt,onTransitionStart:pt,onTransitionInterrupt:pt,onTransitionEnd:pt},bt=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(he.a)(this,e),Object(s.a)(this,"_animationFrame",null),Object(s.a)(this,"_onTransitionFrame",(function(){t._animationFrame=requestAnimationFrame(t._onTransitionFrame),t._updateViewport()})),this.props=null,this.onViewportChange=r.onViewportChange||pt,this.onStateChange=r.onStateChange||pt,this.time=r.getTime||Date.now}return Object(fe.a)(e,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(e){var t=this.props;if(this.props=e,!t||this._shouldIgnoreViewportChange(t,e))return!1;if(this._isTransitionEnabled(e)){var r=Object.assign({},t),n=Object.assign({},e);if(this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this.state.interruption===vt?Object.assign(r,this.state.endProps):Object.assign(r,this.state.propsInTransition),this.state.interruption===gt)){var i=this.time(),a=(i-this.state.startTime)/this.state.duration;n.transitionDuration=this.state.duration-(i-this.state.startTime),n.transitionEasing=function(e,t){var r=e(t);return function(n){return 1/(1-r)*(e(n*(1-t)+t)-r)}}(this.state.easing,a),n.transitionInterpolator=r.transitionInterpolator}return n.onTransitionStart(),this._triggerTransition(r,n),!0}return this._isTransitionInProgress()&&(t.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(e){var t=e.transitionDuration,r=e.transitionInterpolator;return(t>0||"auto"===t)&&Boolean(r)}},{key:"_isUpdateDueToCurrentTransition",value:function(e){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(e,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(e,t){return!e||(this._isTransitionInProgress()?this.state.interruption===mt||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t))}},{key:"_triggerTransition",value:function(e,t){me(this._isTransitionEnabled(t)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var r=t.transitionInterpolator,n=r.getDuration?r.getDuration(e,t):t.transitionDuration;if(0!==n){var i=t.transitionInterpolator.initializeProps(e,t),a={inTransition:!0,isZooming:e.zoom!==t.zoom,isPanning:e.longitude!==t.longitude||e.latitude!==t.latitude,isRotating:e.bearing!==t.bearing||e.pitch!==t.pitch};this.state={duration:n,easing:t.transitionEasing,interpolator:t.transitionInterpolator,interruption:t.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(a)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var e=this.time(),t=this.state,r=t.startTime,n=t.duration,i=t.easing,a=t.interpolator,o=t.startProps,s=t.endProps,u=!1,l=(e-r)/n;l>=1&&(l=1,u=!0),l=i(l);var c=a.interpolateProps(o,s,l),h=new Ee(Object.assign({},this.props,c));this.state.propsInTransition=h.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),u&&(this._endTransition(),this.props.onTransitionEnd())}}]),e}();Object(s.a)(bt,"defaultProps",_t);var wt=r(1104),xt=r.n(wt),kt={mousedown:1,mousemove:2,mouseup:4};!function(e){var t=e.prototype.handler;e.prototype.handler=function(e){var r=this.store;e.button>0&&"pointerdown"===e.type&&(function(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}(r,(function(t){return t.pointerId===e.pointerId}))||r.push(e)),t.call(this,e)}}(xt.a.PointerEventInput),xt.a.MouseInput.prototype.handler=function(e){var t=kt[e.type];1&t&&e.button>=0&&(this.pressed=!0),2&t&&0===e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))};var Et=xt.a.Manager,St=xt.a,Tt=St?[[St.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[St.Rotate,{enable:!1}],[St.Pinch,{enable:!1}],[St.Swipe,{enable:!1}],[St.Pan,{threshold:0,enable:!1}],[St.Press,{enable:!1}],[St.Tap,{event:"doubletap",taps:2,enable:!1}],[St.Tap,{event:"anytap",enable:!1}],[St.Tap,{enable:!1}]]:null,At={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Ct={doubletap:["tap"]},It={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Rt=["keydown","keyup"],Mt=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],Pt=["wheel","mousewheel"],Ot={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},Lt={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Dt=r(1105),Bt=-1!==Dt.b.indexOf("firefox"),Nt=Pt,zt="wheel",Ft=4.000244140625,jt=function(){function e(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(d.a)(this,e),this.element=t,this.callback=r,this.options=Object.assign({enable:!0},i),this.events=Nt.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(e){return t.addEventListener(e,n.handleEvent,!!Dt.a&&{passive:!1})}))}return Object(p.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){e===zt&&(this.options.enable=t)}},{key:"handleEvent",value:function(e){if(this.options.enable){var t=e.deltaY;Dt.c.WheelEvent&&(Bt&&e.deltaMode===Dt.c.WheelEvent.DOM_DELTA_PIXEL&&(t/=Dt.c.devicePixelRatio),e.deltaMode===Dt.c.WheelEvent.DOM_DELTA_LINE&&(t*=40));var r={x:e.clientX,y:e.clientY};0!==t&&t%Ft===0&&(t=Math.floor(t/Ft)),e.shiftKey&&t&&(t*=.25),this._onWheel(e,-t,r)}}},{key:"_onWheel",value:function(e,t,r){this.callback({type:zt,center:r,delta:t,srcEvent:e,pointerType:"mouse",target:e.target})}}]),e}(),Ut=Mt,Vt="pointermove",qt="pointerover",Gt="pointerout",Kt="pointerleave",Ht=function(){function e(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(d.a)(this,e),this.element=t,this.callback=r,this.pressed=!1,this.options=Object.assign({enable:!0},i),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=Ut.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((function(e){return t.addEventListener(e,n.handleEvent)}))}return Object(p.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){e===Vt&&(this.enableMoveEvent=t),e===qt&&(this.enableOverEvent=t),e===Gt&&(this.enableOutEvent=t),e===Kt&&(this.enableLeaveEvent=t)}},{key:"handleEvent",value:function(e){this.handleOverEvent(e),this.handleOutEvent(e),this.handleLeaveEvent(e),this.handleMoveEvent(e)}},{key:"handleOverEvent",value:function(e){this.enableOverEvent&&"mouseover"===e.type&&this.callback({type:qt,srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleOutEvent",value:function(e){this.enableOutEvent&&"mouseout"===e.type&&this.callback({type:Gt,srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleLeaveEvent",value:function(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this.callback({type:Kt,srcEvent:e,pointerType:"mouse",target:e.target})}},{key:"handleMoveEvent",value:function(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this.callback({type:Vt,srcEvent:e,pointerType:"mouse",target:e.target});break;case"mouseup":this.pressed=!1}}}]),e}(),Wt=Rt,Zt="keydown",Yt="keyup",Xt=function(){function e(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(d.a)(this,e),this.element=t,this.callback=r,this.options=Object.assign({enable:!0},i),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=Wt.concat(i.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=i.tabIndex||0,t.style.outline="none",this.events.forEach((function(e){return t.addEventListener(e,n.handleEvent)}))}return Object(p.a)(e,[{key:"destroy",value:function(){var e=this;this.events.forEach((function(t){return e.element.removeEventListener(t,e.handleEvent)}))}},{key:"enableEventType",value:function(e,t){e===Zt&&(this.enableDownEvent=t),e===Yt&&(this.enableUpEvent=t)}},{key:"handleEvent",value:function(e){var t=e.target||e.srcElement;"INPUT"===t.tagName&&"text"===t.type||"TEXTAREA"===t.tagName||(this.enableDownEvent&&"keydown"===e.type&&this.callback({type:Zt,srcEvent:e,key:e.key,target:e.target}),this.enableUpEvent&&"keyup"===e.type&&this.callback({type:Yt,srcEvent:e,key:e.key,target:e.target}))}}]),e}(),Qt="contextmenu",Jt=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(d.a)(this,e),this.element=t,this.callback=r,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}return Object(p.a)(e,[{key:"destroy",value:function(){this.element.removeEventListener("contextmenu",this.handleEvent)}},{key:"enableEventType",value:function(e,t){e===Qt&&(this.options.enable=t)}},{key:"handleEvent",value:function(e){this.options.enable&&this.callback({type:Qt,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}]),e}(),$t={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};var er={srcElement:"root",priority:0},tr=function(){function e(t){Object(d.a)(this,e),this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}return Object(p.a)(e,[{key:"isEmpty",value:function(){return!this._active}},{key:"add",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.handlers,o=this.handlersByElement;r&&("object"!==typeof r||r.addEventListener)&&(r={srcElement:r}),r=r?Object.assign({},er,r):er;var s=o.get(r.srcElement);s||(s=[],o.set(r.srcElement,s));var u={type:e,handler:t,srcElement:r.srcElement,priority:r.priority};n&&(u.once=!0),i&&(u.passive=!0),a.push(u),this._active=this._active||!u.passive;for(var l=s.length-1;l>=0&&!(s[l].priority>=u.priority);)l--;s.splice(l+1,0,u)}},{key:"remove",value:function(e,t){for(var r=this.handlers,n=this.handlersByElement,i=r.length-1;i>=0;i--){var a=r[i];if(a.type===e&&a.handler===t){r.splice(i,1);var o=n.get(a.srcElement);o.splice(o.indexOf(a),1),0===o.length&&n.delete(a.srcElement)}}this._active=r.some((function(e){return!e.passive}))}},{key:"handleEvent",value:function(e){if(!this.isEmpty()){for(var t=this._normalizeEvent(e),r=e.srcEvent.target;r&&r!==t.rootElement;){if(this._emit(t,r),t.handled)return;r=r.parentNode}this._emit(t,"root")}}},{key:"_emit",value:function(e,t){var r=this.handlersByElement.get(t);if(r){for(var n=!1,i=function(){e.handled=!0},a=function(){e.handled=!0,n=!0},o=[],s=0;s<r.length;s++){var u=r[s],l=u.type,c=u.handler,h=u.once;if(c(Object.assign({},e,{type:l,stopPropagation:i,stopImmediatePropagation:a})),h&&o.push(r[s]),n)break}for(var f=0;f<o.length;f++){var d=o[f],p=d.type,y=d.handler;this.remove(p,y)}}}},{key:"_normalizeEvent",value:function(e){var t=this.eventManager.element;return Object.assign({},e,function(e){var t=$t[e.srcEvent.type];if(!t)return null;var r=e.srcEvent,n=r.buttons,i=r.button,a=r.which,o=!1,s=!1,u=!1;return 4===t||2===t&&!Number.isFinite(n)?(o=1===a,s=2===a,u=3===a):2===t?(o=Boolean(1&n),s=Boolean(4&n),u=Boolean(2&n)):1===t&&(o=0===i,s=1===i,u=2===i),{leftButton:o,middleButton:s,rightButton:u}}(e),function(e,t){var r=e.srcEvent;if(!e.center&&!Number.isFinite(r.clientX))return null;var n=e.center||{x:r.clientX,y:r.clientY},i=t.getBoundingClientRect(),a=i.width/t.offsetWidth||1,o=i.height/t.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-t.clientLeft)/a,y:(n.y-i.top-t.clientTop)/o}}}(e,t),{handled:!1,rootElement:t})}}]),e}(),rr={events:null,recognizers:null,recognizerOptions:{},Manager:Et,touchAction:"none",tabIndex:0},nr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(d.a)(this,e),this.options=Object.assign({},rr,r),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);var n=r.events;n&&this.on(n)}return Object(p.a)(e,[{key:"setElement",value:function(e){var t=this;if(this.element&&this.destroy(),this.element=e,e){var r=this.options,n=r.Manager;for(var i in this.manager=new n(e,{touchAction:r.touchAction,recognizers:r.recognizers||Tt}).on("hammer.input",this._onBasicInput),r.recognizers||Object.keys(At).forEach((function(e){var r=t.manager.get(e);r&&At[e].forEach((function(e){r.recognizeWith(e)}))})),r.recognizerOptions){var a=this.manager.get(i);if(a){var o=r.recognizerOptions[i];delete o.enable,a.set(o)}}this.wheelInput=new jt(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Ht(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Xt(e,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new Jt(e,this._onOtherEvent,{enable:!1});var s,u=Object(re.a)(this.events);try{for(u.s();!(s=u.n()).done;){var l=Object(f.a)(s.value,2),c=l[0],h=l[1];h.isEmpty()||(this._toggleRecognizer(h.recognizerName,!0),this.manager.on(c,h.handleEvent))}}catch(d){u.e(d)}finally{u.f()}}}},{key:"destroy",value:function(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}},{key:"on",value:function(e,t,r){this._addEventHandler(e,t,r,!1)}},{key:"once",value:function(e,t,r){this._addEventHandler(e,t,r,!0)}},{key:"watch",value:function(e,t,r){this._addEventHandler(e,t,r,!1,!0)}},{key:"off",value:function(e,t){this._removeEventHandler(e,t)}},{key:"_toggleRecognizer",value:function(e,t){var r=this.manager;if(r){var n=r.get(e);if(n&&n.options.enable!==t){n.set({enable:t});var i=Ct[e];i&&!this.options.recognizers&&i.forEach((function(i){var a=r.get(i);t?(a.requireFailure(e),n.dropRequireFailure(i)):a.dropRequireFailure(e)}))}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}}},{key:"_addEventHandler",value:function(e,t,r,n,i){if("string"===typeof e){var a=this.manager,o=this.events,s=Lt[e]||e,u=o.get(s);u||(u=new tr(this),o.set(s,u),u.recognizerName=Ot[s]||s,a&&a.on(s,u.handleEvent)),u.add(e,t,r,n,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}else for(var l in r=t,e)this._addEventHandler(l,e[l],r,n,i)}},{key:"_removeEventHandler",value:function(e,t){if("string"===typeof e){var r=this.events,n=Lt[e]||e,i=r.get(n);if(i&&(i.remove(e,t),i.isEmpty())){var a,o=i.recognizerName,s=!1,u=Object(re.a)(r.values());try{for(u.s();!(a=u.n()).done;){var l=a.value;if(l.recognizerName===o&&!l.isEmpty()){s=!0;break}}}catch(h){u.e(h)}finally{u.f()}s||this._toggleRecognizer(o,!1)}}else for(var c in e)this._removeEventHandler(c,e[c])}},{key:"_onBasicInput",value:function(e){var t=e.srcEvent,r=It[t.type];r&&this.manager.emit(r,e)}},{key:"_onOtherEvent",value:function(e){this.manager.emit(e.type,e)}}]),e}();function ir(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ar(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ir(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var or={transitionDuration:0},sr={transitionDuration:300,transitionEasing:function(e){return e},transitionInterpolator:new dt,transitionInterruption:yt},ur=300,lr=function(e){return 1-(1-e)*(1-e)},cr=["wheel"],hr=["panstart","panmove","panend"],fr=["pinchstart","pinchmove","pinchend"],dr=["tripanstart","tripanmove","tripanend"],pr=["doubletap"],yr=["keydown"],vr=function(){function e(){var t=this;Object(he.a)(this,e),Object(s.a)(this,"events",[]),Object(s.a)(this,"scrollZoom",!0),Object(s.a)(this,"dragPan",!0),Object(s.a)(this,"dragRotate",!0),Object(s.a)(this,"doubleClickZoom",!0),Object(s.a)(this,"touchZoom",!0),Object(s.a)(this,"touchRotate",!1),Object(s.a)(this,"keyboard",!0),Object(s.a)(this,"_interactionState",{isDragging:!1}),Object(s.a)(this,"_events",{}),Object(s.a)(this,"_setInteractionState",(function(e){Object.assign(t._interactionState,e),t.onStateChange&&t.onStateChange(t._interactionState)})),Object(s.a)(this,"_onTransition",(function(e,r){t.onViewportChange(e,t._interactionState,r)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new bt({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return Object(fe.a)(e,[{key:"handleEvent",value:function(e){this.mapState=this.getMapState();var t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}},{key:"getCenter",value:function(e){var t=e.offsetCenter;return[t.x,t.y]}},{key:"isFunctionKeyPressed",value:function(e){var t=e.srcEvent;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}},{key:"blockEvents",value:function(e){var t=this,r=setTimeout((function(){t._eventStartBlocked===r&&(t._eventStartBlocked=null)}),e);this._eventStartBlocked=r}},{key:"updateViewport",value:function(e,t,r){var n=this.mapState instanceof Ee?this.mapState.getViewportProps():this.mapState,i=ar(ar({},e.getViewportProps()),t),a=Object.keys(i).some((function(e){return n[e]!==i[e]}));this._state=e.getState(),this._setInteractionState(r),a&&this.onViewportChange(i,this._interactionState,n)}},{key:"getMapState",value:function(e){return new Ee(ar(ar(ar({},this.mapStateProps),this._state),e))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(e){var t=e.onViewportChange,r=e.onStateChange,n=e.eventManager,i=void 0===n?this.eventManager:n,a=e.isInteractive,o=void 0===a||a,s=e.scrollZoom,u=void 0===s?this.scrollZoom:s,l=e.dragPan,c=void 0===l?this.dragPan:l,h=e.dragRotate,f=void 0===h?this.dragRotate:h,d=e.doubleClickZoom,p=void 0===d?this.doubleClickZoom:d,y=e.touchZoom,v=void 0===y?this.touchZoom:y,m=e.touchRotate,g=void 0===m?this.touchRotate:m,_=e.keyboard,b=void 0===_?this.keyboard:_;this.onViewportChange=t,this.onStateChange=r;var w=this.mapStateProps||{},x=w.height!==e.height||w.width!==e.width;this.mapStateProps=e,x&&(this.mapState=w,this.updateViewport(new Ee(e))),this._transitionManager.processViewportChange(e),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(cr,o&&Boolean(u)),this.toggleEvents(hr,o&&Boolean(c||f)),this.toggleEvents(fr,o&&Boolean(v||g)),this.toggleEvents(dr,o&&Boolean(g)),this.toggleEvents(pr,o&&Boolean(p)),this.toggleEvents(yr,o&&Boolean(b)),this.scrollZoom=u,this.dragPan=c,this.dragRotate=f,this.doubleClickZoom=p,this.touchZoom=v,this.touchRotate=g,this.keyboard=b}},{key:"toggleEvents",value:function(e,t){var r=this;this.eventManager&&e.forEach((function(e){r._events[e]!==t&&(r._events[e]=t,t?r.eventManager.on(e,r.handleEvent):r.eventManager.off(e,r.handleEvent))}))}},{key:"_onPanStart",value:function(e){var t=this.getCenter(e);this._panRotate=this.isFunctionKeyPressed(e)||e.rightButton;var r=this._panRotate?this.mapState.rotateStart({pos:t}):this.mapState.panStart({pos:t});return this.updateViewport(r,or,{isDragging:!0}),!0}},{key:"_onPan",value:function(e){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(e):this._onPanMove(e))}},{key:"_onPanEnd",value:function(e){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(e):this._onPanMoveEnd(e))}},{key:"_onPanMove",value:function(e){if(!this.dragPan)return!1;var t=this.getCenter(e),r=this.mapState.pan({pos:t});return this.updateViewport(r,or,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(e){if(this.dragPan){var t=this.dragPan.inertia,r=void 0===t?ur:t;if(r&&e.velocity){var n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.mapState.pan({pos:i}).panEnd();return this.updateViewport(a,ar(ar({},sr),{},{transitionDuration:r,transitionEasing:lr}),{isDragging:!1,isPanning:!0}),!0}}var o=this.mapState.panEnd();return this.updateViewport(o,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(e){if(!this.dragRotate)return!1;var t=this.getCenter(e),r=this.mapState.rotate({pos:t});return this.updateViewport(r,or,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(e){if(this.dragRotate){var t=this.dragRotate.inertia,r=void 0===t?ur:t;if(r&&e.velocity){var n=this.getCenter(e),i=[n[0]+e.velocityX*r/2,n[1]+e.velocityY*r/2],a=this.mapState.rotate({pos:i}).rotateEnd();return this.updateViewport(a,ar(ar({},sr),{},{transitionDuration:r,transitionEasing:lr}),{isDragging:!1,isRotating:!0}),!0}}var o=this.mapState.panEnd();return this.updateViewport(o,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(e){if(!this.scrollZoom)return!1;var t=this.scrollZoom,r=t.speed,n=void 0===r?.01:r,i=t.smooth,a=void 0!==i&&i;e.preventDefault();var o=this.getCenter(e),s=e.delta,u=2/(1+Math.exp(-Math.abs(s*n)));s<0&&0!==u&&(u=1/u);var l=this.mapState.zoom({pos:o,scale:u});return this.updateViewport(l,ar(ar({},sr),{},{transitionInterpolator:new dt({around:o}),transitionDuration:a?250:1}),{isPanning:!0,isZooming:!0}),!0}},{key:"_onPinchStart",value:function(e){var t=this.getCenter(e),r=this.mapState.zoomStart({pos:t}).rotateStart({pos:t});return this._startPinchRotation=e.rotation,this._lastPinchEvent=e,this.updateViewport(r,or,{isDragging:!0}),!0}},{key:"_onPinch",value:function(e){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var t=this.mapState;if(this.touchZoom){var r=e.scale,n=this.getCenter(e);t=t.zoom({pos:n,scale:r})}if(this.touchRotate){var i=e.rotation;t=t.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(t,or,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=e,!0}},{key:"_onPinchEnd",value:function(e){if(!this.isDragging())return!1;if(this.touchZoom){var t=this.touchZoom.inertia,r=void 0===t?ur:t,n=this._lastPinchEvent;if(r&&n&&e.scale!==n.scale){var i=this.getCenter(e),a=this.mapState.rotateEnd(),o=Math.log2(e.scale),s=(o-Math.log2(n.scale))/(e.deltaTime-n.deltaTime),u=Math.pow(2,o+s*r/2);return a=a.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(a,ar(ar({},sr),{},{transitionInterpolator:new dt({around:i}),transitionDuration:r,transitionEasing:lr}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(r),!0}}var l=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(l,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(e){var t=this.getCenter(e),r=this.mapState.rotateStart({pos:t});return this.updateViewport(r,or,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(e){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var t=this.getCenter(e);t[0]-=e.deltaX;var r=this.mapState.rotate({pos:t});return this.updateViewport(r,or,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(e){if(!this.isDragging())return!1;if(this.touchRotate){var t=this.touchRotate.inertia,r=void 0===t?ur:t;if(r&&e.velocityY){var n=this.getCenter(e),i=[n[0],n[1]+=e.velocityY*r/2],a=this.mapState.rotate({pos:i});return this.updateViewport(a,ar(ar({},sr),{},{transitionDuration:r,transitionEasing:lr}),{isDragging:!1,isRotating:!0}),this.blockEvents(r),!1}}var o=this.mapState.rotateEnd();return this.updateViewport(o,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(e){if(!this.doubleClickZoom)return!1;var t=this.getCenter(e),r=this.isFunctionKeyPressed(e),n=this.mapState.zoom({pos:t,scale:r?.5:2});return this.updateViewport(n,Object.assign({},sr,{transitionInterpolator:new dt({around:t})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(e){if(!this.keyboard)return!1;var t,r=this.isFunctionKeyPressed(e),n=this.keyboard,i=n.zoomSpeed,a=void 0===i?2:i,o=n.moveSpeed,s=void 0===o?100:o,u=n.rotateSpeedX,l=void 0===u?15:u,c=n.rotateSpeedY,h=void 0===c?10:c,f=this.mapStateProps;switch(e.srcEvent.keyCode){case 189:t=r?this.getMapState({zoom:f.zoom-Math.log2(a)-1}):this.getMapState({zoom:f.zoom-Math.log2(a)});break;case 187:t=r?this.getMapState({zoom:f.zoom+Math.log2(a)+1}):this.getMapState({zoom:f.zoom+Math.log2(a)});break;case 37:t=r?this.getMapState({bearing:f.bearing-l}):this.mapState.pan({pos:[s,0],startPos:[0,0]});break;case 39:t=r?this.getMapState({bearing:f.bearing+l}):this.mapState.pan({pos:[-s,0],startPos:[0,0]});break;case 38:t=r?this.getMapState({pitch:f.pitch+h}):this.mapState.pan({pos:[0,s],startPos:[0,0]});break;case 40:t=r?this.getMapState({pitch:f.pitch-h}):this.mapState.pan({pos:[0,-s],startPos:[0,0]});break;default:return!1}return this.updateViewport(t,sr)}}]),e}();function mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _r=Object.assign({},Ve.propTypes,{maxZoom:l.number,minZoom:l.number,maxPitch:l.number,minPitch:l.number,onViewStateChange:l.func,onViewportChange:l.func,onInteractionStateChange:l.func,transitionDuration:l.oneOfType([l.number,l.string]),transitionInterpolator:l.object,transitionInterruption:l.number,transitionEasing:l.func,onTransitionStart:l.func,onTransitionInterrupt:l.func,onTransitionEnd:l.func,scrollZoom:l.oneOfType([l.bool,l.object]),dragPan:l.oneOfType([l.bool,l.object]),dragRotate:l.oneOfType([l.bool,l.object]),doubleClickZoom:l.bool,touchZoom:l.oneOfType([l.bool,l.object]),touchRotate:l.oneOfType([l.bool,l.object]),keyboard:l.oneOfType([l.bool,l.object]),onHover:l.func,onClick:l.func,onDblClick:l.func,onContextMenu:l.func,onMouseDown:l.func,onMouseMove:l.func,onMouseUp:l.func,onTouchStart:l.func,onTouchMove:l.func,onTouchEnd:l.func,onMouseEnter:l.func,onMouseLeave:l.func,onMouseOut:l.func,onWheel:l.func,touchAction:l.string,eventRecognizerOptions:l.object,clickRadius:l.number,interactiveLayerIds:l.array,getCursor:l.func,controller:l.instanceOf(vr)}),br=Object.assign({},Ve.defaultProps,be,bt.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(e){return e.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(e){var t=e.isDragging,r=e.isHovering;return t?"grabbing":r?"pointer":"grab"}});function wr(e){if(e.lngLat||!e.offsetCenter)return e;var t=e.offsetCenter,r=t.x,n=t.y;if(!Number.isFinite(r)||!Number.isFinite(n))return e;var i=[r,n];e.point=i;var a=this.viewport,o=a.unproject(i,{targetZ:a.meterOffset[2]});return e.lngLat=[o[0],o[1]],e}function xr(e){var t=this.map;if(!t||!e)return null;var r={},n=this.props.clickRadius;this.props.interactiveLayerIds&&(r.layers=this.props.interactiveLayerIds);try{return t.queryRenderedFeatures(n?[[e[0]-n,e[1]+n],[e[0]+n,e[1]-n]]:e,r)}catch(i){return null}}function kr(e,t){var r=this.props[e];r&&r(wr.call(this,t))}function Er(e){kr.call(this,"touch"===e.pointerType?"onTouchStart":"onMouseDown",e)}function Sr(e){kr.call(this,"touch"===e.pointerType?"onTouchEnd":"onMouseUp",e)}function Tr(e){if(kr.call(this,"touch"===e.pointerType?"onTouchMove":"onMouseMove",e),!this.state.isDragging){var t,r=this.props,n=r.onHover,i=r.interactiveLayerIds;e=wr.call(this,e),(i||n)&&(t=xr.call(this,e.point));var a=Boolean(i&&t&&t.length>0),o=a&&!this.state.isHovering,s=!a&&this.state.isHovering;(n||o)&&(e.features=t,n&&n(e)),o&&kr.call(this,"onMouseEnter",e),s&&kr.call(this,"onMouseLeave",e),(o||s)&&this.setState({isHovering:a})}}function Ar(e){var t=this.props,r=t.onClick,n=t.onNativeClick,i=t.onDblClick,a=t.doubleClickZoom,o=[],s=i||a;switch(e.type){case"anyclick":o.push(n),s||o.push(r);break;case"click":s&&o.push(r)}(o=o.filter(Boolean)).length&&((e=wr.call(this,e)).features=xr.call(this,e.point),o.forEach((function(t){return t(e)})))}var Cr=Object(u.forwardRef)((function(e,t){var r=Object(u.useContext)(Re),i=Object(u.useMemo)((function(){return e.controller||new vr}),[]),a=Object(u.useMemo)((function(){return new nr(null,{touchAction:e.touchAction,recognizerOptions:e.eventRecognizerOptions})}),[]),s=Object(u.useRef)(null),l=Object(u.useRef)(null),c=Object(u.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;c.props=e,c.map=l.current&&l.current.getMap(),c.setState=function(t){c.state=gr(gr({},c.state),t),s.current.style.cursor=e.getCursor(c.state)};var h,f,d=!0,p=function(e,t,r){if(d)h=[e,t,r];else{var n=c.props,i=n.onViewStateChange,a=n.onViewportChange;Object.defineProperty(e,"position",{get:function(){return[0,0,Pe(c.map,e)]}}),i&&i({viewState:e,interactionState:t,oldViewState:r}),a&&a(e,t,r)}};Object(u.useImperativeHandle)(t,(function(){return function(e){return{getMap:e.current&&e.current.getMap,queryRenderedFeatures:e.current&&e.current.queryRenderedFeatures}}(l)}),[]);var y=Object(u.useMemo)((function(){return gr(gr({},r),{},{eventManager:a,container:r.container||s.current})}),[r,s.current]);y.onViewportChange=p,y.viewport=r.viewport||Be(c),c.viewport=y.viewport;var v=function(e){var t=e.isDragging,r=void 0!==t&&t;if(r!==c.state.isDragging&&c.setState({isDragging:r}),d)f=e;else{var n=c.props.onInteractionStateChange;n&&n(e)}},m=function(){c.width&&c.height&&i.setOptions(gr(gr(gr({},c.props),c.props.viewState),{},{isInteractive:Boolean(c.props.onViewStateChange||c.props.onViewportChange),onViewportChange:p,onStateChange:v,eventManager:a,width:c.width,height:c.height}))};Object(u.useEffect)((function(){return a.setElement(s.current),a.on({pointerdown:Er.bind(c),pointermove:Tr.bind(c),pointerup:Sr.bind(c),pointerleave:kr.bind(c,"onMouseOut"),click:Ar.bind(c),anyclick:Ar.bind(c),dblclick:kr.bind(c,"onDblClick"),wheel:kr.bind(c,"onWheel"),contextmenu:kr.bind(c,"onContextMenu")}),function(){a.destroy()}}),[]),Me((function(){h&&p.apply(void 0,o(h)),f&&v(f)})),m();var g=e.width,_=e.height,b=e.style,w=e.getCursor,x=Object(u.useMemo)((function(){return gr(gr({position:"relative"},b),{},{width:g,height:_,cursor:w(c.state)})}),[b,g,_,w,c.state]);return h&&c._child||(c._child=u.createElement(Ie,{value:y},u.createElement("div",{key:"event-canvas",ref:s,style:x},u.createElement(Ve,n({},e,{width:"100%",height:"100%",style:null,onResize:function(e){var t=e.width,r=e.height;c.width=t,c.height=r,m(),c.props.onResize({width:t,height:r})},ref:l}))))),d=!1,c._child}));Cr.supported=Ve.supported,Cr.propTypes=_r,Cr.defaultProps=br;var Ir=Cr;function Rr(e){return(Rr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mr(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!Mr(e[r],t[r]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===Rr(e)&&"object"===Rr(t)){var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var a=0,o=n;a<o.length;a++){var s=o[a];if(!t.hasOwnProperty(s))return!1;if(!Mr(e[s],t[s]))return!1}return!0}return!1}function Pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Or={type:l.string.isRequired,id:l.string},Lr=0;function Dr(e,t,r){if(e.style&&e.style._loaded){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pr(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},r);return delete n.id,delete n.children,e.addSource(t,n),e.getSource(t)}return null}function Br(e){var t=Object(u.useContext)(Re),r=Object(u.useRef)({id:e.id,type:e.type}),n=c(Object(u.useState)(0),2)[1],i=Object(u.useMemo)((function(){return e.id||"jsx-source-".concat(Lr++)}),[]),a=t.map;Object(u.useEffect)((function(){if(a){var e=function(){return n((function(e){return e+1}))};return a.on("styledata",e),function(){a.off("styledata",e),requestAnimationFrame((function(){a.style&&a.style._loaded&&a.getSource(i)&&a.removeSource(i)}))}}}),[a,i]);var o=a&&a.style&&a.getSource(i);return o?function(e,t,r){me(t.id===r.id,"source id changed"),me(t.type===r.type,"source type changed");var n="",i=0;for(var a in t)"children"===a||"id"===a||Mr(r[a],t[a])||(n=a,i++);if(i){var o=t.type;if("geojson"===o)e.setData(t.data);else if("image"===o)e.updateImage({url:t.url,coordinates:t.coordinates});else if("canvas"!==o&&"video"!==o||1!==i||"coordinates"!==n)if("vector"===o&&e.setUrl)switch(n){case"url":e.setUrl(t.url);break;case"tiles":e.setTiles(t.tiles)}else console.warn("Unable to update <Source> prop: ".concat(n));else e.setCoordinates(t.coordinates)}}(o,e,r.current):o=Dr(a,i,e),r.current=e,o&&u.Children.map(e.children,(function(e){return e&&Object(u.cloneElement)(e,{source:i})}))||null}Br.propTypes=Or;function Nr(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zr(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var jr={type:l.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,id:l.string,source:l.string,beforeId:l.string};function Ur(e,t,r,n){me(r.id===n.id,"layer id changed"),me(r.type===n.type,"layer type changed");try{!function(e,t,r,n){var i=r.layout,a=void 0===i?{}:i,o=r.paint,s=void 0===o?{}:o,u=r.filter,l=r.minzoom,c=r.maxzoom,h=r.beforeId,f=Nr(r,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(h!==n.beforeId&&e.moveLayer(t,h),a!==n.layout){var d=n.layout||{};for(var p in a)Mr(a[p],d[p])||e.setLayoutProperty(t,p,a[p]);for(var y in d)a.hasOwnProperty(y)||e.setLayoutProperty(t,y,void 0)}if(s!==n.paint){var v=n.paint||{};for(var m in s)Mr(s[m],v[m])||e.setPaintProperty(t,m,s[m]);for(var g in v)s.hasOwnProperty(g)||e.setPaintProperty(t,g,void 0)}for(var _ in Mr(u,n.filter)||e.setFilter(t,u),l===n.minzoom&&c===n.maxzoom||e.setLayerZoomRange(t,l,c),f)Mr(f[_],n[_])||e.setLayerProperty(t,_,f[_])}(e,t,r,n)}catch(i){console.warn(i)}}var Vr=0;function qr(e){var t=Object(u.useContext)(Re),r=Object(u.useRef)({id:e.id,type:e.type}),n=c(Object(u.useState)(0),2)[1],i=Object(u.useMemo)((function(){return e.id||"jsx-layer-".concat(Vr++)}),[]),a=t.map;return Object(u.useEffect)((function(){if(a){var e=function(){return n((function(e){return e+1}))};return a.on("styledata",e),function(){a.off("styledata",e),a.style&&a.style._loaded&&a.removeLayer(i)}}}),[a]),a&&a.style&&a.getLayer(i)?Ur(a,i,e,r.current):function(e,t,r){if(e.style&&e.style._loaded){var n=Fr(Fr({},r),{},{id:t});delete n.beforeId,e.addLayer(n,r.beforeId)}}(a,i,e),r.current=e,null}qr.propTypes=jr;var Gr={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},Kr={captureScroll:l.bool,captureDrag:l.bool,captureClick:l.bool,captureDoubleClick:l.bool,capturePointerMove:l.bool};function Hr(e){var t=e.containerRef.current,r=e.context.eventManager;if(t&&r){var n={wheel:function(t){var r=e.props;r.captureScroll&&t.stopPropagation(),r.onScroll&&r.onScroll(t,e)},panstart:function(t){var r=e.props;r.captureDrag&&t.stopPropagation(),r.onDragStart&&r.onDragStart(t,e)},anyclick:function(t){var r=e.props;r.captureClick&&t.stopPropagation(),r.onClick&&r.onClick(t,e)},click:function(t){var r=e.props;r.captureClick&&t.stopPropagation(),r.onClick&&r.onClick(t,e)},dblclick:function(t){var r=e.props;r.captureDoubleClick&&t.stopPropagation(),r.onDoubleClick&&r.onDoubleClick(t,e)},pointermove:function(t){var r=e.props;r.capturePointerMove&&t.stopPropagation(),r.onPointerMove&&r.onPointerMove(t,e)}};return r.watch(n,t),function(){r.off(n)}}}function Wr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(u.useContext)(Re),r=Object(u.useRef)(null),n=Object(u.useRef)({props:e,state:{},context:t,containerRef:r}),i=n.current;return i.props=e,i.context=t,Object(u.useEffect)((function(){return Hr(i)}),[t.eventManager]),i}function Zr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Je(e);if(t){var i=Je(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return Qe(this,r)}}function Yr(e){var t=e.instance,r=Wr(e),n=r.context,i=r.containerRef;return t._context=n,t._containerRef=i,t._render()}var Xr=function(e){Ze(r,e);var t=Zr(r);function r(){var e;Object(he.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e=t.call.apply(t,[this].concat(i)),Object(s.a)(He(e),"_context",{}),Object(s.a)(He(e),"_containerRef",Object(u.createRef)()),Object(s.a)(He(e),"_onScroll",(function(e){})),Object(s.a)(He(e),"_onDragStart",(function(e){})),Object(s.a)(He(e),"_onDblClick",(function(e){})),Object(s.a)(He(e),"_onClick",(function(e){})),Object(s.a)(He(e),"_onPointerMove",(function(e){})),e}return Object(fe.a)(r,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return u.createElement(Yr,n({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),r}(u.PureComponent);function Qr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qr(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Object(s.a)(Xr,"propTypes",Kr),Object(s.a)(Xr,"defaultProps",Gr);var $r=Object.assign({},Kr,{draggable:l.bool,onDrag:l.func,onDragEnd:l.func,onDragStart:l.func,offsetLeft:l.number,offsetTop:l.number}),en=Object.assign({},Gr,{draggable:!1,offsetLeft:0,offsetTop:0});function tn(e){var t=e.offsetCenter;return[t.x,t.y]}function rn(e,t,r,n){var i=e[0]+t[0]-r.offsetLeft,a=e[1]+t[1]-r.offsetTop;return n.viewport.unproject([i,a])}function nn(e,t){var r=t.props,n=t.callbacks,i=t.state,a=t.context,o=t.containerRef;if(r.draggable){e.stopPropagation();var s=tn(e),u=function(e,t){var r=e.center,n=r.x,i=r.y;if(t){var a=t.getBoundingClientRect();return[a.left-n,a.top-i]}return null}(e,o.current);if(i.setDragPos(s),i.setDragOffset(u),n.onDragStart&&u){var l=Object.assign({},e);l.lngLat=rn(s,u,r,a),n.onDragStart(l)}}}function an(e){var t=e.context.eventManager;if(t&&e.state.dragPos){var r={panmove:function(t){return function(e,t){var r=t.props,n=t.callbacks,i=t.state,a=t.context;e.stopPropagation();var o=tn(e);i.setDragPos(o);var s=i.dragOffset;if(n.onDrag&&s){var u=Object.assign({},e);u.lngLat=rn(o,s,r,a),n.onDrag(u)}}(t,e)},panend:function(t){return function(e,t){var r=t.props,n=t.callbacks,i=t.state,a=t.context;e.stopPropagation();var o=i.dragPos,s=i.dragOffset;if(i.setDragPos(null),i.setDragOffset(null),n.onDragEnd&&o&&s){var u=Object.assign({},e);u.lngLat=rn(o,s,r,a),n.onDragEnd(u)}}(t,e)},pancancel:function(t){return function(e,t){var r=t.state;e.stopPropagation(),r.setDragPos(null),r.setDragOffset(null)}(t,e)}};return t.watch(r),function(){t.off(r)}}}var on="undefined"!==typeof window&&window.devicePixelRatio||1,sn=function(e){return Math.round(e*on)/on},un=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===e)return t;var n="x"===r?e.offsetWidth:e.offsetHeight;return sn(t/100*n)/n*100},ln=Object.assign({},$r,{className:l.string,longitude:l.number.isRequired,latitude:l.number.isRequired}),cn=Object.assign({},en,{className:""});function hn(e){var t=function(e){var t=c(Object(u.useState)(null),2),r=t[0],n=t[1],i=c(Object(u.useState)(null),2),a=i[0],o=i[1],s=Wr(Jr(Jr({},e),{},{onDragStart:nn}));return s.callbacks=e,s.state.dragPos=r,s.state.setDragPos=n,s.state.dragOffset=a,s.state.setDragOffset=o,Object(u.useEffect)((function(){return an(s)}),[s.context.eventManager,Boolean(r)]),s}(e),r=t.state,n=t.containerRef,i=e.children,a=e.className,o=e.draggable,s=r.dragPos,l=function(e){var t=e.props,r=e.state,n=e.context,i=t.longitude,a=t.latitude,o=t.offsetLeft,s=t.offsetTop,u=r.dragPos,l=r.dragOffset,h=n.viewport,f=n.map;if(u&&l)return[u[0]+l[0],u[1]+l[1]];var d=Pe(f,{longitude:i,latitude:a}),p=c(h.project([i,a,d]),2),y=p[0],v=p[1];return[y+=o,v+=s]}(t),h=c(l,2),f=h[0],d=h[1],p="translate(".concat(sn(f),"px, ").concat(sn(d),"px)"),y=o?s?"grabbing":"grab":"auto",v=Object(u.useMemo)((function(){var e={position:"absolute",left:0,top:0,transform:p,cursor:y};return u.createElement("div",{className:"mapboxgl-marker ".concat(a),ref:t.containerRef,style:e},i)}),[i,a]),m=n.current;return m&&(m.style.transform=p,m.style.cursor=y),v}hn.defaultProps=cn,hn.propTypes=ln;var fn=u.memo(hn),dn={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},pn=Object.keys(dn);function yn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mn=Object.assign({},Kr,{className:l.string,longitude:l.number.isRequired,latitude:l.number.isRequired,altitude:l.number,offsetLeft:l.number,offsetTop:l.number,tipSize:l.number,closeButton:l.bool,closeOnClick:l.bool,anchor:l.oneOf(Object.keys(dn)),dynamicPosition:l.bool,sortByDepth:l.bool,onClose:l.func}),gn=Object.assign({},Gr,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function _n(e,t,r,n){var i=c(n,2),a=i[0],o=i[1],s=e.anchor,u=e.dynamicPosition,l=e.tipSize;return r&&u?function(e){var t=e.x,r=e.y,n=e.width,i=e.height,a=e.selfWidth,o=e.selfHeight,s=e.anchor,u=e.padding,l=void 0===u?0:u,c=dn[s],h=c.x,f=c.y,d=r-f*o,p=d+o,y=Math.max(0,l-d)+Math.max(0,p-i+l);if(y>0){var v=f,m=y;for(f=0;f<=1;f+=.5)p=(d=r-f*o)+o,(y=Math.max(0,l-d)+Math.max(0,p-i+l))<m&&(m=y,v=f);f=v}var g=.5;.5===f&&(h=Math.floor(h),g=1);var _=t-h*a,b=_+a,w=Math.max(0,l-_)+Math.max(0,b-n+l);if(w>0){var x=h,k=w;for(h=0;h<=1;h+=g)b=(_=t-h*a)+a,(w=Math.max(0,l-_)+Math.max(0,b-n+l))<k&&(k=w,x=h);h=x}return pn.find((function(e){var t=dn[e];return t.x===h&&t.y===f}))||s}({x:a,y:o,anchor:s,padding:l,width:t.width,height:t.height,selfWidth:r.clientWidth,selfHeight:r.clientHeight}):s}function bn(e,t){var r=t.props,n=t.context;(r.closeOnClick||"mapboxgl-popup-close-button"===e.target.className)&&(r.onClose(),n.eventManager&&n.eventManager.once("click",(function(e){return e.stopPropagation()}),e.target))}function wn(e){var t=Object(u.useRef)(null),r=Wr(vn(vn({},e),{},{onClick:bn})),n=r.context,i=r.containerRef,a=c(Object(u.useState)(!1),2)[1];Object(u.useEffect)((function(){a(!0)}),[t.current]);var o=n.viewport,s=n.map,l=e.className,h=e.longitude,f=e.latitude,d=e.tipSize,p=e.closeButton,y=e.children,v=e.altitude;void 0===v&&(v=Pe(s,{longitude:h,latitude:f}));var m=o.project([h,f,v]),g=_n(e,o,t.current,m),_=function(e,t,r,n,i){var a=c(n,3),o=a[0],s=a[1],u=a[2],l=e.offsetLeft,h=e.offsetTop,f=e.sortByDepth,d=dn[i],p=o+l,y=s+h,v=un(r,100*-d.x),m=un(r,100*-d.y,"y"),g={position:"absolute",transform:"\n      translate(".concat(v,"%, ").concat(m,"%)\n      translate(").concat(sn(p),"px, ").concat(sn(y),"px)\n    "),display:void 0,zIndex:void 0};return f?(u>1||u<-1||o<0||o>t.width||s<0||s>t.height?g.display="none":g.zIndex=Math.floor((1-u)/2*1e5),g):g}(e,o,i.current,m,g),b=Object(u.useCallback)((function(e){return!n.eventManager&&bn(e,r)}),[n.eventManager]);return u.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(g," ").concat(l),style:_,ref:i},u.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:d}}),u.createElement("div",{key:"content",ref:t,className:"mapboxgl-popup-content",onClick:b},p&&u.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button"},"\xd7"),y))}wn.propTypes=mn,wn.defaultProps=gn;var xn=u.memo(wn);function kn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var En=Object.assign({},Kr,{toggleLabel:l.string,className:l.string,style:l.object,compact:l.bool,customAttribution:l.oneOfType([l.string,l.arrayOf(l.string)])}),Sn=Object.assign({},Gr,{className:"",toggleLabel:"Toggle Attribution"});function Tn(e){var t=Wr(e),r=t.context,n=t.containerRef,i=Object(u.useRef)(null),a=c(Object(u.useState)(!1),2),o=a[0],l=a[1];Object(u.useEffect)((function(){var t;return r.map&&(t=function(e,t,r,n){var i=new ce.a.AttributionControl(e);return i._map=t,i._container=r,i._innerContainer=n,i._updateAttributions(),i._updateEditLink(),t.on("styledata",i._updateData),t.on("sourcedata",i._updateData),i}({customAttribution:e.customAttribution},r.map,n.current,i.current)),function(){return t&&function(e){e._map.off("styledata",e._updateData),e._map.off("sourcedata",e._updateData)}(t)}}),[r.map]);var h=void 0===e.compact?r.viewport.width<=640:e.compact;Object(u.useEffect)((function(){!h&&o&&l(!1)}),[h]);var f=Object(u.useCallback)((function(){return l((function(e){return!e}))}),[]),d=Object(u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute"},e.style)}),[e.style]);return u.createElement("div",{style:d,className:e.className},u.createElement("div",{ref:n,"aria-pressed":o,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(h?"mapboxgl-compact":""," ").concat(o?"mapboxgl-compact-show":"")},u.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:e.toggleLabel,onClick:f}),u.createElement("div",{ref:i,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}Tn.propTypes=En,Tn.defaultProps=Sn;u.memo(Tn);var An=r(793);function Cn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var In=Object.assign({},Kr,{className:l.string,style:l.object,container:l.object,label:l.string}),Rn=Object.assign({},Gr,{className:"",container:null,label:"Toggle fullscreen"});function Mn(e){var t=Wr(e),r=t.context,n=t.containerRef,i=c(Object(u.useState)(!1),2),a=i[0],o=i[1],l=c(Object(u.useState)(!1),2),h=l[0],f=l[1],d=c(Object(u.useState)(null),2),p=d[0],y=d[1];Object(u.useEffect)((function(){var e=new ce.a.FullscreenControl;y(e),f(e._checkFullscreenSupport());var t=function(){var t=!e._fullscreen;e._fullscreen=t,o(t)};return An.a.addEventListener(e._fullscreenchange,t),function(){An.a.removeEventListener(e._fullscreenchange,t)}}),[]);var v=Object(u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Cn(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute"},e.style)}),[e.style]);if(!h)return null;var m=e.className,g=e.label,_=a?"shrink":"fullscreen";return u.createElement("div",{style:v,className:m},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},u.createElement("button",{key:_,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(_),type:"button",title:g,onClick:function(){p&&(p._container=e.container||r.container,p._onClickFullscreen())}},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Mn.propTypes=In,Mn.defaultProps=Rn;var Pn,On=u.memo(Mn);function Ln(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Dn=function(){},Bn=Object.assign({},Kr,{className:l.string,style:l.object,label:l.string,disabledLabel:l.string,auto:l.bool,positionOptions:l.object,fitBoundsOptions:l.object,trackUserLocation:l.bool,showUserLocation:l.bool,showAccuracyCircle:l.bool,onViewStateChange:l.func,onViewportChange:l.func,onGeolocate:l.func}),Nn=Object.assign({},Gr,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showAccuracyCircle:!0,onGeolocate:function(){}});function zn(e,t){var r=t.context,n=t.props,i=function(e){var t=new ce.a.LngLat(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,n=t.toBounds(r);return[[n._ne.lng,n._ne.lat],[n._sw.lng,n._sw.lat]]}(e),a=r.viewport.fitBounds(i,n.fitBoundsOptions),o=a.longitude,s=a.latitude,u=a.zoom,l=Object.assign({},r.viewport,{longitude:o,latitude:s,zoom:u}),c=new Ee(l),h=Object.assign({},c.getViewportProps(),sr),f=n.onViewportChange||r.onViewportChange||Dn;(n.onViewStateChange||r.onViewStateChange||Dn)({viewState:h}),f(h)}function Fn(e){var t=Wr(e),r=t.context,n=t.containerRef,i=Object(u.useRef)(null),a=c(Object(u.useState)(null),2),o=a[0],l=a[1],h=c(Object(u.useState)(!1),2),f=h[0],d=h[1];Object(u.useEffect)((function(){var n;return r.map&&(void 0!==Pn?Promise.resolve(Pn):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(e){return Pn="denied"!==e.state})):(Pn=Boolean(window.navigator.geolocation),Promise.resolve(Pn))).then((function(a){d(a),i.current&&((n=function(e,t,r){var n=new ce.a.GeolocateControl(t);n._container=An.a.createElement("div"),n._map={on:function(){},_getUIString:function(){return""}},n._setupUI(!0),n._map=e.map,n._geolocateButton=r;var i=e.eventManager;return n.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===n._watchState&&(n._watchState="BACKGROUND",r.classList.add("mapboxgl-ctrl-geolocate-background"),r.classList.remove("mapboxgl-ctrl-geolocate-active"))})),n.on("geolocate",t.onGeolocate),n}(r,e,i.current))._updateCamera=function(e){return zn(e,t)},l(n))})),function(){n&&n._clearWatch()}}),[r.map]);var p=Object(u.useCallback)((function(){o&&(o.options=t.props,o.trigger())}),[o]);Object(u.useEffect)((function(){e.auto&&p()}),[o,e.auto]),Object(u.useEffect)((function(){o&&o._onZoom()}),[r.viewport.zoom]);var y=e.className,v=e.label,m=e.disabledLabel,g=e.trackUserLocation,_=Object(u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ln(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute"},e.style)}),[e.style]);return u.createElement("div",{style:_,className:y},u.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},u.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:i,disabled:!f,"aria-pressed":!g,type:"button",title:f?v:m,"aria-label":f?v:m,onClick:p},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Fn.propTypes=Bn,Fn.defaultProps=Nn;var jn=u.memo(Fn);function Un(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Vn=function(){},qn=Object.assign({},Kr,{className:l.string,style:l.object,onViewStateChange:l.func,onViewportChange:l.func,showCompass:l.bool,showZoom:l.bool,zoomInLabel:l.string,zoomOutLabel:l.string,compassLabel:l.string}),Gn=Object.assign({},Gr,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function Kn(e){return function(e,t){for(var r=(e||"").split(".").map(Number),n=(t||"").split(".").map(Number),i=0;i<3;i++){var a=r[i]||0,o=n[i]||0;if(a<o)return-1;if(a>o)return 1}return 0}(e,"1.6.0")>=0?2:1}function Hn(e,t,r){var n=e.viewport,i=new Ee(Object.assign({},n,r)),a=Object.assign({},i.getViewportProps(),sr),o=t.onViewportChange||e.onViewportChange||Vn;(t.onViewStateChange||e.onViewStateChange||Vn)({viewState:a}),o(a)}function Wn(e,t,r,n){return u.createElement("button",{key:e,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(e),type:"button",title:t,onClick:r},n||u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function Zn(e){var t=Wr(e),r=t.context,n=t.containerRef,i=e.className,a=e.showCompass,o=e.showZoom,l=e.zoomInLabel,c=e.zoomOutLabel,h=e.compassLabel,f=Object(u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Un(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute"},e.style)}),[e.style]);return u.createElement("div",{style:f,className:i},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:n},o&&Wn("zoom-in",l,(function(){Hn(r,e,{zoom:r.viewport.zoom+1})})),o&&Wn("zoom-out",c,(function(){Hn(r,e,{zoom:r.viewport.zoom-1})})),a&&Wn("compass",h,(function(){Hn(r,e,{bearing:0,pitch:0})}),function(e){var t=Object(u.useMemo)((function(){return e.map?Kn(e.map.version):2}),[e.map]),r=e.viewport.bearing,n={transform:"rotate(".concat(-r,"deg)")};return 2===t?u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:n}):u.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:n})}(r))))}Zn.propTypes=qn,Zn.defaultProps=Gn;var Yn=u.memo(Zn);function Xn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Qn=Object.assign({},Kr,{className:l.string,style:l.object,maxWidth:l.number,unit:l.oneOf(["imperial","metric","nautical"])}),Jn=Object.assign({},Gr,{className:"",maxWidth:100,unit:"metric"});function $n(e){var t=Wr(e),r=t.context,n=t.containerRef,i=c(Object(u.useState)(null),2),a=i[0],o=i[1];Object(u.useEffect)((function(){if(r.map){var e=new ce.a.ScaleControl;e._map=r.map,e._container=n.current,o(e)}}),[r.map]),a&&(a.options=e,a._onMove());var l=Object(u.useMemo)((function(){return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xn(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute"},e.style)}),[e.style]);return u.createElement("div",{style:l,className:e.className},u.createElement("div",{ref:n,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}$n.propTypes=Qn,$n.defaultProps=Jn;var ei=u.memo($n),ti="undefined"!==typeof window&&window.devicePixelRatio||1,ri=Object.assign({},Kr,{redraw:l.func.isRequired});function ni(e){var t=Wr(e),r=t.context,n=t.containerRef,i=c(Object(u.useState)(null),2),a=i[0],o=i[1];Object(u.useEffect)((function(){o(n.current.getContext("2d"))}),[]);var s=r.viewport,l=r.isDragging;return a&&(a.save(),a.scale(ti,ti),e.redraw({width:s.width,height:s.height,ctx:a,isDragging:l,project:s.project,unproject:s.unproject}),a.restore()),u.createElement("canvas",{ref:n,width:s.width*ti,height:s.height*ti,style:{width:"".concat(s.width,"px"),height:"".concat(s.height,"px"),position:"absolute",left:0,top:0}})}ni.propTypes=ri,ni.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function ii(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var ai=Object.assign({},Kr,{redraw:l.func.isRequired,style:l.object});function oi(e){var t=Wr(e),r=t.context,n=t.containerRef,i=r.viewport,a=r.isDragging,o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ii(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute",left:0,top:0,width:i.width,height:i.height},e.style);return u.createElement("div",{ref:n,style:o},e.redraw({width:i.width,height:i.height,isDragging:a,project:i.project,unproject:i.unproject}))}oi.propTypes=ai,oi.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function si(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var ui=Object.assign({},Kr,{redraw:l.func.isRequired,style:l.object});function li(e){var t=Wr(e),r=t.context,n=t.containerRef,i=r.viewport,a=r.isDragging,o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?si(Object(r),!0).forEach((function(t){Object(s.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):si(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({position:"absolute",left:0,top:0},e.style);return u.createElement("svg",{width:i.width,height:i.height,ref:n,style:o},e.redraw({width:i.width,height:i.height,isDragging:a,project:i.project,unproject:i.unproject}))}li.propTypes=ui,li.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};ce.a&&ce.a.setRTLTextPlugin},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){"use strict";(function(e){var r=function(){if("undefined"!==typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,n){return e[0]===t&&(r=n,!0)})),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r++){var i=n[r];e.call(t,i[1],i[0])}},t}()}(),n="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,i="undefined"!==typeof e&&e.Math===Math?e:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),a="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(i):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)};var o=["top","right","bottom","left","width","height","size","weight"],s="undefined"!==typeof MutationObserver,u=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,n=!1,i=0;function o(){r&&(r=!1,e()),n&&u()}function s(){a(o)}function u(){var e=Date.now();if(r){if(e-i<2)return;n=!0}else r=!0,n=!1,setTimeout(s,t);i=e}return u}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),s?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,r=void 0===t?"":t;o.some((function(e){return!!~r.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),l=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},c=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||i},h=m(0,0,0,0);function f(e){return parseFloat(e)||0}function d(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.reduce((function(t,r){return t+f(e["border-"+r+"-width"])}),0)}function p(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return h;var n=c(e).getComputedStyle(e),i=function(e){for(var t={},r=0,n=["top","right","bottom","left"];r<n.length;r++){var i=n[r],a=e["padding-"+i];t[i]=f(a)}return t}(n),a=i.left+i.right,o=i.top+i.bottom,s=f(n.width),u=f(n.height);if("border-box"===n.boxSizing&&(Math.round(s+a)!==t&&(s-=d(n,"left","right")+a),Math.round(u+o)!==r&&(u-=d(n,"top","bottom")+o)),!function(e){return e===c(e).document.documentElement}(e)){var l=Math.round(s+a)-t,p=Math.round(u+o)-r;1!==Math.abs(l)&&(s-=l),1!==Math.abs(p)&&(u-=p)}return m(i.left,i.top,s,u)}var y="undefined"!==typeof SVGGraphicsElement?function(e){return e instanceof c(e).SVGGraphicsElement}:function(e){return e instanceof c(e).SVGElement&&"function"===typeof e.getBBox};function v(e){return n?y(e)?function(e){var t=e.getBBox();return m(0,0,t.width,t.height)}(e):p(e):h}function m(e,t,r,n){return{x:e,y:t,width:r,height:n}}var g=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=v(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),_=function(e,t){var r=function(e){var t=e.x,r=e.y,n=e.width,i=e.height,a="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,o=Object.create(a.prototype);return l(o,{x:t,y:r,width:n,height:i,top:r,right:t+n,bottom:i+r,left:t}),o}(t);l(this,{target:e,contentRect:r})},b=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new r,"function"!==typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new g(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(e instanceof c(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new _(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),w="undefined"!==typeof WeakMap?new WeakMap:new r,x=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var r=u.getInstance(),n=new b(t,r,this);w.set(this,n)};["observe","unobserve","disconnect"].forEach((function(e){x.prototype[e]=function(){var t;return(t=w.get(this))[e].apply(t,arguments)}}));var k="undefined"!==typeof i.ResizeObserver?i.ResizeObserver:x;t.a=k}).call(this,r(22))},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return f}));var n=r(686),i=r(687),a=r(669),o=r(57),s=r(793),u=r(1099);var l={container:o.object,gl:o.object,mapboxApiAccessToken:o.string,mapboxApiUrl:o.string,attributionControl:o.bool,preserveDrawingBuffer:o.bool,reuseMaps:o.bool,transformRequest:o.func,mapOptions:o.object,mapStyle:o.oneOfType([o.string,o.object]),preventStyleDiffing:o.bool,visible:o.bool,asyncRender:o.bool,onLoad:o.func,onError:o.func,width:o.number,height:o.number,viewState:o.object,longitude:o.number,latitude:o.number,zoom:o.number,bearing:o.number,pitch:o.number,altitude:o.number},c={container:s.a.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!==typeof window&&window.location){var r=window.location.search.match(/access_token=([^&\/]*)/);t=r&&r[1]}t||"undefined"===typeof e||(t=t||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RECAPTCHA_TOKEN:"6Lest7wbAAAAAPRzQ2ZGU-w_O9v-gbnw3fK1l98u",REACT_APP_MAP_TOKEN:"pk.eyJ1IjoibWljaGFlbDEwIiwiYSI6ImNrcndxejR4ZjA1Nmcydm5vNzM4YTdsdWIifQ.bGHbfUZ1juBxAL55eGMSnA",REACT_APP_API_URL:"https://api.testleekdao.xyz/",REACT_APP_LOTTERY_OWNER:"0xB232D899b39Ee282EC26BBA385497b9FCD150ED3",REACT_APP_API_USERNAME:"leekdao",REACT_APP_NODE_1:"https://rpc-mumbai.maticvigil.com/",REACT_APP_NODE_3:"https://rpc-mumbai.matic.today/",REACT_APP_NODE_2:"https://polygon-mumbai.infura.io/v3/cddf815255c54292a6d96f68893e8034",REACT_APP_CHAIN_ID:"80001",REACT_APP_API_PASSWORD:"LuckyDraw!123"}).MapboxAccessToken||Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RECAPTCHA_TOKEN:"6Lest7wbAAAAAPRzQ2ZGU-w_O9v-gbnw3fK1l98u",REACT_APP_MAP_TOKEN:"pk.eyJ1IjoibWljaGFlbDEwIiwiYSI6ImNrcndxejR4ZjA1Nmcydm5vNzM4YTdsdWIifQ.bGHbfUZ1juBxAL55eGMSnA",REACT_APP_API_URL:"https://api.testleekdao.xyz/",REACT_APP_LOTTERY_OWNER:"0xB232D899b39Ee282EC26BBA385497b9FCD150ED3",REACT_APP_API_USERNAME:"leekdao",REACT_APP_NODE_1:"https://rpc-mumbai.maticvigil.com/",REACT_APP_NODE_3:"https://rpc-mumbai.matic.today/",REACT_APP_NODE_2:"https://polygon-mumbai.infura.io/v3/cddf815255c54292a6d96f68893e8034",REACT_APP_CHAIN_ID:"80001",REACT_APP_API_PASSWORD:"LuckyDraw!123"}).REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(e){e&&console.error(e.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";e.debug&&o.checkPropTypes(l,e,"prop",t)}var f=function(){function e(t){var r=this;if(Object(n.a)(this,e),Object(a.a)(this,"props",c),Object(a.a)(this,"width",0),Object(a.a)(this,"height",0),Object(a.a)(this,"_fireLoadEvent",(function(){r.props.onLoad({type:"load",target:r._map})})),!t.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=t.mapboxgl,e.initialized||(e.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(t)}return Object(i.a)(e,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(e){return this._update(this.props,e),this}},{key:"redraw",value:function(){var e=this._map;e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(t){this._map=e.savedMap;var r=this._map.getContainer(),n=t.container;for(n.classList.add("mapboxgl-map");r.childNodes.length>0;)n.appendChild(r.childNodes[0]);this._map._container=n,e.savedMap=null,t.mapStyle&&this._map.setStyle(Object(u.a)(t.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(t){if(t.reuseMaps&&e.savedMap)this._reuse(t);else{if(t.gl){var r=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=r,t.gl}}var n={container:t.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:Object(u.a)(t.mapStyle),interactive:!1,trackResize:!1,attributionControl:t.attributionControl,preserveDrawingBuffer:t.preserveDrawingBuffer};t.transformRequest&&(n.transformRequest=t.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},n,t.mapOptions)),this._map.once("load",t.onLoad),this._map.on("error",t.onError)}return this}},{key:"_destroy",value:function(){this._map&&(e.savedMap?this._map.remove():(e.savedMap=this._map,this._map.off("load",this.props.onLoad),this._map.off("error",this.props.onError),this._map.off("styledata",this._fireLoadEvent)),this._map=null)}},{key:"_initialize",value:function(e){var t=this;h(e=Object.assign({},c,e),"Mapbox"),this.mapboxgl.accessToken=e.mapboxApiAccessToken||c.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=e.mapboxApiUrl,this._create(e);var r=e.container;Object.defineProperty(r,"offsetWidth",{get:function(){return t.width}}),Object.defineProperty(r,"clientWidth",{get:function(){return t.width}}),Object.defineProperty(r,"offsetHeight",{get:function(){return t.height}}),Object.defineProperty(r,"clientHeight",{get:function(){return t.height}});var n=this._map.getCanvas();n&&(n.style.outline="none"),this._updateMapViewport({},e),this._updateMapSize({},e),this.props=e}},{key:"_update",value:function(e,t){if(this._map){h(t=Object.assign({},this.props,t),"Mapbox");var r=this._updateMapViewport(e,t),n=this._updateMapSize(e,t);this._updateMapStyle(e,t),t.asyncRender||!r&&!n||this.redraw(),this.props=t}}},{key:"_updateMapStyle",value:function(e,t){e.mapStyle!==t.mapStyle&&this._map.setStyle(Object(u.a)(t.mapStyle),{diff:!t.preventStyleDiffing})}},{key:"_updateMapSize",value:function(e,t){var r=e.width!==t.width||e.height!==t.height;return r&&(this.width=t.width,this.height=t.height,this._map.resize()),r}},{key:"_updateMapViewport",value:function(e,t){var r=this._getViewState(e),n=this._getViewState(t),i=n.latitude!==r.latitude||n.longitude!==r.longitude||n.zoom!==r.zoom||n.pitch!==r.pitch||n.bearing!==r.bearing||n.altitude!==r.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(n)),n.altitude!==r.altitude&&(this._map.transform.altitude=n.altitude)),i}},{key:"_getViewState",value:function(e){var t=e.viewState||e,r=t.longitude,n=t.latitude,i=t.zoom,a=t.pitch,o=void 0===a?0:a,s=t.bearing,u=void 0===s?0:s,l=t.altitude;return{longitude:r,latitude:n,zoom:i,pitch:o,bearing:u,altitude:void 0===l?1.5:l}}},{key:"_checkStyleSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof s.a)try{var t=s.a.createElement("div");t.className="mapboxgl-map",t.style.display="none",s.a.body.appendChild(t);var r="static"!==window.getComputedStyle(t).position;if(!r){var n=s.a.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(e,"/mapbox-gl.css")),s.a.head.appendChild(n)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(e){return{center:[e.longitude,e.latitude],zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}}}]),e}();Object(a.a)(f,"initialized",!1),Object(a.a)(f,"propTypes",l),Object(a.a)(f,"defaultProps",c),Object(a.a)(f,"savedMap",null)}).call(this,r(21))},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(669);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function l(e){if(!e)return null;if("string"===typeof e)return e;e.toJS&&(e=e.toJS());var t,r={},n=o(e.layers);try{for(n.s();!(t=n.n()).done;){var i=t.value;r[i.id]=i}}catch(l){n.e(l)}finally{n.f()}var s=e.layers.map((function(e){var t=r[e.ref],n=null;if("interactive"in e&&delete(n=a({},e)).interactive,t){delete(n=n||a({},e)).ref;var i,s=o(u);try{for(s.s();!(i=s.n()).done;){var c=i.value;c in t&&(n[c]=t[c])}}catch(l){s.e(l)}finally{s.f()}}return n||e}));return a(a({},e),{},{layers:s})}},function(e,t,r){var n=r(331),i=r(334),a=r(135),o=r(332);e.exports=function(e){return n(e)||i(e)||a(e)||o()}},function(e,t,r){var n=r(314),i=r(182),a=r(1102),o=r(322);function s(t){var r="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!a(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return o(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t){function r(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(e.exports=r=function(e){return typeof e},e.exports.default=e.exports,e.exports.__esModule=!0):(e.exports=r=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.default=e.exports,e.exports.__esModule=!0),r(t)}e.exports=r,e.exports.default=e.exports,e.exports.__esModule=!0},function(e,t,r){var n;!function(i,a,o,s){"use strict";var u,l=["","webkit","Moz","MS","ms","o"],c=a.createElement("div"),h=Math.round,f=Math.abs,d=Date.now;function p(e,t,r){return setTimeout(w(e,r),t)}function y(e,t,r){return!!Array.isArray(e)&&(v(e,r[t],r),!0)}function v(e,t,r){var n;if(e)if(e.forEach)e.forEach(t,r);else if(e.length!==s)for(n=0;n<e.length;)t.call(r,e[n],n,e),n++;else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}function m(e,t,r){var n="DEPRECATED METHOD: "+t+"\n"+r+" AT \n";return function(){var t=new Error("get-stack-trace"),r=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=i.console&&(i.console.warn||i.console.log);return a&&a.call(i.console,n,r),e.apply(this,arguments)}}u="function"!==typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(n!==s&&null!==n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}:Object.assign;var g=m((function(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;)(!r||r&&e[n[i]]===s)&&(e[n[i]]=t[n[i]]),i++;return e}),"extend","Use `assign`."),_=m((function(e,t){return g(e,t,!0)}),"merge","Use `assign`.");function b(e,t,r){var n,i=t.prototype;(n=e.prototype=Object.create(i)).constructor=e,n._super=i,r&&u(n,r)}function w(e,t){return function(){return e.apply(t,arguments)}}function x(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function k(e,t){return e===s?t:e}function E(e,t,r){v(C(t),(function(t){e.addEventListener(t,r,!1)}))}function S(e,t,r){v(C(t),(function(t){e.removeEventListener(t,r,!1)}))}function T(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function A(e,t){return e.indexOf(t)>-1}function C(e){return e.trim().split(/\s+/g)}function I(e,t,r){if(e.indexOf&&!r)return e.indexOf(t);for(var n=0;n<e.length;){if(r&&e[n][r]==t||!r&&e[n]===t)return n;n++}return-1}function R(e){return Array.prototype.slice.call(e,0)}function M(e,t,r){for(var n=[],i=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];I(i,o)<0&&n.push(e[a]),i[a]=o,a++}return r&&(n=t?n.sort((function(e,r){return e[t]>r[t]})):n.sort()),n}function P(e,t){for(var r,n,i=t[0].toUpperCase()+t.slice(1),a=0;a<l.length;){if((n=(r=l[a])?r+i:t)in e)return n;a++}return s}var O=1;function L(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var D="ontouchstart"in i,B=P(i,"PointerEvent")!==s,N=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z="touch",F="mouse",j=24,U=["x","y"],V=["clientX","clientY"];function q(e,t){var r=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){x(e.options.enable,[e])&&r.handler(t)},this.init()}function G(e,t,r){var n=r.pointers.length,i=r.changedPointers.length,a=1&t&&n-i===0,o=12&t&&n-i===0;r.isFirst=!!a,r.isFinal=!!o,a&&(e.session={}),r.eventType=t,function(e,t){var r=e.session,n=t.pointers,i=n.length;r.firstInput||(r.firstInput=K(t));i>1&&!r.firstMultiple?r.firstMultiple=K(t):1===i&&(r.firstMultiple=!1);var a=r.firstInput,o=r.firstMultiple,u=o?o.center:a.center,l=t.center=H(n);t.timeStamp=d(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=X(u,l),t.distance=Y(u,l),function(e,t){var r=t.center,n=e.offsetDelta||{},i=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(i=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=e.offsetDelta={x:r.x,y:r.y});t.deltaX=i.x+(r.x-n.x),t.deltaY=i.y+(r.y-n.y)}(r,t),t.offsetDirection=Z(t.deltaX,t.deltaY);var c=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=c.x,t.overallVelocityY=c.y,t.overallVelocity=f(c.x)>f(c.y)?c.x:c.y,t.scale=o?(h=o.pointers,p=n,Y(p[0],p[1],V)/Y(h[0],h[1],V)):1,t.rotation=o?function(e,t){return X(t[1],t[0],V)+X(e[1],e[0],V)}(o.pointers,n):0,t.maxPointers=r.prevInput?t.pointers.length>r.prevInput.maxPointers?t.pointers.length:r.prevInput.maxPointers:t.pointers.length,function(e,t){var r,n,i,a,o=e.lastInterval||t,u=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(u>25||o.velocity===s)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,h=W(u,l,c);n=h.x,i=h.y,r=f(h.x)>f(h.y)?h.x:h.y,a=Z(l,c),e.lastInterval=t}else r=o.velocity,n=o.velocityX,i=o.velocityY,a=o.direction;t.velocity=r,t.velocityX=n,t.velocityY=i,t.direction=a}(r,t);var h,p;var y=e.element;T(t.srcEvent.target,y)&&(y=t.srcEvent.target);t.target=y}(e,r),e.emit("hammer.input",r),e.recognize(r),e.session.prevInput=r}function K(e){for(var t=[],r=0;r<e.pointers.length;)t[r]={clientX:h(e.pointers[r].clientX),clientY:h(e.pointers[r].clientY)},r++;return{timeStamp:d(),pointers:t,center:H(t),deltaX:e.deltaX,deltaY:e.deltaY}}function H(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var r=0,n=0,i=0;i<t;)r+=e[i].clientX,n+=e[i].clientY,i++;return{x:h(r/t),y:h(n/t)}}function W(e,t,r){return{x:t/e||0,y:r/e||0}}function Z(e,t){return e===t?1:f(e)>=f(t)?e<0?2:4:t<0?8:16}function Y(e,t,r){r||(r=U);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return Math.sqrt(n*n+i*i)}function X(e,t,r){r||(r=U);var n=t[r[0]]-e[r[0]],i=t[r[1]]-e[r[1]];return 180*Math.atan2(i,n)/Math.PI}q.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(L(this.element),this.evWin,this.domHandler)}};var Q={mousedown:1,mousemove:2,mouseup:4},J="mousedown",$="mousemove mouseup";function ee(){this.evEl=J,this.evWin=$,this.pressed=!1,q.apply(this,arguments)}b(ee,q,{handler:function(e){var t=Q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:F,srcEvent:e}))}});var te={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},re={2:z,3:"pen",4:F,5:"kinect"},ne="pointerdown",ie="pointermove pointerup pointercancel";function ae(){this.evEl=ne,this.evWin=ie,q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",ie="MSPointerMove MSPointerUp MSPointerCancel"),b(ae,q,{handler:function(e){var t=this.store,r=!1,n=e.type.toLowerCase().replace("ms",""),i=te[n],a=re[e.pointerType]||e.pointerType,o=a==z,s=I(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&i&&(r=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),r&&t.splice(s,1))}});var oe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},se="touchstart",ue="touchstart touchmove touchend touchcancel";function le(){this.evTarget=se,this.evWin=ue,this.started=!1,q.apply(this,arguments)}function ce(e,t){var r=R(e.touches),n=R(e.changedTouches);return 12&t&&(r=M(r.concat(n),"identifier",!0)),[r,n]}b(le,q,{handler:function(e){var t=oe[e.type];if(1===t&&(this.started=!0),this.started){var r=ce.call(this,e,t);12&t&&r[0].length-r[1].length===0&&(this.started=!1),this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:z,srcEvent:e})}}});var he={touchstart:1,touchmove:2,touchend:4,touchcancel:8},fe="touchstart touchmove touchend touchcancel";function de(){this.evTarget=fe,this.targetIds={},q.apply(this,arguments)}function pe(e,t){var r=R(e.touches),n=this.targetIds;if(3&t&&1===r.length)return n[r[0].identifier]=!0,[r,r];var i,a,o=R(e.changedTouches),s=[],u=this.target;if(a=r.filter((function(e){return T(e.target,u)})),1===t)for(i=0;i<a.length;)n[a[i].identifier]=!0,i++;for(i=0;i<o.length;)n[o[i].identifier]&&s.push(o[i]),12&t&&delete n[o[i].identifier],i++;return s.length?[M(a.concat(s),"identifier",!0),s]:void 0}b(de,q,{handler:function(e){var t=he[e.type],r=pe.call(this,e,t);r&&this.callback(this.manager,t,{pointers:r[0],changedPointers:r[1],pointerType:z,srcEvent:e})}});function ye(){q.apply(this,arguments);var e=w(this.handler,this);this.touch=new de(this.manager,e),this.mouse=new ee(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function ve(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,me.call(this,t)):12&e&&me.call(this,t)}function me(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var r={x:t.clientX,y:t.clientY};this.lastTouches.push(r);var n=this.lastTouches;setTimeout((function(){var e=n.indexOf(r);e>-1&&n.splice(e,1)}),2500)}}function ge(e){for(var t=e.srcEvent.clientX,r=e.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var i=this.lastTouches[n],a=Math.abs(t-i.x),o=Math.abs(r-i.y);if(a<=25&&o<=25)return!0}return!1}b(ye,q,{handler:function(e,t,r){var n=r.pointerType==z,i=r.pointerType==F;if(!(i&&r.sourceCapabilities&&r.sourceCapabilities.firesTouchEvents)){if(n)ve.call(this,t,r);else if(i&&ge.call(this,r))return;this.callback(e,t,r)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _e=P(c.style,"touchAction"),be=_e!==s,we="compute",xe="auto",ke="manipulation",Ee="none",Se="pan-x",Te="pan-y",Ae=function(){if(!be)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(r){e[r]=!t||i.CSS.supports("touch-action",r)})),e}();function Ce(e,t){this.manager=e,this.set(t)}Ce.prototype={set:function(e){e==we&&(e=this.compute()),be&&this.manager.element.style&&Ae[e]&&(this.manager.element.style[_e]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,(function(t){x(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(A(e,Ee))return Ee;var t=A(e,Se),r=A(e,Te);if(t&&r)return Ee;if(t||r)return t?Se:Te;if(A(e,ke))return ke;return xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,r=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var n=this.actions,i=A(n,Ee)&&!Ae.none,a=A(n,Te)&&!Ae["pan-y"],o=A(n,Se)&&!Ae["pan-x"];if(i){var s=1===e.pointers.length,u=e.distance<2,l=e.deltaTime<250;if(s&&u&&l)return}if(!o||!a)return i||a&&6&r||o&&r&j?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ie=32;function Re(e){this.options=u({},this.defaults,e||{}),this.id=O++,this.manager=null,this.options.enable=k(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Me(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function Pe(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Oe(e,t){var r=t.manager;return r?r.get(e):e}function Le(){Re.apply(this,arguments)}function De(){Le.apply(this,arguments),this.pX=null,this.pY=null}function Be(){Le.apply(this,arguments)}function Ne(){Re.apply(this,arguments),this._timer=null,this._input=null}function ze(){Le.apply(this,arguments)}function Fe(){Le.apply(this,arguments)}function je(){Re.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ue(e,t){return(t=t||{}).recognizers=k(t.recognizers,Ue.defaults.preset),new Ve(e,t)}Re.prototype={defaults:{},set:function(e){return u(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(y(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Oe(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return y(e,"dropRecognizeWith",this)||(e=Oe(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(y(e,"requireFailure",this))return this;var t=this.requireFail;return-1===I(t,e=Oe(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(y(e,"dropRequireFailure",this))return this;e=Oe(e,this);var t=I(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,r=this.state;function n(r){t.manager.emit(r,e)}r<8&&n(t.options.event+Me(r)),n(t.options.event),e.additionalEvent&&n(e.additionalEvent),r>=8&&n(t.options.event+Me(r))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ie},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=u({},e);if(!x(this.options.enable,[this,t]))return this.reset(),void(this.state=Ie);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},b(Le,Re,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,r=e.eventType,n=6&t,i=this.attrTest(e);return n&&(8&r||!i)?16|t:n||i?4&r?8|t:2&t?4|t:2:Ie}}),b(De,Le,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Te),e&j&&t.push(Se),t},directionTest:function(e){var t=this.options,r=!0,n=e.distance,i=e.direction,a=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===a?1:a<0?2:4,r=a!=this.pX,n=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,r=o!=this.pY,n=Math.abs(e.deltaY))),e.direction=i,r&&n>t.threshold&&i&t.direction},attrTest:function(e){return Le.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=Pe(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),b(Be,Le,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),b(Ne,Re,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!n||!r||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Ie},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),b(ze,Le,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ee]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),b(Fe,Le,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return De.prototype.getTouchAction.call(this)},attrTest:function(e){var t,r=this.options.direction;return 30&r?t=e.overallVelocity:6&r?t=e.overallVelocityX:r&j&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&r&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=Pe(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),b(je,Re,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ke]},process:function(e){var t=this.options,r=e.pointers.length===t.pointers,n=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(n&&i&&r){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Y(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Ie},failTimeout:function(){return this._timer=p((function(){this.state=Ie}),this.options.interval,this),Ie},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ue.VERSION="2.0.7",Ue.defaults={domEvents:!1,touchAction:we,enable:!0,inputTarget:null,inputClass:null,preset:[[ze,{enable:!1}],[Be,{enable:!1},["rotate"]],[Fe,{direction:6}],[De,{direction:6},["swipe"]],[je],[je,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ve(e,t){var r;this.options=u({},Ue.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((r=this).options.inputClass||(B?ae:N?de:D?ye:ee))(r,G),this.touchAction=new Ce(this,this.options.touchAction),qe(this,!0),v(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function qe(e,t){var r,n=e.element;n.style&&(v(e.options.cssProps,(function(i,a){r=P(n.style,a),t?(e.oldCssProps[r]=n.style[r],n.style[r]=i):n.style[r]=e.oldCssProps[r]||""})),t||(e.oldCssProps={}))}Ve.prototype={set:function(e){return u(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var r;this.touchAction.preventDefaults(e);var n=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var a=0;a<n.length;)r=n[a],2===t.stopped||i&&r!=i&&!r.canRecognizeWith(i)?r.reset():r.recognize(e),!i&&14&r.state&&(i=t.curRecognizer=r),a++}},get:function(e){if(e instanceof Re)return e;for(var t=this.recognizers,r=0;r<t.length;r++)if(t[r].options.event==e)return t[r];return null},add:function(e){if(y(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(y(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,r=I(t,e);-1!==r&&(t.splice(r,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var r=this.handlers;return v(C(e),(function(e){r[e]=r[e]||[],r[e].push(t)})),this}},off:function(e,t){if(e!==s){var r=this.handlers;return v(C(e),(function(e){t?r[e]&&r[e].splice(I(r[e],t),1):delete r[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var r=a.createEvent("Event");r.initEvent(e,!0,!0),r.gesture=t,t.target.dispatchEvent(r)}(e,t);var r=this.handlers[e]&&this.handlers[e].slice();if(r&&r.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var n=0;n<r.length;)r[n](t),n++}},destroy:function(){this.element&&qe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Ue,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ie,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:j,DIRECTION_ALL:30,Manager:Ve,Input:q,TouchAction:Ce,TouchInput:de,MouseInput:ee,PointerEventInput:ae,TouchMouseInput:ye,SingleTouchInput:le,Recognizer:Re,AttrRecognizer:Le,Tap:je,Pan:De,Swipe:Fe,Pinch:Be,Rotate:ze,Press:Ne,on:E,off:S,each:v,merge:_,extend:g,assign:u,inherit:b,bindFn:w,prefixed:P}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=Ue,(n=function(){return Ue}.call(t,r,t,e))===s||(e.exports=n)}(window,document)},function(e,t,r){"use strict";(function(e){r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return a}));var n="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i="undefined"!==typeof window?window:e,a=("undefined"!==typeof e||window,"undefined"!==typeof document&&document,!1);try{var o={get passive(){return a=!0,!0}};i.addEventListener("test",o,o),i.removeEventListener("test",o,o)}catch(s){}}).call(this,r(22))},,function(e,t,r){"use strict";var n=r(679),i=r(10).Buffer,a=r(168),o=r(688),s=r(320),u=r(1135),l=r(127),c=r(695),h=r(743),f=r(1204),d=r(951),p=r(952);function y(e){var t=e.nodeAddress(),r=e.protos(),n=r[r.length-1].name;return{host:t.address,port:t.port,protocol:n.startsWith("http")?n:"http"}}e.exports=function(e,t,r){var n,i={};e?o.isMultiaddr(e)?i=y(e):"object"===typeof e?i=e:"string"===typeof e&&("/"===e[0]?i=y(o(e)):i.host=e):"undefined"!==typeof self&&(i={host:(n=self.location).hostname,port:n.port||(n.protocol.startsWith("https")?443:80),protocol:n.protocol.startsWith("http")?n.protocol.split(":")[0]:"http"}),t&&"object"!==typeof t&&(t={port:t});var a=Object.assign(d(),i,t,r),s=p(a),u=f(s,a);return u.send=s,u},Object.assign(e.exports,{isIPFS:n,Buffer:i,CID:a,multiaddr:o,multibase:s,multicodec:u,multihash:l,PeerId:c,PeerInfo:h})},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1109),a=r(795),o=r(91);function s(e){var t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(var n=0;n<r.length;n++){var i=r[n],o=a(i);if(0!==o.size){if(++n>=r.length)throw g("invalid address: "+e);if(o.path){t.push([i,m(r.slice(n).join("/"))]);break}t.push([i,r[n]])}else t.push([i])}return t}function u(e){var t=[];return e.map((function(e){var r=_(e);t.push(r.name),e.length>1&&t.push(e[1])})),m(t.join("/"))}function l(e){return e.map((function(e){Array.isArray(e)||(e=[e]);var t=_(e);return e.length>1?[t.code,i.toBuffer(t.code,e[1])]:[t.code]}))}function c(e){return e.map((function(e){var t=_(e);return e.length>1?[t.code,i.toString(t.code,e[1])]:[t.code]}))}function h(e){return y(n.concat(e.map((function(e){var t=_(e),r=n.from(o.encode(t.code));return e.length>1&&(r=n.concat([r,e[1]])),r}))))}function f(e,t){return e.size>0?e.size/8:0===e.size?0:o.decode(t)+o.decode.bytes}function d(e){for(var t=[],r=0;r<e.length;){var n=o.decode(e,r),i=o.decode.bytes,s=f(a(n),e.slice(r+i));if(0!==s){var u=e.slice(r+i,r+i+s);if((r+=s+i)>e.length)throw g("Invalid address buffer: "+e.toString("hex"));t.push([n,u])}else t.push([n]),r+=i}return t}function p(e){return h(l(s(e=m(e))))}function y(e){var t=v(e);if(t)throw t;return n.from(e)}function v(e){try{d(e)}catch(t){return t}}function m(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function g(e){return new Error("Error parsing address: "+e)}function _(e){return a(e[0])}e.exports={stringToStringTuples:s,stringTuplesToString:u,tuplesToStringTuples:c,stringTuplesToTuples:l,bufferToTuples:d,tuplesToBuffer:h,bufferToString:function(e){return u(c(d(e)))},stringToBuffer:p,fromString:function(e){return p(e)},fromBuffer:y,validateBuffer:v,isValidBuffer:function(e){return void 0===v(e)},cleanPath:m,ParseError:g,protoFromTuple:_,sizeForAddr:f}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1110),a=r(795),o=r(874),s=r(876),u=r(91);function l(e,t){return t instanceof n?l.toString(e,t):l.toBuffer(e,t)}function c(e){if(!i.isIP(e))throw new Error("invalid ip address");return i.toBuffer(e)}function h(e){var t=n.alloc(2);return t.writeUInt16BE(e,0),t}function f(e){return e.readUInt16BE(0)}function d(e){var t=e.slice(0,e.length-2),r=e.slice(e.length-2);return s.encode("base32",t).toString().slice(1)+":"+f(r)}e.exports=l,l.toString=function(e,t){switch((e=a(e)).code){case 4:case 41:return function(e){var t=i.toString(e);if(!t||!i.isIP(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return f(t);case 53:case 54:case 55:case 56:case 400:case 777:return function(e){var t=u.decode(e);if((e=e.slice(u.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return e.toString()}(t);case 421:return function(e){var t=u.decode(e),r=e.slice(u.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return s.encode("base58btc",r).toString().slice(1)}(t);case 444:case 445:return d(t);default:return t.toString("hex")}},l.toBuffer=function(e,t){switch((e=a(e)).code){case 4:case 41:return c(t);case 6:case 273:case 33:case 132:return h(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return function(e){var t=n.from(e),r=n.from(u.encode(t.length));return n.concat([r,t])}(t);case 421:return function(e){var t=new o(e).multihash,r=n.from(u.encode(t.length));return n.concat([r,t])}(t);case 444:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(16!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion address.");var r=s.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");var a=h(i);return n.concat([r,a])}(t);case 445:return function(e){var t=e.split(":");if(2!==t.length)throw new Error("failed to parse onion addr: "+t+" does not contain a port number");if(56!==t[0].length)throw new Error("failed to parse onion addr: "+t[0]+" not a Tor onion3 address.");var r=s.decode("b"+t[0]),i=parseInt(t[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");var a=h(i);return n.concat([r,a])}(t);default:return n.from(t,"hex")}}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1111),a=i,o=i.v4,s=i.v6;e.exports={isIP:a,isV4:o,isV6:s,toBuffer:function e(t,r,i){var a;if(i=~~i,o(t))a=r||n.alloc(i+4),t.split(/\./g).map((function(e){a[i++]=255&parseInt(e,10)}));else if(s(t)){var u,l=t.split(":",8);for(u=0;u<l.length;u++){var c;o(l[u])&&(c=e(l[u]),l[u]=c.slice(0,2).toString("hex")),c&&++u<8&&l.splice(u,0,c.slice(2,4).toString("hex"))}if(""===l[0])for(;l.length<8;)l.unshift("0");else if(""===l[l.length-1])for(;l.length<8;)l.push("0");else if(l.length<8){for(u=0;u<l.length&&""!==l[u];u++);var h=[u,"1"];for(u=9-l.length;u>0;u--)h.push("0");l.splice.apply(l,h)}for(a=r||n.alloc(i+16),u=0;u<l.length;u++){var f=parseInt(l[u],16);a[i++]=f>>8&255,a[i++]=255&f}}if(!a)throw Error("Invalid ip address: "+t);return a},toString:function(e,t,r){t=~~t;var n,i=[];if(4===(r=r||e.length-t)){for(var a=0;a<r;a++)i.push(e[t+a]);n=i.join(".")}else if(16===r){for(var o=0;o<r;o+=2)i.push(e.readUInt16BE(t+o).toString(16));n=(n=(n=i.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return n}}},function(e,t,r){"use strict";var n=r(1112),i=function(e){return n({exact:!0}).test(e)};i.v4=function(e){return n.v4({exact:!0}).test(e)},i.v6=function(e){return n.v6({exact:!0}).test(e)},i.version=function(e){return i(e)?i.v4(e)?4:6:void 0},e.exports=i},function(e,t,r){"use strict";var n="[a-fA-F\\d:]",i=function(e){return e&&e.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(n,")|(?<=").concat(n,")(?=\\s|$))"):""},a="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",o="[a-fA-F\\d]{1,4}",s="\n(?:\n(?:".concat(o,":){7}(?:").concat(o,"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(o,":){6}(?:").concat(a,"|:").concat(o,"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(o,":){5}(?::").concat(a,"|(?::").concat(o,"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(o,":){4}(?:(?::").concat(o,"){0,1}:").concat(a,"|(?::").concat(o,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(o,":){3}(?:(?::").concat(o,"){0,2}:").concat(a,"|(?::").concat(o,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(o,":){2}(?:(?::").concat(o,"){0,3}:").concat(a,"|(?::").concat(o,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(o,":){1}(?:(?::").concat(o,"){0,4}:").concat(a,"|(?::").concat(o,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::").concat(o,"){0,5}:").concat(a,"|(?::").concat(o,"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),u=new RegExp("(?:^".concat(a,"$)|(?:^").concat(s,"$)")),l=new RegExp("^".concat(a,"$")),c=new RegExp("^".concat(s,"$")),h=function(e){return e&&e.exact?u:new RegExp("(?:".concat(i(e)).concat(a).concat(i(e),")|(?:").concat(i(e)).concat(s).concat(i(e),")"),"g")};h.v4=function(e){return e&&e.exact?l:new RegExp("".concat(i(e)).concat(a).concat(i(e)),"g")},h.v6=function(e){return e&&e.exact?c:new RegExp("".concat(i(e)).concat(s).concat(i(e)),"g")},e.exports=h},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1114);function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");var r=a(e);return function(e,t){a(e).decode(t.toString())}(r.name,t),n.concat([r.codeBuf,t])}).encode=function(e,t){var r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},t.decode=function(e){n.isBuffer(e)&&(e=e.toString());var t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());var r=a(e[0]);return n.from(r.decode(e.substring(1)))},t.isEncoded=function(e){if(n.isBuffer(e)&&(e=e.toString()),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return n.isBuffer(e)&&(e=e.toString()),a(e[0])},t.names=Object.freeze(i.names),t.codes=Object.freeze(i.codes)},function(e,t,r){"use strict";var n=r(174),i=r(10).Buffer,a=r(1115),o=r(1116),s=[["identity","\0",function(){return{encode:function(e){return i.from(e).toString()},decode:function(e){return i.from(e)}}},""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=s.reduce((function(e,t){return e[t[0]]=new a(t[0],t[1],t[2],t[3]),e}),{}),l=s.reduce((function(e,t){return e[t[1]]=u[t[0]],e}),{});e.exports={names:u,codes:l}},function(e,t,r){"use strict";var n=r(67),i=r(18),a=r(19),o=r(10).Buffer,s=function(){function e(t,r,n,a){i(this,e),this.name=t,this.code=r,this.codeBuf=o.from(this.code),this.alphabet=a,this.engine=n(a)}return a(e,[{key:"encode",value:function(e){return this.engine.encode(e)}},{key:"decode",value:function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.alphabet&&this.alphabet.indexOf(i)<0)throw new Error("invalid character '".concat(i,"' in '").concat(e,"'"))}}catch(a){r.e(a)}finally{r.f()}return this.engine.decode(e)}}]),e}();e.exports=s},function(e,t,r){"use strict";e.exports=function(e){return function(t){return{encode:function(r){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",o=0,s=0,u=0;u<e.length;++u)for(s=s<<8|e[u],o+=8;o>r;)a+=t[i&s>>(o-=r)];if(o&&(a+=t[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a}(r,t,e)},decode:function(r){return function(e,t,r){for(var n={},i=0;i<t.length;++i)n[t[i]]=i;for(var a=e.length;"="===e[a-1];)--a;for(var o=new Uint8Array(a*r/8|0),s=0,u=0,l=0,c=0;c<a;++c){var h=n[e[c]];if(void 0===h)throw new SyntaxError("Invalid character "+e[c]);u=u<<r|h,(s+=r)>=8&&(s-=8,o[l++]=255&u>>s)}if(s>=r||255&u<<8-s)throw new SyntaxError("Unexpected end of data");return o}(r,t,e)}}}}},function(e,t,r){"use strict";var n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:n}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1119);function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");var r=a(e);return function(e,t){a(e).decode(t.toString())}(r.name,t),n.concat([r.codeBuf,t])}).encode=function(e,t){var r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},t.decode=function(e){n.isBuffer(e)&&(e=e.toString());var t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());var r=a(e[0]);return n.from(r.decode(e.substring(1)))},t.isEncoded=function(e){if(n.isBuffer(e)&&(e=e.toString()),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return n.isBuffer(e)&&(e=e.toString()),a(e[0])},t.names=Object.freeze(i.names),t.codes=Object.freeze(i.codes)},function(e,t,r){"use strict";var n=r(174),i=r(10).Buffer,a=r(1120),o=r(1121),s=[["identity","\0",function(){return{encode:function(e){return i.from(e).toString()},decode:function(e){return i.from(e)}}},""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=s.reduce((function(e,t){return e[t[0]]=new a(t[0],t[1],t[2],t[3]),e}),{}),l=s.reduce((function(e,t){return e[t[1]]=u[t[0]],e}),{});e.exports={names:u,codes:l}},function(e,t,r){"use strict";var n=r(67),i=r(18),a=r(19),o=r(10).Buffer,s=function(){function e(t,r,n,a){i(this,e),this.name=t,this.code=r,this.codeBuf=o.from(this.code),this.alphabet=a,this.engine=n(a)}return a(e,[{key:"encode",value:function(e){return this.engine.encode(e)}},{key:"decode",value:function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.alphabet&&this.alphabet.indexOf(i)<0)throw new Error("invalid character '".concat(i,"' in '").concat(e,"'"))}}catch(a){r.e(a)}finally{r.f()}return this.engine.decode(e)}}]),e}();e.exports=s},function(e,t,r){"use strict";e.exports=function(e){return function(t){return{encode:function(r){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",o=0,s=0,u=0;u<e.length;++u)for(s=s<<8|e[u],o+=8;o>r;)a+=t[i&s>>(o-=r)];if(o&&(a+=t[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a}(r,t,e)},decode:function(r){return function(e,t,r){for(var n={},i=0;i<t.length;++i)n[t[i]]=i;for(var a=e.length;"="===e[a-1];)--a;for(var o=new Uint8Array(a*r/8|0),s=0,u=0,l=0,c=0;c<a;++c){var h=n[e[c]];if(void 0===h)throw new SyntaxError("Invalid character "+e[c]);u=u<<r|h,(s+=r)>=8&&(s-=8,o[l++]=255&u>>s)}if(s>=r||255&u<<8-s)throw new SyntaxError("Unexpected end of data");return o}(r,t,e)}}}}},function(e,t,r){"use strict";var n=r(875),i=r(10).Buffer,a={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!==typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!i.isBuffer(e.multihash))return"multihash must be a Buffer";try{n.validate(e.multihash)}catch(r){var t=r.message;return t||(t="Multihash validation failed"),t}}};e.exports=a},function(e,t,r){"use strict";var n=r(1124),i=r(174),a=r(1125),o=r(1126),s=r(1127),u=[["base1","1","","1"],["base2","0",i,"01"],["base8","7",i,"01234567"],["base10","9",i,"0123456789"],["base16","f",a,"0123456789abcdef"],["base32","b",o,"abcdefghijklmnopqrstuvwxyz234567"],["base32pad","c",o,"abcdefghijklmnopqrstuvwxyz234567="],["base32hex","v",o,"0123456789abcdefghijklmnopqrstuv"],["base32hexpad","t",o,"0123456789abcdefghijklmnopqrstuv="],["base32z","h",o,"ybndrfg8ejkmcpqxot1uwisza345h769"],["base58flickr","Z",i,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base58btc","z",i,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base64","m",s,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",s,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",s,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",s,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],l=u.reduce((function(e,t){return e[t[0]]=new n(t[0],t[1],t[2],t[3]),e}),{}),c=u.reduce((function(e,t){return e[t[1]]=l[t[0]],e}),{});e.exports={names:l,codes:c}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=function(){function e(t,r,i,a){n(this,e),this.name=t,this.code=r,this.alphabet=a,i&&a&&(this.engine=i(a))}return i(e,[{key:"encode",value:function(e){return this.engine.encode(e)}},{key:"decode",value:function(e){return this.engine.decode(e)}},{key:"isImplemented",value:function(){return this.engine}}]),e}();e.exports=a},function(e,t,r){"use strict";var n=r(67),i=r(10).Buffer;e.exports=function(e){return{encode:function(e){return"string"===typeof e?i.from(e).toString("hex"):e.toString("hex")},decode:function(t){var r,a=n(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(e.indexOf(o)<0)throw new Error("invalid base16 character")}}catch(s){a.e(s)}finally{a.f()}return i.from(t,"hex")}}}},function(e,t,r){"use strict";var n=r(67);function i(e,t){var r=e.byteLength,n=new Uint8Array(e),i=t.indexOf("=")===t.length-1;i&&(t=t.substring(0,t.length-1));for(var a=0,o=0,s="",u=0;u<r;u++)for(o=o<<8|n[u],a+=8;a>=5;)s+=t[o>>>a-5&31],a-=5;if(a>0&&(s+=t[o<<5-a&31]),i)for(;s.length%8!==0;)s+="=";return s}e.exports=function(e){return{encode:function(t){return i("string"===typeof t?Uint8Array.from(t):t,e)},decode:function(t){var r,i=n(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(e.indexOf(a)<0)throw new Error("invalid base32 character")}}catch(o){i.e(o)}finally{i.f()}return function(e,t){for(var r=(e=e.replace(new RegExp("=","g"),"")).length,n=0,i=0,a=0,o=new Uint8Array(5*r/8|0),s=0;s<r;s++)i=i<<5|t.indexOf(e[s]),(n+=5)>=8&&(o[a++]=i>>>n-8&255,n-=8);return o.buffer}(t,e)}}}},function(e,t,r){"use strict";var n=r(67),i=r(10).Buffer;e.exports=function(e){var t=e.indexOf("=")>-1,r=e.indexOf("-")>-1&&e.indexOf("_")>-1;return{encode:function(e){var n="";n="string"===typeof e?i.from(e).toString("base64"):e.toString("base64"),r&&(n=n.replace(/\+/g,"-").replace(/\//g,"_"));var a=n.indexOf("=");return a>0&&!t&&(n=n.substring(0,a)),n},decode:function(t){var r,a=n(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(e.indexOf(o)<0)throw new Error("invalid base64 character")}}catch(s){a.e(s)}finally{a.f()}return i.from(t,"base64")}}}},function(e,t,r){"use strict";var n=r(873),i=A("dns4"),a=A("dns6"),o=T(A("dns"),A("dnsaddr"),i,a),s=T(A("ip4"),A("ip6")),u=T(S(s,A("tcp")),S(o,A("tcp"))),l=S(s,A("udp")),c=S(l,A("utp")),h=T(S(u,A("ws")),S(o,A("ws"))),f=T(S(u,A("wss")),S(o,A("wss"))),d=T(S(u,A("http")),S(s,A("http")),S(o,A("http"))),p=T(S(u,A("https")),S(s,A("https")),S(o,A("https"))),y=T(S(h,A("p2p-webrtc-star"),A("p2p")),S(f,A("p2p-webrtc-star"),A("p2p")),S(h,A("p2p-webrtc-star")),S(f,A("p2p-webrtc-star"))),v=T(S(h,A("p2p-websocket-star"),A("p2p")),S(f,A("p2p-websocket-star"),A("p2p")),S(h,A("p2p-websocket-star")),S(f,A("p2p-websocket-star"))),m=T(S(d,A("p2p-webrtc-direct")),S(p,A("p2p-webrtc-direct"))),g=T(h,f,d,p,y,m,u,c),_=T(S(g,A("p2p-stardust"),A("p2p")),S(g,A("p2p-stardust"))),b=T(S(g,A("p2p")),y,A("p2p")),w=T(S(b,A("p2p-circuit"),b),S(b,A("p2p-circuit")),S(A("p2p-circuit"),b),S(g,A("p2p-circuit")),S(A("p2p-circuit"),g),A("p2p-circuit")),x=function e(){return T(S(w,e),w)}(),k=T(S(x,b,x),S(b,x),S(x,b),x,b);function E(e){return function(t){if(!n.isMultiaddr(t))try{t=n(t)}catch(i){return!1}var r=e(t.protoNames());return null!==r&&0===r.length}}function S(){var e=Array.from(arguments);function t(t){return t.length<e.length?null:(e.some((function(e){if(null===(t="function"===typeof e?e().partialMatch(t):e.partialMatch(t)))return!0})),t)}return{toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:E(t),partialMatch:t}}function T(){var e=Array.from(arguments);function t(t){var r=null;return e.some((function(e){var n="function"===typeof e?e().partialMatch(t):e.partialMatch(t);if(n)return r=n,!0})),r}var r={toString:function(){return"{ "+e.join(" ")+" }"},input:e,matches:E(t),partialMatch:t};return r}function A(e){var t=e;return{toString:function(){return t},matches:function(e){if("string"===typeof e)try{e=n(e)}catch(i){return!1}var r=e.protoNames();return 1===r.length&&r[0]===t},partialMatch:function(e){return 0===e.length?null:e[0]===t?e.slice(1):null}}}t.DNS=o,t.DNS4=i,t.DNS6=a,t.IP=s,t.TCP=u,t.UDP=l,t.UTP=c,t.HTTP=d,t.HTTPS=p,t.WebSockets=h,t.WebSocketsSecure=f,t.WebSocketStar=v,t.WebRTCStar=y,t.WebRTCDirect=m,t.Reliable=g,t.Stardust=_,t.Circuit=x,t.P2P=k,t.IPFS=k},function(e,t,r){"use strict";(function(t){var n=r(1130),i=r(796),a=r(91);function o(e){var t=[],r=e.split("/").slice(1);if(1===r.length&&""===r[0])return[];for(var n=0;n<r.length;n++){var a=r[n],o=i(a);if(0!==o.size){if(++n>=r.length)throw m("invalid address: "+e);if(o.path){t.push([a,v(r.slice(n).join("/"))]);break}t.push([a,r[n]])}else t.push([a])}return t}function s(e){var t=[];return e.map((function(e){var r=g(e);t.push(r.name),e.length>1&&t.push(e[1])})),v(t.join("/"))}function u(e){return e.map((function(e){Array.isArray(e)||(e=[e]);var t=g(e);return e.length>1?[t.code,n.toBuffer(t.code,e[1])]:[t.code]}))}function l(e){return e.map((function(e){var t=g(e);return e.length>1?[t.code,n.toString(t.code,e[1])]:[t.code]}))}function c(e){return p(t.concat(e.map((function(e){var r=g(e),n=t.from(a.encode(r.code));return e.length>1&&(n=t.concat([n,e[1]])),n}))))}function h(e,t){return e.size>0?e.size/8:0===e.size?0:a.decode(t)+a.decode.bytes}function f(e){for(var t=[],r=0;r<e.length;){var n=a.decode(e,r),o=a.decode.bytes,s=h(i(n),e.slice(r+o));if(0!==s){var u=e.slice(r+o,r+o+s);if((r+=s+o)>e.length)throw m("Invalid address buffer: "+e.toString("hex"));t.push([n,u])}else t.push([n]),r+=o}return t}function d(e){return c(u(o(e=v(e))))}function p(e){var r=y(e);if(r)throw r;return t.from(e)}function y(e){try{f(e)}catch(t){return t}}function v(e){return"/"+e.trim().split("/").filter((function(e){return e})).join("/")}function m(e){return new Error("Error parsing address: "+e)}function g(e){return i(e[0])}e.exports={stringToStringTuples:o,stringTuplesToString:s,tuplesToStringTuples:l,stringTuplesToTuples:u,bufferToTuples:f,tuplesToBuffer:c,bufferToString:function(e){return s(l(f(e)))},stringToBuffer:d,fromString:function(e){return d(e)},fromBuffer:p,validateBuffer:y,isValidBuffer:function(e){return void 0===y(e)},cleanPath:v,ParseError:m,protoFromTuple:g,sizeForAddr:h}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(1131),i=r(1132),a=r(796),o=r(694),s=r(1134),u=r(91);function l(e,r){return r instanceof t?l.toString(e,r):l.toBuffer(e,r)}function c(e){if(!i(e))throw new Error("invalid ip address");return n.toBuffer(e)}function h(e){var r=t.alloc(2);return r.writeUInt16BE(e,0),r}function f(e){return e.readUInt16BE(0)}function d(e){var t=e.slice(0,e.length-2),r=e.slice(e.length-2);return s.encode(t).toString("ascii").toLowerCase()+":"+f(r)}e.exports=l,l.toString=function(e,t){switch((e=a(e)).code){case 4:case 41:return function(e){var t=n.toString(e);if(!i(t))throw new Error("invalid ip address");return t}(t);case 6:case 273:case 33:case 132:return f(t);case 53:case 54:case 55:case 56:case 400:return function(e){var t=u.decode(e);if((e=e.slice(u.decode.bytes)).length!==t)throw new Error("inconsistent lengths");return e.toString()}(t);case 421:return function(e){var t=u.decode(e),r=e.slice(u.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return o.encode(r)}(t);case 444:case 445:return d(t);default:return t.toString("hex")}},l.toBuffer=function(e,r){switch((e=a(e)).code){case 4:case 41:return c(r);case 6:case 273:case 33:case 132:return h(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:return function(e){var r=t.from(e),n=t.from(u.encode(r.length));return t.concat([n,r])}(r);case 421:return function(e){var r=t.from(o.decode(e)),n=t.from(u.encode(r.length));return t.concat([n,r])}(r);case 444:return function(e){var r=e.split(":");if(2!==r.length)throw new Error("failed to parse onion addr: "+r+" does not contain a port number");if(16!==r[0].length)throw new Error("failed to parse onion addr: "+r[0]+" not a Tor onion address.");var n=t.from(s.decode.asBytes(r[0].toUpperCase())),i=parseInt(r[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");var a=h(i);return t.concat([n,a])}(r);case 445:return function(e){var r=e.split(":");if(2!==r.length)throw new Error("failed to parse onion addr: "+r+" does not contain a port number");if(56!==r[0].length)throw new Error("failed to parse onion addr: "+r[0]+" not a Tor onion3 address.");var n=t.from(s.decode.asBytes(r[0].toUpperCase())),i=parseInt(r[1],10);if(i<1||i>65536)throw new Error("Port number is not in range(1, 65536)");var a=h(i);return t.concat([n,a])}(r);default:return t.from(r,"hex")}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=t,i=r(10).Buffer,a=r(319);n.toBuffer=function(e,t,r){var n;if(r=~~r,this.isV4Format(e))n=t||new i(r+4),e.split(/\./g).map((function(e){n[r++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){var a,o=e.split(":",8);for(a=0;a<o.length;a++){var s;this.isV4Format(o[a])&&(s=this.toBuffer(o[a]),o[a]=s.slice(0,2).toString("hex")),s&&++a<8&&o.splice(a,0,s.slice(2,4).toString("hex"))}if(""===o[0])for(;o.length<8;)o.unshift("0");else if(""===o[o.length-1])for(;o.length<8;)o.push("0");else if(o.length<8){for(a=0;a<o.length&&""!==o[a];a++);var u=[a,1];for(a=9-o.length;a>0;a--)u.push("0");o.splice.apply(o,u)}for(n=t||new i(r+16),a=0;a<o.length;a++){var l=parseInt(o[a],16);n[r++]=l>>8&255,n[r++]=255&l}}if(!n)throw Error("Invalid ip address: "+e);return n},n.toString=function(e,t,r){t=~~t;var n=[];if(4===(r=r||e.length-t)){for(var i=0;i<r;i++)n.push(e[t+i]);n=n.join(".")}else if(16===r){for(i=0;i<r;i+=2)n.push(e.readUInt16BE(t+i).toString(16));n=(n=(n=n.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return n};var o=/^(\d{1,3}\.){3,3}\d{1,3}$/,s=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function u(e){return e?e.toLowerCase():"ipv4"}n.isV4Format=function(e){return o.test(e)},n.isV6Format=function(e){return s.test(e)},n.fromPrefixLen=function(e,t){var r=4;"ipv6"===(t=e>32?"ipv6":u(t))&&(r=16);for(var a=new i(r),o=0,s=a.length;o<s;++o){var l=8;e<8&&(l=e),e-=l,a[o]=255&~(255>>l)}return n.toString(a)},n.mask=function(e,t){e=n.toBuffer(e),t=n.toBuffer(t);var r=new i(Math.max(e.length,t.length)),a=0;if(e.length===t.length)for(a=0;a<e.length;a++)r[a]=e[a]&t[a];else if(4===t.length)for(a=0;a<t.length;a++)r[a]=e[e.length-4+a]&t[a];else{for(a=0;a<r.length-6;a++)r[a]=0;for(r[10]=255,r[11]=255,a=0;a<e.length;a++)r[a+12]=e[a]&t[a+12];a+=12}for(;a<r.length;a++)r[a]=0;return n.toString(r)},n.cidr=function(e){var t=e.split("/"),r=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: "+r);var i=n.fromPrefixLen(parseInt(t[1],10));return n.mask(r,i)},n.subnet=function(e,t){for(var r=n.toLong(n.mask(e,t)),i=n.toBuffer(t),a=0,o=0;o<i.length;o++)if(255===i[o])a+=8;else for(var s=255&i[o];s;)s=s<<1&255,a++;var u=Math.pow(2,32-a);return{networkAddress:n.fromLong(r),firstAddress:u<=2?n.fromLong(r):n.fromLong(r+1),lastAddress:u<=2?n.fromLong(r+u-1):n.fromLong(r+u-2),broadcastAddress:n.fromLong(r+u-1),subnetMask:t,subnetMaskLength:a,numHosts:u<=2?u:u-2,length:u,contains:function(e){return r===n.toLong(n.mask(e,t))}}},n.cidrSubnet=function(e){var t=e.split("/"),r=t[0];if(2!==t.length)throw new Error("invalid CIDR subnet: "+r);var i=n.fromPrefixLen(parseInt(t[1],10));return n.subnet(r,i)},n.not=function(e){for(var t=n.toBuffer(e),r=0;r<t.length;r++)t[r]=255^t[r];return n.toString(t)},n.or=function(e,t){if(e=n.toBuffer(e),t=n.toBuffer(t),e.length===t.length){for(var r=0;r<e.length;++r)e[r]|=t[r];return n.toString(e)}var i=e,a=t;t.length>e.length&&(i=t,a=e);var o=i.length-a.length;for(r=o;r<i.length;++r)i[r]|=a[r-o];return n.toString(i)},n.isEqual=function(e,t){if(e=n.toBuffer(e),t=n.toBuffer(t),e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if(4===t.length){var i=t;t=e,e=i}for(r=0;r<10;r++)if(0!==t[r])return!1;var a=t.readUInt16BE(10);if(0!==a&&65535!==a)return!1;for(r=0;r<4;r++)if(e[r]!==t[r+12])return!1;return!0},n.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},n.isPublic=function(e){return!n.isPrivate(e)},n.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},n.loopback=function(e){if("ipv4"!==(e=u(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},n.address=function(e,t){var r,i=a.networkInterfaces();if(t=u(t),e&&"private"!==e&&"public"!==e){var o=i[e].filter((function(e){return e.family.toLowerCase()===t}));if(0===o.length)return;return o[0].address}return(r=Object.keys(i).map((function(r){var a=i[r].filter((function(r){return r.family=r.family.toLowerCase(),r.family===t&&!n.isLoopback(r.address)&&(!e||("public"===e?n.isPrivate(r.address):n.isPublic(r.address)))}));return a.length?a[0].address:void 0})).filter(Boolean)).length?r[0]:n.loopback(t)},n.toLong=function(e){var t=0;return e.split(".").forEach((function(e){t<<=8,t+=parseInt(e)})),t>>>0},n.fromLong=function(e){return(e>>>24)+"."+(e>>16&255)+"."+(e>>8&255)+"."+(255&e)}},function(e,t,r){"use strict";var n=r(1133),i=e.exports=function(e){return n({exact:!0}).test(e)};i.v4=function(e){return n.v4({exact:!0}).test(e)},i.v6=function(e){return n.v6({exact:!0}).test(e)}},function(e,t,r){"use strict";var n="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}",i="[0-9a-fA-F]{1,4}",a="\n(\n(?:".concat(i,":){7}(?:").concat(i,"|:)|                                // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:").concat(i,":){6}(?:").concat(n,"|:").concat(i,"|:)|                         // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:").concat(i,":){5}(?::").concat(n,"|(:").concat(i,"){1,2}|:)|                 // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:").concat(i,":){4}(?:(:").concat(i,"){0,1}:").concat(n,"|(:").concat(i,"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:").concat(i,":){3}(?:(:").concat(i,"){0,2}:").concat(n,"|(:").concat(i,"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:").concat(i,":){2}(?:(:").concat(i,"){0,3}:").concat(n,"|(:").concat(i,"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:").concat(i,":){1}(?:(:").concat(i,"){0,4}:").concat(n,"|(:").concat(i,"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::((?::").concat(i,"){0,5}:").concat(n,"|(?::").concat(i,"){1,7}|:))           // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(%[0-9a-zA-Z]{1,})?                                           // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=e.exports=function(e){return e&&e.exact?new RegExp("(?:^".concat(n,"$)|(?:^").concat(a,"$)")):new RegExp("(?:".concat(n,")|(?:").concat(a,")"),"g")};o.v4=function(e){return e&&e.exact?new RegExp("^".concat(n,"$")):new RegExp(n,"g")},o.v6=function(e){return e&&e.exact?new RegExp("^".concat(a,"$")):new RegExp(a,"g")}},function(e,t,r){(function(t,n){var i;!function(){"use strict";var a="object"===typeof window?window:{};!a.HI_BASE32_NO_NODE_JS&&"object"===typeof t&&t.versions&&t.versions.node&&(a=n);var o=!a.HI_BASE32_NO_COMMON_JS&&"object"===typeof e&&e.exports,s=r(328),u="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),l={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31},c=[0,0,0,0,0,0,0,0],h=function(e,t){t.length>10&&(t="..."+t.substr(-10));var r=new Error("Decoded data is not valid UTF-8. Maybe try base32.decode.asBytes()? Partial data after reading "+e+" bytes: "+t+" <-");throw r.position=e,r},f=function(e){if(""===e)return[];if(!/^[A-Z2-7=]+$/.test(e))throw new Error("Invalid base32 characters");for(var t,r,n,i,a,o,s,u,c=[],h=0,f=(e=e.replace(/=/g,"")).length,d=0,p=f>>3<<3;d<p;)t=l[e.charAt(d++)],r=l[e.charAt(d++)],n=l[e.charAt(d++)],i=l[e.charAt(d++)],a=l[e.charAt(d++)],o=l[e.charAt(d++)],s=l[e.charAt(d++)],u=l[e.charAt(d++)],c[h++]=255&(t<<3|r>>>2),c[h++]=255&(r<<6|n<<1|i>>>4),c[h++]=255&(i<<4|a>>>1),c[h++]=255&(a<<7|o<<2|s>>>3),c[h++]=255&(s<<5|u);var y=f-p;return 2===y?(t=l[e.charAt(d++)],r=l[e.charAt(d++)],c[h++]=255&(t<<3|r>>>2)):4===y?(t=l[e.charAt(d++)],r=l[e.charAt(d++)],n=l[e.charAt(d++)],i=l[e.charAt(d++)],c[h++]=255&(t<<3|r>>>2),c[h++]=255&(r<<6|n<<1|i>>>4)):5===y?(t=l[e.charAt(d++)],r=l[e.charAt(d++)],n=l[e.charAt(d++)],i=l[e.charAt(d++)],a=l[e.charAt(d++)],c[h++]=255&(t<<3|r>>>2),c[h++]=255&(r<<6|n<<1|i>>>4),c[h++]=255&(i<<4|a>>>1)):7===y&&(t=l[e.charAt(d++)],r=l[e.charAt(d++)],n=l[e.charAt(d++)],i=l[e.charAt(d++)],a=l[e.charAt(d++)],o=l[e.charAt(d++)],s=l[e.charAt(d++)],c[h++]=255&(t<<3|r>>>2),c[h++]=255&(r<<6|n<<1|i>>>4),c[h++]=255&(i<<4|a>>>1),c[h++]=255&(a<<7|o<<2|s>>>3)),c},d=function(e,t){if(!t)return function(e){for(var t,r,n="",i=e.length,a=0,o=0;a<i;)if((t=e[a++])<=127)n+=String.fromCharCode(t);else{t>191&&t<=223?(r=31&t,o=1):t<=239?(r=15&t,o=2):t<=247?(r=7&t,o=3):h(a,n);for(var s=0;s<o;++s)((t=e[a++])<128||t>191)&&h(a,n),r<<=6,r+=63&t;r>=55296&&r<=57343&&h(a,n),r>1114111&&h(a,n),r<=65535?n+=String.fromCharCode(r):(r-=65536,n+=String.fromCharCode(55296+(r>>10)),n+=String.fromCharCode(56320+(1023&r)))}return n}(f(e));if(""===e)return"";if(!/^[A-Z2-7=]+$/.test(e))throw new Error("Invalid base32 characters");var r,n,i,a,o,s,u,c,d="",p=e.indexOf("=");-1===p&&(p=e.length);for(var y=0,v=p>>3<<3;y<v;)r=l[e.charAt(y++)],n=l[e.charAt(y++)],i=l[e.charAt(y++)],a=l[e.charAt(y++)],o=l[e.charAt(y++)],s=l[e.charAt(y++)],u=l[e.charAt(y++)],c=l[e.charAt(y++)],d+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|i<<1|a>>>4))+String.fromCharCode(255&(a<<4|o>>>1))+String.fromCharCode(255&(o<<7|s<<2|u>>>3))+String.fromCharCode(255&(u<<5|c));var m=p-v;return 2===m?(r=l[e.charAt(y++)],n=l[e.charAt(y++)],d+=String.fromCharCode(255&(r<<3|n>>>2))):4===m?(r=l[e.charAt(y++)],n=l[e.charAt(y++)],i=l[e.charAt(y++)],a=l[e.charAt(y++)],d+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|i<<1|a>>>4))):5===m?(r=l[e.charAt(y++)],n=l[e.charAt(y++)],i=l[e.charAt(y++)],a=l[e.charAt(y++)],o=l[e.charAt(y++)],d+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|i<<1|a>>>4))+String.fromCharCode(255&(a<<4|o>>>1))):7===m&&(r=l[e.charAt(y++)],n=l[e.charAt(y++)],i=l[e.charAt(y++)],a=l[e.charAt(y++)],o=l[e.charAt(y++)],s=l[e.charAt(y++)],u=l[e.charAt(y++)],d+=String.fromCharCode(255&(r<<3|n>>>2))+String.fromCharCode(255&(n<<6|i<<1|a>>>4))+String.fromCharCode(255&(a<<4|o>>>1))+String.fromCharCode(255&(o<<7|s<<2|u>>>3))),d},p={encode:function(e,t){var r="string"!==typeof e;return r&&e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),r?function(e){for(var t,r,n,i,a,o="",s=e.length,l=0,c=5*parseInt(s/5);l<c;)t=e[l++],r=e[l++],n=e[l++],i=e[l++],a=e[l++],o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[31&(i<<3|a>>>5)]+u[31&a];var h=s-c;return 1===h?(t=e[l],o+=u[t>>>3]+u[t<<2&31]+"======"):2===h?(t=e[l++],r=e[l],o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[r<<4&31]+"===="):3===h?(t=e[l++],r=e[l++],n=e[l],o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[n<<1&31]+"==="):4===h&&(t=e[l++],r=e[l++],n=e[l++],i=e[l],o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[i<<3&31]+"="),o}(e):t?function(e){for(var t,r,n,i,a,o="",s=e.length,l=0,c=5*parseInt(s/5);l<c;)t=e.charCodeAt(l++),r=e.charCodeAt(l++),n=e.charCodeAt(l++),i=e.charCodeAt(l++),a=e.charCodeAt(l++),o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[31&(i<<3|a>>>5)]+u[31&a];var h=s-c;return 1===h?(t=e.charCodeAt(l),o+=u[t>>>3]+u[t<<2&31]+"======"):2===h?(t=e.charCodeAt(l++),r=e.charCodeAt(l),o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[r<<4&31]+"===="):3===h?(t=e.charCodeAt(l++),r=e.charCodeAt(l++),n=e.charCodeAt(l),o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[n<<1&31]+"==="):4===h&&(t=e.charCodeAt(l++),r=e.charCodeAt(l++),n=e.charCodeAt(l++),i=e.charCodeAt(l),o+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[i<<3&31]+"="),o}(e):function(e){var t,r,n,i,a,o,s,l=!1,h="",f=0,d=0,p=e.length;if(""===e)return h;do{for(c[0]=c[5],c[1]=c[6],c[2]=c[7],s=d;f<p&&s<5;++f)(o=e.charCodeAt(f))<128?c[s++]=o:o<2048?(c[s++]=192|o>>6,c[s++]=128|63&o):o<55296||o>=57344?(c[s++]=224|o>>12,c[s++]=128|o>>6&63,c[s++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++f)),c[s++]=240|o>>18,c[s++]=128|o>>12&63,c[s++]=128|o>>6&63,c[s++]=128|63&o);d=s-5,f===p&&++f,f>p&&s<6&&(l=!0),t=c[0],s>4?(r=c[1],n=c[2],i=c[3],a=c[4],h+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[31&(i<<3|a>>>5)]+u[31&a]):1===s?h+=u[t>>>3]+u[t<<2&31]+"======":2===s?(r=c[1],h+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[r<<4&31]+"===="):3===s?(r=c[1],n=c[2],h+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[n<<1&31]+"==="):(r=c[1],n=c[2],i=c[3],h+=u[t>>>3]+u[31&(t<<2|r>>>6)]+u[r>>>1&31]+u[31&(r<<4|n>>>4)]+u[31&(n<<1|i>>>7)]+u[i>>>2&31]+u[i<<3&31]+"=")}while(!l);return h}(e)},decode:d};d.asBytes=f,o?e.exports=p:(a.base32=p,s&&(void 0===(i=function(){return p}.call(p,r,p,e))||(e.exports=i)))}()}).call(this,r(21),r(22))},function(e,t,r){"use strict";(function(n){var i=r(91),a=r(1136),o=r(1137),s=r(877);(t=e.exports).addPrefix=function(e,t){var r;if(n.isBuffer(e))r=s.varintBufferEncode(e);else{if(!o[e])throw new Error("multicodec not recognized");r=o[e]}return n.concat([r,t])},t.rmPrefix=function(e){return i.decode(e),e.slice(i.decode.bytes)},t.getCodec=function(e){var t=i.decode(e),r=a.get(t);if(void 0===r)throw new Error("Code ".concat(t," not found"));return r},t.getName=function(e){return a.get(e)},t.getNumber=function(e){var t=o[e];if(void 0===t)throw new Error("Codec `"+e+"` not found");return s.varintBufferDecode(t)[0]},t.getCode=function(e){return i.decode(e)},t.getCodeVarint=function(e){var t=o[e];if(void 0===t)throw new Error("Codec `"+e+"` not found");return t},t.getVarint=function(e){return i.encode(e)};var u=r(1138);Object.assign(t,u),t.print=r(1139)}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(760),i=new Map;for(var a in n){var o=n[a];i.set(o,a)}e.exports=Object.freeze(i)},function(e,t,r){"use strict";var n=r(760),i=r(877).varintEncode,a={};for(var o in n){var s=n[o];a[o]=i(s)}e.exports=Object.freeze(a)},function(e,t,r){"use strict";for(var n=r(92),i=r(760),a={},o=0,s=Object.entries(i);o<s.length;o++){var u=n(s[o],2),l=u[0],c=u[1];a[l.toUpperCase().replace(/-/g,"_")]=c}e.exports=Object.freeze(a)},function(e,t,r){"use strict";for(var n=r(92),i=r(760),a={},o=0,s=Object.entries(i);o<s.length;o++){var u=n(s[o],2),l=u[0],c=u[1];void 0===a[c]&&(a[c]=l)}e.exports=Object.freeze(a)},function(e,t,r){"use strict";(function(n){var i=r(761)(r(798));r(696),r(742),r(762);var a=r(665);t=e.exports;var o={rsa:r(1157),ed25519:r(1175),secp256k1:r(1179)(i,r(891))};function s(e){return void 0!==o[e.toLowerCase()]}t.supportedKeys=o,t.keysPBM=i,t.keyStretcher=r(1194),t.generateEphemeralKeyPair=r(1200),t.generateKeyPair=function(e,t,r){var n=o[e.toLowerCase()];if(!n)return r(new Error("invalid or unsupported key type"));n.generateKeyPair(t,r)},t.generateKeyPairFromSeed=function(e,t,r,n){var i=o[e.toLowerCase()];return i?"ed25519"!==e.toLowerCase()?n(new Error("Seed key derivation is unimplemented for RSA or secp256k1")):void i.generateKeyPairFromSeed(t,r,n):n(new Error("invalid or unsupported key type"))},t.unmarshalPublicKey=function(e){var t=i.PublicKey.decode(e),r=t.Data;switch(t.Type){case i.KeyType.RSA:return o.rsa.unmarshalRsaPublicKey(r);case i.KeyType.Ed25519:return o.ed25519.unmarshalEd25519PublicKey(r);case i.KeyType.Secp256k1:if(o.secp256k1)return o.secp256k1.unmarshalSecp256k1PublicKey(r);throw new Error("secp256k1 support requires libp2p-crypto-secp256k1 package");default:throw new Error("invalid or unsupported key type")}},t.marshalPublicKey=function(e,t){if(!s(t=(t||"rsa").toLowerCase()))throw new Error("invalid or unsupported key type");return e.bytes},t.unmarshalPrivateKey=function(e,t){var r;try{r=i.PrivateKey.decode(e)}catch(a){return t(a)}var n=r.Data;switch(r.Type){case i.KeyType.RSA:return o.rsa.unmarshalRsaPrivateKey(n,t);case i.KeyType.Ed25519:return o.ed25519.unmarshalEd25519PrivateKey(n,t);case i.KeyType.Secp256k1:return o.secp256k1?o.secp256k1.unmarshalSecp256k1PrivateKey(n,t):t(new Error("secp256k1 support requires libp2p-crypto-secp256k1 package"));default:t(new Error("invalid or unsupported key type"))}},t.marshalPrivateKey=function(e,t){if(!s(t=(t||"rsa").toLowerCase()))throw new Error("invalid or unsupported key type");return e.bytes},t.import=function(e,t,r){try{var i=a.pki.decryptRsaPrivateKey(e,t);if(null===i)throw new Error("Cannot read the key, most likely the password is wrong or not a RSA key");var s=a.asn1.toDer(a.pki.privateKeyToAsn1(i));return s=n.from(s.getBytes(),"binary"),o.rsa.unmarshalRsaPrivateKey(s,r)}catch(u){r(u)}}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(1142),i=r(1144);e.exports=n,e.exports.parse=n,e.exports.stringify=i},function(e,t,r){var n=r(1143),i=["int32","int64","uint32","uint64","sint32","sint64","bool","fixed64","sfixed64","double","fixed32","sfixed32","float"],a=function e(t){var r=t.shift();if("{"!==r)return r;r={};for(var n="";t.length;)switch(t[0]){case"}":return t.shift(),r;case":":t.shift(),r[n]=e(t);break;default:n=t.shift()}},o=function(e){for(var t={};e.length;)switch(e[0]){case"[":case",":e.shift();var r=e.shift();"("===r&&(r=e.shift(),e.shift());var n=[];if("."===e[0][0]&&(n=e[0].substr(1).split("."),e.shift()),"="!==e[0])throw new Error("Unexpected token in field options: "+e[0]);if(e.shift(),"]"===e[0])throw new Error("Unexpected ] in field option");var i=[r].concat(n),o=i.pop();i.reduce((function(e,t,r){return null==e[t]&&(e[t]={}),e[t]}),t)[o]=a(e);break;case"]":return e.shift(),t;default:throw new Error("Unexpected token in field options: "+e[0])}throw new Error("No closing tag for field options")},s=function(e){for(var t={name:null,type:null,tag:-1,map:null,oneof:null,required:!1,repeated:!1,options:{}};e.length;)switch(e[0]){case"=":e.shift(),t.tag=Number(e.shift());break;case"map":if(t.type="map",t.map={from:null,to:null},e.shift(),"<"!==e[0])throw new Error("Unexpected token in map type: "+e[0]);if(e.shift(),t.map.from=e.shift(),","!==e[0])throw new Error("Unexpected token in map type: "+e[0]);if(e.shift(),t.map.to=e.shift(),">"!==e[0])throw new Error("Unexpected token in map type: "+e[0]);e.shift(),t.name=e.shift();break;case"repeated":case"required":case"optional":var r=e.shift();t.required="required"===r,t.repeated="repeated"===r,t.type=e.shift(),t.name=e.shift();break;case"[":t.options=o(e);break;case";":if(null===t.name)throw new Error("Missing field name");if(null===t.type)throw new Error("Missing type in message field: "+t.name);if(-1===t.tag)throw new Error("Missing tag number in message field: "+t.name);return e.shift(),t;default:throw new Error("Unexpected token in message field: "+e[0])}throw new Error("No ; found for message field")},u=function(e){for(var t={enums:[],options:{},messages:[],fields:[],extends:[],extensions:null};e.length;)switch(e[0]){case"map":case"repeated":case"optional":case"required":t.fields.push(s(e));break;case"enum":t.enums.push(y(e));break;case"message":t.messages.push(h(e));break;case"extensions":t.extensions=c(e);break;case"oneof":e.shift();var r=e.shift();if("{"!==e[0])throw new Error("Unexpected token in oneof: "+e[0]);for(e.shift();"}"!==e[0];){e.unshift("optional");var n=s(e);n.oneof=r,t.fields.push(n)}e.shift();break;case"extend":t.extends.push(l(e));break;case";":e.shift();break;case"reserved":for(e.shift();";"!==e[0];)e.shift();break;case"option":var i=v(e);if(void 0!==t.options[i.name])throw new Error("Duplicate option "+i.name);t.options[i.name]=i.value;break;default:e.unshift("optional"),t.fields.push(s(e))}return t},l=function(e){return{name:e[1],message:h(e)}},c=function(e){e.shift();var t=Number(e.shift());if(isNaN(t))throw new Error("Invalid from in extensions definition");if("to"!==e.shift())throw new Error("Expected keyword 'to' in extensions definition");var r=e.shift();if("max"===r&&(r=536870911),r=Number(r),isNaN(r))throw new Error("Invalid to in extensions definition");if(";"!==e.shift())throw new Error("Missing ; in extensions definition");return{from:t,to:r}},h=function(e){e.shift();var t=1,r=[],n={name:e.shift(),options:{},enums:[],extends:[],messages:[],fields:[]};if("{"!==e[0])throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if("{"===e[0]?t++:"}"===e[0]&&t--,!t)return e.shift(),r=u(r),n.enums=r.enums,n.messages=r.messages,n.fields=r.fields,n.extends=r.extends,n.extensions=r.extensions,n.options=r.options,n;r.push(e.shift())}if(t)throw new Error("No closing tag for message")},f=function(e){e.shift();var t=e.shift();if(";"!==e[0])throw new Error("Expected ; but found "+e[0]);return e.shift(),t},d=function(e){if(e.shift(),"="!==e[0])throw new Error("Expected = but found "+e[0]);e.shift();var t=e.shift();switch(t){case'"proto2"':t=2;break;case'"proto3"':t=3;break;default:throw new Error("Expected protobuf syntax version but found "+t)}if(";"!==e[0])throw new Error("Expected ; but found "+e[0]);return e.shift(),t},p=function(e){if(e.length<4)throw new Error("Invalid enum value: "+e.slice(0,3).join(" "));if("="!==e[1])throw new Error("Expected = but found "+e[1]);if(";"!==e[3]&&"["!==e[3])throw new Error("Expected ; or [ but found "+e[1]);var t=e.shift();e.shift();var r={value:null,options:{}};return r.value=Number(e.shift()),"["===e[0]&&(r.options=o(e)),e.shift(),{name:t,val:r}},y=function(e){e.shift();var t={},r={name:e.shift(),values:{},options:{}};if("{"!==e[0])throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if("}"===e[0])return e.shift(),";"===e[0]&&e.shift(),r;if("option"!==e[0]){var n=p(e);r.values[n.name]=n.val}else t=v(e),r.options[t.name]=t.value}throw new Error("No closing tag for enum")},v=function(e){for(var t=null,r=null,n=function(e){return"true"===e||"false"!==e&&e.replace(/^"+|"+$/gm,"")};e.length;){if(";"===e[0])return e.shift(),{name:t,value:r};switch(e[0]){case"option":e.shift();var i="("===e[0];if(i&&e.shift(),t=e.shift(),i){if(")"!==e[0])throw new Error("Expected ) but found "+e[0]);e.shift()}"."===e[0][0]&&(t+=e.shift());break;case"=":if(e.shift(),null===t)throw new Error("Expected key for option with value: "+e[0]);if(r=n(e.shift()),"optimize_for"===t&&!/^(SPEED|CODE_SIZE|LITE_RUNTIME)$/.test(r))throw new Error("Unexpected value for option optimize_for: "+r);"{"===r&&(r=m(e));break;default:throw new Error("Unexpected token in option: "+e[0])}}},m=function e(t){for(var r=function(e){return"true"===e||"false"!==e&&e.replace(/^"+|"+$/gm,"")},n={};t.length;){if("}"===t[0])return t.shift(),n;var i="("===t[0];i&&t.shift();var a=t.shift();if(i){if(")"!==t[0])throw new Error("Expected ) but found "+t[0]);t.shift()}var o=null;switch(t[0]){case":":if(void 0!==n[a])throw new Error("Duplicate option map key "+a);t.shift(),"{"===(o=r(t.shift()))&&(o=e(t)),n[a]=o,";"===t[0]&&t.shift();break;case"{":if(t.shift(),o=e(t),void 0===n[a]&&(n[a]=[]),!Array.isArray(n[a]))throw new Error("Duplicate option map key "+a);n[a].push(o);break;default:throw new Error("Unexpected token in option map: "+t[0])}}throw new Error("No closing tag for option map")},g=function(e){e.shift();var t=e.shift().replace(/^"+|"+$/gm,"");if(";"!==e[0])throw new Error("Unexpected token: "+e[0]+'. Expected ";"');return e.shift(),t},_=function(e){e.shift();var t={name:e.shift(),methods:[],options:{}};if("{"!==e[0])throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if("}"===e[0])return e.shift(),";"===e[0]&&e.shift(),t;switch(e[0]){case"option":var r=v(e);if(void 0!==t.options[r.name])throw new Error("Duplicate option "+r.name);t.options[r.name]=r.value;break;case"rpc":t.methods.push(b(e));break;default:throw new Error("Unexpected token in service: "+e[0])}}throw new Error("No closing tag for service")},b=function(e){e.shift();var t={name:e.shift(),input_type:null,output_type:null,client_streaming:!1,server_streaming:!1,options:{}};if("("!==e[0])throw new Error("Expected ( but found "+e[0]);if(e.shift(),"stream"===e[0]&&(e.shift(),t.client_streaming=!0),t.input_type=e.shift(),")"!==e[0])throw new Error("Expected ) but found "+e[0]);if(e.shift(),"returns"!==e[0])throw new Error("Expected returns but found "+e[0]);if(e.shift(),"("!==e[0])throw new Error("Expected ( but found "+e[0]);if(e.shift(),"stream"===e[0]&&(e.shift(),t.server_streaming=!0),t.output_type=e.shift(),")"!==e[0])throw new Error("Expected ) but found "+e[0]);if(e.shift(),";"===e[0])return e.shift(),t;if("{"!==e[0])throw new Error("Expected { but found "+e[0]);for(e.shift();e.length;){if("}"===e[0])return e.shift(),";"===e[0]&&e.shift(),t;if("option"!==e[0])throw new Error("Unexpected token in rpc options: "+e[0]);var r=v(e);if(void 0!==t.options[r.name])throw new Error("Duplicate option "+r.name);t.options[r.name]=r.value}throw new Error("No closing tag for rpc")};e.exports=function(e){for(var t=n(e.toString()),r=0;r<t.length;r++){var a;if(/^("|')([^'"]*)$/.test(t[r]))for(a=1===t[r].length?r+1:r;a<t.length;a++)if(/^[^'"\\]*(?:\\.[^'"\\]*)*("|')$/.test(t[a])){t=t.slice(0,r).concat(t.slice(r,a+1).join("")).concat(t.slice(a+1));break}}for(var o={syntax:3,package:null,imports:[],enums:[],messages:[],options:{},extends:[]},s=!0;t.length;){switch(t[0]){case"package":o.package=f(t);break;case"syntax":if(!s)throw new Error("Protobuf syntax version should be first thing in file");o.syntax=d(t);break;case"message":o.messages.push(h(t));break;case"enum":o.enums.push(y(t));break;case"option":var u=v(t);if(o.options[u.name])throw new Error("Duplicate option "+u.name);o.options[u.name]=u.value;break;case"import":o.imports.push(g(t));break;case"extend":o.extends.push(l(t));break;case"service":o.services||(o.services=[]),o.services.push(_(t));break;default:throw new Error("Unexpected token: "+t[0])}s=!1}return o.extends.forEach((function(e){o.messages.forEach((function(t){t.name===e.name&&e.message.fields.forEach((function(e){if(!t.extensions||e.tag<t.extensions.from||e.tag>t.extensions.to)throw new Error(t.name+" does not declare "+e.tag+" as an extension number");t.fields.push(e)}))}))})),o.messages.forEach((function(e){e.fields.forEach((function(t){var r,n,a,s;if(t.options&&"true"===t.options.packed&&-1===i.indexOf(t.type)){if(-1===t.type.indexOf(".")){if(e.enums&&e.enums.some((function(e){return e.name===t.type})))return}else{if((r=t.type.split(".")).length>2)throw new Error("what is this?");if(n=r[0],a=r[1],o.messages.some((function(e){if(e.name===n)return s=e,e})),s&&s.enums&&s.enums.some((function(e){return e.name===a})))return}throw new Error("Fields of type "+t.type+' cannot be declared [packed=true]. Only repeated fields of primitive numeric types (types which use the varint, 32-bit, or 64-bit wire types) can be declared "packed". See https://developers.google.com/protocol-buffers/docs/encoding#optional')}}))})),o}},function(e,t){e.exports=function(e){var t,r=function(e){return e.trim()},n=[];return e.replace(/"(\\"|[^"\n])*?"|'(\\'|[^'\n])*?'/gm,(t=n,function(e){var r="$"+t.length+"$";return t.push(e),r})).replace(/([;,{}()=:[\]<>]|\/\*|\*\/)/g," $1 ").split(/\n/).map(r).filter(Boolean).map((function(e){var t=e.indexOf("//");return t>-1?e.slice(0,t):e})).map(r).filter(Boolean).join("\n").split(/\s+|\n+/gm).filter(function(){var e=!1;return function(t){return"/*"===t?(e=!0,!1):"*/"===t?(e=!1,!1):!e}}()).map(function(e){var t=/^\$(\d+)\$$/;return function(r){var n=r.match(t);return n?e[+n[1]]:r}}(n))}},function(e,t){var r=function(e,t){var r=e.repeated?"repeated":e.required?"required":"optional";"map"===e.type&&(r="map<"+e.map.from+","+e.map.to+">"),e.oneof&&(r="");var n=Object.keys(e.options||{}).map((function(t){return t+" = "+e.options[t]})).join(",");return n&&(n=" ["+n+"]"),t.push((r?r+" ":"")+("map"===e.map?"":e.type+" ")+e.name+" = "+e.tag+n+";"),t},n=function e(t,n){n.push("message "+t.name+" {"),t.options||(t.options={}),o(t.options,n),t.enums||(t.enums=[]),t.enums.forEach((function(e){n.push(i(e,[]))})),t.messages||(t.messages=[]),t.messages.forEach((function(t){n.push(e(t,[]))}));var a={};return t.fields||(t.fields=[]),t.fields.forEach((function(e){e.oneof?(a[e.oneof]||(a[e.oneof]=[]),a[e.oneof].push(r(e,[]))):n.push(r(e,[]))})),Object.keys(a).forEach((function(e){a[e].unshift("oneof "+e+" {"),a[e].push("}"),n.push(a[e])})),n.push("}",""),n},i=function(e,t){t.push("enum "+e.name+" {"),e.options||(e.options={});var r=o(e.options,[]);return r.length>1&&t.push(r.slice(0,-1)),Object.keys(e.values).map((function(r){var n=a(e.values[r]);t.push([r+" = "+n+";"])})),t.push("}",""),t},a=function(e,t){var r=Object.keys(e.options||{}).map((function(t){return t+" = "+e.options[t]})).join(",");return r&&(r=" ["+r+"]"),e.value+r},o=function(e,t){var r=Object.keys(e);return r.forEach((function(r){var n=e[r];~r.indexOf(".")&&(r="("+r+")");var i=typeof n;"object"===i?(n=s(n,[])).length&&t.push("option "+r+" = {",n,"};"):("string"===i&&"optimize_for"!==r&&(n='"'+n+'"'),t.push("option "+r+" = "+n+";"))})),r.length>0&&t.push(""),t},s=function e(t,r){return Object.keys(t).forEach((function(n){var i=t[n],a=typeof i;"object"===a?Array.isArray(i)?i.forEach((function(t){(t=e(t,[])).length&&r.push(n+" {",t,"}")})):(i=e(i,[])).length&&r.push(n+" {",i,"}"):("string"===a&&(i='"'+i+'"'),r.push(n+": "+i))})),r},u=function(e,t){var r="rpc "+e.name+"(";e.client_streaming&&(r+="stream "),r+=e.input_type+") returns (",e.server_streaming&&(r+="stream "),r+=e.output_type+")",e.options||(e.options={});var n=o(e.options,[]);return n.length>1?t.push(r+" {",n.slice(0,-1),"}"):t.push(r+";"),t},l=function e(t){return function(r){return Array.isArray(r)?r.map(e(t+"  ")).join("\n"):t+r}};e.exports=function(e){var t=[];return t.push('syntax = "proto'+e.syntax+'";',""),e.package&&t.push("package "+e.package+";",""),e.options||(e.options={}),o(e.options,t),e.enums||(e.enums=[]),e.enums.forEach((function(e){i(e,t)})),e.messages||(e.messages=[]),e.messages.forEach((function(e){n(e,t)})),e.services&&e.services.forEach((function(e){!function(e,t){t.push("service "+e.name+" {"),e.options||(e.options={}),o(e.options,t),e.methods||(e.methods=[]),e.methods.forEach((function(e){t.push(u(e,[]))})),t.push("}","")}(e,t)})),t.map(l("")).join("\n")}},function(e,t,r){"use strict";var n=r(1146),i=r(1148),a=r(1149),o=r(1150),s=r(91);e.exports=function(e,t){var r={},u={},l={};!function e(t,n){t.enums&&t.enums.forEach((function(t){t.id=n+(n?".":"")+t.name,u[t.id]=t,e(t,t.id)})),t.messages&&t.messages.forEach((function(i){i.id=n+(n?".":"")+i.name,r[i.id]=i,i.fields.forEach((function(e){if(e.map){var i="Map_"+e.map.from+"_"+e.map.to,a={name:i,enums:[],messages:[],fields:[{name:"key",type:e.map.from,tag:1,repeated:!1,required:!0},{name:"value",type:e.map.to,tag:2,repeated:!1,required:!1}],extensions:null,id:n+(n?".":"")+i};r[a.id]||(r[a.id]=a,t.messages.push(a)),e.type=i,e.repeated=!0}})),e(i,i.id)}))}(e,"");var c=function(e,t){e.messages.forEach((function(r){t[r.name]=h(r.name,e.id)})),e.enums.forEach((function(e){t[e.name]=function(e){if(!e)return null;var t={};return Object.keys(e).forEach((function(r){t[r]=e[r].value})),t}(e.values)})),t.type=2,t.message=!0,t.name=e.name;var r={};e.fields.forEach((function(e){e.oneof&&(r[e.oneof]||(r[e.oneof]=[]),r[e.oneof].push(e.name))}));var n=e.fields.map((function(t){return h(t.type,e.id)})),s=o(e,n,r),u=a(e,h,n,r,s),l=i(e,h,n);return u.bytes=l.bytes=0,t.buffer=!0,t.encode=u,t.decode=l,t.encodingLength=s,t},h=function(e,i,a){if(t&&t[e])return t[e];if(n[e])return n[e];var o=(i?i+"."+e:e).split(".").map((function(t,r,n){return n.slice(0,r).concat(e).join(".")})).reverse().reduce((function(e,t){return e||r[t]||u[t]}),null);if(!1===a)return o;if(!o)throw new Error("Could not resolve "+e);return o.values?function(e){var t=Object.keys(e.values||[]).map((function(t){return parseInt(e.values[t].value,10)}));return n.make(0,(function e(r,n,i){if(!t.length||-1===t.indexOf(r))throw new Error("Invalid enum value: "+r);return s.encode(r,n,i),e.bytes=s.encode.bytes,n}),(function e(r,n){var i=s.decode(r,n);if(!t.length||-1===t.indexOf(i))throw new Error("Invalid enum value: "+i);return e.bytes=s.decode.bytes,i}),s.encodingLength)}(o):l[o.id]||c(o,l[o.id]={})};return(e.enums||[]).concat((e.messages||[]).map((function(e){return h(e.id)})))}},function(e,t,r){"use strict";var n=r(91),i=r(1147),a=r(10).Buffer,o=function(e,t,r,n){return t.bytes=r.bytes=0,{type:e,encode:t,decode:r,encodingLength:n}};t.make=o,t.bytes=function(){var e=function(e){return a.isBuffer(e)?e.length:a.byteLength(e)};return o(2,(function t(r,i,a){var o=a,s=e(r);return n.encode(s,i,a),a+=n.encode.bytes,r instanceof Uint8Array?i.set(r,a):i.write(r,a,s),t.bytes=(a+=s)-o,i}),(function e(t,r){var i=r,a=n.decode(t,r);r+=n.decode.bytes;var o=t.slice(r,r+a);return r+=o.length,e.bytes=r-i,o}),(function(t){var r=e(t);return n.encodingLength(r)+r}))}(),t.string=o(2,(function e(t,r,i){var o=i,s=a.byteLength(t);return n.encode(s,r,i,"utf-8"),i+=n.encode.bytes,r.write(t,i,s),e.bytes=(i+=s)-o,r}),(function e(t,r){var i=r,a=n.decode(t,r);r+=n.decode.bytes;var o=t.toString("utf-8",r,r+a);return e.bytes=(r+=a)-i,o}),(function(e){var t=a.byteLength(e);return n.encodingLength(t)+t})),t.bool=o(0,(function e(t,r,n){return r[n]=t?1:0,e.bytes=1,r}),(function e(t,r){var n=t[r]>0;return e.bytes=1,n}),(function(e){return 1})),t.int32=o(0,(function e(t,r,i){return n.encode(t<0?t+4294967296:t,r,i),e.bytes=n.encode.bytes,r}),(function e(t,r){var i=n.decode(t,r);return e.bytes=n.decode.bytes,i>2147483647?i-4294967296:i}),(function(e){return n.encodingLength(e<0?e+4294967296:e)})),t.int64=o(0,(function e(t,r,i){if(t<0){var a=i+9;for(n.encode(-1*t,r,i),r[i+=n.encode.bytes-1]=128|r[i];i<a-1;)r[++i]=255;r[a]=1,e.bytes=10}else n.encode(t,r,i),e.bytes=n.encode.bytes;return r}),(function e(t,r){var i=n.decode(t,r);if(i>=Math.pow(2,63)){for(var o=9;255===t[r+o-1];)o--;o=o||9;var s=a.allocUnsafe(o);t.copy(s,0,r,r+o),s[o-1]=127&s[o-1],i=-1*n.decode(s,0),e.bytes=10}else e.bytes=n.decode.bytes;return i}),(function(e){return e<0?10:n.encodingLength(e)})),t.sint32=t.sint64=o(0,i.encode,i.decode,i.encodingLength),t.uint32=t.uint64=t.enum=t.varint=o(0,n.encode,n.decode,n.encodingLength),t.fixed64=t.sfixed64=o(1,(function e(t,r,n){return r.set(t,n),e.bytes=8,r}),(function e(t,r){var n=t.slice(r,r+8);return e.bytes=8,n}),(function(e){return 8})),t.double=o(1,(function e(t,r,n){return r.writeDoubleLE(t,n),e.bytes=8,r}),(function e(t,r){var n=t.readDoubleLE(r);return e.bytes=8,n}),(function(e){return 8})),t.fixed32=o(5,(function e(t,r,n){return r.writeUInt32LE(t,n),e.bytes=4,r}),(function e(t,r){var n=t.readUInt32LE(r);return e.bytes=4,n}),(function(e){return 4})),t.sfixed32=o(5,(function e(t,r,n){return r.writeInt32LE(t,n),e.bytes=4,r}),(function e(t,r){var n=t.readInt32LE(r);return e.bytes=4,n}),(function(e){return 4})),t.float=o(5,(function e(t,r,n){return r.writeFloatLE(t,n),e.bytes=4,r}),(function e(t,r){var n=t.readFloatLE(r);return e.bytes=4,n}),(function(e){return 4}))},function(e,t,r){var n=r(91);t.encode=function e(t,r,i){t=t>=0?2*t:-2*t-1;var a=n.encode(t,r,i);return e.bytes=n.encode.bytes,a},t.decode=function e(t,r){var i=n.decode(t,r);return e.bytes=n.decode.bytes,1&i?(i+1)/-2:i/2},t.encodingLength=function(e){return n.encodingLength(e>=0?2*e:-2*e-1)}},function(e,t,r){"use strict";var n=r(321),i=r(91),a=r(797).defined;function o(e){return"".concat(e.substring(0,1).toUpperCase()).concat(e.substring(1))}function s(e,t,r,i){var a;if(!Object.prototype.hasOwnProperty.call(e,t)){var s=o(t);Object.defineProperties(e,(n(a={},t,{enumerable:!0,configurable:!0,set:function(e){r=e},get:function(){return void 0===r?i:r}}),n(a,"has".concat(s),{configurable:!0,value:function(){return void 0!==r}}),n(a,"set".concat(s),{configurable:!0,value:function(e){r=e}}),n(a,"get".concat(s),{configurable:!0,value:function(){return r}}),n(a,"clear".concat(s),{configurable:!0,value:function(){r=void 0,e[t]=void 0}}),a))}}var u=function(e,t,r){switch(e){case 0:return i.decode(t,r),r+i.decode.bytes;case 1:return r+8;case 2:var n=i.decode(t,r);return r+i.decode.bytes+n;case 3:case 4:throw new Error("Groups are not supported");case 5:return r+4;default:throw new Error("Unknown wire type: "+e)}},l=function(e){if(e.map)return{};if(e.repeated)return[];switch(e.type){case"string":return"";case"bool":return!1;case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return 0;default:return null}},c=function(e,t){if(void 0===t)return t;switch(e.type){case"bool":return"true"===t;case"float":case"double":case"sfixed32":case"fixed32":case"varint":case"enum":case"uint64":case"uint32":case"int64":case"int32":case"sint64":case"sint32":return parseInt(t,10);default:return t}};e.exports=function(e,t,r){for(var n=[],h={},f=[],d=[],p=0;p<r.length;p++){var y=e.fields[p];h[y.tag]=p;var v=y.options&&y.options.default,m=t(y.type,e.id,!1);d[p]=[v,m&&m.values],e.fields[p].packed=y.repeated&&y.options&&y.options.packed&&"false"!==y.options.packed,y.required&&n.push(y.name),y.oneof&&f.push(y.name)}function g(e,t,r,n,a,u){var l,c=t.name;if(t.oneof)for(var h=Object.keys(r),d=0;d<h.length;d++)if(f.indexOf(h[d])>-1){var p=o(h[d]);delete r["has".concat(p)],delete r["get".concat(p)],delete r["set".concat(p)],delete r["clear".concat(p)],delete r[h[d]]}if(e.message){var y=i.decode(n,a);a+=i.decode.bytes;var v=e.decode(n,a,a+y);t.map?(l=r[c]||{})[v.key]=v.value:t.repeated?(l=r[c]||[]).push(v):l=v}else t.repeated?(l=r[c]||[]).push(e.decode(n,a)):l=e.decode(n,a);return s(r,c,l),a+=e.decode.bytes}return function t(o,p,y){if(null==p&&(p=0),null==y&&(y=o.length),!(y<=o.length&&p<=o.length))throw new Error("Decoded message is not valid");for(var v,m=p,_={};;){if(y<=p){var b,w,x="",k=0;for(k=0;k<n.length;k++)if(x=n[k],!a(_[x]))throw new Error("Decoded message is not valid, missing required field: "+x);for(k=0;k<r.length;k++){v=e.fields[k],w=d[k][0],b=d[k][1],x=v.name;var E=void 0;if(!Object.prototype.hasOwnProperty.call(_,x)){var S=!1;if(v.oneof)for(var T=Object.keys(_),A=0;A<T.length;A++)if(f.indexOf(T[A])>-1){S=!0;break}S||(b?v.repeated?w=[]:(w=w&&b[w]?b[w].value:b[Object.keys(b)[0]].value,w=parseInt(w||0,10)):(E=l(v),w=c(v,w)),s(_,x,w,E))}}return t.bytes=p-m,_}var C=i.decode(o,p);p+=i.decode.bytes;var I=h[C>>3];if(null!=I){var R=r[I];if((v=e.fields[I]).packed){var M=i.decode(o,p);for(M+=p+=i.decode.bytes;p<M;)p=g(R,v,_,o,p)}else p=g(R,v,_,o,p)}else p=u(7&C,o,p)}}}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(797).defined,a=r(91);e.exports=function(e,t,r,o,s){for(var u=Object.keys(o),l=r.length,c={},h=0;h<l;h++){c[h]={p:a.encode(e.fields[h].tag<<3|2),h:a.encode(e.fields[h].tag<<3|r[h].type)};var f=e.fields[h];e.fields[h].packed=f.repeated&&f.options&&f.options.packed&&"false"!==f.options.packed}function d(e,t,r,n,i,o){var s=0;if(!i)for(s=0;s<r.length;s++)e[t++]=r[s];return n.message&&(a.encode(n.encodingLength(o),e,t),t+=a.encode.bytes),n.encode(o,e,t),t+n.encode.bytes}return function t(h,f,p){null==p&&(p=0),null==f&&(f=n.allocUnsafe(s(h)));var y=p,v=Object.keys(h),m=0,g=!1;for(m=0;m<u.length;m++){var _=u[m],b=o[m];if(v.indexOf(b)>-1){if(g)throw new Error("only one of the properties defined in oneof "+_+" can be set");g=!0}}for(m=0;m<l;m++){var w=r[m],x=e.fields[m],k=h[x.name],E=0;if(i(k)){var S,T=c[m].p,A=c[m].h,C=x.packed;if(x.map){var I=Object.keys(k);for(E=0;E<I.length;E++)I[E]={key:I[E],value:k[I[E]]};k=I}if(C){var R=0;for(E=0;E<k.length;E++)Object.prototype.hasOwnProperty.call(k,E)&&(R+=w.encodingLength(k[E]));if(R){for(E=0;E<A.length;E++)f[p++]=T[E];a.encode(R,f,p),p+=a.encode.bytes}}if(x.repeated)for(E=0;E<k.length;E++)S=k[E],i(S)&&(p=d(f,p,A,w,C,S));else p=d(f,p,A,w,C,k)}else if(x.required)throw new Error(x.name+" is required")}return t.bytes=p-y,f}}},function(e,t,r){"use strict";var n=r(797).defined,i=r(91);e.exports=function(e,t,r){for(var a=Object.keys(r),o=t.length,s=new Array(o),u=0;u<e.fields.length;u++){s[u]=i.encodingLength(e.fields[u].tag<<3|t[u].type);var l=e.fields[u];e.fields[u].packed=l.repeated&&l.options&&l.options.packed&&"false"!==l.options.packed}return function(u){var l=0,c=0,h=0;for(c=0;c<a.length;c++){var f=a[c],d=r[f],p=!1;for(h=0;h<d.length;h++)if(n(u[d[h]])){if(p)throw new Error("only one of the properties defined in oneof "+f+" can be set");p=!0}}for(c=0;c<o;c++){var y,v=t[c],m=e.fields[c],g=u[m.name],_=s[c];if(n(g)){if(m.map){var b=Object.keys(g);for(h=0;h<b.length;h++)b[h]={key:b[h],value:g[b[h]]};g=b}if(m.packed){var w=0;for(h=0;h<g.length;h++)n(g[h])&&(w+=y=v.encodingLength(g[h]),v.message&&(w+=i.encodingLength(y)));w&&(l+=_+w+i.encodingLength(w))}else if(m.repeated)for(h=0;h<g.length;h++)n(g[h])&&(l+=_+(y=v.encodingLength(g[h]))+(v.message?i.encodingLength(y):0));else l+=_+(y=v.encodingLength(g))+(v.message?i.encodingLength(y):0)}else if(m.required)throw new Error(m.name+" is required")}return l}}},function(e,t,r){(function(t){var r={};e.exports=r;var n={};r.encode=function(e,t,r){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==r&&"number"!==typeof r)throw new TypeError('"maxline" must be a number.');var n="";if(e instanceof Uint8Array){var i=0,a=t.length,o=t.charAt(0),s=[0];for(i=0;i<e.length;++i){for(var u=0,l=e[i];u<s.length;++u)l+=s[u]<<8,s[u]=l%a,l=l/a|0;for(;l>0;)s.push(l%a),l=l/a|0}for(i=0;0===e[i]&&i<e.length-1;++i)n+=o;for(i=s.length-1;i>=0;--i)n+=t[s[i]]}else n=function(e,t){var r=0,n=t.length,i=t.charAt(0),a=[0];for(r=0;r<e.length();++r){for(var o=0,s=e.at(r);o<a.length;++o)s+=a[o]<<8,a[o]=s%n,s=s/n|0;for(;s>0;)a.push(s%n),s=s/n|0}var u="";for(r=0;0===e.at(r)&&r<e.length()-1;++r)u+=i;for(r=a.length-1;r>=0;--r)u+=t[a[r]];return u}(e,t);if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join("\r\n")}return n},r.decode=function(e,r){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof r)throw new TypeError('"alphabet" must be a string.');var i=n[r];if(!i){i=n[r]=[];for(var a=0;a<r.length;++a)i[r.charCodeAt(a)]=a}e=e.replace(/\s/g,"");var o=r.length,s=r.charAt(0),u=[0];for(a=0;a<e.length;a++){var l=i[e.charCodeAt(a)];if(void 0===l)return;for(var c=0,h=l;c<u.length;++c)h+=u[c]*o,u[c]=255&h,h>>=8;for(;h>0;)u.push(255&h),h>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)u.push(0);return"undefined"!==typeof t?t.from(u.reverse()):new Uint8Array(u.reverse())}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(665);r(667),r(704),r(880);var i=e.exports=n.pkcs1=n.pkcs1||{};function a(e,t,r){r||(r=n.md.sha1.create());for(var i="",a=Math.ceil(t/r.digestLength),o=0;o<a;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,255&o);r.start(),r.update(e+s),i+=r.digest().getBytes()}return i.substring(0,t)}i.encode_rsa_oaep=function(e,t,r){var i,o,s,u;"string"===typeof r?(i=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(i=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(u=r.mgf1.md)),s?s.start():s=n.md.sha1.create(),u||(u=s);var l=Math.ceil(e.n.bitLength()/8),c=l-2*s.digestLength-2;if(t.length>c)throw(v=new Error("RSAES-OAEP input message length is too long.")).length=t.length,v.maxLength=c,v;i||(i=""),s.update(i,"raw");for(var h=s.digest(),f="",d=c-t.length,p=0;p<d;p++)f+="\0";var y=h.getBytes()+f+"\x01"+t;if(o){if(o.length!==s.digestLength){var v;throw(v=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=o.length,v.digestLength=s.digestLength,v}}else o=n.random.getBytes(s.digestLength);var m=a(o,l-s.digestLength-1,u),g=n.util.xorBytes(y,m,y.length),_=a(g,s.digestLength,u),b=n.util.xorBytes(o,_,o.length);return"\0"+b+g},i.decode_rsa_oaep=function(e,t,r){var i,o,s;"string"===typeof r?(i=r,o=arguments[3]||void 0):r&&(i=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var u=Math.ceil(e.n.bitLength()/8);if(t.length!==u)throw(g=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,g.expectedLength=u,g;if(void 0===o?o=n.md.sha1.create():o.start(),s||(s=o),u<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");i||(i=""),o.update(i,"raw");for(var l=o.digest().getBytes(),c=t.charAt(0),h=t.substring(1,o.digestLength+1),f=t.substring(1+o.digestLength),d=a(f,o.digestLength,s),p=n.util.xorBytes(h,d,h.length),y=a(p,u-o.digestLength-1,s),v=n.util.xorBytes(f,y,f.length),m=v.substring(0,o.digestLength),g="\0"!==c,_=0;_<o.digestLength;++_)g|=l.charAt(_)!==m.charAt(_);for(var b=1,w=o.digestLength,x=o.digestLength;x<v.length;x++){var k=v.charCodeAt(x),E=1&k^1,S=b?65534:0;g|=k&S,w+=b&=E}if(g||1!==v.charCodeAt(w))throw new Error("Invalid RSAES-OAEP padding.");return v.substring(w+1)}},function(e,t,r){var n=r(665);r(697),r(667);var i=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=i,i.create=function(){o||(a=String.fromCharCode(128),a+=n.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var r=i.messageLengthSize/4,a=0;a<r;++a)i.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(a,o){"utf8"===o&&(a=n.util.encodeUtf8(a));var s=a.length;i.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var l=i.fullMessageLength.length-1;l>=0;--l)i.fullMessageLength[l]+=s[1],s[1]=s[0]+(i.fullMessageLength[l]/4294967296>>>0),i.fullMessageLength[l]=i.fullMessageLength[l]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(a),u(e,r,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=n.util.createBuffer();o.putBytes(t.bytes());var s,l=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;o.putBytes(a.substr(0,i.blockLength-l));for(var c=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)c+=(s=8*i.fullMessageLength[h+1])/4294967296>>>0,o.putInt32(c>>>0),c=s>>>0;o.putInt32(c);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};u(f,r,o);var d=n.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},i};var a=null,o=!1,s=null;function u(e,t,r){for(var n,i,a,o,u,l,c,h,f,d,p,y,v,m=r.length();m>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=((n=t[u-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=((i=t[u-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(l=e.h0,c=e.h1,h=e.h2,f=e.h3,d=e.h4,p=e.h5,y=e.h6,v=e.h7,u=0;u<64;++u)a=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),o=l&c|h&(l^c),n=v+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(y^d&(p^y))+s[u]+t[u],v=y,y=p,p=d,d=f+n>>>0,f=h,h=c,c=l,l=n+(i=a+o)>>>0;e.h0=e.h0+l|0,e.h1=e.h1+c|0,e.h2=e.h2+h|0,e.h3=e.h3+f|0,e.h4=e.h4+d|0,e.h5=e.h5+p|0,e.h6=e.h6+y|0,e.h7=e.h7+v|0,m-=64}}},function(e,t,r){(function(t){var n=r(665);r(667);var i=null;!n.util.isNodejs||n.options.usePureJavaScript||t.versions["node-webkit"]||(i=r(801)),(e.exports=n.prng=n.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,a=new Array(32),o=0;o<32;++o)a[o]=r.create();function s(){if(t.pools[0].messageLength>=32)return u();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),u()}function u(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var i=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(i),t.generated=0}function l(e){var t=null,r=n.util.globalScope,i=r.crypto||r.msCrypto;i&&i.getRandomValues&&(t=function(e){return i.getRandomValues(e)});var a=n.util.createBuffer();if(t)for(;a.length()<e;){var o=Math.max(1,Math.min(e-a.length(),65536)/4),s=new Uint32Array(Math.floor(o));try{t(s);for(var u=0;u<s.length;++u)a.putInt32(s[u])}catch(d){if(!("undefined"!==typeof QuotaExceededError&&d instanceof QuotaExceededError))throw d}}if(a.length()<e)for(var l,c,h,f=Math.floor(65536*Math.random());a.length()<e;){c=16807*(65535&f),c+=(32767&(l=16807*(f>>16)))<<16,f=4294967295&(c=(2147483647&(c+=l>>15))+(c>>31));for(u=0;u<3;++u)h=f>>>(u<<3),h^=Math.floor(256*Math.random()),a.putByte(String.fromCharCode(255&h))}return a.getBytes(e)}return t.pools=a,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var i=t.plugin.cipher,a=t.plugin.increment,o=t.plugin.formatKey,s=t.plugin.formatSeed,l=n.util.createBuffer();t.key=null,function c(h){if(h)return r(h);if(l.length()>=e)return r(null,l.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return n.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return u(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),u(),e()}))}(c)}));var f=i(t.key,t.seed);t.generated+=f.length,l.putBytes(f),t.key=o(i(t.key,a(t.seed))),t.seed=s(i(t.key,t.seed)),n.util.setImmediate(c)}()},t.generateSync=function(e){var r=t.plugin.cipher,i=t.plugin.increment,a=t.plugin.formatKey,o=t.plugin.formatSeed;t.key=null;for(var u=n.util.createBuffer();u.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&s();var l=r(t.key,t.seed);t.generated+=l.length,u.putBytes(l),t.key=a(r(t.key,i(t.seed))),t.seed=o(r(t.key,t.seed))}return u.getBytes(e)},i?(t.seedFile=function(e,t){i.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return i.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,l(e))}catch(r){t(r)}},t.seedFileSync=l),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",i=0;i<r;i+=8)n+=String.fromCharCode(e>>i&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}}).call(this,r(21))},function(e,t,r){var n=r(665);r(667),r(799),r(704),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,i=[6,4,2,4,2,4,6,2],a=new r(null);a.fromInt(30);var o=function(e,t){return e|t};t.generateProbablePrime=function(e,t,i){"function"===typeof t&&(i=t,t={});var a=(t=t||{}).algorithm||"PRIMEINC";"string"===typeof a&&(a={name:a}),a.options=a.options||{};var o=t.prng||n.random,u={nextBytes:function(e){for(var t=o.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===a.name)return function(e,t,i,a){if("workers"in i)return function(e,t,i,a){if("undefined"===typeof Worker)return s(e,t,i,a);var o=l(e,t),u=i.workers,c=i.workLoad||100,h=30*c/8,f=i.workerScript||"forge/prime.worker.js";if(-1===u)return n.util.estimateCores((function(e,t){e&&(t=2),u=t-1,d()}));function d(){u=Math.max(1,u);for(var n=[],i=0;i<u;++i)n[i]=new Worker(f);for(i=0;i<u;++i)n[i].addEventListener("message",d);var s=!1;function d(i){if(!s){0;var u=i.data;if(u.found){for(var f=0;f<n.length;++f)n[f].terminate();return s=!0,a(null,new r(u.prime,16))}o.bitLength()>e&&(o=l(e,t));var d=o.toString(16);i.target.postMessage({hex:d,workLoad:c}),o.dAddOffset(h,0)}}}d()}(e,t,i,a);return s(e,t,i,a)}(e,u,a.options,i);throw new Error("Invalid prime generation algorithm: "+a.name)}}function s(e,t,r,n){var i=l(e,t),a=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(i.bitLength());"millerRabinTests"in r&&(a=r.millerRabinTests);var o=10;"maxBlockTime"in r&&(o=r.maxBlockTime),u(i,e,t,0,a,o,n)}function u(e,t,r,a,o,s,c){var h=+new Date;do{if(e.bitLength()>t&&(e=l(t,r)),e.isProbablePrime(o))return c(null,e);e.dAddOffset(i[a++%8],0)}while(s<0||+new Date-h<s);n.util.setImmediate((function(){u(e,t,r,a,o,s,c)}))}function l(e,t){var n=new r(e,t),i=e-1;return n.testBit(i)||n.bitwiseTo(r.ONE.shiftLeft(i),o,n),n.dAddOffset(31-n.mod(a).byteValue(),0),n}}()},function(e,t,r){var n=r(665);r(667);var i=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],a=[1,2,3,5],o=function(e,t){return e<<t&65535|(65535&e)>>16-t},s=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"===typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,a=e,o=e.length(),s=t,u=Math.ceil(s/8),l=255>>(7&s);for(r=o;r<128;r++)a.putByte(i[a.at(r-1)+a.at(r-o)&255]);for(a.setAt(128-u,i[a.at(128-u)&l]),r=127-u;r>=0;r--)a.setAt(r,i[a.at(r+1)^a.at(r+u)]);return a};var u=function(e,t,r){var i,u,l,c,h=!1,f=null,d=null,p=null,y=[];for(e=n.rc2.expandKey(e,t),l=0;l<64;l++)y.push(e.getInt16Le());r?(i=function(e){for(l=0;l<4;l++)e[l]+=y[c]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=o(e[l],a[l]),c++},u=function(e){for(l=0;l<4;l++)e[l]+=y[63&e[(l+3)%4]]}):(i=function(e){for(l=3;l>=0;l--)e[l]=s(e[l],a[l]),e[l]-=y[c]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),c--},u=function(e){for(l=3;l>=0;l--)e[l]-=y[63&e[(l+3)%4]]});var v=function(e){var t=[];for(l=0;l<4;l++){var n=f.getInt16Le();null!==p&&(r?n^=p.getInt16Le():p.putInt16Le(n)),t.push(65535&n)}c=r?0:63;for(var i=0;i<e.length;i++)for(var a=0;a<e[i][0];a++)e[i][1](t);for(l=0;l<4;l++)null!==p&&(r?p.putInt16Le(t[l]):t[l]^=p.getInt16Le()),d.putInt16Le(t[l])},m=null;return m={start:function(e,t){e&&"string"===typeof e&&(e=n.util.createBuffer(e)),h=!1,f=n.util.createBuffer(),d=t||new n.util.createBuffer,p=e,m.output=d},update:function(e){for(h||f.putBuffer(e);f.length()>=8;)v([[5,i],[1,u],[6,i],[1,u],[5,i]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,f,!r);else{var n=8===f.length()?8:8-f.length();f.fillWithByte(n,n)}if(t&&(h=!0,m.update()),!r&&(t=0===f.length()))if(e)t=e(8,d,!r);else{var i=d.length(),a=d.at(i-1);a>i?t=!1:d.truncate(a)}return t}}};n.rc2.startEncrypting=function(e,t,r){var i=n.rc2.createEncryptionCipher(e,128);return i.start(t,r),i},n.rc2.createEncryptionCipher=function(e,t){return u(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var i=n.rc2.createDecryptionCipher(e,128);return i.start(t,r),i},n.rc2.createDecryptionCipher=function(e,t){return u(e,t,!1)}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(884),o=r(761),s=r(694),u=r(890),l=r(1165),c=o(r(798));r(1174),r(762);var h=r(665),f=function(){function e(t){n(this,e),this._key=t}return i(e,[{key:"verify",value:function(e,t,r){y(r),l.hashAndVerify(this._key,t,e,r)}},{key:"marshal",value:function(){return l.utils.jwkToPkix(this._key)}},{key:"encrypt",value:function(e,t){var r=this;return d((function(){return l.encrypt(r._key,e)}),t)}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){y(e),a(this.bytes,"sha2-256",e)}},{key:"bytes",get:function(){return c.PublicKey.encode({Type:c.KeyType.RSA,Data:this.marshal()})}}]),e}();function d(e,t){var r;try{r=e()}catch(n){t(n)}return t(null,r)}var p=function(){function e(t,r){n(this,e),this._key=t,this._publicKey=r}return i(e,[{key:"genSecret",value:function(){return l.getRandomValues(16)}},{key:"sign",value:function(e,t){y(t),l.hashAndSign(this._key,e,t)}},{key:"decrypt",value:function(e,t){var r=this;d((function(){return l.decrypt(r._key,e)}),t)}},{key:"marshal",value:function(){return l.utils.jwkToPkcs1(this._key)}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){y(e),a(this.bytes,"sha2-256",e)}},{key:"id",value:function(e){this.public.hash((function(t,r){if(t)return e(t);e(null,s.encode(r))}))}},{key:"export",value:function(e,t,r){var n=this;"function"===typeof t&&(r=t,t=e,e="pkcs-8"),y(r),u((function(){var i=null,a=null;try{var o=new h.util.ByteBuffer(n.marshal()),s=h.asn1.fromDer(o),u=h.pki.privateKeyFromAsn1(s);if("pkcs-8"===e){a=h.pki.encryptRsaPrivateKey(u,t,{algorithm:"aes256",count:1e4,saltSize:16,prfAlgorithm:"sha512"})}else i=new Error("Unknown export format '".concat(e,"'"))}catch(l){i=l}r(i,a)}))}},{key:"public",get:function(){if(!this._publicKey)throw new Error("public key not provided");return new f(this._publicKey)}},{key:"bytes",get:function(){return c.PrivateKey.encode({Type:c.KeyType.RSA,Data:this.marshal()})}}]),e}();function y(e){if("function"!==typeof e)throw new Error("callback is required")}e.exports={RsaPublicKey:f,RsaPrivateKey:p,unmarshalRsaPublicKey:function(e){var t=l.utils.pkixToJwk(e);return new f(t)},unmarshalRsaPrivateKey:function(e,t){var r=l.utils.pkcs1ToJwk(e);l.unmarshalPrivateKey(r,(function(e,r){if(e)return t(e);t(null,new p(r.privateKey,r.publicKey))}))},generateKeyPair:function(e,t){l.generateKey(e,(function(e,r){if(e)return t(e);t(null,new p(r.privateKey,r.publicKey))}))},fromJwk:function(e,t){l.unmarshalPrivateKey(e,(function(e,r){if(e)return t(e);t(null,new p(r.privateKey,r.publicKey))}))}}},function(e,t,r){"use strict";(function(t){var n=r(315),i=r(885),a=r(886),o=r(1160),s=a.toCallback,u=a.toBuf,l=a.fromString,c=a.fromNumberTo32BitBuf;e.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:s(u(n.sha3_512)),sha3384:s(u(n.sha3_384)),sha3256:s(u(n.sha3_256)),sha3224:s(u(n.sha3_224)),shake128:s(u(n.shake_128,128)),shake256:s(u(n.shake_256,256)),keccak224:s(u(n.keccak_224)),keccak256:s(u(n.keccak_256)),keccak384:s(u(n.keccak_384)),keccak512:s(u(n.keccak_512)),murmur3128:s(u(l(i.x64.hash128))),murmur332:s(c(l(i.x86.hash32))),addBlake:r(1162),dblSha2256:function(e,r){o.sha2256(e,(function(e,n){e&&r(e),o.sha2256(t.from(n),r)}))}}}).call(this,r(10).Buffer)},function(e,t,r){!function(r,n){"use strict";var i={version:"3.0.1",x86:{},x64:{}};function a(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function s(e){return e=a(e^=e>>>16,2246822507),e=a(e^=e>>>13,3266489909),e^=e>>>16}function u(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function c(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function h(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function f(e,t){return[e[0]^t[0],e[1]^t[1]]}function d(e){return e=f(e,[0,e[0]>>>1]),e=f(e=l(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=f(e=l(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){t=t||0;for(var r=(e=e||"").length%4,n=e.length-r,i=t,u=0,l=3432918353,c=461845907,h=0;h<n;h+=4)u=a(u=255&e.charCodeAt(h)|(255&e.charCodeAt(h+1))<<8|(255&e.charCodeAt(h+2))<<16|(255&e.charCodeAt(h+3))<<24,l),u=a(u=o(u,15),c),i=a(i=o(i^=u,13),5)+3864292196;switch(u=0,r){case 3:u^=(255&e.charCodeAt(h+2))<<16;case 2:u^=(255&e.charCodeAt(h+1))<<8;case 1:u=a(u^=255&e.charCodeAt(h),l),i^=u=a(u=o(u,15),c)}return(i=s(i^=e.length))>>>0},i.x86.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,i=t,u=t,l=t,c=t,h=0,f=0,d=0,p=0,y=597399067,v=2869860233,m=951274213,g=2716044179,_=0;_<n;_+=16)h=255&e.charCodeAt(_)|(255&e.charCodeAt(_+1))<<8|(255&e.charCodeAt(_+2))<<16|(255&e.charCodeAt(_+3))<<24,f=255&e.charCodeAt(_+4)|(255&e.charCodeAt(_+5))<<8|(255&e.charCodeAt(_+6))<<16|(255&e.charCodeAt(_+7))<<24,d=255&e.charCodeAt(_+8)|(255&e.charCodeAt(_+9))<<8|(255&e.charCodeAt(_+10))<<16|(255&e.charCodeAt(_+11))<<24,p=255&e.charCodeAt(_+12)|(255&e.charCodeAt(_+13))<<8|(255&e.charCodeAt(_+14))<<16|(255&e.charCodeAt(_+15))<<24,h=o(h=a(h,y),15),i=o(i^=h=a(h,v),19),i=a(i+=u,5)+1444728091,f=o(f=a(f,v),16),u=o(u^=f=a(f,m),17),u=a(u+=l,5)+197830471,d=o(d=a(d,m),17),l=o(l^=d=a(d,g),15),l=a(l+=c,5)+2530024501,p=o(p=a(p,g),18),c=o(c^=p=a(p,y),13),c=a(c+=i,5)+850148119;switch(h=0,f=0,d=0,p=0,r){case 15:p^=e.charCodeAt(_+14)<<16;case 14:p^=e.charCodeAt(_+13)<<8;case 13:p=a(p^=e.charCodeAt(_+12),g),c^=p=a(p=o(p,18),y);case 12:d^=e.charCodeAt(_+11)<<24;case 11:d^=e.charCodeAt(_+10)<<16;case 10:d^=e.charCodeAt(_+9)<<8;case 9:d=a(d^=e.charCodeAt(_+8),m),l^=d=a(d=o(d,17),g);case 8:f^=e.charCodeAt(_+7)<<24;case 7:f^=e.charCodeAt(_+6)<<16;case 6:f^=e.charCodeAt(_+5)<<8;case 5:f=a(f^=e.charCodeAt(_+4),v),u^=f=a(f=o(f,16),m);case 4:h^=e.charCodeAt(_+3)<<24;case 3:h^=e.charCodeAt(_+2)<<16;case 2:h^=e.charCodeAt(_+1)<<8;case 1:h=a(h^=e.charCodeAt(_),y),i^=h=a(h=o(h,15),v)}return i^=e.length,i+=u^=e.length,i+=l^=e.length,u+=i+=c^=e.length,l+=i,c+=i,i=s(i),i+=u=s(u),i+=l=s(l),u+=i+=c=s(c),l+=i,c+=i,("00000000"+(i>>>0).toString(16)).slice(-8)+("00000000"+(u>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(c>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,i=[0,t],a=[0,t],o=[0,0],s=[0,0],p=[2277735313,289559509],y=[1291169091,658871167],v=0;v<n;v+=16)o=[255&e.charCodeAt(v+4)|(255&e.charCodeAt(v+5))<<8|(255&e.charCodeAt(v+6))<<16|(255&e.charCodeAt(v+7))<<24,255&e.charCodeAt(v)|(255&e.charCodeAt(v+1))<<8|(255&e.charCodeAt(v+2))<<16|(255&e.charCodeAt(v+3))<<24],s=[255&e.charCodeAt(v+12)|(255&e.charCodeAt(v+13))<<8|(255&e.charCodeAt(v+14))<<16|(255&e.charCodeAt(v+15))<<24,255&e.charCodeAt(v+8)|(255&e.charCodeAt(v+9))<<8|(255&e.charCodeAt(v+10))<<16|(255&e.charCodeAt(v+11))<<24],o=c(o=l(o,p),31),i=u(i=c(i=f(i,o=l(o,y)),27),a),i=u(l(i,[0,5]),[0,1390208809]),s=c(s=l(s,y),33),a=u(a=c(a=f(a,s=l(s,p)),31),i),a=u(l(a,[0,5]),[0,944331445]);switch(o=[0,0],s=[0,0],r){case 15:s=f(s,h([0,e.charCodeAt(v+14)],48));case 14:s=f(s,h([0,e.charCodeAt(v+13)],40));case 13:s=f(s,h([0,e.charCodeAt(v+12)],32));case 12:s=f(s,h([0,e.charCodeAt(v+11)],24));case 11:s=f(s,h([0,e.charCodeAt(v+10)],16));case 10:s=f(s,h([0,e.charCodeAt(v+9)],8));case 9:s=l(s=f(s,[0,e.charCodeAt(v+8)]),y),a=f(a,s=l(s=c(s,33),p));case 8:o=f(o,h([0,e.charCodeAt(v+7)],56));case 7:o=f(o,h([0,e.charCodeAt(v+6)],48));case 6:o=f(o,h([0,e.charCodeAt(v+5)],40));case 5:o=f(o,h([0,e.charCodeAt(v+4)],32));case 4:o=f(o,h([0,e.charCodeAt(v+3)],24));case 3:o=f(o,h([0,e.charCodeAt(v+2)],16));case 2:o=f(o,h([0,e.charCodeAt(v+1)],8));case 1:o=l(o=f(o,[0,e.charCodeAt(v)]),p),i=f(i,o=l(o=c(o,31),y))}return i=u(i=f(i,[0,e.length]),a=f(a,[0,e.length])),a=u(a,i),i=u(i=d(i),a=d(a)),a=u(a,i),("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)+("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},function(e,t,r){"use strict";(function(t){var n=r(887),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function a(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return function(r,a){var o=i.digest({name:e},r);if("function"!==typeof o.then)return o.onerror=function(){a(new Error("hashing data using ".concat(e)))},void(o.oncomplete=function(e){a(null,e.target.result)});n(o.then((function(e){return t.from(new Uint8Array(e))})),a)}}e.exports={sha1:function(e,t){a("SHA-1")(e,t)},sha2256:function(e,t){a("SHA-256")(e,t)},sha2512:function(e,t){a("SHA-512")(e,t)}}}).call(this,r(10).Buffer)},function(e,t,r){(function(t){var n,i=r(888);n="function"===typeof setImediate?setImediate:"object"===typeof t&&t&&t.nextTick?t.nextTick:function(e){setTimeout(e,0)};var a=[];function o(e){if(!(this instanceof o))return"function"===typeof e?new o(e):function(){var e,t=new o((function(t){e=t}));return{resolver:e,promise:t}}();var t,r=!1,s=!1,u=[],l=!1;function c(e){u.length?(l=!0,u.shift()(e||!1)):l=!1}this.then=function(e,i){return new o((function(a){u.push((function(r){var o=s?e:i;if("function"===typeof o){function u(){var e;try{e=o(t)}catch(r){return a.reject(r),c()}a.fulfill(e),c(!0)}r?u():n(u)}else s?(a.fulfill(t),c(r)):(a.reject(t),c(r))})),r&&!l&&c()}))},function(){function n(e){r||(r=!0,s=!1,t=e,c())}for(var o={fulfill:function e(a){r||(i(a)?a.then(e,n):(r=s=!0,t=a,c()))},reject:n},u=0;u<a.length;u++)a[u](this,o);if("function"===typeof e)try{e(o)}catch(l){o.reject(l)}}()}e.exports=o,o.use=function(e){a.push(e)}}).call(this,r(21))},function(e,t,r){"use strict";(function(t){var n=r(763),i=r(886).toCallback,a={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},s=function(e,r){return i((function(n){var i=r.init(e,null);return r.update(i,n),t.from(r.digest(i))}))};e.exports=function(e){for(var t=0;t<64;t++)e[45569+t]=s(t+1,a);for(var r=0;r<32;r++)e[45633+r]=s(r+1,o)}}).call(this,r(10).Buffer)},function(e,t,r){var n=r(889);function i(e,t,r){var n=e[t]+e[r],i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function a(e,t,r,n){var i=e[t]+r;r<0&&(i+=4294967296);var a=e[t+1]+n;i>=4294967296&&a++,e[t]=i,e[t+1]=a}function o(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function s(e,t,r,n,o,s){var u=h[o],l=h[o+1],f=h[s],d=h[s+1];i(c,e,t),a(c,e,u,l);var p=c[n]^c[e],y=c[n+1]^c[e+1];c[n]=y,c[n+1]=p,i(c,r,n),p=c[t]^c[r],y=c[t+1]^c[r+1],c[t]=p>>>24^y<<8,c[t+1]=y>>>24^p<<8,i(c,e,t),a(c,e,f,d),p=c[n]^c[e],y=c[n+1]^c[e+1],c[n]=p>>>16^y<<16,c[n+1]=y>>>16^p<<16,i(c,r,n),p=c[t]^c[r],y=c[t+1]^c[r+1],c[t]=y>>>31^p<<1,c[t+1]=p>>>31^y<<1}var u=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),l=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(e){return 2*e}))),c=new Uint32Array(32),h=new Uint32Array(32);function f(e,t){var r=0;for(r=0;r<16;r++)c[r]=e.h[r],c[r+16]=u[r];for(c[24]=c[24]^e.t,c[25]=c[25]^e.t/4294967296,t&&(c[28]=~c[28],c[29]=~c[29]),r=0;r<32;r++)h[r]=o(e.b,4*r);for(r=0;r<12;r++)s(0,8,16,24,l[16*r+0],l[16*r+1]),s(2,10,18,26,l[16*r+2],l[16*r+3]),s(4,12,20,28,l[16*r+4],l[16*r+5]),s(6,14,22,30,l[16*r+6],l[16*r+7]),s(0,10,20,30,l[16*r+8],l[16*r+9]),s(2,12,22,24,l[16*r+10],l[16*r+11]),s(4,14,16,26,l[16*r+12],l[16*r+13]),s(6,8,18,28,l[16*r+14],l[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^c[r]^c[r+16]}function d(e,t){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");for(var r={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e},n=0;n<16;n++)r.h[n]=u[n];var i=t?t.length:0;return r.h[0]^=16842752^i<<8^e,t&&(p(r,t),r.c=128),r}function p(e,t){for(var r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,f(e,!1),e.c=0),e.b[e.c++]=t[r]}function y(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;f(e,!0);for(var t=new Uint8Array(e.outlen),r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function v(e,t,r){r=r||64,e=n.normalizeInput(e);var i=d(r,t);return p(i,e),y(i)}e.exports={blake2b:v,blake2bHex:function(e,t,r){var i=v(e,t,r);return n.toHex(i)},blake2bInit:d,blake2bUpdate:p,blake2bFinal:y}},function(e,t,r){var n=r(889);function i(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function a(e,t,r,n,i,a){l[e]=l[e]+l[t]+i,l[n]=o(l[n]^l[e],16),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],12),l[e]=l[e]+l[t]+a,l[n]=o(l[n]^l[e],8),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],7)}function o(e,t){return e>>>t^e<<32-t}var s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),u=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),l=new Uint32Array(16),c=new Uint32Array(16);function h(e,t){var r=0;for(r=0;r<8;r++)l[r]=e.h[r],l[r+8]=s[r];for(l[12]^=e.t,l[13]^=e.t/4294967296,t&&(l[14]=~l[14]),r=0;r<16;r++)c[r]=i(e.b,4*r);for(r=0;r<10;r++)a(0,4,8,12,c[u[16*r+0]],c[u[16*r+1]]),a(1,5,9,13,c[u[16*r+2]],c[u[16*r+3]]),a(2,6,10,14,c[u[16*r+4]],c[u[16*r+5]]),a(3,7,11,15,c[u[16*r+6]],c[u[16*r+7]]),a(0,5,10,15,c[u[16*r+8]],c[u[16*r+9]]),a(1,6,11,12,c[u[16*r+10]],c[u[16*r+11]]),a(2,7,8,13,c[u[16*r+12]],c[u[16*r+13]]),a(3,4,9,14,c[u[16*r+14]],c[u[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=l[r]^l[r+8]}function f(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");var r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");var n={h:new Uint32Array(s),b:new Uint32Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(d(n,t),n.c=64),n}function d(e,t){for(var r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,h(e,!1),e.c=0),e.b[e.c++]=t[r]}function p(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;h(e,!0);for(var t=new Uint8Array(e.outlen),r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function y(e,t,r){r=r||32,e=n.normalizeInput(e);var i=f(r,t);return d(i,e),p(i)}e.exports={blake2s:y,blake2sHex:function(e,t,r){var i=y(e,t,r);return n.toHex(i)},blake2sInit:f,blake2sUpdate:d,blake2sFinal:p}},function(e,t,r){"use strict";(function(e){var n=r(804),i=r(805),a=r(891);function o(e){return Promise.all([i.subtle.exportKey("jwk",e.privateKey),i.subtle.exportKey("jwk",e.publicKey)])}t.utils=r(1167),t.generateKey=function(e,t){n(i.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(o).then((function(e){return{privateKey:e[0],publicKey:e[1]}})),t)},t.unmarshalPrivateKey=function(e,t){var r,a=i.subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]);n(Promise.all([a,(r=e,i.subtle.importKey("jwk",{kty:r.kty,n:r.n,e:r.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"]))]).then((function(e){return o({privateKey:e[0],publicKey:e[1]})})).then((function(e){return{privateKey:e[0],publicKey:e[1]}})),t)},t.getRandomValues=a,t.hashAndSign=function(t,r,a){n(i.subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]).then((function(e){return i.subtle.sign({name:"RSASSA-PKCS1-v1_5"},e,Uint8Array.from(r))})).then((function(t){return e.from(t)})),a)},t.hashAndVerify=function(e,t,r,a){n(i.subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]).then((function(e){return i.subtle.verify({name:"RSASSA-PKCS1-v1_5"},e,t,r)})),a)};var s=r(1168),u=s.jwk2pub,l=s.jwk2priv;function c(t,r,n,i){var a=r?u(t):l(t),o=i(e.from(n).toString("binary"),a);return e.from(o,"binary")}t.encrypt=function(e,t){return c(e,!0,t,(function(e,t){return t.encrypt(e)}))},t.decrypt=function(e,t){return c(e,!1,t,(function(e,t){return t.decrypt(e)}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=self.crypto||self.msCrypto,i=r(10).Buffer,a=65536;n&&n.getRandomValues?e.exports=function(e){var t=new Uint8Array(e),r=0;if(e>0)if(e>a)for(;r<e;)r+a>e?(n.getRandomValues(t.subarray(r,r+(e-r))),r+=e-r):(n.getRandomValues(t.subarray(r,r+a)),r+=a);else n.getRandomValues(t);return i.from(t)}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},function(e,t,r){"use strict";var n=r(177),i=r(892),a=i.toBase64,o=i.toBn,s=n.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())})),u=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid({"1.2.840.113549.1.1.1":"rsa"}),this.key("none").optional().null_(),this.key("curve").optional().objid(),this.key("params").optional().seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()))})),l=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("algorithm").use(u),this.key("subjectPublicKey").bitstr())})),c=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));t.pkcs1ToJwk=function(e){var t=s.decode(e,"der");return{kty:"RSA",n:a(t.modulus),e:a(t.publicExponent),d:a(t.privateExponent),p:a(t.prime1),q:a(t.prime2),dp:a(t.exponent1),dq:a(t.exponent2),qi:a(t.coefficient),alg:"RS256",kid:"2011-04-29"}},t.jwkToPkcs1=function(e){return s.encode({version:0,modulus:o(e.n),publicExponent:o(e.e),privateExponent:o(e.d),prime1:o(e.p),prime2:o(e.q),exponent1:o(e.dp),exponent2:o(e.dq),coefficient:o(e.qi)},"der")},t.pkixToJwk=function(e){var t=l.decode(e,"der"),r=c.decode(t.subjectPublicKey.data,"der");return{kty:"RSA",n:a(r.modulus),e:a(r.publicExponent),alg:"RS256",kid:"2011-04-29"}},t.jwkToPkix=function(e){return l.encode({algorithm:{algorithm:"rsa",none:null},subjectPublicKey:{data:c.encode({modulus:o(e.n),publicExponent:o(e.e)},"der")}},"der")}},function(e,t,r){"use strict";var n=r(317),i={util:r(667),pki:r(1169),jsbn:r(799)};function a(e,t){return t.map((function(t){return function(e){var t=i.util.decode64((e+"===".slice((e.length+3)%4)).replace(/-/g,"+").replace(/_/g,"/"));return new i.jsbn.BigInteger(i.util.bytesToHex(t),16)}(e[t])}))}function o(e){var t;return(t=i.pki).setRsaPrivateKey.apply(t,n(a(e,["n","e","d","p","q","dp","dq","qi"])))}function s(e){var t;return(t=i.pki).setRsaPublicKey.apply(t,n(a(e,["n","e"])))}e.exports={jwk2pub:s,jwk2pubPem:function(e){return i.pki.publicKeyToPem(s(e))},jwk2priv:o,jwk2privPem:function(e){return i.pki.privateKeyToPem(o(e))}}},function(e,t,r){var n=r(665);r(696),r(703),r(762),r(802),r(882),r(1170),r(894),r(742),r(667),r(893);var i=n.asn1,a=e.exports=n.pki=n.pki||{};a.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},a.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var o=i.fromDer(t.body);return a.privateKeyFromAsn1(o)},a.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:i.toDer(a.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},a.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:i.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},function(e,t,r){var n=r(665);r(696),r(883),r(703),r(1171),r(762),r(704),r(742),r(880),r(667),r(893);var i=n.asn1,a=n.pki,o=e.exports=n.pkcs12=n.pkcs12||{},s={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},u={name:"PFX",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},s,{name:"PFX.macData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:i.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},l={name:"SafeBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},c={name:"Attribute",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,capture:"values"}]},h={name:"CertBag",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:i.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:i.Class.UNIVERSAL,type:i.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function f(e,t,r,n){for(var i=[],a=0;a<e.length;a++)for(var o=0;o<e[a].safeBags.length;o++){var s=e[a].safeBags[o];void 0!==n&&s.type!==n||(null!==t?void 0!==s.attributes[t]&&s.attributes[t].indexOf(r)>=0&&i.push(s):i.push(s))}return i}function d(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function p(e,t){var r={},o=[];if(!i.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,o))throw(s=new Error("Cannot read EncryptedContentInfo.")).errors=o,s;var s,u=i.derToOid(r.contentType);if(u!==a.oids.data)throw(s=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=u,s;u=i.derToOid(r.encAlgorithm);var l=a.pbe.getCipher(u,r.encParameter,t),c=d(r.encryptedContentAsn1),h=n.util.createBuffer(c.value);if(l.update(h),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function y(e,t,r){if(!t&&0===e.length)return[];if((e=i.fromDer(e,t)).tagClass!==i.Class.UNIVERSAL||e.type!==i.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],o=0;o<e.value.length;o++){var s=e.value[o],u={},c=[];if(!i.validate(s,l,u,c))throw(m=new Error("Cannot read SafeBag.")).errors=c,m;var f,d,p={type:i.derToOid(u.bagId),attributes:v(u.bagAttributes)};n.push(p);var y=u.bagValue.value[0];switch(p.type){case a.oids.pkcs8ShroudedKeyBag:if(null===(y=a.decryptPrivateKeyInfo(y,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case a.oids.keyBag:try{p.key=a.privateKeyFromAsn1(y)}catch(g){p.key=null,p.asn1=y}continue;case a.oids.certBag:f=h,d=function(){if(i.derToOid(u.certId)!==a.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=i.derToOid(u.certId),e}var r=i.fromDer(u.cert,t);try{p.cert=a.certificateFromAsn1(r,!0)}catch(g){p.cert=null,p.asn1=r}};break;default:var m;throw(m=new Error("Unsupported PKCS#12 SafeBag type.")).oid=p.type,m}if(void 0!==f&&!i.validate(y,f,u,c))throw(m=new Error("Cannot read PKCS#12 "+f.name)).errors=c,m;d()}return n}function v(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},o=[];if(!i.validate(e[r],c,n,o)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=o,s}var u=i.derToOid(n.oid);if(void 0!==a.oids[u]){t[a.oids[u]]=[];for(var l=0;l<n.values.length;++l)t[a.oids[u]].push(n.values[l].value)}}return t}o.pkcs12FromAsn1=function(e,t,r){"string"===typeof t?(r=t,t=!0):void 0===t&&(t=!0);var l={};if(!i.validate(e,u,l,[]))throw(c=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=c,c;var c,h={version:l.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=f(h.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=f(h.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=f(h.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return f(h.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return f(h.safeContents,"localKeyId",e,t)}};if(3!==l.version.charCodeAt(0))throw(c=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=l.version.charCodeAt(0),c;if(i.derToOid(l.contentType)!==a.oids.data)throw(c=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=i.derToOid(l.contentType),c;var v=l.content.value[0];if(v.tagClass!==i.Class.UNIVERSAL||v.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(v=d(v),l.mac){var m=null,g=0,_=i.derToOid(l.macAlgorithm);switch(_){case a.oids.sha1:m=n.md.sha1.create(),g=20;break;case a.oids.sha256:m=n.md.sha256.create(),g=32;break;case a.oids.sha384:m=n.md.sha384.create(),g=48;break;case a.oids.sha512:m=n.md.sha512.create(),g=64;break;case a.oids.md5:m=n.md.md5.create(),g=16}if(null===m)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+_);var b=new n.util.ByteBuffer(l.macSalt),w="macIterations"in l?parseInt(n.util.bytesToHex(l.macIterations),16):1,x=o.generateKey(r,b,3,w,g,m),k=n.hmac.create();if(k.start(m,x),k.update(v.value),k.getMac().getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=i.fromDer(t,r)).tagClass!==i.Class.UNIVERSAL||t.type!==i.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<t.value.length;o++){var u=t.value[o],l={},c=[];if(!i.validate(u,s,l,c))throw(m=new Error("Cannot read ContentInfo.")).errors=c,m;var h={encrypted:!1},f=null,v=l.content.value[0];switch(i.derToOid(l.contentType)){case a.oids.data:if(v.tagClass!==i.Class.UNIVERSAL||v.type!==i.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");f=d(v).value;break;case a.oids.encryptedData:f=p(v,n),h.encrypted=!0;break;default:var m;throw(m=new Error("Unsupported PKCS#12 contentType.")).contentType=i.derToOid(l.contentType),m}h.safeBags=y(f,r,n),e.safeContents.push(h)}}(h,v.value,t,r),h},o.toPkcs12Asn1=function(e,t,r,s){(s=s||{}).saltSize=s.saltSize||8,s.count=s.count||2048,s.algorithm=s.algorithm||s.encAlgorithm||"aes128","useMac"in s||(s.useMac=!0),"localKeyId"in s||(s.localKeyId=null),"generateLocalKeyId"in s||(s.generateLocalKeyId=!0);var u,l=s.localKeyId;if(null!==l)l=n.util.hexToBytes(l);else if(s.generateLocalKeyId)if(t){var c=n.util.isArray(t)?t[0]:t;"string"===typeof c&&(c=a.certificateFromPem(c)),(A=n.md.sha1.create()).update(i.toDer(a.certificateToAsn1(c)).getBytes()),l=A.digest().getBytes()}else l=n.random.getBytes(20);var h=[];null!==l&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.localKeyId).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,l)])])),"friendlyName"in s&&h.push(i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.friendlyName).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SET,!0,[i.create(i.Class.UNIVERSAL,i.Type.BMPSTRING,!1,s.friendlyName)])])),h.length>0&&(u=i.create(i.Class.UNIVERSAL,i.Type.SET,!0,h));var f=[],d=[];null!==t&&(d=n.util.isArray(t)?t:[t]);for(var p=[],y=0;y<d.length;++y){"string"===typeof(t=d[y])&&(t=a.certificateFromPem(t));var v=0===y?u:void 0,m=a.certificateToAsn1(t),g=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.certBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.x509Certificate).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(m).getBytes())])])]),v]);p.push(g)}if(p.length>0){var _=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,p),b=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(_).getBytes())])]);f.push(b)}var w=null;if(null!==e){var x=a.wrapRsaPrivateKey(a.privateKeyToAsn1(e));w=null===r?i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.keyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[x]),u]):i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.pkcs8ShroudedKeyBag).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[a.encryptPrivateKeyInfo(x,r,s)]),u]);var k=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[w]),E=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(k).getBytes())])]);f.push(E)}var S,T=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,f);if(s.useMac){var A=n.md.sha1.create(),C=new n.util.ByteBuffer(n.random.getBytes(s.saltSize)),I=s.count,R=(e=o.generateKey(r,C,3,I,20),n.hmac.create());R.start(A,e),R.update(i.toDer(T).getBytes());var M=R.getMac();S=i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.sha1).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.NULL,!1,"")]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,M.getBytes())]),i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,C.getBytes()),i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(I).getBytes())])}return i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.INTEGER,!1,i.integerToDer(3).getBytes()),i.create(i.Class.UNIVERSAL,i.Type.SEQUENCE,!0,[i.create(i.Class.UNIVERSAL,i.Type.OID,!1,i.oidToDer(a.oids.data).getBytes()),i.create(i.Class.CONTEXT_SPECIFIC,0,!0,[i.create(i.Class.UNIVERSAL,i.Type.OCTETSTRING,!1,i.toDer(T).getBytes())])]),S])},o.generateKey=n.pbe.generatePkcs12Key},function(e,t,r){var n=r(665);r(696),r(667);var i=n.asn1,a=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=a;var o={name:"ContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};a.contentInfoValidator=o;var s={name:"EncryptedContentInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};a.envelopedDataValidator={name:"EnvelopedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(s)},a.encryptedDataValidator={name:"EncryptedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"}].concat(s)};var u={name:"SignerInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};a.signedDataValidator={name:"SignedData",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},o,{name:"SignedData.Certificates",tagClass:i.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:i.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:i.Class.UNIVERSAL,type:i.Type.SET,capture:"signerInfos",optional:!0,value:[u]}]},a.recipientInfoValidator={name:"RecipientInfo",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:i.Class.UNIVERSAL,type:i.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:i.Class.UNIVERSAL,type:i.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:i.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:i.Class.UNIVERSAL,type:i.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},function(e,t,r){var n=r(665);r(1173),e.exports=n.mgf=n.mgf||{},n.mgf.mgf1=n.mgf1},function(e,t,r){var n=r(665);r(667),n.mgf=n.mgf||{},(e.exports=n.mgf.mgf1=n.mgf1=n.mgf1||{}).create=function(e){return{generate:function(t,r){for(var i=new n.util.ByteBuffer,a=Math.ceil(r/e.digestLength),o=0;o<a;o++){var s=new n.util.ByteBuffer;s.putInt32(o),e.start(),e.update(t+s.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-r),i.getBytes()}}}},function(e,t,r){var n=r(665);r(697),r(667);var i=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=i;var a=n.sha384=n.sha512.sha384=n.sha512.sha384||{};a.create=function(){return i.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=a,n.sha512.sha256=n.sha512.sha256||{create:function(){return i.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return i.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,i.create=function(e){if(s||(o=String.fromCharCode(128),o+=n.util.fillString(String.fromCharCode(0),128),u=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(l={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],s=!0),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],r=null,i=n.util.createBuffer(),a=new Array(80),h=0;h<80;++h)a[h]=new Array(2);var f=64;switch(e){case"SHA-384":f=48;break;case"SHA-512/256":f=32;break;case"SHA-512/224":f=28}var d={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:f,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){d.messageLength=0,d.fullMessageLength=d.messageLength128=[];for(var e=d.messageLengthSize/4,a=0;a<e;++a)d.fullMessageLength.push(0);i=n.util.createBuffer(),r=new Array(t.length);for(a=0;a<t.length;++a)r[a]=t[a].slice(0);return d}};return d.start(),d.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var o=e.length;d.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var s=d.fullMessageLength.length-1;s>=0;--s)d.fullMessageLength[s]+=o[1],o[1]=o[0]+(d.fullMessageLength[s]/4294967296>>>0),d.fullMessageLength[s]=d.fullMessageLength[s]>>>0,o[0]=o[1]/4294967296>>>0;return i.putBytes(e),c(r,a,i),(i.read>2048||0===i.length())&&i.compact(),d},d.digest=function(){var t=n.util.createBuffer();t.putBytes(i.bytes());var s,u=d.fullMessageLength[d.fullMessageLength.length-1]+d.messageLengthSize&d.blockLength-1;t.putBytes(o.substr(0,d.blockLength-u));for(var l=8*d.fullMessageLength[0],h=0;h<d.fullMessageLength.length-1;++h)l+=(s=8*d.fullMessageLength[h+1])/4294967296>>>0,t.putInt32(l>>>0),l=s>>>0;t.putInt32(l);var f=new Array(r.length);for(h=0;h<r.length;++h)f[h]=r[h].slice(0);c(f,a,t);var p,y=n.util.createBuffer();p="SHA-512"===e?f.length:"SHA-384"===e?f.length-2:f.length-4;for(h=0;h<p;++h)y.putInt32(f[h][0]),h===p-1&&"SHA-512/224"===e||y.putInt32(f[h][1]);return y},d};var o=null,s=!1,u=null,l=null;function c(e,t,r){for(var n,i,a,o,s,l,c,h,f,d,p,y,v,m,g,_,b,w,x,k,E,S,T,A,C,I,R,M,P,O,L,D,B,N=r.length();N>=128;){for(R=0;R<16;++R)t[R][0]=r.getInt32()>>>0,t[R][1]=r.getInt32()>>>0;for(;R<80;++R)n=(((M=(O=t[R-2])[0])>>>19|(P=O[1])<<13)^(P>>>29|M<<3)^M>>>6)>>>0,i=((M<<13|P>>>19)^(P<<3|M>>>29)^(M<<26|P>>>6))>>>0,a=(((M=(D=t[R-15])[0])>>>1|(P=D[1])<<31)^(M>>>8|P<<24)^M>>>7)>>>0,o=((M<<31|P>>>1)^(M<<24|P>>>8)^(M<<25|P>>>7))>>>0,L=t[R-7],B=t[R-16],P=i+L[1]+o+B[1],t[R][0]=n+L[0]+a+B[0]+(P/4294967296>>>0)>>>0,t[R][1]=P>>>0;for(p=e[0][0],y=e[0][1],v=e[1][0],m=e[1][1],g=e[2][0],_=e[2][1],b=e[3][0],w=e[3][1],x=e[4][0],k=e[4][1],E=e[5][0],S=e[5][1],T=e[6][0],A=e[6][1],C=e[7][0],I=e[7][1],R=0;R<80;++R)c=((x>>>14|k<<18)^(x>>>18|k<<14)^(k>>>9|x<<23))>>>0,h=(T^x&(E^T))>>>0,s=((p>>>28|y<<4)^(y>>>2|p<<30)^(y>>>7|p<<25))>>>0,l=((p<<4|y>>>28)^(y<<30|p>>>2)^(y<<25|p>>>7))>>>0,f=(p&v|g&(p^v))>>>0,d=(y&m|_&(y^m))>>>0,P=I+(((x<<18|k>>>14)^(x<<14|k>>>18)^(k<<23|x>>>9))>>>0)+((A^k&(S^A))>>>0)+u[R][1]+t[R][1],n=C+c+h+u[R][0]+t[R][0]+(P/4294967296>>>0)>>>0,i=P>>>0,a=s+f+((P=l+d)/4294967296>>>0)>>>0,o=P>>>0,C=T,I=A,T=E,A=S,E=x,S=k,x=b+n+((P=w+i)/4294967296>>>0)>>>0,k=P>>>0,b=g,w=_,g=v,_=m,v=p,m=y,p=n+a+((P=i+o)/4294967296>>>0)>>>0,y=P>>>0;P=e[0][1]+y,e[0][0]=e[0][0]+p+(P/4294967296>>>0)>>>0,e[0][1]=P>>>0,P=e[1][1]+m,e[1][0]=e[1][0]+v+(P/4294967296>>>0)>>>0,e[1][1]=P>>>0,P=e[2][1]+_,e[2][0]=e[2][0]+g+(P/4294967296>>>0)>>>0,e[2][1]=P>>>0,P=e[3][1]+w,e[3][0]=e[3][0]+b+(P/4294967296>>>0)>>>0,e[3][1]=P>>>0,P=e[4][1]+k,e[4][0]=e[4][0]+x+(P/4294967296>>>0)>>>0,e[4][1]=P>>>0,P=e[5][1]+S,e[5][0]=e[5][0]+E+(P/4294967296>>>0)>>>0,e[5][1]=P>>>0,P=e[6][1]+A,e[6][0]=e[6][0]+T+(P/4294967296>>>0)>>>0,e[6][1]=P>>>0,P=e[7][1]+I,e[7][0]=e[7][0]+C+(P/4294967296>>>0)>>>0,e[7][1]=P>>>0,N-=128}}},function(e,t,r){"use strict";(function(t){var n=r(18),i=r(19),a=r(884),o=r(761),s=r(694),u=r(1176),l=o(r(798)),c=function(){function e(t){n(this,e),this._key=d(t,u.publicKeyLength)}return i(e,[{key:"verify",value:function(e,t,r){f(r),u.hashAndVerify(this._key,t,e,r)}},{key:"marshal",value:function(){return t.from(this._key)}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){f(e),a(this.bytes,"sha2-256",e)}},{key:"bytes",get:function(){return l.PublicKey.encode({Type:l.KeyType.Ed25519,Data:this.marshal()})}}]),e}(),h=function(){function e(t,r){n(this,e),this._key=d(t,u.privateKeyLength),this._publicKey=d(r,u.publicKeyLength)}return i(e,[{key:"sign",value:function(e,t){f(t),u.hashAndSign(this._key,e,t)}},{key:"marshal",value:function(){return t.concat([t.from(this._key),t.from(this._publicKey)])}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){f(e),a(this.bytes,"sha2-256",e)}},{key:"id",value:function(e){this.public.hash((function(t,r){if(t)return e(t);e(null,s.encode(r))}))}},{key:"public",get:function(){if(!this._publicKey)throw new Error("public key not provided");return new c(this._publicKey)}},{key:"bytes",get:function(){return l.PrivateKey.encode({Type:l.KeyType.Ed25519,Data:this.marshal()})}}]),e}();function f(e){if("function"!==typeof e)throw new Error("callback is required")}function d(e,r){if(t.isBuffer(e)&&(e=new Uint8Array(e)),!(e instanceof Uint8Array)||e.length!==r)throw new Error("Key must be a Uint8Array or Buffer of length "+r);return e}e.exports={Ed25519PublicKey:c,Ed25519PrivateKey:h,unmarshalEd25519PrivateKey:function(e,t){try{e=d(e,u.privateKeyLength+u.publicKeyLength)}catch(i){return t(i)}var r=e.slice(0,u.privateKeyLength),n=e.slice(u.privateKeyLength,e.length);t(null,new h(r,n))},unmarshalEd25519PublicKey:function(e){return e=d(e,u.publicKeyLength),new c(e)},generateKeyPair:function(e,t){void 0===t&&"function"===typeof e&&(t=e),u.generateKey((function(e,r){if(e)return t(e);var n;try{n=new h(r.secretKey,r.publicKey)}catch(e){return void t(e)}t(null,n)}))},generateKeyPairFromSeed:function(e,t,r){void 0===r&&"function"===typeof t&&(r=t),u.generateKeyFromSeed(e,(function(e,t){if(e)return r(e);var n;try{n=new h(t.secretKey,t.publicKey)}catch(e){return void r(e)}r(null,n)}))}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(e){var n=r(1177),i=r(890);t.publicKeyLength=n.sign.publicKeyLength,t.privateKeyLength=n.sign.secretKeyLength,t.generateKey=function(e){i((function(){var t;try{t=n.sign.keyPair()}catch(r){return e(r)}e(null,t)}))},t.generateKeyFromSeed=function(e,t){i((function(){var r;try{r=n.sign.keyPair.fromSeed(e)}catch(i){return t(i)}t(null,r)}))},t.hashAndSign=function(t,r,a){i((function(){a(null,e.from(n.sign.detached(r,t)))}))},t.hashAndVerify=function(e,t,r,a){i((function(){var i;try{i=n.sign.detached.verify(r,t,e)}catch(o){return a(o)}a(null,i)}))}}).call(this,r(10).Buffer)},function(e,t,r){!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),a=new Uint8Array(32);a[0]=9;var o=t(),s=t([1]),u=t([56129,1]),l=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),d=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var a,o=0;for(a=0;a<i;a++)o|=e[t+a]^r[n+a];return(1&o-1>>>8)-1}function v(e,t,r,n){return y(e,t,r,n,16)}function m(e,t,r,n){return y(e,t,r,n,32)}function g(e,t,r,n){!function(e,t,r,n){for(var i,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,u=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,l=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,f=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,v=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,g=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,_=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,b=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,w=a,x=o,k=s,E=u,S=l,T=c,A=h,C=f,I=d,R=p,M=y,P=v,O=m,L=g,D=_,B=b,N=0;N<20;N+=2)w^=(i=(O^=(i=(I^=(i=(S^=(i=w+O|0)<<7|i>>>25)+w|0)<<9|i>>>23)+S|0)<<13|i>>>19)+I|0)<<18|i>>>14,T^=(i=(x^=(i=(L^=(i=(R^=(i=T+x|0)<<7|i>>>25)+T|0)<<9|i>>>23)+R|0)<<13|i>>>19)+L|0)<<18|i>>>14,M^=(i=(A^=(i=(k^=(i=(D^=(i=M+A|0)<<7|i>>>25)+M|0)<<9|i>>>23)+D|0)<<13|i>>>19)+k|0)<<18|i>>>14,B^=(i=(P^=(i=(C^=(i=(E^=(i=B+P|0)<<7|i>>>25)+B|0)<<9|i>>>23)+E|0)<<13|i>>>19)+C|0)<<18|i>>>14,w^=(i=(E^=(i=(k^=(i=(x^=(i=w+E|0)<<7|i>>>25)+w|0)<<9|i>>>23)+x|0)<<13|i>>>19)+k|0)<<18|i>>>14,T^=(i=(S^=(i=(C^=(i=(A^=(i=T+S|0)<<7|i>>>25)+T|0)<<9|i>>>23)+A|0)<<13|i>>>19)+C|0)<<18|i>>>14,M^=(i=(R^=(i=(I^=(i=(P^=(i=M+R|0)<<7|i>>>25)+M|0)<<9|i>>>23)+P|0)<<13|i>>>19)+I|0)<<18|i>>>14,B^=(i=(D^=(i=(L^=(i=(O^=(i=B+D|0)<<7|i>>>25)+B|0)<<9|i>>>23)+O|0)<<13|i>>>19)+L|0)<<18|i>>>14;w=w+a|0,x=x+o|0,k=k+s|0,E=E+u|0,S=S+l|0,T=T+c|0,A=A+h|0,C=C+f|0,I=I+d|0,R=R+p|0,M=M+y|0,P=P+v|0,O=O+m|0,L=L+g|0,D=D+_|0,B=B+b|0,e[0]=w>>>0&255,e[1]=w>>>8&255,e[2]=w>>>16&255,e[3]=w>>>24&255,e[4]=x>>>0&255,e[5]=x>>>8&255,e[6]=x>>>16&255,e[7]=x>>>24&255,e[8]=k>>>0&255,e[9]=k>>>8&255,e[10]=k>>>16&255,e[11]=k>>>24&255,e[12]=E>>>0&255,e[13]=E>>>8&255,e[14]=E>>>16&255,e[15]=E>>>24&255,e[16]=S>>>0&255,e[17]=S>>>8&255,e[18]=S>>>16&255,e[19]=S>>>24&255,e[20]=T>>>0&255,e[21]=T>>>8&255,e[22]=T>>>16&255,e[23]=T>>>24&255,e[24]=A>>>0&255,e[25]=A>>>8&255,e[26]=A>>>16&255,e[27]=A>>>24&255,e[28]=C>>>0&255,e[29]=C>>>8&255,e[30]=C>>>16&255,e[31]=C>>>24&255,e[32]=I>>>0&255,e[33]=I>>>8&255,e[34]=I>>>16&255,e[35]=I>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=M>>>0&255,e[41]=M>>>8&255,e[42]=M>>>16&255,e[43]=M>>>24&255,e[44]=P>>>0&255,e[45]=P>>>8&255,e[46]=P>>>16&255,e[47]=P>>>24&255,e[48]=O>>>0&255,e[49]=O>>>8&255,e[50]=O>>>16&255,e[51]=O>>>24&255,e[52]=L>>>0&255,e[53]=L>>>8&255,e[54]=L>>>16&255,e[55]=L>>>24&255,e[56]=D>>>0&255,e[57]=D>>>8&255,e[58]=D>>>16&255,e[59]=D>>>24&255,e[60]=B>>>0&255,e[61]=B>>>8&255,e[62]=B>>>16&255,e[63]=B>>>24&255}(e,t,r,n)}function _(e,t,r,n){!function(e,t,r,n){for(var i,a=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,u=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,l=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,h=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,f=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,d=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,v=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,m=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,g=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,_=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,b=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,w=0;w<20;w+=2)a^=(i=(m^=(i=(d^=(i=(l^=(i=a+m|0)<<7|i>>>25)+a|0)<<9|i>>>23)+l|0)<<13|i>>>19)+d|0)<<18|i>>>14,c^=(i=(o^=(i=(g^=(i=(p^=(i=c+o|0)<<7|i>>>25)+c|0)<<9|i>>>23)+p|0)<<13|i>>>19)+g|0)<<18|i>>>14,y^=(i=(h^=(i=(s^=(i=(_^=(i=y+h|0)<<7|i>>>25)+y|0)<<9|i>>>23)+_|0)<<13|i>>>19)+s|0)<<18|i>>>14,b^=(i=(v^=(i=(f^=(i=(u^=(i=b+v|0)<<7|i>>>25)+b|0)<<9|i>>>23)+u|0)<<13|i>>>19)+f|0)<<18|i>>>14,a^=(i=(u^=(i=(s^=(i=(o^=(i=a+u|0)<<7|i>>>25)+a|0)<<9|i>>>23)+o|0)<<13|i>>>19)+s|0)<<18|i>>>14,c^=(i=(l^=(i=(f^=(i=(h^=(i=c+l|0)<<7|i>>>25)+c|0)<<9|i>>>23)+h|0)<<13|i>>>19)+f|0)<<18|i>>>14,y^=(i=(p^=(i=(d^=(i=(v^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+v|0)<<13|i>>>19)+d|0)<<18|i>>>14,b^=(i=(_^=(i=(g^=(i=(m^=(i=b+_|0)<<7|i>>>25)+b|0)<<9|i>>>23)+m|0)<<13|i>>>19)+g|0)<<18|i>>>14;e[0]=a>>>0&255,e[1]=a>>>8&255,e[2]=a>>>16&255,e[3]=a>>>24&255,e[4]=c>>>0&255,e[5]=c>>>8&255,e[6]=c>>>16&255,e[7]=c>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=b>>>0&255,e[13]=b>>>8&255,e[14]=b>>>16&255,e[15]=b>>>24&255,e[16]=h>>>0&255,e[17]=h>>>8&255,e[18]=h>>>16&255,e[19]=h>>>24&255,e[20]=f>>>0&255,e[21]=f>>>8&255,e[22]=f>>>16&255,e[23]=f>>>24&255,e[24]=d>>>0&255,e[25]=d>>>8&255,e[26]=d>>>16&255,e[27]=d>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var b=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function w(e,t,r,n,i,a,o){var s,u,l=new Uint8Array(16),c=new Uint8Array(64);for(u=0;u<16;u++)l[u]=0;for(u=0;u<8;u++)l[u]=a[u];for(;i>=64;){for(g(c,l,o,b),u=0;u<64;u++)e[t+u]=r[n+u]^c[u];for(s=1,u=8;u<16;u++)s=s+(255&l[u])|0,l[u]=255&s,s>>>=8;i-=64,t+=64,n+=64}if(i>0)for(g(c,l,o,b),u=0;u<i;u++)e[t+u]=r[n+u]^c[u];return 0}function x(e,t,r,n,i){var a,o,s=new Uint8Array(16),u=new Uint8Array(64);for(o=0;o<16;o++)s[o]=0;for(o=0;o<8;o++)s[o]=n[o];for(;r>=64;){for(g(u,s,i,b),o=0;o<64;o++)e[t+o]=u[o];for(a=1,o=8;o<16;o++)a=a+(255&s[o])|0,s[o]=255&a,a>>>=8;r-=64,t+=64}if(r>0)for(g(u,s,i,b),o=0;o<r;o++)e[t+o]=u[o];return 0}function k(e,t,r,n,i){var a=new Uint8Array(32);_(a,n,i,b);for(var o=new Uint8Array(8),s=0;s<8;s++)o[s]=n[s+16];return x(e,t,r,o,a)}function E(e,t,r,n,i,a,o){var s=new Uint8Array(32);_(s,a,o,b);for(var u=new Uint8Array(8),l=0;l<8;l++)u[l]=a[l+16];return w(e,t,r,n,i,u,s)}var S=function(e){var t,r,n,i,a,o,s,u;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),a=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|a<<12),this.r[5]=a>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(a>>>14|o<<2),s=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|s<<5),u=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(s>>>8|u<<8),this.r[9]=u>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function T(e,t,r,n,i,a){var o=new S(a);return o.update(r,n,i),o.finish(e,t),0}function A(e,t,r,n,i,a){var o=new Uint8Array(16);return T(o,0,r,n,i,a),v(e,t,o,0)}function C(e,t,r,n,i){var a;if(r<32)return-1;for(E(e,0,t,0,r,n,i),T(e,16,e,32,r-32,e),a=0;a<16;a++)e[a]=0;return 0}function I(e,t,r,n,i){var a,o=new Uint8Array(32);if(r<32)return-1;if(k(o,0,32,n,i),0!==A(t,16,t,32,r-32,o))return-1;for(E(e,0,t,0,r,n,i),a=0;a<32;a++)e[a]=0;return 0}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function M(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function P(e,t,r){for(var n,i=~(r-1),a=0;a<16;a++)n=i&(e[a]^t[a]),e[a]^=n,t[a]^=n}function O(e,r){var n,i,a,o=t(),s=t();for(n=0;n<16;n++)s[n]=r[n];for(M(s),M(s),M(s),i=0;i<2;i++){for(o[0]=s[0]-65517,n=1;n<15;n++)o[n]=s[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=s[15]-32767-(o[14]>>16&1),a=o[15]>>16&1,o[14]&=65535,P(s,o,1-a)}for(n=0;n<16;n++)e[2*n]=255&s[n],e[2*n+1]=s[n]>>8}function L(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return O(r,e),O(n,t),m(r,0,n,0)}function D(e){var t=new Uint8Array(32);return O(t,e),1&t[0]}function B(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function N(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function z(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,i,a=0,o=0,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,y=0,v=0,m=0,g=0,_=0,b=0,w=0,x=0,k=0,E=0,S=0,T=0,A=0,C=0,I=0,R=0,M=0,P=0,O=0,L=0,D=0,B=r[0],N=r[1],z=r[2],F=r[3],j=r[4],U=r[5],V=r[6],q=r[7],G=r[8],K=r[9],H=r[10],W=r[11],Z=r[12],Y=r[13],X=r[14],Q=r[15];a+=(n=t[0])*B,o+=n*N,s+=n*z,u+=n*F,l+=n*j,c+=n*U,h+=n*V,f+=n*q,d+=n*G,p+=n*K,y+=n*H,v+=n*W,m+=n*Z,g+=n*Y,_+=n*X,b+=n*Q,o+=(n=t[1])*B,s+=n*N,u+=n*z,l+=n*F,c+=n*j,h+=n*U,f+=n*V,d+=n*q,p+=n*G,y+=n*K,v+=n*H,m+=n*W,g+=n*Z,_+=n*Y,b+=n*X,w+=n*Q,s+=(n=t[2])*B,u+=n*N,l+=n*z,c+=n*F,h+=n*j,f+=n*U,d+=n*V,p+=n*q,y+=n*G,v+=n*K,m+=n*H,g+=n*W,_+=n*Z,b+=n*Y,w+=n*X,x+=n*Q,u+=(n=t[3])*B,l+=n*N,c+=n*z,h+=n*F,f+=n*j,d+=n*U,p+=n*V,y+=n*q,v+=n*G,m+=n*K,g+=n*H,_+=n*W,b+=n*Z,w+=n*Y,x+=n*X,k+=n*Q,l+=(n=t[4])*B,c+=n*N,h+=n*z,f+=n*F,d+=n*j,p+=n*U,y+=n*V,v+=n*q,m+=n*G,g+=n*K,_+=n*H,b+=n*W,w+=n*Z,x+=n*Y,k+=n*X,E+=n*Q,c+=(n=t[5])*B,h+=n*N,f+=n*z,d+=n*F,p+=n*j,y+=n*U,v+=n*V,m+=n*q,g+=n*G,_+=n*K,b+=n*H,w+=n*W,x+=n*Z,k+=n*Y,E+=n*X,S+=n*Q,h+=(n=t[6])*B,f+=n*N,d+=n*z,p+=n*F,y+=n*j,v+=n*U,m+=n*V,g+=n*q,_+=n*G,b+=n*K,w+=n*H,x+=n*W,k+=n*Z,E+=n*Y,S+=n*X,T+=n*Q,f+=(n=t[7])*B,d+=n*N,p+=n*z,y+=n*F,v+=n*j,m+=n*U,g+=n*V,_+=n*q,b+=n*G,w+=n*K,x+=n*H,k+=n*W,E+=n*Z,S+=n*Y,T+=n*X,A+=n*Q,d+=(n=t[8])*B,p+=n*N,y+=n*z,v+=n*F,m+=n*j,g+=n*U,_+=n*V,b+=n*q,w+=n*G,x+=n*K,k+=n*H,E+=n*W,S+=n*Z,T+=n*Y,A+=n*X,C+=n*Q,p+=(n=t[9])*B,y+=n*N,v+=n*z,m+=n*F,g+=n*j,_+=n*U,b+=n*V,w+=n*q,x+=n*G,k+=n*K,E+=n*H,S+=n*W,T+=n*Z,A+=n*Y,C+=n*X,I+=n*Q,y+=(n=t[10])*B,v+=n*N,m+=n*z,g+=n*F,_+=n*j,b+=n*U,w+=n*V,x+=n*q,k+=n*G,E+=n*K,S+=n*H,T+=n*W,A+=n*Z,C+=n*Y,I+=n*X,R+=n*Q,v+=(n=t[11])*B,m+=n*N,g+=n*z,_+=n*F,b+=n*j,w+=n*U,x+=n*V,k+=n*q,E+=n*G,S+=n*K,T+=n*H,A+=n*W,C+=n*Z,I+=n*Y,R+=n*X,M+=n*Q,m+=(n=t[12])*B,g+=n*N,_+=n*z,b+=n*F,w+=n*j,x+=n*U,k+=n*V,E+=n*q,S+=n*G,T+=n*K,A+=n*H,C+=n*W,I+=n*Z,R+=n*Y,M+=n*X,P+=n*Q,g+=(n=t[13])*B,_+=n*N,b+=n*z,w+=n*F,x+=n*j,k+=n*U,E+=n*V,S+=n*q,T+=n*G,A+=n*K,C+=n*H,I+=n*W,R+=n*Z,M+=n*Y,P+=n*X,O+=n*Q,_+=(n=t[14])*B,b+=n*N,w+=n*z,x+=n*F,k+=n*j,E+=n*U,S+=n*V,T+=n*q,A+=n*G,C+=n*K,I+=n*H,R+=n*W,M+=n*Z,P+=n*Y,O+=n*X,L+=n*Q,b+=(n=t[15])*B,o+=38*(x+=n*z),s+=38*(k+=n*F),u+=38*(E+=n*j),l+=38*(S+=n*U),c+=38*(T+=n*V),h+=38*(A+=n*q),f+=38*(C+=n*G),d+=38*(I+=n*K),p+=38*(R+=n*H),y+=38*(M+=n*W),v+=38*(P+=n*Z),m+=38*(O+=n*Y),g+=38*(L+=n*X),_+=38*(D+=n*Q),a=(n=(a+=38*(w+=n*N))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=(a+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=s+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),_=(n=_+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),a+=i-1+37*(i-1),e[0]=a,e[1]=o,e[2]=s,e[3]=u,e[4]=l,e[5]=c,e[6]=h,e[7]=f,e[8]=d,e[9]=p,e[10]=y,e[11]=v,e[12]=m,e[13]=g,e[14]=_,e[15]=b}function j(e,t){F(e,t,t)}function U(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)j(i,i),2!==n&&4!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function V(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)j(i,i),1!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function q(e,r,n){var i,a,o=new Uint8Array(32),s=new Float64Array(80),l=t(),c=t(),h=t(),f=t(),d=t(),p=t();for(a=0;a<31;a++)o[a]=r[a];for(o[31]=127&r[31]|64,o[0]&=248,B(s,n),a=0;a<16;a++)c[a]=s[a],f[a]=l[a]=h[a]=0;for(l[0]=f[0]=1,a=254;a>=0;--a)P(l,c,i=o[a>>>3]>>>(7&a)&1),P(h,f,i),N(d,l,h),z(l,l,h),N(h,c,f),z(c,c,f),j(f,d),j(p,l),F(l,h,l),F(h,c,d),N(d,l,h),z(l,l,h),j(c,l),z(h,f,p),F(l,h,u),N(l,l,f),F(h,h,l),F(l,f,p),F(f,c,s),j(c,d),P(l,c,i),P(h,f,i);for(a=0;a<16;a++)s[a+16]=l[a],s[a+32]=h[a],s[a+48]=c[a],s[a+64]=f[a];var y=s.subarray(32),v=s.subarray(16);return U(y,y),F(v,v,y),O(e,v),0}function G(e,t){return q(e,t,a)}function K(e,t){return n(t,32),G(e,t)}function H(e,t,r){var n=new Uint8Array(32);return q(n,r,t),_(e,i,n,b)}S.prototype.blocks=function(e,t,r){for(var n,i,a,o,s,u,l,c,h,f,d,p,y,v,m,g,_,b,w,x=this.fin?0:2048,k=this.h[0],E=this.h[1],S=this.h[2],T=this.h[3],A=this.h[4],C=this.h[5],I=this.h[6],R=this.h[7],M=this.h[8],P=this.h[9],O=this.r[0],L=this.r[1],D=this.r[2],B=this.r[3],N=this.r[4],z=this.r[5],F=this.r[6],j=this.r[7],U=this.r[8],V=this.r[9];r>=16;)f=h=0,f+=(k+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*O,f+=(E+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*V),f+=(S+=8191&(i>>>10|(a=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*U),f+=(T+=8191&(a>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*j),h=(f+=(A+=8191&(o>>>4|(s=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*F))>>>13,f&=8191,f+=(C+=s>>>1&8191)*(5*z),f+=(I+=8191&(s>>>14|(u=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*N),f+=(R+=8191&(u>>>11|(l=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*B),f+=(M+=8191&(l>>>8|(c=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*D),d=h+=(f+=(P+=c>>>5|x)*(5*L))>>>13,d+=k*L,d+=E*O,d+=S*(5*V),d+=T*(5*U),h=(d+=A*(5*j))>>>13,d&=8191,d+=C*(5*F),d+=I*(5*z),d+=R*(5*N),d+=M*(5*B),h+=(d+=P*(5*D))>>>13,d&=8191,p=h,p+=k*D,p+=E*L,p+=S*O,p+=T*(5*V),h=(p+=A*(5*U))>>>13,p&=8191,p+=C*(5*j),p+=I*(5*F),p+=R*(5*z),p+=M*(5*N),y=h+=(p+=P*(5*B))>>>13,y+=k*B,y+=E*D,y+=S*L,y+=T*O,h=(y+=A*(5*V))>>>13,y&=8191,y+=C*(5*U),y+=I*(5*j),y+=R*(5*F),y+=M*(5*z),v=h+=(y+=P*(5*N))>>>13,v+=k*N,v+=E*B,v+=S*D,v+=T*L,h=(v+=A*O)>>>13,v&=8191,v+=C*(5*V),v+=I*(5*U),v+=R*(5*j),v+=M*(5*F),m=h+=(v+=P*(5*z))>>>13,m+=k*z,m+=E*N,m+=S*B,m+=T*D,h=(m+=A*L)>>>13,m&=8191,m+=C*O,m+=I*(5*V),m+=R*(5*U),m+=M*(5*j),g=h+=(m+=P*(5*F))>>>13,g+=k*F,g+=E*z,g+=S*N,g+=T*B,h=(g+=A*D)>>>13,g&=8191,g+=C*L,g+=I*O,g+=R*(5*V),g+=M*(5*U),_=h+=(g+=P*(5*j))>>>13,_+=k*j,_+=E*F,_+=S*z,_+=T*N,h=(_+=A*B)>>>13,_&=8191,_+=C*D,_+=I*L,_+=R*O,_+=M*(5*V),b=h+=(_+=P*(5*U))>>>13,b+=k*U,b+=E*j,b+=S*F,b+=T*z,h=(b+=A*N)>>>13,b&=8191,b+=C*B,b+=I*D,b+=R*L,b+=M*O,w=h+=(b+=P*(5*V))>>>13,w+=k*V,w+=E*U,w+=S*j,w+=T*F,h=(w+=A*z)>>>13,w&=8191,w+=C*N,w+=I*B,w+=R*D,w+=M*L,k=f=8191&(h=(h=((h+=(w+=P*O)>>>13)<<2)+h|0)+(f&=8191)|0),E=d+=h>>>=13,S=p&=8191,T=y&=8191,A=v&=8191,C=m&=8191,I=g&=8191,R=_&=8191,M=b&=8191,P=w&=8191,t+=16,r-=16;this.h[0]=k,this.h[1]=E,this.h[2]=S,this.h[3]=T,this.h[4]=A,this.h[5]=C,this.h[6]=I,this.h[7]=R,this.h[8]=M,this.h[9]=P},S.prototype.finish=function(e,t){var r,n,i,a,o=new Uint16Array(10);if(this.leftover){for(a=this.leftover,this.buffer[a++]=1;a<16;a++)this.buffer[a]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,a=2;a<10;a++)this.h[a]+=r,r=this.h[a]>>>13,this.h[a]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,a=1;a<10;a++)o[a]=this.h[a]+r,r=o[a]>>>13,o[a]&=8191;for(o[9]-=8192,n=(1^r)-1,a=0;a<10;a++)o[a]&=n;for(n=~n,a=0;a<10;a++)this.h[a]=this.h[a]&n|o[a];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,a=1;a<8;a++)i=(this.h[a]+this.pad[a]|0)+(i>>>16)|0,this.h[a]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},S.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var W=C,Z=I;var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function X(e,t,r,n){for(var i,a,o,s,u,l,c,h,f,d,p,y,v,m,g,_,b,w,x,k,E,S,T,A,C,I,R=new Int32Array(16),M=new Int32Array(16),P=e[0],O=e[1],L=e[2],D=e[3],B=e[4],N=e[5],z=e[6],F=e[7],j=t[0],U=t[1],V=t[2],q=t[3],G=t[4],K=t[5],H=t[6],W=t[7],Z=0;n>=128;){for(x=0;x<16;x++)k=8*x+Z,R[x]=r[k+0]<<24|r[k+1]<<16|r[k+2]<<8|r[k+3],M[x]=r[k+4]<<24|r[k+5]<<16|r[k+6]<<8|r[k+7];for(x=0;x<80;x++)if(i=P,a=O,o=L,s=D,u=B,l=N,c=z,F,f=j,d=U,p=V,y=q,v=G,m=K,g=H,W,T=65535&(S=W),A=S>>>16,C=65535&(E=F),I=E>>>16,T+=65535&(S=(G>>>14|B<<18)^(G>>>18|B<<14)^(B>>>9|G<<23)),A+=S>>>16,C+=65535&(E=(B>>>14|G<<18)^(B>>>18|G<<14)^(G>>>9|B<<23)),I+=E>>>16,T+=65535&(S=G&K^~G&H),A+=S>>>16,C+=65535&(E=B&N^~B&z),I+=E>>>16,T+=65535&(S=Y[2*x+1]),A+=S>>>16,C+=65535&(E=Y[2*x]),I+=E>>>16,E=R[x%16],A+=(S=M[x%16])>>>16,C+=65535&E,I+=E>>>16,C+=(A+=(T+=65535&S)>>>16)>>>16,T=65535&(S=w=65535&T|A<<16),A=S>>>16,C=65535&(E=b=65535&C|(I+=C>>>16)<<16),I=E>>>16,T+=65535&(S=(j>>>28|P<<4)^(P>>>2|j<<30)^(P>>>7|j<<25)),A+=S>>>16,C+=65535&(E=(P>>>28|j<<4)^(j>>>2|P<<30)^(j>>>7|P<<25)),I+=E>>>16,A+=(S=j&U^j&V^U&V)>>>16,C+=65535&(E=P&O^P&L^O&L),I+=E>>>16,h=65535&(C+=(A+=(T+=65535&S)>>>16)>>>16)|(I+=C>>>16)<<16,_=65535&T|A<<16,T=65535&(S=y),A=S>>>16,C=65535&(E=s),I=E>>>16,A+=(S=w)>>>16,C+=65535&(E=b),I+=E>>>16,O=i,L=a,D=o,B=s=65535&(C+=(A+=(T+=65535&S)>>>16)>>>16)|(I+=C>>>16)<<16,N=u,z=l,F=c,P=h,U=f,V=d,q=p,G=y=65535&T|A<<16,K=v,H=m,W=g,j=_,x%16===15)for(k=0;k<16;k++)E=R[k],T=65535&(S=M[k]),A=S>>>16,C=65535&E,I=E>>>16,E=R[(k+9)%16],T+=65535&(S=M[(k+9)%16]),A+=S>>>16,C+=65535&E,I+=E>>>16,b=R[(k+1)%16],T+=65535&(S=((w=M[(k+1)%16])>>>1|b<<31)^(w>>>8|b<<24)^(w>>>7|b<<25)),A+=S>>>16,C+=65535&(E=(b>>>1|w<<31)^(b>>>8|w<<24)^b>>>7),I+=E>>>16,b=R[(k+14)%16],A+=(S=((w=M[(k+14)%16])>>>19|b<<13)^(b>>>29|w<<3)^(w>>>6|b<<26))>>>16,C+=65535&(E=(b>>>19|w<<13)^(w>>>29|b<<3)^b>>>6),I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,R[k]=65535&C|I<<16,M[k]=65535&T|A<<16;T=65535&(S=j),A=S>>>16,C=65535&(E=P),I=E>>>16,E=e[0],A+=(S=t[0])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[0]=P=65535&C|I<<16,t[0]=j=65535&T|A<<16,T=65535&(S=U),A=S>>>16,C=65535&(E=O),I=E>>>16,E=e[1],A+=(S=t[1])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[1]=O=65535&C|I<<16,t[1]=U=65535&T|A<<16,T=65535&(S=V),A=S>>>16,C=65535&(E=L),I=E>>>16,E=e[2],A+=(S=t[2])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[2]=L=65535&C|I<<16,t[2]=V=65535&T|A<<16,T=65535&(S=q),A=S>>>16,C=65535&(E=D),I=E>>>16,E=e[3],A+=(S=t[3])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[3]=D=65535&C|I<<16,t[3]=q=65535&T|A<<16,T=65535&(S=G),A=S>>>16,C=65535&(E=B),I=E>>>16,E=e[4],A+=(S=t[4])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[4]=B=65535&C|I<<16,t[4]=G=65535&T|A<<16,T=65535&(S=K),A=S>>>16,C=65535&(E=N),I=E>>>16,E=e[5],A+=(S=t[5])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[5]=N=65535&C|I<<16,t[5]=K=65535&T|A<<16,T=65535&(S=H),A=S>>>16,C=65535&(E=z),I=E>>>16,E=e[6],A+=(S=t[6])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[6]=z=65535&C|I<<16,t[6]=H=65535&T|A<<16,T=65535&(S=W),A=S>>>16,C=65535&(E=F),I=E>>>16,E=e[7],A+=(S=t[7])>>>16,C+=65535&E,I+=E>>>16,I+=(C+=(A+=(T+=65535&S)>>>16)>>>16)>>>16,e[7]=F=65535&C|I<<16,t[7]=W=65535&T|A<<16,Z+=128,n-=128}return n}function Q(e,t,r){var n,i=new Int32Array(8),a=new Int32Array(8),o=new Uint8Array(256),s=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,a[0]=4089235720,a[1]=2227873595,a[2]=4271175723,a[3]=1595750129,a[4]=2917565137,a[5]=725511199,a[6]=4215389547,a[7]=327033209,X(i,a,t,r),r%=128,n=0;n<r;n++)o[n]=t[s-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,s/536870912|0,s<<3),X(i,a,o,r),n=0;n<8;n++)p(e,8*n,i[n],a[n]);return 0}function J(e,r){var n=t(),i=t(),a=t(),o=t(),s=t(),u=t(),l=t(),h=t(),f=t();z(n,e[1],e[0]),z(f,r[1],r[0]),F(n,n,f),N(i,e[0],e[1]),N(f,r[0],r[1]),F(i,i,f),F(a,e[3],r[3]),F(a,a,c),F(o,e[2],r[2]),N(o,o,o),z(s,i,n),z(u,o,a),N(l,o,a),N(h,i,n),F(e[0],s,u),F(e[1],h,l),F(e[2],l,u),F(e[3],s,h)}function $(e,t,r){var n;for(n=0;n<4;n++)P(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),a=t();U(a,r[2]),F(n,r[0],a),F(i,r[1],a),O(e,i),e[31]^=D(n)<<7}function te(e,t,r){var n,i;for(R(e[0],o),R(e[1],s),R(e[2],s),R(e[3],o),i=255;i>=0;--i)$(e,t,n=r[i/8|0]>>(7&i)&1),J(t,e),J(e,e),$(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];R(n[0],h),R(n[1],f),R(n[2],s),F(n[3],h,f),te(e,n,r)}function ne(e,r,i){var a,o=new Uint8Array(64),s=[t(),t(),t(),t()];for(i||n(r,32),Q(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(s,o),ee(e,s),a=0;a<32;a++)r[a+32]=e[a];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ae(e,t){var r,n,i,a;for(n=63;n>=32;--n){for(r=0,i=n-32,a=n-12;i<a;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ae(e,r)}function se(e,r,n,i){var a,o,s=new Uint8Array(64),u=new Uint8Array(64),l=new Uint8Array(64),c=new Float64Array(64),h=[t(),t(),t(),t()];Q(s,i,32),s[0]&=248,s[31]&=127,s[31]|=64;var f=n+64;for(a=0;a<n;a++)e[64+a]=r[a];for(a=0;a<32;a++)e[32+a]=s[32+a];for(Q(l,e.subarray(32),n+32),oe(l),re(h,l),ee(e,h),a=32;a<64;a++)e[a]=i[a];for(Q(u,e,n+64),oe(u),a=0;a<64;a++)c[a]=0;for(a=0;a<32;a++)c[a]=l[a];for(a=0;a<32;a++)for(o=0;o<32;o++)c[a+o]+=u[a]*s[o];return ae(e.subarray(32),c),f}function ue(e,r,n,i){var a,u=new Uint8Array(32),c=new Uint8Array(64),h=[t(),t(),t(),t()],f=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),a=t(),u=t(),c=t(),h=t(),f=t();return R(e[2],s),B(e[1],r),j(a,e[1]),F(u,a,l),z(a,a,e[2]),N(u,e[2],u),j(c,u),j(h,c),F(f,h,c),F(n,f,a),F(n,n,u),V(n,n),F(n,n,a),F(n,n,u),F(n,n,u),F(e[0],n,u),j(i,e[0]),F(i,i,u),L(i,a)&&F(e[0],e[0],d),j(i,e[0]),F(i,i,u),L(i,a)?-1:(D(e[0])===r[31]>>7&&z(e[0],o,e[0]),F(e[3],e[0],e[1]),0)}(f,i))return-1;for(a=0;a<n;a++)e[a]=r[a];for(a=0;a<32;a++)e[a+32]=i[a];if(Q(c,e,n),oe(c),te(h,f,c),re(f,r.subarray(32)),J(h,f),ee(u,h),n-=64,m(r,0,u,0)){for(a=0;a<n;a++)e[a]=0;return-1}for(a=0;a<n;a++)e[a]=r[a+64];return n}var le=16,ce=64,he=32,fe=64;function de(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:_,crypto_stream_xor:E,crypto_stream:k,crypto_stream_salsa20_xor:w,crypto_stream_salsa20:x,crypto_onetimeauth:T,crypto_onetimeauth_verify:A,crypto_verify_16:v,crypto_verify_32:m,crypto_secretbox:C,crypto_secretbox_open:I,crypto_scalarmult:q,crypto_scalarmult_base:G,crypto_box_beforenm:H,crypto_box_afternm:W,crypto_box:function(e,t,r,n,i,a){var o=new Uint8Array(32);return H(o,i,a),W(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,a){var o=new Uint8Array(32);return H(o,i,a),Z(e,t,r,n,o)},crypto_box_keypair:K,crypto_hash:Q,crypto_sign:se,crypto_sign_keypair:ne,crypto_sign_open:ue,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:le,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:ce,crypto_sign_PUBLICKEYBYTES:he,crypto_sign_SECRETKEYBYTES:fe,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:l,L:ie,pack25519:O,unpack25519:B,M:F,A:N,S:j,Z:z,pow2523:V,add:J,set25519:R,modL:ae,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+32]=e[a];return C(i,n,n.length,t,r),i.subarray(le)},e.secretbox.open=function(e,t,r){pe(e,t,r),de(r,t);for(var n=new Uint8Array(le+e.length),i=new Uint8Array(n.length),a=0;a<e.length;a++)n[a+le]=e[a];return n.length<32||0!==I(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=le,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return q(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return G(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var a=e.box.before(n,i);return e.secretbox(t,r,a)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return H(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var a=e.box.before(n,i);return e.secretbox.open(t,r,a)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return K(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return G(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==fe)throw new Error("bad secret key size");var r=new Uint8Array(ce+e.length);return se(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==he)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ue(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),a=0;a<i.length;a++)i[a]=r[a];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(ce),a=0;a<i.length;a++)i[a]=n[a];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==ce)throw new Error("bad signature size");if(r.length!==he)throw new Error("bad public key size");var n,i=new Uint8Array(ce+e.length),a=new Uint8Array(ce+e.length);for(n=0;n<ce;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+ce]=e[n];return ue(a,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(he),t=new Uint8Array(fe);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==fe)throw new Error("bad secret key size");for(var t=new Uint8Array(he),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(he),r=new Uint8Array(fe),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=he,e.sign.secretKeyLength=fe,e.sign.seedLength=32,e.sign.signatureLength=ce,e.hash=function(e){pe(e);var t=new Uint8Array(64);return Q(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===y(e,0,t,0,e.length))},e.setPRNG=function(e){n=e},function(){var t="undefined"!==typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var n,i=new Uint8Array(r);for(n=0;n<r;n+=65536)t.getRandomValues(i.subarray(n,n+Math.min(r-n,65536)));for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}else(t=r(1178))&&t.randomBytes&&e.setPRNG((function(e,r){var n,i=t.randomBytes(r);for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}()}(e.exports?e.exports:self.nacl=self.nacl||{})},,function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(694),o=r(895);e.exports=function(e,t,s){s=s||r(1183)(t);var u=function(){function t(e){n(this,t),s.validatePublicKey(e),this._key=e}return i(t,[{key:"verify",value:function(e,t,r){c(r),s.hashAndVerify(this._key,t,e,r)}},{key:"marshal",value:function(){return s.compressPublicKey(this._key)}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){c(e),o(this.bytes,"sha2-256",e)}},{key:"bytes",get:function(){return e.PublicKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()})}}]),t}(),l=function(){function t(e,r){n(this,t),this._key=e,this._publicKey=r||s.computePublicKey(e),s.validatePrivateKey(this._key),s.validatePublicKey(this._publicKey)}return i(t,[{key:"sign",value:function(e,t){c(t),s.hashAndSign(this._key,e,t)}},{key:"marshal",value:function(){return this._key}},{key:"equals",value:function(e){return this.bytes.equals(e.bytes)}},{key:"hash",value:function(e){c(e),o(this.bytes,"sha2-256",e)}},{key:"id",value:function(e){this.public.hash((function(t,r){if(t)return e(t);e(null,a.encode(r))}))}},{key:"public",get:function(){return new u(this._publicKey)}},{key:"bytes",get:function(){return e.PrivateKey.encode({Type:e.KeyType.Secp256k1,Data:this.marshal()})}}]),t}();function c(e){if("function"!==typeof e)throw new Error("callback is required")}return{Secp256k1PublicKey:u,Secp256k1PrivateKey:l,unmarshalSecp256k1PrivateKey:function(e,t){t(null,new l(e))},unmarshalSecp256k1PublicKey:function(e){return new u(e)},generateKeyPair:function(e,t){void 0===t&&"function"===typeof e&&(t=e),c(t),s.generateKey((function(e,r){if(e)return t(e);var n;try{n=new l(r)}catch(e){return t(e)}t(null,n)}))}}}},function(e,t,r){"use strict";(function(t){var n=r(315),i=r(885),a=r(896),o=r(1181),s=a.toCallback,u=a.toBuf,l=a.fromString,c=a.fromNumberTo32BitBuf;e.exports={sha1:o.sha1,sha2256:o.sha2256,sha2512:o.sha2512,sha3512:s(u(n.sha3_512)),sha3384:s(u(n.sha3_384)),sha3256:s(u(n.sha3_256)),sha3224:s(u(n.sha3_224)),shake128:s(u(n.shake_128,128)),shake256:s(u(n.shake_256,256)),keccak224:s(u(n.keccak_224)),keccak256:s(u(n.keccak_256)),keccak384:s(u(n.keccak_384)),keccak512:s(u(n.keccak_512)),murmur3128:s(u(l(i.x64.hash128))),murmur332:s(c(l(i.x86.hash32))),addBlake:r(1182),dblSha2256:function(e,r){o.sha2256(e,(function(e,n){e&&r(e),o.sha2256(t.from(n),r)}))}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(887),i=function(){if(self.crypto)return self.crypto.subtle||self.crypto.webkitSubtle;if(self.msCrypto)return self.msCrypto.subtle}();function a(e){if(!i)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return function(r,a){var o=i.digest({name:e},r);if("function"!==typeof o.then)return o.onerror=function(){a(new Error("hashing data using ".concat(e)))},void(o.oncomplete=function(e){a(null,e.target.result)});n(o.then((function(e){return t.from(new Uint8Array(e))})),a)}}e.exports={sha1:function(e,t){a("SHA-1")(e,t)},sha2256:function(e,t){a("SHA-256")(e,t)},sha2512:function(e,t){a("SHA-512")(e,t)}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(763),i=r(896).toCallback,a={init:n.blake2bInit,update:n.blake2bUpdate,digest:n.blake2bFinal},o={init:n.blake2sInit,update:n.blake2sUpdate,digest:n.blake2sFinal},s=function(e,r){return i((function(n){var i=r.init(e,null);return r.update(i,n),t.from(r.digest(i))}))};e.exports=function(e){for(var t=0;t<64;t++)e[45569+t]=s(t+1,a);for(var r=0;r<32;r++)e[45633+r]=s(r+1,o)}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(1184),i=r(895),a=r(900),o="sha2-256";e.exports=function(e){function t(e){if(!n.privateKeyVerify(e))throw new Error("Invalid private key")}return{generateKey:function(t){var r,i,o;do{r=e(32)}while(!n.privateKeyVerify(r));i=null,o=r,a((function(){return t(i,o)}))},privateKeyLength:32,hashAndSign:function(e,t,r){var s=function(e,t){return a((function(){return r(e,t)}))};i.digest(t,o,(function(t,r){if(t)return s(t);try{var i=n.sign(r,e),a=n.signatureExport(i.signature);return s(null,a)}catch(t){s(t)}}))},hashAndVerify:function(e,t,r,s){var u=function(e,t){return a((function(){return s(e,t)}))};i.digest(r,o,(function(r,i){if(r)return u(r);try{t=n.signatureImport(t);var a=n.verify(i,t,e);return u(null,a)}catch(r){u(r)}}))},compressPublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error("Invalid public key");return n.publicKeyConvert(e,!0)},decompressPublicKey:function(e){return n.publicKeyConvert(e,!1)},validatePrivateKey:t,validatePublicKey:function(e){if(!n.publicKeyVerify(e))throw new Error("Invalid public key")},computePublicKey:function(e){return t(e),n.publicKeyCreate(e)}}}},function(e,t,r){"use strict";e.exports=r(1185)(r(1189))},function(e,t,r){"use strict";var n=r(1186),i=r(1187),a=r(897);function o(e,t){return void 0===e?t:(n.isBoolean(e,a.COMPRESSED_TYPE_INVALID),e)}e.exports=function(e){return{privateKeyVerify:function(t){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),32===t.length&&e.privateKeyVerify(t)},privateKeyExport:function(t,r){n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0);var s=e.privateKeyExport(t,r);return i.privateKeyExport(t,s,r)},privateKeyImport:function(t){if(n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),(t=i.privateKeyImport(t))&&32===t.length&&e.privateKeyVerify(t))return t;throw new Error(a.EC_PRIVATE_KEY_IMPORT_DER_FAIL)},privateKeyNegate:function(t){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyNegate(t)},privateKeyModInverse:function(t){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),e.privateKeyModInverse(t)},privateKeyTweakAdd:function(t,r){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,a.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,a.TWEAK_LENGTH_INVALID),e.privateKeyTweakAdd(t,r)},privateKeyTweakMul:function(t,r){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),n.isBuffer(r,a.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,a.TWEAK_LENGTH_INVALID),e.privateKeyTweakMul(t,r)},publicKeyCreate:function(t,r){return n.isBuffer(t,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(t,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyCreate(t,r)},publicKeyConvert:function(t,r){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),r=o(r,!0),e.publicKeyConvert(t,r)},publicKeyVerify:function(t){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),e.publicKeyVerify(t)},publicKeyTweakAdd:function(t,r,i){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,a.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,a.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakAdd(t,r,i)},publicKeyTweakMul:function(t,r,i){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,a.TWEAK_TYPE_INVALID),n.isBufferLength(r,32,a.TWEAK_LENGTH_INVALID),i=o(i,!0),e.publicKeyTweakMul(t,r,i)},publicKeyCombine:function(t,r){n.isArray(t,a.EC_PUBLIC_KEYS_TYPE_INVALID),n.isLengthGTZero(t,a.EC_PUBLIC_KEYS_LENGTH_INVALID);for(var i=0;i<t.length;++i)n.isBuffer(t[i],a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t[i],33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID);return r=o(r,!0),e.publicKeyCombine(t,r)},signatureNormalize:function(t){return n.isBuffer(t,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,a.ECDSA_SIGNATURE_LENGTH_INVALID),e.signatureNormalize(t)},signatureExport:function(t){n.isBuffer(t,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(t,64,a.ECDSA_SIGNATURE_LENGTH_INVALID);var r=e.signatureExport(t);return i.signatureExport(r)},signatureImport:function(t){n.isBuffer(t,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,a.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImport(t);if(r)return e.signatureImport(r);throw new Error(a.ECDSA_SIGNATURE_PARSE_DER_FAIL)},signatureImportLax:function(t){n.isBuffer(t,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isLengthGTZero(t,a.ECDSA_SIGNATURE_LENGTH_INVALID);var r=i.signatureImportLax(t);if(r)return e.signatureImport(r);throw new Error(a.ECDSA_SIGNATURE_PARSE_DER_FAIL)},sign:function(t,r,i){n.isBuffer(t,a.MSG32_TYPE_INVALID),n.isBufferLength(t,32,a.MSG32_LENGTH_INVALID),n.isBuffer(r,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,a.EC_PRIVATE_KEY_LENGTH_INVALID);var o=null,s=null;return void 0!==i&&(n.isObject(i,a.OPTIONS_TYPE_INVALID),void 0!==i.data&&(n.isBuffer(i.data,a.OPTIONS_DATA_TYPE_INVALID),n.isBufferLength(i.data,32,a.OPTIONS_DATA_LENGTH_INVALID),o=i.data),void 0!==i.noncefn&&(n.isFunction(i.noncefn,a.OPTIONS_NONCEFN_TYPE_INVALID),s=i.noncefn)),e.sign(t,r,s,o)},verify:function(t,r,i){return n.isBuffer(t,a.MSG32_TYPE_INVALID),n.isBufferLength(t,32,a.MSG32_LENGTH_INVALID),n.isBuffer(r,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,a.ECDSA_SIGNATURE_LENGTH_INVALID),n.isBuffer(i,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(i,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),e.verify(t,r,i)},recover:function(t,r,i,s){return n.isBuffer(t,a.MSG32_TYPE_INVALID),n.isBufferLength(t,32,a.MSG32_LENGTH_INVALID),n.isBuffer(r,a.ECDSA_SIGNATURE_TYPE_INVALID),n.isBufferLength(r,64,a.ECDSA_SIGNATURE_LENGTH_INVALID),n.isNumber(i,a.RECOVERY_ID_TYPE_INVALID),n.isNumberInInterval(i,-1,4,a.RECOVERY_ID_VALUE_INVALID),s=o(s,!0),e.recover(t,r,i,s)},ecdh:function(t,r){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),e.ecdh(t,r)},ecdhUnsafe:function(t,r,i){return n.isBuffer(t,a.EC_PUBLIC_KEY_TYPE_INVALID),n.isBufferLength2(t,33,65,a.EC_PUBLIC_KEY_LENGTH_INVALID),n.isBuffer(r,a.EC_PRIVATE_KEY_TYPE_INVALID),n.isBufferLength(r,32,a.EC_PRIVATE_KEY_LENGTH_INVALID),i=o(i,!0),e.ecdhUnsafe(t,r,i)}}}},function(e,t,r){"use strict";(function(e){var r=Object.prototype.toString;t.isArray=function(e,t){if(!Array.isArray(e))throw TypeError(t)},t.isBoolean=function(e,t){if("[object Boolean]"!==r.call(e))throw TypeError(t)},t.isBuffer=function(t,r){if(!e.isBuffer(t))throw TypeError(r)},t.isFunction=function(e,t){if("[object Function]"!==r.call(e))throw TypeError(t)},t.isNumber=function(e,t){if("[object Number]"!==r.call(e))throw TypeError(t)},t.isObject=function(e,t){if("[object Object]"!==r.call(e))throw TypeError(t)},t.isBufferLength=function(e,t,r){if(e.length!==t)throw RangeError(r)},t.isBufferLength2=function(e,t,r,n){if(e.length!==t&&e.length!==r)throw RangeError(n)},t.isLengthGTZero=function(e,t){if(0===e.length)throw RangeError(t)},t.isNumberInInterval=function(e,t,r,n){if(e<=t||e>=r)throw RangeError(n)}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(17).Buffer,i=r(1188),a=n.from([48,129,211,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,133,48,129,130,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,33,2,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,36,3,34,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),o=n.from([48,130,1,19,2,1,1,4,32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,129,165,48,129,162,2,1,1,48,44,6,7,42,134,72,206,61,1,1,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,255,255,252,47,48,6,4,1,0,4,1,7,4,65,4,121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184,2,33,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,254,186,174,220,230,175,72,160,59,191,210,94,140,208,54,65,65,2,1,1,161,68,3,66,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);t.privateKeyExport=function(e,t,r){var i=n.from(r?a:o);return e.copy(i,r?8:9),t.copy(i,r?181:214),i},t.privateKeyImport=function(e){var t=e.length,r=0;if(!(t<r+1||48!==e[r])&&!(t<(r+=1)+1)&&128&e[r]){var n=127&e[r];if(r+=1,!(n<1||n>2)&&!(t<r+n)){var i=e[r+n-1]|(n>1?e[r+n-2]<<8:0);if(!(t<(r+=n)+i)&&!(t<r+3||2!==e[r]||1!==e[r+1]||1!==e[r+2])&&!(t<(r+=3)+2||4!==e[r]||e[r+1]>32||t<r+2+e[r+1]))return e.slice(r+2,r+2+e[r+1])}}},t.signatureExport=function(e){for(var t=n.concat([n.from([0]),e.r]),r=33,a=0;r>1&&0===t[a]&&!(128&t[a+1]);--r,++a);for(var o=n.concat([n.from([0]),e.s]),s=33,u=0;s>1&&0===o[u]&&!(128&o[u+1]);--s,++u);return i.encode(t.slice(a),o.slice(u))},t.signatureImport=function(e){var t=n.alloc(32,0),r=n.alloc(32,0);try{var a=i.decode(e);if(33===a.r.length&&0===a.r[0]&&(a.r=a.r.slice(1)),a.r.length>32)throw new Error("R length is too long");if(33===a.s.length&&0===a.s[0]&&(a.s=a.s.slice(1)),a.s.length>32)throw new Error("S length is too long")}catch(o){return}return a.r.copy(t,32-a.r.length),a.s.copy(r,32-a.s.length),{r:t,s:r}},t.signatureImportLax=function(e){var t=n.alloc(32,0),r=n.alloc(32,0),i=e.length,a=0;if(48===e[a++]){var o=e[a++];if(!(128&o&&(a+=o-128)>i)&&2===e[a++]){var s=e[a++];if(128&s){if(a+(o=s-128)>i)return;for(;o>0&&0===e[a];a+=1,o-=1);for(s=0;o>0;a+=1,o-=1)s=(s<<8)+e[a]}if(!(s>i-a)){var u=a;if(a+=s,2===e[a++]){var l=e[a++];if(128&l){if(a+(o=l-128)>i)return;for(;o>0&&0===e[a];a+=1,o-=1);for(l=0;o>0;a+=1,o-=1)l=(l<<8)+e[a]}if(!(l>i-a)){var c=a;for(a+=l;s>0&&0===e[u];s-=1,u+=1);if(!(s>32)){var h=e.slice(u,u+s);for(h.copy(t,32-h.length);l>0&&0===e[c];l-=1,c+=1);if(!(l>32)){var f=e.slice(c,c+l);return f.copy(r,32-f.length),{r:t,s:r}}}}}}}}}},function(e,t,r){var n=r(17).Buffer;e.exports={check:function(e){if(e.length<8)return!1;if(e.length>72)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-2)return!1;if(2!==e[2])return!1;var t=e[3];if(0===t)return!1;if(5+t>=e.length)return!1;if(2!==e[4+t])return!1;var r=e[5+t];return 0!==r&&(6+t+r===e.length&&(!(128&e[4])&&(!(t>1&&0===e[4]&&!(128&e[5]))&&(!(128&e[t+6])&&!(r>1&&0===e[t+6]&&!(128&e[t+7]))))))},decode:function(e){if(e.length<8)throw new Error("DER sequence length is too short");if(e.length>72)throw new Error("DER sequence length is too long");if(48!==e[0])throw new Error("Expected DER sequence");if(e[1]!==e.length-2)throw new Error("DER sequence length is invalid");if(2!==e[2])throw new Error("Expected DER integer");var t=e[3];if(0===t)throw new Error("R length is zero");if(5+t>=e.length)throw new Error("R length is too long");if(2!==e[4+t])throw new Error("Expected DER integer (2)");var r=e[5+t];if(0===r)throw new Error("S length is zero");if(6+t+r!==e.length)throw new Error("S length is invalid");if(128&e[4])throw new Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw new Error("R value excessively padded");if(128&e[t+6])throw new Error("S value is negative");if(r>1&&0===e[t+6]&&!(128&e[t+7]))throw new Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}},encode:function(e,t){var r=e.length,i=t.length;if(0===r)throw new Error("R length is zero");if(0===i)throw new Error("S length is zero");if(r>33)throw new Error("R length is too long");if(i>33)throw new Error("S length is too long");if(128&e[0])throw new Error("R value is negative");if(128&t[0])throw new Error("S value is negative");if(r>1&&0===e[0]&&!(128&e[1]))throw new Error("R value excessively padded");if(i>1&&0===t[0]&&!(128&t[1]))throw new Error("S value excessively padded");var a=n.allocUnsafe(6+r+i);return a[0]=48,a[1]=a.length-2,a[2]=2,a[3]=e.length,e.copy(a,4),a[4+r]=2,a[5+r]=t.length,t.copy(a,6+r),a}}},function(e,t,r){"use strict";var n=r(17).Buffer,i=r(76),a=r(1190),o=r(897),s=r(765),u=r(898),l=r(1193);t.privateKeyVerify=function(e){var t=s.fromBuffer(e);return!(t.isOverflow()||t.isZero())},t.privateKeyExport=function(e,t){var r=s.fromBuffer(e);if(r.isOverflow()||r.isZero())throw new Error(o.EC_PRIVATE_KEY_EXPORT_DER_FAIL);return l.mul(r).toPublicKey(t)},t.privateKeyNegate=function(e){var t=s.fromBuffer(e);return t.isZero()?n.alloc(32):(t.ucmp(s.n)>0&&t.isub(s.n),s.n.sub(t).toBuffer())},t.privateKeyModInverse=function(e){var t=s.fromBuffer(e);if(t.isOverflow()||t.isZero())throw new Error(o.EC_PRIVATE_KEY_RANGE_INVALID);return t.uinvm().toBuffer()},t.privateKeyTweakAdd=function(e,t){var r=s.fromBuffer(t);if(r.isOverflow())throw new Error(o.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);if(r.iadd(s.fromBuffer(e)),r.isOverflow()&&r.isub(s.n),r.isZero())throw new Error(o.EC_PRIVATE_KEY_TWEAK_ADD_FAIL);return r.toBuffer()},t.privateKeyTweakMul=function(e,t){var r=s.fromBuffer(t);if(r.isOverflow()||r.isZero())throw new Error(o.EC_PRIVATE_KEY_TWEAK_MUL_FAIL);var n=s.fromBuffer(e);return r.umul(n).ureduce().toBuffer()},t.publicKeyCreate=function(e,t){var r=s.fromBuffer(e);if(r.isOverflow()||r.isZero())throw new Error(o.EC_PUBLIC_KEY_CREATE_FAIL);return l.mul(r).toPublicKey(t)},t.publicKeyConvert=function(e,t){var r=u.fromPublicKey(e);if(null===r)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);return r.toPublicKey(t)},t.publicKeyVerify=function(e){return null!==u.fromPublicKey(e)},t.publicKeyTweakAdd=function(e,t,r){var n=u.fromPublicKey(e);if(null===n)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);if((t=s.fromBuffer(t)).isOverflow())throw new Error(o.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);var i=l.mul(t).add(n);if(i.inf)throw new Error(o.EC_PUBLIC_KEY_TWEAK_ADD_FAIL);return i.toPublicKey(r)},t.publicKeyTweakMul=function(e,t,r){var n=u.fromPublicKey(e);if(null===n)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);if((t=s.fromBuffer(t)).isOverflow()||t.isZero())throw new Error(o.EC_PUBLIC_KEY_TWEAK_MUL_FAIL);return n.mul(t).toPublicKey(r)},t.publicKeyCombine=function(e,t){for(var r=new Array(e.length),n=0;n<e.length;++n)if(r[n]=u.fromPublicKey(e[n]),null===r[n])throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);for(var i=r[0],a=1;a<r.length;++a)i=i.add(r[a]);if(i.inf)throw new Error(o.EC_PUBLIC_KEY_COMBINE_FAIL);return i.toPublicKey(t)},t.signatureNormalize=function(e){var t=s.fromBuffer(e.slice(0,32)),r=s.fromBuffer(e.slice(32,64));if(t.isOverflow()||r.isOverflow())throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);var i=n.from(e);return r.isHigh()&&s.n.sub(r).toBuffer().copy(i,32),i},t.signatureExport=function(e){var t=e.slice(0,32),r=e.slice(32,64);if(s.fromBuffer(t).isOverflow()||s.fromBuffer(r).isOverflow())throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);return{r:t,s:r}},t.signatureImport=function(e){var t=s.fromBuffer(e.r);t.isOverflow()&&(t=s.fromNumber(0));var r=s.fromBuffer(e.s);return r.isOverflow()&&(r=s.fromNumber(0)),n.concat([t.toBuffer(),r.toBuffer()])},t.sign=function(e,t,r,i){var u=s.fromBuffer(t);if(u.isOverflow()||u.isZero())throw new Error(o.ECDSA_SIGN_FAIL);if(null===r){var c=new a("sha256",t,e,i);r=function(){return c.generate(32)}}for(var h=s.fromBuffer(e),f=0;;++f){var d=r(e,t,null,i,f);if(!n.isBuffer(d)||32!==d.length)throw new Error(o.ECDSA_SIGN_FAIL);var p=s.fromBuffer(d);if(!p.isOverflow()&&!p.isZero()){var y=l.mul(p),v=y.x.fireduce();if(!v.isZero()){var m=p.uinvm().umul(v.umul(u).ureduce().iadd(h).fireduce()).ureduce();if(!m.isZero()){var g=(0!==y.x.ucmp(v)?2:0)|(y.y.isOdd()?1:0);return m.isHigh()&&(m=s.n.sub(m),g^=1),{signature:n.concat([v.toBuffer(),m.toBuffer()]),recovery:g}}}}}},t.verify=function(e,t,r){var n=s.fromBuffer(t.slice(0,32)),i=s.fromBuffer(t.slice(32,64));if(n.isOverflow()||i.isOverflow())throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);if(i.isHigh()||n.isZero()||i.isZero())return!1;var a=u.fromPublicKey(r);if(null===a)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);var c=i.uinvm(),h=c.umul(s.fromBuffer(e)).ureduce(),f=c.umul(n).ureduce(),d=l.mulAdd(h,a,f);if(d.inf)return!1;var p=d.z.redSqr();return 0===n.redMul(p).ucmp(d.x)||!(n.ucmp(s.psn)>=0)&&0===n.iadd(s.psn).redMul(p).ucmp(d.x)},t.recover=function(e,t,r,i){var a=s.fromBuffer(t.slice(0,32)),c=s.fromBuffer(t.slice(32,64));if(a.isOverflow()||c.isOverflow())throw new Error(o.ECDSA_SIGNATURE_PARSE_FAIL);do{if(a.isZero()||c.isZero())break;var h=a;if(r>>1){if(h.ucmp(s.psn)>=0)break;h=a.add(s.n)}var f=n.concat([n.from([2+(1&r)]),h.toBuffer()]),d=u.fromPublicKey(f);if(null===d)break;var p=a.uinvm(),y=s.n.sub(s.fromBuffer(e)).umul(p).ureduce(),v=c.umul(p).ureduce();return u.fromECJPoint(l.mulAdd(y,d,v)).toPublicKey(i)}while(0);throw new Error(o.ECDSA_RECOVER_FAIL)},t.ecdh=function(e,r){var n=t.ecdhUnsafe(e,r,!0);return i("sha256").update(n).digest()},t.ecdhUnsafe=function(e,t,r){var n=u.fromPublicKey(e);if(null===n)throw new Error(o.EC_PUBLIC_KEY_PARSE_FAIL);var i=s.fromBuffer(t);if(i.isOverflow()||i.isZero())throw new Error(o.ECDH_FAIL);return n.mul(i).toPublicKey(r)}},function(e,t,r){"use strict";(function(t){var n=r(183),i=r(1191),a=new t(0),o=new t([0]),s=new t([1]);function u(e,t,r,n){var a=i[e];if(void 0===a)throw new Error("hash "+e+" is not supported");this._algo=e,this._securityStrength=a.securityStrength/8,this._outlen=a.outlen/8,this._reseedInterval=281474976710656,this._init(t,r,n)}u.prototype._update=function(e){var t=n(this._algo,this._K).update(this._V).update(o);e&&t.update(e),this._K=t.digest(),this._V=n(this._algo,this._K).update(this._V).digest(),e&&(this._K=n(this._algo,this._K).update(this._V).update(s).update(e).digest(),this._V=n(this._algo,this._K).update(this._V).digest())},u.prototype._init=function(e,r,n){if(e.length<this._securityStrength)throw new Error("Not enough entropy");this._K=new t(this._outlen),this._V=new t(this._outlen);for(var i=0;i<this._K.length;++i)this._K[i]=0,this._V[i]=1;this._update(t.concat([e,r,n||a])),this._reseed=1},u.prototype.reseed=function(e,r){if(e.length<this._securityStrength)throw new Error("Not enough entropy");this._update(t.concat([e,r||a])),this._reseed=1},u.prototype.generate=function(e,r){if(this._reseed>this._reseedInterval)throw new Error("Reseed is required");r&&0===r.length&&(r=void 0),r&&this._update(r);for(var i=new t(0);i.length<e;)this._V=n(this._algo,this._K).update(this._V).digest(),i=t.concat([i,this._V]);return this._update(r),this._reseed+=1,i.slice(0,e)},e.exports=u}).call(this,r(10).Buffer)},function(e){e.exports=JSON.parse('{"sha1":{"securityStrength":128,"outlen":160,"seedlen":440},"sha224":{"securityStrength":192,"outlen":224,"seedlen":440},"sha256":{"securityStrength":256,"outlen":256,"seedlen":440},"sha384":{"securityStrength":256,"outlen":384,"seedlen":888},"sha512":{"securityStrength":256,"outlen":512,"seedlen":888}}')},function(e,t,r){"use strict";t.umulTo10x10=function(e,t,r){var n,i,a,o=e.words,s=t.words,u=r.words,l=0,c=0|o[0],h=8191&c,f=c>>>13,d=0|o[1],p=8191&d,y=d>>>13,v=0|o[2],m=8191&v,g=v>>>13,_=0|o[3],b=8191&_,w=_>>>13,x=0|o[4],k=8191&x,E=x>>>13,S=0|o[5],T=8191&S,A=S>>>13,C=0|o[6],I=8191&C,R=C>>>13,M=0|o[7],P=8191&M,O=M>>>13,L=0|o[8],D=8191&L,B=L>>>13,N=0|o[9],z=8191&N,F=N>>>13,j=0|s[0],U=8191&j,V=j>>>13,q=0|s[1],G=8191&q,K=q>>>13,H=0|s[2],W=8191&H,Z=H>>>13,Y=0|s[3],X=8191&Y,Q=Y>>>13,J=0|s[4],$=8191&J,ee=J>>>13,te=0|s[5],re=8191&te,ne=te>>>13,ie=0|s[6],ae=8191&ie,oe=ie>>>13,se=0|s[7],ue=8191&se,le=se>>>13,ce=0|s[8],he=8191&ce,fe=ce>>>13,de=0|s[9],pe=8191&de,ye=de>>>13;r.length=19,n=Math.imul(h,U),i=Math.imul(h,V);var ve=l+n+((8191&(i+=Math.imul(f,U)))<<13);l=(a=Math.imul(f,V))+(i>>>13)+(ve>>>26),ve&=67108863,n=Math.imul(p,U),i=Math.imul(p,V),i+=Math.imul(y,U),a=Math.imul(y,V),n+=Math.imul(h,G),i+=Math.imul(h,K);var me=l+n+((8191&(i+=Math.imul(f,G)))<<13);l=(a+=Math.imul(f,K))+(i>>>13)+(me>>>26),me&=67108863,n=Math.imul(m,U),i=Math.imul(m,V),i+=Math.imul(g,U),a=Math.imul(g,V),n+=Math.imul(p,G),i+=Math.imul(p,K),i+=Math.imul(y,G),a+=Math.imul(y,K),n+=Math.imul(h,W),i+=Math.imul(h,Z);var ge=l+n+((8191&(i+=Math.imul(f,W)))<<13);l=(a+=Math.imul(f,Z))+(i>>>13)+(ge>>>26),ge&=67108863,n=Math.imul(b,U),i=Math.imul(b,V),i+=Math.imul(w,U),a=Math.imul(w,V),n+=Math.imul(m,G),i+=Math.imul(m,K),i+=Math.imul(g,G),a+=Math.imul(g,K),n+=Math.imul(p,W),i+=Math.imul(p,Z),i+=Math.imul(y,W),a+=Math.imul(y,Z),n+=Math.imul(h,X),i+=Math.imul(h,Q);var _e=l+n+((8191&(i+=Math.imul(f,X)))<<13);l=(a+=Math.imul(f,Q))+(i>>>13)+(_e>>>26),_e&=67108863,n=Math.imul(k,U),i=Math.imul(k,V),i+=Math.imul(E,U),a=Math.imul(E,V),n+=Math.imul(b,G),i+=Math.imul(b,K),i+=Math.imul(w,G),a+=Math.imul(w,K),n+=Math.imul(m,W),i+=Math.imul(m,Z),i+=Math.imul(g,W),a+=Math.imul(g,Z),n+=Math.imul(p,X),i+=Math.imul(p,Q),i+=Math.imul(y,X),a+=Math.imul(y,Q),n+=Math.imul(h,$),i+=Math.imul(h,ee);var be=l+n+((8191&(i+=Math.imul(f,$)))<<13);l=(a+=Math.imul(f,ee))+(i>>>13)+(be>>>26),be&=67108863,n=Math.imul(T,U),i=Math.imul(T,V),i+=Math.imul(A,U),a=Math.imul(A,V),n+=Math.imul(k,G),i+=Math.imul(k,K),i+=Math.imul(E,G),a+=Math.imul(E,K),n+=Math.imul(b,W),i+=Math.imul(b,Z),i+=Math.imul(w,W),a+=Math.imul(w,Z),n+=Math.imul(m,X),i+=Math.imul(m,Q),i+=Math.imul(g,X),a+=Math.imul(g,Q),n+=Math.imul(p,$),i+=Math.imul(p,ee),i+=Math.imul(y,$),a+=Math.imul(y,ee),n+=Math.imul(h,re),i+=Math.imul(h,ne);var we=l+n+((8191&(i+=Math.imul(f,re)))<<13);l=(a+=Math.imul(f,ne))+(i>>>13)+(we>>>26),we&=67108863,n=Math.imul(I,U),i=Math.imul(I,V),i+=Math.imul(R,U),a=Math.imul(R,V),n+=Math.imul(T,G),i+=Math.imul(T,K),i+=Math.imul(A,G),a+=Math.imul(A,K),n+=Math.imul(k,W),i+=Math.imul(k,Z),i+=Math.imul(E,W),a+=Math.imul(E,Z),n+=Math.imul(b,X),i+=Math.imul(b,Q),i+=Math.imul(w,X),a+=Math.imul(w,Q),n+=Math.imul(m,$),i+=Math.imul(m,ee),i+=Math.imul(g,$),a+=Math.imul(g,ee),n+=Math.imul(p,re),i+=Math.imul(p,ne),i+=Math.imul(y,re),a+=Math.imul(y,ne),n+=Math.imul(h,ae),i+=Math.imul(h,oe);var xe=l+n+((8191&(i+=Math.imul(f,ae)))<<13);l=(a+=Math.imul(f,oe))+(i>>>13)+(xe>>>26),xe&=67108863,n=Math.imul(P,U),i=Math.imul(P,V),i+=Math.imul(O,U),a=Math.imul(O,V),n+=Math.imul(I,G),i+=Math.imul(I,K),i+=Math.imul(R,G),a+=Math.imul(R,K),n+=Math.imul(T,W),i+=Math.imul(T,Z),i+=Math.imul(A,W),a+=Math.imul(A,Z),n+=Math.imul(k,X),i+=Math.imul(k,Q),i+=Math.imul(E,X),a+=Math.imul(E,Q),n+=Math.imul(b,$),i+=Math.imul(b,ee),i+=Math.imul(w,$),a+=Math.imul(w,ee),n+=Math.imul(m,re),i+=Math.imul(m,ne),i+=Math.imul(g,re),a+=Math.imul(g,ne),n+=Math.imul(p,ae),i+=Math.imul(p,oe),i+=Math.imul(y,ae),a+=Math.imul(y,oe),n+=Math.imul(h,ue),i+=Math.imul(h,le);var ke=l+n+((8191&(i+=Math.imul(f,ue)))<<13);l=(a+=Math.imul(f,le))+(i>>>13)+(ke>>>26),ke&=67108863,n=Math.imul(D,U),i=Math.imul(D,V),i+=Math.imul(B,U),a=Math.imul(B,V),n+=Math.imul(P,G),i+=Math.imul(P,K),i+=Math.imul(O,G),a+=Math.imul(O,K),n+=Math.imul(I,W),i+=Math.imul(I,Z),i+=Math.imul(R,W),a+=Math.imul(R,Z),n+=Math.imul(T,X),i+=Math.imul(T,Q),i+=Math.imul(A,X),a+=Math.imul(A,Q),n+=Math.imul(k,$),i+=Math.imul(k,ee),i+=Math.imul(E,$),a+=Math.imul(E,ee),n+=Math.imul(b,re),i+=Math.imul(b,ne),i+=Math.imul(w,re),a+=Math.imul(w,ne),n+=Math.imul(m,ae),i+=Math.imul(m,oe),i+=Math.imul(g,ae),a+=Math.imul(g,oe),n+=Math.imul(p,ue),i+=Math.imul(p,le),i+=Math.imul(y,ue),a+=Math.imul(y,le),n+=Math.imul(h,he),i+=Math.imul(h,fe);var Ee=l+n+((8191&(i+=Math.imul(f,he)))<<13);l=(a+=Math.imul(f,fe))+(i>>>13)+(Ee>>>26),Ee&=67108863,n=Math.imul(z,U),i=Math.imul(z,V),i+=Math.imul(F,U),a=Math.imul(F,V),n+=Math.imul(D,G),i+=Math.imul(D,K),i+=Math.imul(B,G),a+=Math.imul(B,K),n+=Math.imul(P,W),i+=Math.imul(P,Z),i+=Math.imul(O,W),a+=Math.imul(O,Z),n+=Math.imul(I,X),i+=Math.imul(I,Q),i+=Math.imul(R,X),a+=Math.imul(R,Q),n+=Math.imul(T,$),i+=Math.imul(T,ee),i+=Math.imul(A,$),a+=Math.imul(A,ee),n+=Math.imul(k,re),i+=Math.imul(k,ne),i+=Math.imul(E,re),a+=Math.imul(E,ne),n+=Math.imul(b,ae),i+=Math.imul(b,oe),i+=Math.imul(w,ae),a+=Math.imul(w,oe),n+=Math.imul(m,ue),i+=Math.imul(m,le),i+=Math.imul(g,ue),a+=Math.imul(g,le),n+=Math.imul(p,he),i+=Math.imul(p,fe),i+=Math.imul(y,he),a+=Math.imul(y,fe),n+=Math.imul(h,pe),i+=Math.imul(h,ye);var Se=l+n+((8191&(i+=Math.imul(f,pe)))<<13);l=(a+=Math.imul(f,ye))+(i>>>13)+(Se>>>26),Se&=67108863,n=Math.imul(z,G),i=Math.imul(z,K),i+=Math.imul(F,G),a=Math.imul(F,K),n+=Math.imul(D,W),i+=Math.imul(D,Z),i+=Math.imul(B,W),a+=Math.imul(B,Z),n+=Math.imul(P,X),i+=Math.imul(P,Q),i+=Math.imul(O,X),a+=Math.imul(O,Q),n+=Math.imul(I,$),i+=Math.imul(I,ee),i+=Math.imul(R,$),a+=Math.imul(R,ee),n+=Math.imul(T,re),i+=Math.imul(T,ne),i+=Math.imul(A,re),a+=Math.imul(A,ne),n+=Math.imul(k,ae),i+=Math.imul(k,oe),i+=Math.imul(E,ae),a+=Math.imul(E,oe),n+=Math.imul(b,ue),i+=Math.imul(b,le),i+=Math.imul(w,ue),a+=Math.imul(w,le),n+=Math.imul(m,he),i+=Math.imul(m,fe),i+=Math.imul(g,he),a+=Math.imul(g,fe),n+=Math.imul(p,pe),i+=Math.imul(p,ye);var Te=l+n+((8191&(i+=Math.imul(y,pe)))<<13);l=(a+=Math.imul(y,ye))+(i>>>13)+(Te>>>26),Te&=67108863,n=Math.imul(z,W),i=Math.imul(z,Z),i+=Math.imul(F,W),a=Math.imul(F,Z),n+=Math.imul(D,X),i+=Math.imul(D,Q),i+=Math.imul(B,X),a+=Math.imul(B,Q),n+=Math.imul(P,$),i+=Math.imul(P,ee),i+=Math.imul(O,$),a+=Math.imul(O,ee),n+=Math.imul(I,re),i+=Math.imul(I,ne),i+=Math.imul(R,re),a+=Math.imul(R,ne),n+=Math.imul(T,ae),i+=Math.imul(T,oe),i+=Math.imul(A,ae),a+=Math.imul(A,oe),n+=Math.imul(k,ue),i+=Math.imul(k,le),i+=Math.imul(E,ue),a+=Math.imul(E,le),n+=Math.imul(b,he),i+=Math.imul(b,fe),i+=Math.imul(w,he),a+=Math.imul(w,fe),n+=Math.imul(m,pe),i+=Math.imul(m,ye);var Ae=l+n+((8191&(i+=Math.imul(g,pe)))<<13);l=(a+=Math.imul(g,ye))+(i>>>13)+(Ae>>>26),Ae&=67108863,n=Math.imul(z,X),i=Math.imul(z,Q),i+=Math.imul(F,X),a=Math.imul(F,Q),n+=Math.imul(D,$),i+=Math.imul(D,ee),i+=Math.imul(B,$),a+=Math.imul(B,ee),n+=Math.imul(P,re),i+=Math.imul(P,ne),i+=Math.imul(O,re),a+=Math.imul(O,ne),n+=Math.imul(I,ae),i+=Math.imul(I,oe),i+=Math.imul(R,ae),a+=Math.imul(R,oe),n+=Math.imul(T,ue),i+=Math.imul(T,le),i+=Math.imul(A,ue),a+=Math.imul(A,le),n+=Math.imul(k,he),i+=Math.imul(k,fe),i+=Math.imul(E,he),a+=Math.imul(E,fe),n+=Math.imul(b,pe),i+=Math.imul(b,ye);var Ce=l+n+((8191&(i+=Math.imul(w,pe)))<<13);l=(a+=Math.imul(w,ye))+(i>>>13)+(Ce>>>26),Ce&=67108863,n=Math.imul(z,$),i=Math.imul(z,ee),i+=Math.imul(F,$),a=Math.imul(F,ee),n+=Math.imul(D,re),i+=Math.imul(D,ne),i+=Math.imul(B,re),a+=Math.imul(B,ne),n+=Math.imul(P,ae),i+=Math.imul(P,oe),i+=Math.imul(O,ae),a+=Math.imul(O,oe),n+=Math.imul(I,ue),i+=Math.imul(I,le),i+=Math.imul(R,ue),a+=Math.imul(R,le),n+=Math.imul(T,he),i+=Math.imul(T,fe),i+=Math.imul(A,he),a+=Math.imul(A,fe),n+=Math.imul(k,pe),i+=Math.imul(k,ye);var Ie=l+n+((8191&(i+=Math.imul(E,pe)))<<13);l=(a+=Math.imul(E,ye))+(i>>>13)+(Ie>>>26),Ie&=67108863,n=Math.imul(z,re),i=Math.imul(z,ne),i+=Math.imul(F,re),a=Math.imul(F,ne),n+=Math.imul(D,ae),i+=Math.imul(D,oe),i+=Math.imul(B,ae),a+=Math.imul(B,oe),n+=Math.imul(P,ue),i+=Math.imul(P,le),i+=Math.imul(O,ue),a+=Math.imul(O,le),n+=Math.imul(I,he),i+=Math.imul(I,fe),i+=Math.imul(R,he),a+=Math.imul(R,fe),n+=Math.imul(T,pe),i+=Math.imul(T,ye);var Re=l+n+((8191&(i+=Math.imul(A,pe)))<<13);l=(a+=Math.imul(A,ye))+(i>>>13)+(Re>>>26),Re&=67108863,n=Math.imul(z,ae),i=Math.imul(z,oe),i+=Math.imul(F,ae),a=Math.imul(F,oe),n+=Math.imul(D,ue),i+=Math.imul(D,le),i+=Math.imul(B,ue),a+=Math.imul(B,le),n+=Math.imul(P,he),i+=Math.imul(P,fe),i+=Math.imul(O,he),a+=Math.imul(O,fe),n+=Math.imul(I,pe),i+=Math.imul(I,ye);var Me=l+n+((8191&(i+=Math.imul(R,pe)))<<13);l=(a+=Math.imul(R,ye))+(i>>>13)+(Me>>>26),Me&=67108863,n=Math.imul(z,ue),i=Math.imul(z,le),i+=Math.imul(F,ue),a=Math.imul(F,le),n+=Math.imul(D,he),i+=Math.imul(D,fe),i+=Math.imul(B,he),a+=Math.imul(B,fe),n+=Math.imul(P,pe),i+=Math.imul(P,ye);var Pe=l+n+((8191&(i+=Math.imul(O,pe)))<<13);l=(a+=Math.imul(O,ye))+(i>>>13)+(Pe>>>26),Pe&=67108863,n=Math.imul(z,he),i=Math.imul(z,fe),i+=Math.imul(F,he),a=Math.imul(F,fe),n+=Math.imul(D,pe),i+=Math.imul(D,ye);var Oe=l+n+((8191&(i+=Math.imul(B,pe)))<<13);l=(a+=Math.imul(B,ye))+(i>>>13)+(Oe>>>26),Oe&=67108863,n=Math.imul(z,pe),i=Math.imul(z,ye);var Le=l+n+((8191&(i+=Math.imul(F,pe)))<<13);return l=(a=Math.imul(F,ye))+(i>>>13)+(Le>>>26),Le&=67108863,u[0]=ve,u[1]=me,u[2]=ge,u[3]=_e,u[4]=be,u[5]=we,u[6]=xe,u[7]=ke,u[8]=Ee,u[9]=Se,u[10]=Te,u[11]=Ae,u[12]=Ce,u[13]=Ie,u[14]=Re,u[15]=Me,u[16]=Pe,u[17]=Oe,u[18]=Le,0!==l&&(u[19]=l,r.length++),r}},function(e,t,r){"use strict";var n=r(17).Buffer,i=r(765),a=r(898),o=r(899);function s(){this.x=i.fromBuffer(n.from("79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","hex")),this.y=i.fromBuffer(n.from("483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8","hex")),this.inf=!1,this._precompute()}s.prototype._precompute=function(){for(var e=new a(this.x,this.y),t=new Array(1+Math.ceil(64.25)),r=t[0]=e,n=1;n<t.length;++n){for(var i=0;i<4;i++)r=r.dbl();t[n]=r}this.precomputed={naf:e._getNAFPoints(7),doubles:{step:4,points:t,negpoints:t.map((function(e){return e.neg()}))}}},s.prototype.mul=function(e){for(var t=this.precomputed.doubles.step,r=this.precomputed.doubles.points,n=this.precomputed.doubles.negpoints,i=e.getNAF(1),s=((1<<t+1)-(t%2===0?2:1))/3,u=[],l=0;l<i.length;l+=t){for(var c=0,h=l+t-1;h>=l;h--)c=(c<<1)+i[h];u.push(c)}for(var f=new o(null,null,null),d=new o(null,null,null),p=s;p>0;p--){for(var y=0;y<u.length;y++)u[y]===p?d=d.mixedAdd(r[y]):u[y]===-p&&(d=d.mixedAdd(n[y]));f=f.add(d)}return a.fromECJPoint(f)},s.prototype.mulAdd=function(e,t,r){for(var n=this.precomputed.naf,i=t._getNAFPoints1(),a=[n.points,i.points],s=[e.getNAF(n.wnd),r.getNAF(i.wnd)],u=new o(null,null,null),l=[null,null],c=Math.max(s[0].length,s[1].length);c>=0;c--){for(var h=0;c>=0&&(l[0]=0|s[0][c],l[1]=0|s[1][c],0===l[0]&&0===l[1]);++h,--c);if(c>=0&&(h+=1),u=u.dblp(h),c<0)break;for(var f=0;f<2;f++){var d,p=l[f];0!==p&&(p>0?d=a[f][p>>1]:p<0&&(d=a[f][-p>>1].neg()),u=void 0===d.z?u.mixedAdd(d):u.add(d))}}return u},e.exports=new s},function(e,t,r){"use strict";(function(t){var n=r(1195),i=r(1198),a={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};e.exports=function(e,r,o,s){var u=a[e];if(!u)return s(new Error("unkown cipherType passed"));if(!r)return s(new Error("unkown hashType passed"));var l=u.keySize,c=u.ivSize,h=t.from("key expansion"),f=2*(c+l+20);i.create(r,o,(function(e,r){if(e)return s(e);r.digest(h,(function(e,i){if(e)return s(e);var a=[],o=0;n((function(){return o<f}),(function(e){r.digest(t.concat([i,h]),(function(t,n){if(t)return e(t);var s=n.length;o+s>f&&(s=f-o),a.push(n),o+=s,r.digest(i,(function(t,r){if(t)return e(t);i=r,e()}))}))}),(function(e){if(e)return s(e);var r=f/2,n=t.concat(a),i=n.slice(0,r),o=n.slice(r,f),u=function(e){return{iv:e.slice(0,c),cipherKey:e.slice(c,c+l),macKey:e.slice(c+l)}};s(null,{k1:u(i),k2:u(o)})}))}))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){r=(0,a.default)(r||n.default);var s=(0,o.default)(t);if(!e())return r(null);s((function t(n){if(n)return r(n);if(e())return s(t);var a=(0,i.default)(arguments,1);r.apply(null,[null].concat(a))}))};var n=s(r(133)),i=s(r(764)),a=s(r(806)),o=s(r(807));function s(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)((function(t,r){var i;try{i=e.apply(this,t)}catch(a){return r(a)}(0,n.default)(i)&&"function"===typeof i.then?i.then((function(e){s(r,null,e)}),(function(e){s(r,e.message?e:new Error(e))})):r(null,i)}))};var n=o(r(77)),i=o(r(1197)),a=o(r(803));function o(e){return e&&e.__esModule?e:{default:e}}function s(e,t,r){try{e(t,r)}catch(n){(0,a.default)(u,n)}}function u(e){throw e}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(){var t=(0,a.default)(arguments),r=t.pop();e.call(this,t,r)}};var n,i=r(764),a=(n=i)&&n.__esModule?n:{default:n};e.exports=t.default},function(e,t,r){"use strict";(function(e){var n=r(804),i=r(805),a=r(1199),o={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"};t.create=function(t,r,s){var u=o[t];n(i.subtle.importKey("raw",r,{name:"HMAC",hash:{name:u}},!1,["sign"]).then((function(r){return{digest:function(t,a){!function(t,r,a){n(i.subtle.sign({name:"HMAC"},t,r).then((function(t){return e.from(t)})),a)}(r,t,a)},length:a[t]}})),s)}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";e.exports={SHA1:20,SHA256:32,SHA512:64}},function(e,t,r){"use strict";var n=r(1201);e.exports=function(e,t){n.generateEphmeralKeyPair(e,t)}},function(e,t,r){"use strict";(function(e){var n=r(805),i=r(804),a=r(177).bignum,o=r(892),s=o.toBase64,u=o.toBn,l={"P-256":256,"P-384":384,"P-521":521};t.generateEphmeralKeyPair=function(t,r){i(n.subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]).then((function(r){var o=function(o,u,c){var h;"function"===typeof u&&(c=u,u=void 0),h=u?n.subtle.importKey("jwk",function(e,t){var r=f(e,t.public);return r.d=s(new a(t.private)),r}(t,u),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):Promise.resolve(r.privateKey);var d=Promise.all([n.subtle.importKey("jwk",f(t,o),{name:"ECDH",namedCurve:t},!1,[]),h]);i(d.then((function(e){return n.subtle.deriveBits({name:"ECDH",namedCurve:t,public:e[0]},e[1],l[t])})).then((function(t){return e.from(t)})),c)};return n.subtle.exportKey("jwk",r.publicKey).then((function(e){return{key:h(e),genSharedKey:o}}))})),r)};var c={"P-256":32,"P-384":48,"P-521":66};function h(t){var r=c[t.crv];return e.concat([e.from([4]),u(t.x).toArrayLike(e,"be",r),u(t.y).toArrayLike(e,"be",r)],1+2*r)}function f(t,r){var n=c[t];if(!r.slice(0,1).equals(e.from([4])))throw new Error("Invalid key format");var i=new a(r.slice(1,n+1)),o=new a(r.slice(1+n));return{kty:"EC",crv:t,x:s(i,n),y:s(o,n),ext:!0}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(903).ensureMultiaddr,o=r(1203),s=function(){function e(t){n(this,e),this._multiaddrs=t||[],this._observedMultiaddrs=[]}return i(e,[{key:"add",value:function(e){e=a(e),this.has(e)||this._multiaddrs.push(e)}},{key:"addSafe",value:function(e){var t=this;e=a(e),this._observedMultiaddrs.some((function(r,n){if(r.equals(e))return t.add(e),t._observedMultiaddrs.splice(n,1),!0}))||this._observedMultiaddrs.push(e)}},{key:"toArray",value:function(){return this._multiaddrs.slice()}},{key:"forEach",value:function(e){return this._multiaddrs.forEach(e)}},{key:"filterBy",value:function(e){return"object"!==typeof e||"function"!==typeof e.matches||"function"!==typeof e.partialMatch||"function"!==typeof e.toString?[]:this._multiaddrs.filter((function(t){return e.matches(t)}))}},{key:"has",value:function(e){return e=a(e),this._multiaddrs.some((function(t){return t.equals(e)}))}},{key:"delete",value:function(e){var t=this;e=a(e),this._multiaddrs.some((function(r,n){if(r.equals(e))return t._multiaddrs.splice(n,1),!0}))}},{key:"replace",value:function(e,t){var r=this;Array.isArray(e)||(e=[e]),Array.isArray(t)||(t=[t]),e.forEach((function(e){return r.delete(e)})),t.forEach((function(e){return r.add(e)}))}},{key:"clear",value:function(){this._multiaddrs=[]}},{key:"distinct",value:function(){return o(this._multiaddrs,(function(e){return[e.toOptions().port,e.toOptions().transport].join()}))}},{key:"size",get:function(){return this._multiaddrs.length}}]),e}();e.exports=s},function(e,t,r){"use strict";e.exports=function(e,t){var r=[],n={};if("function"!==typeof t){var i=t;t=function(e){return e[i]}}return e.forEach((function(e){var i=t(e);n[i]||(n[i]=!0,r.push(e))})),r}},function(e,t,r){"use strict";e.exports=function(e,t){var n={add:r(904),addReadableStream:r(1261),addPullStream:r(1262),addFromFs:r(1264),addFromURL:r(1265),addFromStream:r(904),cat:r(1276),catReadableStream:r(1286),catPullStream:r(1288),get:r(1291),getReadableStream:r(1306),getPullStream:r(1307),ls:r(1308),lsReadableStream:r(1345),lsPullStream:r(1346),refs:r(828),refsReadableStream:r(1369),refsPullStream:r(1370),files:r(1371),block:r(972),bitswap:r(1389),dag:r(1393),object:r(1438),pin:r(1451),bootstrap:r(1455),dht:r(1459),name:r(1466),ping:r(1473),pingReadableStream:r(1475),pingPullStream:r(1476),swarm:r(1477),pubsub:r(1483),dns:r(1487),commands:r(1488),config:r(1489),diag:r(1493),id:r(1497),key:r(1498),log:r(1505),mount:r(1509),repo:r(1510),stop:r(988),shutdown:r(988),stats:r(1514),update:r(1520),version:r(1521),resolve:r(1522),getEndpointConfig:function(e,t){return r(1523)(t)}},i={};return Object.keys(n).forEach((function(r){i[r]=n[r](e,t)})),i}},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1207).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(808),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(910);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(705).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(808)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t){e.exports=function e(t,r){if(t&&r)return e(t)(r);if("function"!==typeof t)throw new TypeError("need wrapper function");return Object.keys(t).forEach((function(e){n[e]=t[e]})),n;function n(){for(var e=new Array(arguments.length),r=0;r<e.length;r++)e[r]=arguments[r];var n=t.apply(this,e),i=e[e.length-1];return"function"===typeof n&&n!==i&&Object.keys(i).forEach((function(e){n[e]=i[e]})),n}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(r(1214)),i=a(r(1234));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)(n.default,1),e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r,o){(0,n.default)(t)(e,(0,i.default)((0,a.default)(r)),o)};var n=o(r(1215)),i=o(r(1233)),a=o(r(807));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t,r,u){if(u=(0,i.default)(u||n.default),e<=0||!t)return u(null);var l=(0,a.default)(t),c=!1,h=0,f=!1;function d(e,t){if(h-=1,e)c=!0,u(e);else{if(t===s.default||c&&h<=0)return c=!0,u(null);f||p()}}function p(){for(f=!0;h<e&&!c;){var t=l();if(null===t)return c=!0,void(h<=0&&u(null));h+=1,r(t.value,t.key,(0,o.default)(d))}f=!1}p()}};var n=u(r(133)),i=u(r(902)),a=u(r(1216)),o=u(r(806)),s=u(r(1232));function u(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,n.default)(e))return function(e){var t=-1,r=e.length;return function(){return++t<r?{value:e[t],key:t}:null}}(e);var t=(0,i.default)(e);return t?function(e){var t=-1;return function(){var r=e.next();return r.done?null:(t++,{value:r.value,key:t})}}(t):function(e){var t=(0,a.default)(e),r=-1,n=t.length;return function(){var i=t[++r];return r<n?{value:e[i],key:i}:null}}(e)};var n=o(r(323)),i=o(r(1217)),a=o(r(1218));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return n&&e[n]&&e[n]()};var n="function"===typeof Symbol&&Symbol.iterator;e.exports=t.default},function(e,t,r){var n=r(1219),i=r(1228),a=r(323);e.exports=function(e){return a(e)?n(e):i(e)}},function(e,t,r){var n=r(787),i=r(1220),a=r(132),o=r(1222),s=r(338),u=r(1224),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=a(e),c=!r&&i(e),h=!r&&!c&&o(e),f=!r&&!c&&!h&&u(e),d=r||c||h||f,p=d?n(e.length,String):[],y=p.length;for(var v in e)!t&&!l.call(e,v)||d&&("length"==v||h&&("offset"==v||"parent"==v)||f&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,y))||p.push(v);return p}},function(e,t,r){var n=r(1221),i=r(318),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,u=n(function(){return arguments}())?n:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=u},function(e,t,r){var n=r(178),i=r(318);e.exports=function(e){return i(e)&&"[object Arguments]"==n(e)}},function(e,t,r){(function(e){var n=r(107),i=r(1223),a=t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a?n.Buffer:void 0,u=(s?s.isBuffer:void 0)||i;e.exports=u}).call(this,r(68)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(1225),i=r(1226),a=r(1227),o=a&&a.isTypedArray,s=o?i(o):n;e.exports=s},function(e,t,r){var n=r(178),i=r(337),a=r(318),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){(function(e){var n=r(325),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&n.process,s=function(){try{var e=a&&a.require&&a.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=s}).call(this,r(68)(e))},function(e,t,r){var n=r(1229),i=r(1230),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))a.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,r){var n=r(1231)(Object.keys,Object);e.exports=n},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return function(t,r,n){return e(t,n)}},e.exports=t.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return function(r,n,i){return e(r,t,n,i)}},e.exports=t.default},function(e,t,r){"use strict";var n=r(746),i=r(1236),a=r(672).Readable,o=r(911),s=r(809).isSource,u=r(766),l=r(1237),c=r(918).supportsFileReader,h=r(1246);function f(e){if(c&&"file"===o(e))return h(e);if("buffer"===o(e))return new a({read:function(){this.push(e),this.push(null)}});if(s(e))return l.readable(e);if(u.readable(e))return e;throw new Error("Input not supported. Expected Buffer|ReadableStream|PullStream|File got ".concat(o(e),". Check the documentation for more info https://github.com/ipfs/interface-js-ipfs-core/blob/master/SPEC/FILES.md#add"))}e.exports=function(e,t){var a=[].concat(e);return i(a,(function(e){if("string"===typeof e){if(!n)throw new Error("Can only add file paths in node");return function(e,t){var n=r(1255),i=r(1256),a=r(1257),o=null==e.followSymlinks||e.followSymlinks;t=n.resolve(t);var s=i.statSync(t);if(s.isDirectory()&&!e.recursive)throw new Error("Can only add directories using --recursive");if(s.isDirectory()&&e.recursive){var u=(t=t.split(n.sep).join("/"))+(t.endsWith("/")?"":"/"),l=u.split("/");l=l[l.length-2]+"/";var c=new a.sync.GlobSync("**/*",{cwd:t,follow:o,dot:e.hidden,ignore:e.ignore});return c.found.map((function(e){var t=u+e;return!0===c.symlinks[t]?{path:l+e,symlink:!0,dir:!1,content:i.readlinkSync(t)}:"FILE"===c.cache[t]?{path:l+e,symlink:!1,dir:!1,content:i.createReadStream(t)}:"DIR"===c.cache[t]||c.cache[t]instanceof Array?{path:l+e,symlink:!1,dir:!0}:void 0})).filter(Boolean)}return{path:n.basename(t),content:i.createReadStream(t)}}(t,e)}if("object"===o(e)){if(e.path&&"string"===o(e.path)&&!e.content)return e.dir=!0,e;if(e.dir)return e;if(e.content)return{path:e.path||"",symlink:!1,dir:!1,content:f(e.content)}}return{path:"",symlink:!1,dir:!1,content:f(e)}}))}},function(e,t,r){"use strict";e.exports=function(e,t,r){var n=[];return Array.isArray(e)?(e.forEach((function(e,i,a){var o=t.call(r,e,i,a);Array.isArray(o)?n.push.apply(n,o):null!=o&&n.push(o)})),n):n}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(176),o=r(23),s=r(24),u=function(e){o(r,e);var t=s(r);function r(e,i,o){var s;return n(this,r),(s=t.call(this,o)).source=e,s.drainingSource=!1,s.sink=i,s.input=[],s.writeCallbacks=[],s.internalSourceCallbacks=[],s.sink&&s.sink(s._internalSource.bind(a(s))),s}return i(r,[{key:"drainPull",value:function(){var e=this;this.drainingSource=!0,this.source(null,(function t(r,n){return r instanceof Error?e.emit("error",r):r?e.push(null):void(e.push(n)?e.source(null,t):e.drainingSource=!1)}))}},{key:"_read",value:function(){this.source&&!this.drainingSource&&this.drainPull()}},{key:"_write",value:function(e,t,r){this.internalSourceCallbacks.length>0?(this.internalSourceCallbacks.shift()(null,e),r()):(this.input.push(e),this.writeCallbacks.push(r))}},{key:"_internalSource",value:function(e,t){if(e)return this.writeCallbacks.length>0&&this.writeCallbacks.shift()(e instanceof Error?e:new Error("Aborted")),t(e);this.input.length>0?(t(null,this.input.shift()),this.writeCallbacks.shift()()):this.internalSourceCallbacks.push(t)}},{key:"_final",value:function(e){this.internalSourceCallbacks.length>0&&this.internalSourceCallbacks.shift()(!0),e()}},{key:"_destroy",value:function(e,t){!this._readableState.ended&&this.source&&this.source(!0,(function(){})),this.internalSourceCallbacks.length>0&&this.internalSourceCallbacks.shift()(e),t(e)}}]),r}(r(1238).Duplex);function l(e,t,r){return e&&"object"===typeof e&&(t=(e=e.source).sink),new u(e,t,Object.assign({readableObjectMode:!0,writableObjectMode:!0},r))}e.exports={duplex:l,readable:function(e,t){return l(e,null,t)},writeable:function(e,t){return l(null,e,t)}}},function(e,t,r){(t=e.exports=r(912)).Stream=t,t.Readable=t,t.Writable=r(916),t.Duplex=r(709),t.Transform=r(917),t.PassThrough=r(1244),t.finished=r(810),t.pipeline=r(1245)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1241).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(810),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(917);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(708).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(810)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(23),o=r(24),s=r(1247).Readable,u=r(918).supportsFileReader;e.exports=function(e,t){if(!u)throw new Error("FileReader DOM API is not supported.");return new(function(t){a(s,t);var r=o(s);function s(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(this,s),(t=r.call(this,i)).file=e,t.offset=i.offset||0,t.chunkSize=i.chunkSize||1048576,t.fileReader=new self.FileReader(e),t.fileReader.onloadend=function(e){var r=e.target.result;0===r.byteLength&&t.push(null),t.push(new Uint8Array(r))},t.fileReader.onerror=function(e){return t.destroy(e)},t}return i(s,[{key:"_read",value:function(t){var r=this.offset+this.chunkSize,n=e.slice(this.offset,r);this.fileReader.readAsArrayBuffer(n),this.offset=r}}]),s}(s))(e,t)}},function(e,t,r){(t=e.exports=r(919)).Stream=t,t.Readable=t,t.Writable=r(923),t.Duplex=r(711),t.Transform=r(924),t.PassThrough=r(1253),t.finished=r(811),t.pipeline=r(1254)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1250).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(811),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(924);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(710).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(811)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var t="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,i="/"===o.charAt(0))}return(i?"/":"")+(t=r(n(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),o="/"===i(e,-1);return(e=r(n(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&o&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!==typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var i=n(e.split("/")),a=n(r.split("/")),o=Math.min(i.length,a.length),s=o,u=0;u<o;u++)if(i[u]!==a[u]){s=u;break}var l=[];for(u=s;u<i.length;u++)l.push("..");return(l=l.concat(a.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!==typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!i){n=a;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var r=function(e){"string"!==typeof e&&(e+="");var t,r=0,n=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){r=t+1;break}}else-1===n&&(i=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){"string"!==typeof e&&(e+="");for(var t=-1,r=0,n=-1,i=!0,a=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===n&&(i=!1,n=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){r=o+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===r+1?"":e.slice(t,n)};var i="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r(21))},,,function(e,t,r){"use strict";(function(t){var n=r(18),i=r(19),a=r(23),o=r(24),s=r(672).Transform,u=r(746),l="--",c="\r\n",h=t.from(c),f=function(e){a(s,e);var r=o(s);function s(e){var t;return n(this,s),(t=r.call(this,Object.assign({},e,{objectMode:!0,highWaterMark:1})))._boundary=t._generateBoundary(),t._files=[],t._draining=!1,t}return i(s,[{key:"_flush",value:function(){this.push(t.from(l+this._boundary+l+c)),this.push(null)}},{key:"_generateBoundary",value:function(){for(var e="--------------------------",t=0;t<24;t++)e+=Math.floor(10*Math.random()).toString(16);return e}},{key:"_transform",value:function(e,r,n){if(t.isBuffer(e))return this.push(e),n();this._files.push(e),this._maybeDrain(n)}},{key:"_maybeDrain",value:function(e){var t=this;if(this._draining)this.once("drained all files",e);else if(this._files.length){this._draining=!0;var r=this._files.shift();this._pushFile(r,(function(r){t._draining=!1,r?t.emit("error",r):t._maybeDrain(e)}))}else this.emit("drained all files"),e()}},{key:"_pushFile",value:function(e,r){var n=this,i=this._leading(e.headers||{});this.push(i);var a=e.content||t.alloc(0);if(t.isBuffer(a))return this.push(a),this.push(h),r();a.once("error",this.emit.bind(this,"error")),a.once("end",(function(){n.push(h),r()})),a.on("data",(function(e){!n.push(e)&&u&&(a.pause(),n.once("drain",(function(){return a.resume()})))}))}},{key:"_leading",value:function(e){var r=[l+this._boundary];Object.keys(e).forEach((function(t){r.push(t+": "+e[t])})),r.push(""),r.push("");var n=r.join(c);return t.from(n)}}]),s}(s);e.exports=f}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(911),i=r(766),a=r(809).isSource,o=r(1260);e.exports=function(e){var t=function(e){return o(e)||i.readable(e)||a(e)||"file"===n(e)},r=function(e){return t(e)||function(e){return"object"===typeof e&&(e.content?t(e.content):Boolean(e.path)&&"string"===typeof e.path)}(e)};if(r(e)||Array.isArray(e)&&e.every(r))return!0;throw new Error("Input not supported. Expected Buffer|ReadableStream|PullStream|File|Array<Object> got ".concat(n(e),". Check the documentation for more info https://github.com/ipfs/interface-js-ipfs-core/blob/master/SPEC/FILES.md#add"))}},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,r){"use strict";var n=r(745),i=r(707);e.exports=function(e){return function(t){return(t=t||{}).converter=i,n(e,"add")(t)}}},function(e,t,r){"use strict";var n=r(745),i=r(707),a=r(683);e.exports=function(e){return function(t){return(t=t||{}).converter=i,a(n(e,"add")({qs:t}))}}},function(e,t){e.exports=function(e){!function t(){var r=!0,n=!1;do{n=!0,r=!1,e.call(this,(function(){n?r=!0:t()})),n=!1}while(r)}()}},function(e,t,r){"use strict";var n=r(746),i=r(662),a=r(812),o=r(707);e.exports=function(e){var t=a(e,"add");return i((function(e,r,i){return"function"===typeof r&&void 0===i&&(i=r,r={}),"function"===typeof r&&"function"===typeof i&&(i=r,r={}),n?"string"!==typeof e?i(new Error('"path" must be a string')):void t(e,{qs:r,converter:o},i):i(new Error("fsAdd does not work in the browser"))}))}},function(e,t,r){"use strict";var n=r(662),i=r(813).URL,a=r(926).getRequest,o=r(812),s=r(707);e.exports=function(e){var t=o(e,"add");return n((function(e,r,n){if("function"===typeof r&&void 0===n&&(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),!u(e))return n(new Error('"url" param must be an http(s) url'));l(e,r,t,n)}))};var u=function(e){return"string"===typeof e&&e.startsWith("http")},l=function e(t,r,n,o){var l=new i(t),c=a(l,(function(t){if(t.statusCode>=400)return o(new Error("Failed to download with ".concat(t.statusCode)));var i=t.headers.location;if(t.statusCode>=300&&t.statusCode<400&&i){if(!u(i))return o(new Error("redirection url must be an http(s) url"));e(i,r,n,o)}else{var a={qs:r,converter:s},c=decodeURIComponent(l.pathname.split("/").pop());n({content:t,path:c},a,o)}}));c.once("error",o),c.end()}},function(e,t,r){"use strict";var n=r(925),i=n.URLWithLegacySupport,a=n.format;e.exports=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,s=r.protocol?r.protocol.replace(":",""):"http";s=(n[s]||o||s)+":";try{t=new i(e)}catch(l){t={}}var u=Object.assign({},r,{protocol:s||t.protocol,host:r.host||t.host});return new i(e,a(u)).toString()}},function(e,t,r){(function(t){var n=r(1268),i=r(928),a=r(330),o=self.URL,s=function(e,r){"string"===typeof e?((e=new o(e,self.location.protocol+"//"+self.location.host)).path=e.pathname+e.search,e.auth=e.username&&e.password?e.username+":"+e.password:null):e=Object.assign({},e);var i=-1===t.location.protocol.search(/^https?:$/)?"http:":"",a=e.protocol||i,s=e.hostname||e.host,u=e.port,l=e.path||"/";s&&-1!==s.indexOf(":")&&(s="["+s+"]"),e.url=(s?a+"//"+s:"")+(u?":"+u:"")+l,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var c=new n(e);return r&&c.on("response",r),c},u=function(){};u.defaultMaxSockets=4;e.exports={Agent:u,ClientRequest:n,IncomingMessage:i,METHODS:["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"],STATUS_CODES:a,get:function(e,t){var r=s(e,t);return r.end(),r},globalAgent:new u,request:s,maxHeaderSize:"8KB"}}).call(this,r(22))},function(e,t,r){(function(t){var n=r(927),i=r(14),a=r(928),o=r(929),s=self.fetch,u=e.exports=function(e){var r=this;o.Writable.call(this),this._opts=e,this._body=[],this._headers={},e.auth&&this.setHeader("Authorization","Basic "+t.from(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])})),this._mode="fetch",this._fetchTimer=null,this.on("finish",(function(){return r._onFinish()}))};i(u,o.Writable),u.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===l.indexOf(r)&&(this._headers[r]=t)},u.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},u.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},u.prototype._onFinish=function(){var e=this;if(!this._destroyed){var t=this._opts,r=this._headers,i=null;"GET"!==t.method&&"HEAD"!==t.method&&(i=new Blob(this._body,{type:(r["content-type"]||{}).value||""}));var a=null;if(n.abortController){var o=new AbortController;a=o.signal,this._fetchAbortController=o,"requestTimeout"in t&&0!==t.requestTimeout&&(this._fetchTimer=setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}s(this._opts.url,{method:this._opts.method,headers:this._headers,body:i||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:a}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}},u.prototype._connect=function(){var e=this;this._destroyed||(this._response=new a(this._fetchResponse,this._mode,this._fetchTimer),this._response.on("error",(function(t){return e.emit("error",t)})),this.emit("response",this._response))},u.prototype._write=function(e,t,r){this._body.push(e),r()},u.prototype.abort=u.prototype.destroy=function(){this._destroyed=!0,clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},u.prototype.end=function(e,t,r){"function"===typeof e&&(r=e,e=void 0),o.Writable.prototype.end.call(this,e,t,r)},u.prototype.flushHeaders=function(){},u.prototype.setTimeout=function(){},u.prototype.setNoDelay=function(){},u.prototype.setSocketKeepAlive=function(){};var l=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,r(10).Buffer)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1271).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(814),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(935);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(712).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(814)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){"use strict";var n=r(662),i=r(681),a=r(679),o=r(1277);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={});try{t=i(t)}catch(u){if(!a.ipfsPath(t))return n(u)}var s={offset:r.offset,length:r.length};e({path:"cat",args:t,buffer:r.buffer,qs:s},(function(e,t){if(e)return n(e);t.pipe(o((function(e,t){if(e)return n(e);n(null,t)})))}))}))}},function(e,t,r){"use strict";(function(t){var n=r(1278).Duplex;function i(e){if(!(this instanceof i))return new i(e);if(this._bufs=[],this.length=0,"function"==typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",(function(e){e.on("error",t)})),this.on("unpipe",(function(e){e.removeListener("error",t)}))}else this.append(e);n.call(this)}r(171).inherits(i,n),i.prototype._offset=function(e){var t,r=0,n=0;if(0===e)return[0,0];for(;n<this._bufs.length;n++){if(e<(t=r+this._bufs[n].length)||n==this._bufs.length-1)return[n,e-r];r=t}},i.prototype._reverseOffset=function(e){for(var t=e[0],r=e[1],n=0;n<t;n++)r+=this._bufs[n].length;return r},i.prototype.append=function(e){var r=0;if(t.isBuffer(e))this._appendBuffer(e);else if(Array.isArray(e))for(;r<e.length;r++)this.append(e[r]);else if(e instanceof i)for(;r<e._bufs.length;r++)this.append(e._bufs[r]);else null!=e&&("number"==typeof e&&(e=e.toString()),this._appendBuffer(t.from(e)));return this},i.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},i.prototype._write=function(e,t,r){this._appendBuffer(e),"function"==typeof r&&r()},i.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},i.prototype.end=function(e){n.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},i.prototype.get=function(e){if(!(e>this.length||e<0)){var t=this._offset(e);return this._bufs[t[0]][t[1]]}},i.prototype.slice=function(e,t){return"number"==typeof e&&e<0&&(e+=this.length),"number"==typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},i.prototype.copy=function(e,r,n,i){if(("number"!=typeof n||n<0)&&(n=0),("number"!=typeof i||i>this.length)&&(i=this.length),n>=this.length)return e||t.alloc(0);if(i<=0)return e||t.alloc(0);var a,o,s=!!e,u=this._offset(n),l=i-n,c=l,h=s&&r||0,f=u[1];if(0===n&&i==this.length){if(!s)return 1===this._bufs.length?this._bufs[0]:t.concat(this._bufs,this.length);for(o=0;o<this._bufs.length;o++)this._bufs[o].copy(e,h),h+=this._bufs[o].length;return e}if(c<=this._bufs[u[0]].length-f)return s?this._bufs[u[0]].copy(e,r,f,f+c):this._bufs[u[0]].slice(f,f+c);for(s||(e=t.allocUnsafe(l)),o=u[0];o<this._bufs.length;o++){if(!(c>(a=this._bufs[o].length-f))){this._bufs[o].copy(e,h,f,f+c),h+=a;break}this._bufs[o].copy(e,h,f),h+=a,c-=a,f&&(f=0)}return e.length>h?e.slice(0,h):e},i.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!==typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return new i;var r=this._offset(e),n=this._offset(t),a=this._bufs.slice(r[0],n[0]+1);return 0==n[1]?a.pop():a[a.length-1]=a[a.length-1].slice(0,n[1]),0!=r[1]&&(a[0]=a[0].slice(r[1])),new i(a)},i.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},i.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},i.prototype.duplicate=function(){for(var e=0,t=new i;e<this._bufs.length;e++)t.append(this._bufs[e]);return t},i.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},i.prototype.indexOf=function(e,r,n){if(void 0===n&&"string"===typeof r&&(n=r,r=void 0),"function"===typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"===typeof e?e=t.from([e]):"string"===typeof e?e=t.from(e,n):e instanceof i?e=e.slice():t.isBuffer(e)||(e=t.from(e)),r=Number(r||0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),0===e.length)return r>this.length?this.length:r;for(var a=this._offset(r),o=a[0],s=a[1];o<this._bufs.length;o++){for(var u=this._bufs[o];s<u.length;){if(u.length-s>=e.length){var l=u.indexOf(e,s);if(-1!==l)return this._reverseOffset([o,l]);s=u.length-e.length+1}else{var c=this._reverseOffset([o,s]);if(this._match(c,e))return c;s++}}s=0}return-1},i.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(var r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(var t in e)!function(t){i.prototype[t]=null===e[t]?function(e,r){return this.slice(e,e+r)[t](0,r)}:function(r){return this.slice(r,r+e[t])[t](0)}}(t)}(),e.exports=i}).call(this,r(10).Buffer)},function(e,t,r){(t=e.exports=r(936)).Stream=t,t.Readable=t,t.Writable=r(940),t.Duplex=r(715),t.Transform=r(941),t.PassThrough=r(1284),t.finished=r(815),t.pipeline=r(1285)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1281).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(815),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(941);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(714).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(815)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){"use strict";var n=r(681),i=r(679),a=r(672),o=r(675);e.exports=function(e){return function(t,r){r=r||{};var s=new a.PassThrough;try{t=n(t)}catch(l){if(!i.ipfsPath(t))return s.destroy(l)}var u={offset:r.offset,length:r.length};return e({path:"cat",args:t,buffer:r.buffer,qs:u},(function(e,t){if(e)return s.destroy(e);o(t,s)})),s}}},,function(e,t,r){"use strict";var n=r(681),i=r(679),a=r(683),o=r(689);e.exports=function(e){return function(t,r){r=r||{};var s=o.source();try{t=n(t)}catch(l){if(!i.ipfsPath(t))return s.end(l)}var u={offset:r.offset,length:r.length};return e({path:"cat",args:t,buffer:r.buffer,qs:u},(function(e,t){if(e)return s.end(e);s.resolve(a(t))})),s}}},function(e,t){e.exports=function(){var e,t,r,n,i;function a(a){return i?i(a):(e=a,function(e,i){t?t(e,i):(n=e,r=i)})}return a.resolve=function(a){if(i)throw new Error("already resolved");if(!(i=a))throw new Error("resolve *must* be passed a transform stream");e&&(t=i(e),r&&t(n,r))},a}},function(e,t,r){var n=r(942),i=r(943);e.exports=function(){var e=n(),t=i();return{source:e,sink:t,resolve:function(r){e.resolve(r.source),t.resolve(r.sink)}}}},function(e,t,r){"use strict";var n=r(662),i=r(681),a=r(817),o=r(744),s=r(819),u=r(679);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={});try{t=i(t)}catch(c){if(!u.ipfsPath(t))return n(c)}var l={path:"get",args:t,qs:r};e.andTransform(l,a,(function(e,t){if(e)return n(e);var r=[];t.pipe(s.obj((function(e,t,n){e.content?e.content.pipe(o((function(t){r.push({path:e.path,content:t})}))):r.push(e),n()}),(function(){return n(null,r)})))}))}))}},function(e,t,r){t.extract=r(1293),t.pack=r(1303)},function(e,t,r){var n=r(171),i=r(1294),a=r(950),o=r(747).Writable,s=r(747).PassThrough,u=function(){},l=function(e){return(e&=511)&&512-e},c=function(e,t){this._parent=e,this.offset=t,s.call(this,{autoDestroy:!1})};n.inherits(c,s),c.prototype.destroy=function(e){this._parent.destroy(e)};var h=function e(t){if(!(this instanceof e))return new e(t);o.call(this,t),t=t||{},this._offset=0,this._buffer=i(),this._missing=0,this._partial=!1,this._onparse=u,this._header=null,this._stream=null,this._overflow=null,this._cb=null,this._locked=!1,this._destroyed=!1,this._pax=null,this._paxGlobal=null,this._gnuLongPath=null,this._gnuLongLinkPath=null;var r=this,n=r._buffer,s=function(){r._continue()},h=function(e){if(r._locked=!1,e)return r.destroy(e);r._stream||s()},f=function(){r._stream=null;var e=l(r._header.size);e?r._parse(e,d):r._parse(512,g),r._locked||s()},d=function(){r._buffer.consume(l(r._header.size)),r._parse(512,g),s()},p=function(){var e=r._header.size;r._paxGlobal=a.decodePax(n.slice(0,e)),n.consume(e),f()},y=function(){var e=r._header.size;r._pax=a.decodePax(n.slice(0,e)),r._paxGlobal&&(r._pax=Object.assign({},r._paxGlobal,r._pax)),n.consume(e),f()},v=function(){var e=r._header.size;this._gnuLongPath=a.decodeLongPath(n.slice(0,e),t.filenameEncoding),n.consume(e),f()},m=function(){var e=r._header.size;this._gnuLongLinkPath=a.decodeLongPath(n.slice(0,e),t.filenameEncoding),n.consume(e),f()},g=function e(){var i,o=r._offset;try{i=r._header=a.decode(n.slice(0,512),t.filenameEncoding,t.allowUnknownFormat)}catch(u){r.emit("error",u)}return n.consume(512),i?"gnu-long-path"===i.type?(r._parse(i.size,v),void s()):"gnu-long-link-path"===i.type?(r._parse(i.size,m),void s()):"pax-global-header"===i.type?(r._parse(i.size,p),void s()):"pax-header"===i.type?(r._parse(i.size,y),void s()):(r._gnuLongPath&&(i.name=r._gnuLongPath,r._gnuLongPath=null),r._gnuLongLinkPath&&(i.linkname=r._gnuLongLinkPath,r._gnuLongLinkPath=null),r._pax&&(r._header=i=function(e,t){return t.path&&(e.name=t.path),t.linkpath&&(e.linkname=t.linkpath),t.size&&(e.size=parseInt(t.size,10)),e.pax=t,e}(i,r._pax),r._pax=null),r._locked=!0,i.size&&"directory"!==i.type?(r._stream=new c(r,o),r.emit("entry",i,r._stream,h),r._parse(i.size,f),void s()):(r._parse(512,e),void r.emit("entry",i,function(e,t){var r=new c(e,t);return r.end(),r}(r,o),h))):(r._parse(512,e),void s())};this._onheader=g,this._parse(512,g)};n.inherits(h,o),h.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.emit("close"))},h.prototype._parse=function(e,t){this._destroyed||(this._offset+=e,this._missing=e,t===this._onheader&&(this._partial=!1),this._onparse=t)},h.prototype._continue=function(){if(!this._destroyed){var e=this._cb;this._cb=u,this._overflow?this._write(this._overflow,void 0,e):e()}},h.prototype._write=function(e,t,r){if(!this._destroyed){var n=this._stream,i=this._buffer,a=this._missing;if(e.length&&(this._partial=!0),e.length<a)return this._missing-=e.length,this._overflow=null,n?n.write(e,r):(i.append(e),r());this._cb=r,this._missing=0;var o=null;e.length>a&&(o=e.slice(a),e=e.slice(0,a)),n?n.end(e):i.append(e),this._overflow=o,this._onparse()}},h.prototype._final=function(e){if(this._partial)return this.destroy(new Error("Unexpected end of data"));e()},e.exports=h},function(e,t,r){"use strict";var n=r(747).Duplex,i=r(14),a=r(1302);function o(e){if(!(this instanceof o))return new o(e);if("function"===typeof e){this._callback=e;var t=function(e){this._callback&&(this._callback(e),this._callback=null)}.bind(this);this.on("pipe",(function(e){e.on("error",t)})),this.on("unpipe",(function(e){e.removeListener("error",t)})),e=null}a._init.call(this,e),n.call(this)}i(o,n),Object.assign(o.prototype,a.prototype),o.prototype._new=function(e){return new o(e)},o.prototype._write=function(e,t,r){this._appendBuffer(e),"function"===typeof r&&r()},o.prototype._read=function(e){if(!this.length)return this.push(null);e=Math.min(e,this.length),this.push(this.slice(0,e)),this.consume(e)},o.prototype.end=function(e){n.prototype.end.call(this,e),this._callback&&(this._callback(null,this.slice()),this._callback=null)},o.prototype._destroy=function(e,t){this._bufs.length=0,this.length=0,t(e)},o.prototype._isBufferList=function(e){return e instanceof o||e instanceof a||o.isBufferList(e)},o.isBufferList=a.isBufferList,e.exports=o,e.exports.BufferListStream=o,e.exports.BufferList=a},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1297).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(818),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(949);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(716).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(818)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){"use strict";var n=r(10).Buffer,i=Symbol.for("BufferList");function a(e){if(!(this instanceof a))return new a(e);a._init.call(this,e)}a._init=function(e){Object.defineProperty(this,i,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)},a.prototype._new=function(e){return new a(e)},a.prototype._offset=function(e){if(0===e)return[0,0];for(var t=0,r=0;r<this._bufs.length;r++){var n=t+this._bufs[r].length;if(e<n||r===this._bufs.length-1)return[r,e-t];t=n}},a.prototype._reverseOffset=function(e){for(var t=e[0],r=e[1],n=0;n<t;n++)r+=this._bufs[n].length;return r},a.prototype.get=function(e){if(!(e>this.length||e<0)){var t=this._offset(e);return this._bufs[t[0]][t[1]]}},a.prototype.slice=function(e,t){return"number"===typeof e&&e<0&&(e+=this.length),"number"===typeof t&&t<0&&(t+=this.length),this.copy(null,0,e,t)},a.prototype.copy=function(e,t,r,i){if(("number"!==typeof r||r<0)&&(r=0),("number"!==typeof i||i>this.length)&&(i=this.length),r>=this.length)return e||n.alloc(0);if(i<=0)return e||n.alloc(0);var a=!!e,o=this._offset(r),s=i-r,u=s,l=a&&t||0,c=o[1];if(0===r&&i===this.length){if(!a)return 1===this._bufs.length?this._bufs[0]:n.concat(this._bufs,this.length);for(var h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,l),l+=this._bufs[h].length;return e}if(u<=this._bufs[o[0]].length-c)return a?this._bufs[o[0]].copy(e,t,c,c+u):this._bufs[o[0]].slice(c,c+u);a||(e=n.allocUnsafe(s));for(var f=o[0];f<this._bufs.length;f++){var d=this._bufs[f].length-c;if(!(u>d)){this._bufs[f].copy(e,l,c,c+u),l+=d;break}this._bufs[f].copy(e,l,c),l+=d,u-=d,c&&(c=0)}return e.length>l?e.slice(0,l):e},a.prototype.shallowSlice=function(e,t){if(e=e||0,t="number"!==typeof t?this.length:t,e<0&&(e+=this.length),t<0&&(t+=this.length),e===t)return this._new();var r=this._offset(e),n=this._offset(t),i=this._bufs.slice(r[0],n[0]+1);return 0===n[1]?i.pop():i[i.length-1]=i[i.length-1].slice(0,n[1]),0!==r[1]&&(i[0]=i[0].slice(r[1])),this._new(i)},a.prototype.toString=function(e,t,r){return this.slice(t,r).toString(e)},a.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;){if(!(e>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},a.prototype.duplicate=function(){for(var e=this._new(),t=0;t<this._bufs.length;t++)e.append(this._bufs[t]);return e},a.prototype.append=function(e){if(null==e)return this;if(e.buffer)this._appendBuffer(n.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(var t=0;t<e.length;t++)this.append(e[t]);else if(this._isBufferList(e))for(var r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else"number"===typeof e&&(e=e.toString()),this._appendBuffer(n.from(e));return this},a.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length},a.prototype.indexOf=function(e,t,r){if(void 0===r&&"string"===typeof t&&(r=t,t=void 0),"function"===typeof e||Array.isArray(e))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if("number"===typeof e?e=n.from([e]):"string"===typeof e?e=n.from(e,r):this._isBufferList(e)?e=e.slice():Array.isArray(e.buffer)?e=n.from(e.buffer,e.byteOffset,e.byteLength):n.isBuffer(e)||(e=n.from(e)),t=Number(t||0),isNaN(t)&&(t=0),t<0&&(t=this.length+t),t<0&&(t=0),0===e.length)return t>this.length?this.length:t;for(var i=this._offset(t),a=i[0],o=i[1];a<this._bufs.length;a++){for(var s=this._bufs[a];o<s.length;){if(s.length-o>=e.length){var u=s.indexOf(e,o);if(-1!==u)return this._reverseOffset([a,u]);o=s.length-e.length+1}else{var l=this._reverseOffset([a,o]);if(this._match(l,e))return l;o++}}o=0}return-1},a.prototype._match=function(e,t){if(this.length-e<t.length)return!1;for(var r=0;r<t.length;r++)if(this.get(e+r)!==t[r])return!1;return!0},function(){var e={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(var t in e)!function(t){a.prototype[t]=null===e[t]?function(e,r){return this.slice(e,e+r)[t](0,r)}:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.slice(r,r+e[t])[t](0)}}(t)}(),a.prototype._isBufferList=function(e){return e instanceof a||a.isBufferList(e)},a.isBufferList=function(e){return null!=e&&e[i]},e.exports=a},function(e,t,r){(function(t,n){var i=r(1304),a=r(816),o=r(14),s=t.alloc,u=r(747).Readable,l=r(747).Writable,c=r(66).StringDecoder,h=r(950),f=parseInt("755",8),d=parseInt("644",8),p=s(1024),y=function(){},v=function(e,t){(t&=511)&&e.push(p.slice(0,512-t))};var m=function(e){l.call(this),this.written=0,this._to=e,this._destroyed=!1};o(m,l),m.prototype._write=function(e,t,r){if(this.written+=e.length,this._to.push(e))return r();this._to._drain=r},m.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var g=function(){l.call(this),this.linkname="",this._decoder=new c("utf-8"),this._destroyed=!1};o(g,l),g.prototype._write=function(e,t,r){this.linkname+=this._decoder.write(e),r()},g.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var _=function(){l.call(this),this._destroyed=!1};o(_,l),_.prototype._write=function(e,t,r){r(new Error("No body allowed for this entry"))},_.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("close"))};var b=function e(t){if(!(this instanceof e))return new e(t);u.call(this,t),this._drain=y,this._finalized=!1,this._finalizing=!1,this._destroyed=!1,this._stream=null};o(b,u),b.prototype.entry=function(e,r,o){if(this._stream)throw new Error("already piping an entry");if(!this._finalized&&!this._destroyed){"function"===typeof r&&(o=r,r=null),o||(o=y);var s=this;if(e.size&&"symlink"!==e.type||(e.size=0),e.type||(e.type=function(e){switch(e&i.S_IFMT){case i.S_IFBLK:return"block-device";case i.S_IFCHR:return"character-device";case i.S_IFDIR:return"directory";case i.S_IFIFO:return"fifo";case i.S_IFLNK:return"symlink"}return"file"}(e.mode)),e.mode||(e.mode="directory"===e.type?f:d),e.uid||(e.uid=0),e.gid||(e.gid=0),e.mtime||(e.mtime=new Date),"string"===typeof r&&(r=t.from(r)),t.isBuffer(r)){e.size=r.length,this._encode(e);var u=this.push(r);return v(s,e.size),u?n.nextTick(o):this._drain=o,new _}if("symlink"===e.type&&!e.linkname){var l=new g;return a(l,(function(t){if(t)return s.destroy(),o(t);e.linkname=l.linkname,s._encode(e),o()})),l}if(this._encode(e),"file"!==e.type&&"contiguous-file"!==e.type)return n.nextTick(o),new _;var c=new m(this);return this._stream=c,a(c,(function(t){return s._stream=null,t?(s.destroy(),o(t)):c.written!==e.size?(s.destroy(),o(new Error("size mismatch"))):(v(s,e.size),s._finalizing&&s.finalize(),void o())})),c}},b.prototype.finalize=function(){this._stream?this._finalizing=!0:this._finalized||(this._finalized=!0,this.push(p),this.push(null))},b.prototype.destroy=function(e){this._destroyed||(this._destroyed=!0,e&&this.emit("error",e),this.emit("close"),this._stream&&this._stream.destroy&&this._stream.destroy())},b.prototype._encode=function(e){if(!e.pax){var t=h.encode(e);if(t)return void this.push(t)}this._encodePax(e)},b.prototype._encodePax=function(e){var t=h.encodePax({name:e.name,linkname:e.linkname,pax:e.pax}),r={name:"PaxHeader",mode:e.mode,uid:e.uid,gid:e.gid,size:t.length,mtime:e.mtime,type:"pax-header",linkname:e.linkname&&"PaxHeader",uname:e.uname,gname:e.gname,devmajor:e.devmajor,devminor:e.devminor};this.push(h.encode(r)),this.push(t),v(this,t.length),r.size=e.size,r.type=e.type,this.push(h.encode(r))},b.prototype._read=function(e){var t=this._drain;this._drain=y,t()},e.exports=b}).call(this,r(10).Buffer,r(21))},function(e,t,r){e.exports=r(1305)},function(e){e.exports=JSON.parse('{"O_RDONLY":0,"O_WRONLY":1,"O_RDWR":2,"S_IFMT":61440,"S_IFREG":32768,"S_IFDIR":16384,"S_IFCHR":8192,"S_IFBLK":24576,"S_IFIFO":4096,"S_IFLNK":40960,"S_IFSOCK":49152,"O_CREAT":512,"O_EXCL":2048,"O_NOCTTY":131072,"O_TRUNC":1024,"O_APPEND":8,"O_DIRECTORY":1048576,"O_NOFOLLOW":256,"O_SYNC":128,"O_SYMLINK":2097152,"O_NONBLOCK":4,"S_IRWXU":448,"S_IRUSR":256,"S_IWUSR":128,"S_IXUSR":64,"S_IRWXG":56,"S_IRGRP":32,"S_IWGRP":16,"S_IXGRP":8,"S_IRWXO":7,"S_IROTH":4,"S_IWOTH":2,"S_IXOTH":1,"E2BIG":7,"EACCES":13,"EADDRINUSE":48,"EADDRNOTAVAIL":49,"EAFNOSUPPORT":47,"EAGAIN":35,"EALREADY":37,"EBADF":9,"EBADMSG":94,"EBUSY":16,"ECANCELED":89,"ECHILD":10,"ECONNABORTED":53,"ECONNREFUSED":61,"ECONNRESET":54,"EDEADLK":11,"EDESTADDRREQ":39,"EDOM":33,"EDQUOT":69,"EEXIST":17,"EFAULT":14,"EFBIG":27,"EHOSTUNREACH":65,"EIDRM":90,"EILSEQ":92,"EINPROGRESS":36,"EINTR":4,"EINVAL":22,"EIO":5,"EISCONN":56,"EISDIR":21,"ELOOP":62,"EMFILE":24,"EMLINK":31,"EMSGSIZE":40,"EMULTIHOP":95,"ENAMETOOLONG":63,"ENETDOWN":50,"ENETRESET":52,"ENETUNREACH":51,"ENFILE":23,"ENOBUFS":55,"ENODATA":96,"ENODEV":19,"ENOENT":2,"ENOEXEC":8,"ENOLCK":77,"ENOLINK":97,"ENOMEM":12,"ENOMSG":91,"ENOPROTOOPT":42,"ENOSPC":28,"ENOSR":98,"ENOSTR":99,"ENOSYS":78,"ENOTCONN":57,"ENOTDIR":20,"ENOTEMPTY":66,"ENOTSOCK":38,"ENOTSUP":45,"ENOTTY":25,"ENXIO":6,"EOPNOTSUPP":102,"EOVERFLOW":84,"EPERM":1,"EPIPE":32,"EPROTO":100,"EPROTONOSUPPORT":43,"EPROTOTYPE":41,"ERANGE":34,"EROFS":30,"ESPIPE":29,"ESRCH":3,"ESTALE":70,"ETIME":101,"ETIMEDOUT":60,"ETXTBSY":26,"EWOULDBLOCK":35,"EXDEV":18,"SIGHUP":1,"SIGINT":2,"SIGQUIT":3,"SIGILL":4,"SIGTRAP":5,"SIGABRT":6,"SIGIOT":6,"SIGBUS":10,"SIGFPE":8,"SIGKILL":9,"SIGUSR1":30,"SIGSEGV":11,"SIGUSR2":31,"SIGPIPE":13,"SIGALRM":14,"SIGTERM":15,"SIGCHLD":20,"SIGCONT":19,"SIGSTOP":17,"SIGTSTP":18,"SIGTTIN":21,"SIGTTOU":22,"SIGURG":16,"SIGXCPU":24,"SIGXFSZ":25,"SIGVTALRM":26,"SIGPROF":27,"SIGWINCH":28,"SIGIO":23,"SIGSYS":12,"SSL_OP_ALL":2147486719,"SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION":262144,"SSL_OP_CIPHER_SERVER_PREFERENCE":4194304,"SSL_OP_CISCO_ANYCONNECT":32768,"SSL_OP_COOKIE_EXCHANGE":8192,"SSL_OP_CRYPTOPRO_TLSEXT_BUG":2147483648,"SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS":2048,"SSL_OP_EPHEMERAL_RSA":0,"SSL_OP_LEGACY_SERVER_CONNECT":4,"SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER":32,"SSL_OP_MICROSOFT_SESS_ID_BUG":1,"SSL_OP_MSIE_SSLV2_RSA_PADDING":0,"SSL_OP_NETSCAPE_CA_DN_BUG":536870912,"SSL_OP_NETSCAPE_CHALLENGE_BUG":2,"SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG":1073741824,"SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG":8,"SSL_OP_NO_COMPRESSION":131072,"SSL_OP_NO_QUERY_MTU":4096,"SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION":65536,"SSL_OP_NO_SSLv2":16777216,"SSL_OP_NO_SSLv3":33554432,"SSL_OP_NO_TICKET":16384,"SSL_OP_NO_TLSv1":67108864,"SSL_OP_NO_TLSv1_1":268435456,"SSL_OP_NO_TLSv1_2":134217728,"SSL_OP_PKCS1_CHECK_1":0,"SSL_OP_PKCS1_CHECK_2":0,"SSL_OP_SINGLE_DH_USE":1048576,"SSL_OP_SINGLE_ECDH_USE":524288,"SSL_OP_SSLEAY_080_CLIENT_DH_BUG":128,"SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG":0,"SSL_OP_TLS_BLOCK_PADDING_BUG":512,"SSL_OP_TLS_D5_BUG":256,"SSL_OP_TLS_ROLLBACK_BUG":8388608,"ENGINE_METHOD_DSA":2,"ENGINE_METHOD_DH":4,"ENGINE_METHOD_RAND":8,"ENGINE_METHOD_ECDH":16,"ENGINE_METHOD_ECDSA":32,"ENGINE_METHOD_CIPHERS":64,"ENGINE_METHOD_DIGESTS":128,"ENGINE_METHOD_STORE":256,"ENGINE_METHOD_PKEY_METHS":512,"ENGINE_METHOD_PKEY_ASN1_METHS":1024,"ENGINE_METHOD_ALL":65535,"ENGINE_METHOD_NONE":0,"DH_CHECK_P_NOT_SAFE_PRIME":2,"DH_CHECK_P_NOT_PRIME":1,"DH_UNABLE_TO_CHECK_GENERATOR":4,"DH_NOT_SUITABLE_GENERATOR":8,"NPN_ENABLED":1,"RSA_PKCS1_PADDING":1,"RSA_SSLV23_PADDING":2,"RSA_NO_PADDING":3,"RSA_PKCS1_OAEP_PADDING":4,"RSA_X931_PADDING":5,"RSA_PKCS1_PSS_PADDING":6,"POINT_CONVERSION_COMPRESSED":2,"POINT_CONVERSION_UNCOMPRESSED":4,"POINT_CONVERSION_HYBRID":6,"F_OK":0,"R_OK":4,"W_OK":2,"X_OK":1,"UV_UDP_REUSEADDR":4}')},function(e,t,r){"use strict";var n=r(681),i=r(817),a=r(679),o=r(672),s=r(675);e.exports=function(e){return function(t,r){r=r||{};var u=new o.PassThrough({objectMode:!0});try{t=n(t)}catch(c){if(!a.ipfsPath(t))return u.destroy(c)}var l={path:"get",args:t,qs:r};return e.andTransform(l,i,(function(e,t){if(e)return u.destroy(e);s(t,u)})),u}}},function(e,t,r){"use strict";var n=r(681),i=r(817),a=r(679),o=r(767),s=r(820),u=r(683),l=r(689);e.exports=function(e){return function(t,r){r=r||{};var c=l.source();try{t=n(t)}catch(f){if(!a.ipfsPath(t))return c.end(f)}var h={path:"get",args:t,qs:r};return e.andTransform(h,i,(function(e,t){if(e)return c.end(e);c.resolve(o(u.source(t),s((function(e){var t=e.path,r=e.content;return r?{path:t,content:u.source(r)}:e}))))})),c}}},function(e,t,r){"use strict";var n=r(662),i=r(679),a=r(664),o=r(681);function s(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"unknown"}}e.exports=function(e){var t=a(e);return n((function(e,r,n){"function"===typeof r&&(n=r,r={});try{e=o(e)}catch(a){if(!i.ipfsPath(e))return n(a)}t({path:"ls",args:e,qs:r},(function(t,r){if(t)return n(t);var i=r.Objects;return i?(i=i[0])?(i=i.Links,Array.isArray(i)?(i=i.map((function(t){return{name:t.Name,path:e+"/"+t.Name,size:t.Size,hash:t.Hash,type:s(t),depth:t.Depth||1}})),void n(null,i)):n(new Error("expected one array in results.Objects[0].Links"))):n(new Error("expected one array in results.Objects")):n(new Error("expected .Objects in results"))}))}))}},function(e){e.exports=JSON.parse('{"name":"ipfs-http-client","version":"33.1.1","description":"A client library for the IPFS HTTP API","keywords":["ipfs"],"homepage":"https://github.com/ipfs/js-ipfs-http-client","bugs":"https://github.com/ipfs/js-ipfs-http-client/issues","license":"MIT","leadMaintainer":"Alan Shaw <alan@tableflip.io>","files":["src","dist"],"main":"src/index.js","browser":{"glob":false,"fs":false,"stream":"readable-stream"},"repository":"github:ipfs/js-ipfs-http-client","scripts":{"test":"aegir test","test:node":"aegir test -t node","test:browser":"aegir test -t browser","test:webworker":"aegir test -t webworker","lint":"aegir lint","build":"aegir build","release":"aegir release ","release-minor":"aegir release --type minor ","release-major":"aegir release --type major ","coverage":"npx nyc -r html npm run test:node -- --bail"},"dependencies":{"async":"^2.6.1","bignumber.js":"^9.0.0","bl":"^3.0.0","bs58":"^4.0.1","buffer":"^5.2.1","cids":"~0.7.1","concat-stream":"github:hugomrdias/concat-stream#feat/smaller","debug":"^4.1.0","detect-node":"^2.0.4","end-of-stream":"^1.4.1","err-code":"^1.1.2","flatmap":"0.0.3","glob":"^7.1.3","ipfs-block":"~0.8.1","ipfs-utils":"~0.0.3","ipld-dag-cbor":"~0.15.0","ipld-dag-pb":"~0.17.3","ipld-raw":"^4.0.0","is-ipfs":"~0.6.1","is-pull-stream":"0.0.0","is-stream":"^2.0.0","iso-stream-http":"~0.1.2","iso-url":"~0.4.6","just-kebab-case":"^1.1.0","just-map-keys":"^1.1.0","kind-of":"^6.0.2","lru-cache":"^5.1.1","multiaddr":"^6.0.6","multibase":"~0.6.0","multicodec":"~0.5.1","multihashes":"~0.4.14","ndjson":"github:hugomrdias/ndjson#feat/readable-stream3","once":"^1.4.0","peer-id":"~0.12.2","peer-info":"~0.15.1","promisify-es6":"^1.0.3","pull-defer":"~0.2.3","pull-stream":"^3.6.9","pull-to-stream":"~0.1.1","pump":"^3.0.0","qs":"^6.5.2","readable-stream":"^3.1.1","stream-to-pull-stream":"^1.7.2","tar-stream":"^2.0.1","through2":"^3.0.1"},"devDependencies":{"aegir":"^19.0.3","browser-process-platform":"~0.1.1","chai":"^4.2.0","cross-env":"^5.2.0","dirty-chai":"^2.0.1","go-ipfs-dep":"~0.4.21","interface-ipfs-core":"^0.109.0","ipfsd-ctl":"~0.43.0","nock":"^10.0.2","stream-equal":"^1.1.1"},"engines":{"node":">=8.3.0","npm":">=3.0.0"},"contributors":["Alan Shaw <alan.shaw@protocol.ai>","Alan Shaw <alan@tableflip.io>","Alex Mingoia <talk@alexmingoia.com>","Alex Potsides <alex@achingbrain.net>","Antonio Tenorio-Forn\xe9s <antoniotenorio@ucm.es>","Bruno Barbieri <bbarbieri@delivery.com>","Clemo <flipflopsimsommer@users.noreply.github.com>","Connor Keenan <ckeenan89@gmail.com>","Danny <dannyid@protonmail.com>","David Braun <David.Braun@Toptal.com>","David Dias <daviddias.p@gmail.com>","Dietrich Ayala <autonome@gmail.com>","Diogo Silva <fsdiogo@gmail.com>","Dmitriy Ryajov <dryajov@gmail.com>","Dmitry Nikulin <dmitr-nikulin@mail.ru>","Donatas Stundys <donatas.stundys@necolt.com>","Fil <fil@rezo.net>","Filip \u0160 <filip.stamcar@hotmail.com>","Francisco Baio Dias <xicombd@gmail.com>","Friedel Ziegelmayer <dignifiedquire@gmail.com>","Gar <gar+gh@danger.computer>","Gavin McDermott <gavinmcdermott@gmail.com>","Gopalakrishna Palem <KrishnaPG@users.noreply.github.com>","Greenkeeper <support@greenkeeper.io>","Haad <haadcode@users.noreply.github.com>","Harlan T Wood <harlantwood@users.noreply.github.com>","Harlan T Wood <code@harlantwood.net>","Henrique Dias <hacdias@gmail.com>","Holodisc <holodiscent@gmail.com>","Hugo Dias <hugomrdias@gmail.com>","Hugo Dias <mail@hugodias.me>","JGAntunes <j.goncalo.antunes@gmail.com>","Jacob Heun <jacobheun@gmail.com>","James Halliday <substack@gmail.com>","Jason Carver <jacarver@linkedin.com>","Jason Papakostas <vith@users.noreply.github.com>","Jeff Downie <JeffDownie@users.noreply.github.com>","Jeromy <why@ipfs.io>","Jeromy <jeromyj@gmail.com>","Joe Turgeon <arithmetric@gmail.com>","Jonathan <jkrone@vt.edu>","Juan Batiz-Benet <juan@benet.ai>","Kevin Wang <kevin@fossa.io>","Kristoffer Str\xf6m <kristoffer@rymdkoloni.se>","Marcin Rataj <lidel@lidel.org>","Matt Bell <mappum@gmail.com>","Matt Ober <matt.ober3@gmail.com>","Maxime Lathuili\xe8re <k@maxlath.eu>","Michael Bradley <michaelsbradleyjr@gmail.com>","Michael Mur\xe9 <michael.mure@consensys.net>","Michael Mur\xe9 <batolettre@gmail.com>","Mikeal Rogers <mikeal.rogers@gmail.com>","Mitar <mitar.git@tnode.com>","Mithgol <getgit@mithgol.ru>","Mohamed Abdulaziz <mohamed@mohamedabdulaziz.com>","Nitin Patel <31539366+niinpatel@users.noreply.github.com>","Nuno Nogueira <nunofmn@gmail.com>","N\xedckolas Goline <nickolas.goline@gmail.com>","Oli Evans <oli@tableflip.io>","Orie Steele <orie@ohs.io>","Pedro Teixeira <i@pgte.me>","Pete Thomas <pete@xminusone.net>","Richard Littauer <richard.littauer@gmail.com>","Richard Schneider <makaretu@gmail.com>","Roman Khafizianov <requilence@gmail.com>","SeungWon <ksw3894@gmail.com>","Stephen Whitmore <stephen.whitmore@gmail.com>","Tara Vancil <tbvanc@gmail.com>","Teri Chadbourne <terichadbourne@users.noreply.github.com>","Travis Person <travis@protocol.ai>","Travis Person <travis.person@gmail.com>","Vasco Santos <vasco.santos@ua.pt>","Vasco Santos <vasco.santos@moxy.studio>","Victor Bjelkholm <victor@typeform.com>","Volker Mische <volker.mische@gmail.com>","Zhiyuan Lin <edsgerlin@gmail.com>","dirkmc <dirkmdev@gmail.com>","dmitriy ryajov <dryajov@dmitriys-MacBook-Pro.local>","elsehow <yes@cosmopol.is>","ethers <ethereum@outlook.com>","greenkeeper[bot] <greenkeeper[bot]@users.noreply.github.com>","haad <haad@headbanggames.com>","kumavis <kumavis@users.noreply.github.com>","leekt216 <leekt216@gmail.com>","nginnever <ginneversource@gmail.com>","noah the goodra <peterpan0413@live.com>","priecint <tp-dev@seznam.cz>","samuli <samuli@nugg.ad>","shunkin <hiyoko.san.ipod@gmail.com>","victorbjelkholm <victorbjelkholm@gmail.com>","\u0141ukasz Magiera <magik6k@users.noreply.github.com>","\u0141ukasz Magiera <magik6k@gmail.com>"]}')},function(e,t,r){"use strict";var n=r(1311),i=r(1321),a=r(824);e.exports={formats:a,parse:i,stringify:n}},function(e,t,r){"use strict";var n=r(1312),i=r(823),a=r(824),o=Object.prototype.hasOwnProperty,s={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},u=Array.isArray,l=Array.prototype.push,c=function(e,t){l.apply(e,u(t)?t:[t])},h=Date.prototype.toISOString,f=a.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:f,formatter:a.formatters[f],indices:!1,serializeDate:function(e){return h.call(e)},skipNulls:!1,strictNullHandling:!1},p=function e(t,r,a,o,s,l,h,f,p,y,v,m,g,_,b){var w,x=t;if(b.has(t))throw new RangeError("Cyclic object value");if("function"===typeof h?x=h(r,x):x instanceof Date?x=y(x):"comma"===a&&u(x)&&(x=i.maybeMap(x,(function(e){return e instanceof Date?y(e):e}))),null===x){if(o)return l&&!g?l(r,d.encoder,_,"key",v):r;x=""}if("string"===typeof(w=x)||"number"===typeof w||"boolean"===typeof w||"symbol"===typeof w||"bigint"===typeof w||i.isBuffer(x))return l?[m(g?r:l(r,d.encoder,_,"key",v))+"="+m(l(x,d.encoder,_,"value",v))]:[m(r)+"="+m(String(x))];var k,E=[];if("undefined"===typeof x)return E;if("comma"===a&&u(x))k=[{value:x.length>0?x.join(",")||null:void 0}];else if(u(h))k=h;else{var S=Object.keys(x);k=f?S.sort(f):S}for(var T=0;T<k.length;++T){var A=k[T],C="object"===typeof A&&void 0!==A.value?A.value:x[A];if(!s||null!==C){var I=u(x)?"function"===typeof a?a(r,A):r:r+(p?"."+A:"["+A+"]");b.set(t,!0);var R=n();c(E,e(C,I,a,o,s,l,h,f,p,y,v,m,g,_,R))}}return E};e.exports=function(e,t){var r,i=e,l=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!==typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=a.default;if("undefined"!==typeof e.format){if(!o.call(a.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=a.formatters[r],i=d.filter;return("function"===typeof e.filter||u(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"===typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:"undefined"===typeof e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:"undefined"===typeof e.delimiter?d.delimiter:e.delimiter,encode:"boolean"===typeof e.encode?e.encode:d.encode,encoder:"function"===typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"===typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:"function"===typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"===typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"===typeof e.sort?e.sort:null,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}}(t);"function"===typeof l.filter?i=(0,l.filter)("",i):u(l.filter)&&(r=l.filter);var h,f=[];if("object"!==typeof i||null===i)return"";h=t&&t.arrayFormat in s?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var y=s[h];r||(r=Object.keys(i)),l.sort&&r.sort(l.sort);for(var v=n(),m=0;m<r.length;++m){var g=r[m];l.skipNulls&&null===i[g]||c(f,p(i[g],g,y,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,v))}var _=f.join(l.delimiter),b=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),_.length>0?b+_:""}},function(e,t,r){"use strict";var n=r(821),i=r(1317),a=r(1319),o=n("%TypeError%"),s=n("%WeakMap%",!0),u=n("%Map%",!0),l=i("WeakMap.prototype.get",!0),c=i("WeakMap.prototype.set",!0),h=i("WeakMap.prototype.has",!0),f=i("Map.prototype.get",!0),d=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),y=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new o("Side channel does not contain "+a(e))},get:function(n){if(s&&n&&("object"===typeof n||"function"===typeof n)){if(e)return l(e,n)}else if(u){if(t)return f(t,n)}else if(r)return function(e,t){var r=y(e,t);return r&&r.value}(r,n)},has:function(n){if(s&&n&&("object"===typeof n||"function"===typeof n)){if(e)return h(e,n)}else if(u){if(t)return p(t,n)}else if(r)return function(e,t){return!!y(e,t)}(r,n);return!1},set:function(n,i){s&&n&&("object"===typeof n||"function"===typeof n)?(e||(e=new s),c(e,n,i)):u?(t||(t=new u),d(t,n,i)):(r||(r={key:{},next:null}),function(e,t,r){var n=y(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,i))}};return n}},function(e,t,r){"use strict";(function(t){var n=t.Symbol,i=r(1314);e.exports=function(){return"function"===typeof n&&("function"===typeof Symbol&&("symbol"===typeof n("foo")&&("symbol"===typeof Symbol("bar")&&i())))}}).call(this,r(22))},function(e,t,r){"use strict";e.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"===typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"===typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},function(e,t,r){"use strict";var n="Function.prototype.bind called on incompatible ",i=Array.prototype.slice,a=Object.prototype.toString,o="[object Function]";e.exports=function(e){var t=this;if("function"!==typeof t||a.call(t)!==o)throw new TypeError(n+t);for(var r,s=i.call(arguments,1),u=function(){if(this instanceof r){var n=t.apply(this,s.concat(i.call(arguments)));return Object(n)===n?n:this}return t.apply(e,s.concat(i.call(arguments)))},l=Math.max(0,t.length-s.length),c=[],h=0;h<l;h++)c.push("$"+h);if(r=Function("binder","return function ("+c.join(",")+"){ return binder.apply(this,arguments); }")(u),t.prototype){var f=function(){};f.prototype=t.prototype,r.prototype=new f,f.prototype=null}return r}},function(e,t,r){"use strict";var n=r(822);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(e,t,r){"use strict";var n=r(821),i=r(1318),a=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"===typeof r&&a(e,".prototype.")>-1?i(r):r}},function(e,t,r){"use strict";var n=r(822),i=r(821),a=i("%Function.prototype.apply%"),o=i("%Function.prototype.call%"),s=i("%Reflect.apply%",!0)||n.call(o,a),u=i("%Object.defineProperty%",!0);if(u)try{u({},"a",{value:1})}catch(c){u=null}e.exports=function(){return s(n,o,arguments)};var l=function(){return s(n,a,arguments)};u?u(e.exports,"apply",{value:l}):e.exports.apply=l},function(e,t,r){var n="function"===typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,a=n&&i&&"function"===typeof i.get?i.get:null,o=n&&Map.prototype.forEach,s="function"===typeof Set&&Set.prototype,u=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=s&&u&&"function"===typeof u.get?u.get:null,c=s&&Set.prototype.forEach,h="function"===typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,f="function"===typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d=Boolean.prototype.valueOf,p=Object.prototype.toString,y=Function.prototype.toString,v=String.prototype.match,m="function"===typeof BigInt?BigInt.prototype.valueOf:null,g=Object.getOwnPropertySymbols,_="function"===typeof Symbol?Symbol.prototype.toString:null,b=Object.prototype.propertyIsEnumerable,w=r(1320).custom,x=w&&T(w)?w:null;function k(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function E(e){return String(e).replace(/"/g,"&quot;")}function S(e){return"[object Array]"===I(e)}function T(e){return"[object Symbol]"===I(e)}e.exports=function e(t,r,n,i){var s=r||{};if(C(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(C(s,"maxStringLength")&&("number"===typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var u=!C(s,"customInspect")||s.customInspect;if("boolean"!==typeof u)throw new TypeError('option "customInspect", if provided, must be `true` or `false`');if(C(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if("undefined"===typeof t)return"undefined";if(null===t)return"null";if("boolean"===typeof t)return t?"true":"false";if("string"===typeof t)return M(t,s);if("number"===typeof t)return 0===t?1/0/t>0?"0":"-0":String(t);if("bigint"===typeof t)return String(t)+"n";var p="undefined"===typeof s.depth?5:s.depth;if("undefined"===typeof n&&(n=0),n>=p&&p>0&&"object"===typeof t)return S(t)?"[Array]":"[Object]";var g=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"===typeof e.indent&&e.indent>0))return null;r=Array(e.indent+1).join(" ")}return{base:r,prev:Array(t+1).join(r)}}(s,n);if("undefined"===typeof i)i=[];else if(R(i,t)>=0)return"[Circular]";function b(t,r,a){if(r&&(i=i.slice()).push(r),a){var o={depth:s.depth};return C(s,"quoteStyle")&&(o.quoteStyle=s.quoteStyle),e(t,o,n+1,i)}return e(t,s,n+1,i)}if("function"===typeof t){var w=function(e){if(e.name)return e.name;var t=v.call(y.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),A=N(t,b);return"[Function"+(w?": "+w:" (anonymous)")+"]"+(A.length>0?" { "+A.join(", ")+" }":"")}if(T(t)){var P=_.call(t);return"object"===typeof t?O(P):P}if(function(e){if(!e||"object"!==typeof e)return!1;if("undefined"!==typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"===typeof e.nodeName&&"function"===typeof e.getAttribute}(t)){for(var z="<"+String(t.nodeName).toLowerCase(),F=t.attributes||[],j=0;j<F.length;j++)z+=" "+F[j].name+"="+k(E(F[j].value),"double",s);return z+=">",t.childNodes&&t.childNodes.length&&(z+="..."),z+="</"+String(t.nodeName).toLowerCase()+">"}if(S(t)){if(0===t.length)return"[]";var U=N(t,b);return g&&!function(e){for(var t=0;t<e.length;t++)if(R(e[t],"\n")>=0)return!1;return!0}(U)?"["+B(U,g)+"]":"[ "+U.join(", ")+" ]"}if(function(e){return"[object Error]"===I(e)}(t)){var V=N(t,b);return 0===V.length?"["+String(t)+"]":"{ ["+String(t)+"] "+V.join(", ")+" }"}if("object"===typeof t&&u){if(x&&"function"===typeof t[x])return t[x]();if("function"===typeof t.inspect)return t.inspect()}if(function(e){if(!a||!e||"object"!==typeof e)return!1;try{a.call(e);try{l.call(e)}catch(z){return!0}return e instanceof Map}catch(t){}return!1}(t)){var q=[];return o.call(t,(function(e,r){q.push(b(r,t,!0)+" => "+b(e,t))})),D("Map",a.call(t),q,g)}if(function(e){if(!l||!e||"object"!==typeof e)return!1;try{l.call(e);try{a.call(e)}catch(t){return!0}return e instanceof Set}catch(r){}return!1}(t)){var G=[];return c.call(t,(function(e){G.push(b(e,t))})),D("Set",l.call(t),G,g)}if(function(e){if(!h||!e||"object"!==typeof e)return!1;try{h.call(e,h);try{f.call(e,f)}catch(z){return!0}return e instanceof WeakMap}catch(t){}return!1}(t))return L("WeakMap");if(function(e){if(!f||!e||"object"!==typeof e)return!1;try{f.call(e,f);try{h.call(e,h)}catch(z){return!0}return e instanceof WeakSet}catch(t){}return!1}(t))return L("WeakSet");if(function(e){return"[object Number]"===I(e)}(t))return O(b(Number(t)));if(function(e){return"[object BigInt]"===I(e)}(t))return O(b(m.call(t)));if(function(e){return"[object Boolean]"===I(e)}(t))return O(d.call(t));if(function(e){return"[object String]"===I(e)}(t))return O(b(String(t)));if(!function(e){return"[object Date]"===I(e)}(t)&&!function(e){return"[object RegExp]"===I(e)}(t)){var K=N(t,b);return 0===K.length?"{}":g?"{"+B(K,g)+"}":"{ "+K.join(", ")+" }"}return String(t)};var A=Object.prototype.hasOwnProperty||function(e){return e in this};function C(e,t){return A.call(e,t)}function I(e){return p.call(e)}function R(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function M(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return M(e.slice(0,t.maxStringLength),t)+n}return k(e.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,P),"single",t)}function P(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+t.toString(16).toUpperCase()}function O(e){return"Object("+e+")"}function L(e){return e+" { ? }"}function D(e,t,r,n){return e+" ("+t+") {"+(n?B(r,n):r.join(", "))+"}"}function B(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+e.join(","+r)+"\n"+t.prev}function N(e,t){var r=S(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=C(e,i)?t(e[i],e):""}for(var a in e)C(e,a)&&(r&&String(Number(a))===a&&a<e.length||(/[^\w$]/.test(a)?n.push(t(a,e)+": "+t(e[a],e)):n.push(a+": "+t(e[a],e))));if("function"===typeof g)for(var o=g(e),s=0;s<o.length;s++)b.call(e,o[s])&&n.push("["+t(o[s])+"]: "+t(e[o[s]],e));return n}},,function(e,t,r){"use strict";var n=r(823),i=Object.prototype.hasOwnProperty,a=Array.isArray,o={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},u=function(e,t){return e&&"string"===typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},l=function(e,t,r,n){if(e){var a=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,s=r.depth>0&&/(\[[^[\]]*])/.exec(a),l=s?a.slice(0,s.index):a,c=[];if(l){if(!r.plainObjects&&i.call(Object.prototype,l)&&!r.allowPrototypes)return;c.push(l)}for(var h=0;r.depth>0&&null!==(s=o.exec(a))&&h<r.depth;){if(h+=1,!r.plainObjects&&i.call(Object.prototype,s[1].slice(1,-1))&&!r.allowPrototypes)return;c.push(s[1])}return s&&c.push("["+a.slice(s.index)+"]"),function(e,t,r,n){for(var i=n?t:u(t,r),a=e.length-1;a>=0;--a){var o,s=e[a];if("[]"===s&&r.parseArrays)o=[].concat(i);else{o=r.plainObjects?Object.create(null):{};var l="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,c=parseInt(l,10);r.parseArrays||""!==l?!isNaN(c)&&s!==l&&String(c)===l&&c>=0&&r.parseArrays&&c<=r.arrayLimit?(o=[])[c]=i:o[l]=i:o={0:i}}i=o}return i}(c,t,r,n)}};e.exports=function(e,t){var r=function(e){if(!e)return o;if(null!==e.decoder&&void 0!==e.decoder&&"function"!==typeof e.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t="undefined"===typeof e.charset?o.charset:e.charset;return{allowDots:"undefined"===typeof e.allowDots?o.allowDots:!!e.allowDots,allowPrototypes:"boolean"===typeof e.allowPrototypes?e.allowPrototypes:o.allowPrototypes,allowSparse:"boolean"===typeof e.allowSparse?e.allowSparse:o.allowSparse,arrayLimit:"number"===typeof e.arrayLimit?e.arrayLimit:o.arrayLimit,charset:t,charsetSentinel:"boolean"===typeof e.charsetSentinel?e.charsetSentinel:o.charsetSentinel,comma:"boolean"===typeof e.comma?e.comma:o.comma,decoder:"function"===typeof e.decoder?e.decoder:o.decoder,delimiter:"string"===typeof e.delimiter||n.isRegExp(e.delimiter)?e.delimiter:o.delimiter,depth:"number"===typeof e.depth||!1===e.depth?+e.depth:o.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof e.interpretNumericEntities?e.interpretNumericEntities:o.interpretNumericEntities,parameterLimit:"number"===typeof e.parameterLimit?e.parameterLimit:o.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"===typeof e.plainObjects?e.plainObjects:o.plainObjects,strictNullHandling:"boolean"===typeof e.strictNullHandling?e.strictNullHandling:o.strictNullHandling}}(t);if(""===e||null===e||"undefined"===typeof e)return r.plainObjects?Object.create(null):{};for(var c="string"===typeof e?function(e,t){var r,l={},c=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,h=t.parameterLimit===1/0?void 0:t.parameterLimit,f=c.split(t.delimiter,h),d=-1,p=t.charset;if(t.charsetSentinel)for(r=0;r<f.length;++r)0===f[r].indexOf("utf8=")&&("utf8=%E2%9C%93"===f[r]?p="utf-8":"utf8=%26%2310003%3B"===f[r]&&(p="iso-8859-1"),d=r,r=f.length);for(r=0;r<f.length;++r)if(r!==d){var y,v,m=f[r],g=m.indexOf("]="),_=-1===g?m.indexOf("="):g+1;-1===_?(y=t.decoder(m,o.decoder,p,"key"),v=t.strictNullHandling?null:""):(y=t.decoder(m.slice(0,_),o.decoder,p,"key"),v=n.maybeMap(u(m.slice(_+1),t),(function(e){return t.decoder(e,o.decoder,p,"value")}))),v&&t.interpretNumericEntities&&"iso-8859-1"===p&&(v=s(v)),m.indexOf("[]=")>-1&&(v=a(v)?[v]:v),i.call(l,y)?l[y]=n.combine(l[y],v):l[y]=v}return l}(e,r):e,h=r.plainObjects?Object.create(null):{},f=Object.keys(c),d=0;d<f.length;++d){var p=f[d],y=l(p,c[p],r,"string"===typeof e);h=n.merge(h,y,r)}return!0===r.allowSparse?h:n.compact(h)}},function(e,t,r){(function(t){var n=r(1323).Transform,i=r(14);function a(e){n.call(this,e),this._destroyed=!1}function o(e,t,r){r(null,e)}function s(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=o),"function"!=typeof n&&(n=null),e(t,r,n)}}i(a,n),a.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var r=this;t.nextTick((function(){e&&r.emit("error",e),r.emit("close")}))}},e.exports=s((function(e,t,r){var n=new a(e);return n._transform=t,r&&(n._flush=r),n})),e.exports.ctor=s((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=Object.assign({},e,t),a.call(this,this.options)}return i(n,a),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),e.exports.obj=s((function(e,t,r){var n=new a(Object.assign({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this,r(21))},function(e,t,r){(t=e.exports=r(953)).Stream=t,t.Readable=t,t.Writable=r(957),t.Duplex=r(719),t.Transform=r(958),t.PassThrough=r(1329),t.finished=r(826),t.pipeline=r(1330)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1326).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(826),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(958);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(718).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(826)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t,r){"use strict";var n=r(1332).Transform,i=r(66).StringDecoder,a=Symbol("last"),o=Symbol("decoder");function s(e,t,r){var n;if(this.overflow){if(1===(n=this[o].write(e).split(this.matcher)).length)return r();n.shift(),this.overflow=!1}else this[a]+=this[o].write(e),n=this[a].split(this.matcher);this[a]=n.pop();for(var i=0;i<n.length;i++)try{l(this,this.mapper(n[i]))}catch(s){return r(s)}if(this.overflow=this[a].length>this.maxLength,this.overflow&&!this.skipOverflow)return r(new Error("maximum buffer reached"));r()}function u(e){if(this[a]+=this[o].end(),this[a])try{l(this,this.mapper(this[a]))}catch(t){return e(t)}e()}function l(e,t){void 0!==t&&e.push(t)}function c(e){return e}e.exports=function(e,t,r){switch(e=e||/\r?\n/,t=t||c,r=r||{},arguments.length){case 1:"function"===typeof e?(t=e,e=/\r?\n/):"object"!==typeof e||e instanceof RegExp||(r=e,e=/\r?\n/);break;case 2:"function"===typeof e?(r=t,t=e,e=/\r?\n/):"object"===typeof t&&(r=t,t=c)}(r=Object.assign({},r)).transform=s,r.flush=u,r.readableObjectMode=!0;var l=new n(r);return l[a]="",l[o]=new i("utf8"),l.matcher=e,l.mapper=t,l.maxLength=r.maxLength,l.skipOverflow=r.skipOverflow,l.overflow=!1,l}},function(e,t,r){(t=e.exports=r(959)).Stream=t,t.Readable=t,t.Writable=r(963),t.Duplex=r(721),t.Transform=r(964),t.PassThrough=r(1338),t.finished=r(827),t.pipeline=r(1339)},,function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var o=r(10).Buffer,s=r(1335).inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,r,l;return t=e,(r=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return o.alloc(0);for(var t,r,n,i=o.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=i,n=s,o.prototype.copy.call(t,r,n),s+=a.data.length,a=a.next;return i}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,n=t.data;for(e-=n.length;t=t.next;){var i=t.data,a=e>i.length?i.length:e;if(a===i.length?n+=i:n+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(a));break}++r}return this.length-=r,n}},{key:"_getBuffer",value:function(e){var t=o.allocUnsafe(e),r=this.head,n=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,a),0===(e-=a)){a===i.length?(++n,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=i.slice(a));break}++n}return this.length-=n,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}])&&a(t.prototype,r),l&&a(t,l),e}()},,function(e,t,r){"use strict";(function(t){var n;function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(827),o=Symbol("lastResolve"),s=Symbol("lastReject"),u=Symbol("error"),l=Symbol("ended"),c=Symbol("lastPromise"),h=Symbol("handlePromise"),f=Symbol("stream");function d(e,t){return{value:e,done:t}}function p(e){var t=e[o];if(null!==t){var r=e[f].read();null!==r&&(e[c]=null,e[o]=null,e[s]=null,t(d(r,!1)))}}function y(e){t.nextTick(p,e)}var v=Object.getPrototypeOf((function(){})),m=Object.setPrototypeOf((i(n={get stream(){return this[f]},next:function(){var e=this,r=this[u];if(null!==r)return Promise.reject(r);if(this[l])return Promise.resolve(d(void 0,!0));if(this[f].destroyed)return new Promise((function(r,n){t.nextTick((function(){e[u]?n(e[u]):r(d(void 0,!0))}))}));var n,i=this[c];if(i)n=new Promise(function(e,t){return function(r,n){e.then((function(){t[l]?r(d(void 0,!0)):t[h](r,n)}),n)}}(i,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(d(a,!1));n=new Promise(this[h])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,r){e[f].destroy(null,(function(e){e?r(e):t(d(void 0,!0))}))}))})),n),v);e.exports=function(e){var t,r=Object.create(m,(i(t={},f,{value:e,writable:!0}),i(t,o,{value:null,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var n=r[f].read();n?(r[c]=null,r[o]=null,r[s]=null,e(d(n,!1))):(r[o]=e,r[s]=t)},writable:!0}),t));return r[c]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=r[s];return null!==t&&(r[c]=null,r[o]=null,r[s]=null,t(e)),void(r[u]=e)}var n=r[o];null!==n&&(r[c]=null,r[o]=null,r[s]=null,n(d(void 0,!0))),r[l]=!0})),e.on("readable",y.bind(null,r)),r}}).call(this,r(21))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,r){"use strict";e.exports=i;var n=r(964);function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r(14)(i,n),i.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var n;var i=r(720).codes,a=i.ERR_MISSING_ARGS,o=i.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,i,a){a=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(a);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=r(827)),n(e,{readable:t,writable:i},(function(e){if(e)return a(e);s=!0,a()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void a(t||new o("pipe"))}}function l(e){e()}function c(e,t){return e.pipe(t)}function h(e){return e.length?"function"!==typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n,i=h(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new a("streams");var o=t.map((function(e,r){var a=r<t.length-1;return u(e,a,r>0,(function(e){n||(n=e),e&&o.forEach(l),a||(o.forEach(l),i(n))}))}));return t.reduce(c)}},function(e,t){function r(e,t){var r=[],n=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+n.slice(0,r.indexOf(t)).join(".")+"]"}),function(i,a){if(r.length>0){var o=r.indexOf(this);~o?r.splice(o+1):r.push(this),~o?n.splice(o,1/0,i):n.push(i),~r.indexOf(a)&&(a=t.call(this,i,a))}else r.push(a);return null==e?a:e.call(this,i,a)}}(e.exports=function(e,t,n,i){return JSON.stringify(e,r(t,i),n)}).getSerialize=r},function(e,t,r){"use strict";(function(t){var n=r(698);e.exports=function(e,r){n(e,(function(e,n){if(e)return r(e);if(!n||0===n.length)return r();var i;t.isBuffer(n)&&(n=n.toString());try{i=JSON.parse(n)}catch(e){return r(new Error("Invalid JSON: ".concat(n)))}r(null,i)}))}}).call(this,r(10).Buffer)},function(e,t,r){(function(n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!==typeof n&&"env"in n&&(e=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_RECAPTCHA_TOKEN:"6Lest7wbAAAAAPRzQ2ZGU-w_O9v-gbnw3fK1l98u",REACT_APP_MAP_TOKEN:"pk.eyJ1IjoibWljaGFlbDEwIiwiYSI6ImNrcndxejR4ZjA1Nmcydm5vNzM4YTdsdWIifQ.bGHbfUZ1juBxAL55eGMSnA",REACT_APP_API_URL:"https://api.testleekdao.xyz/",REACT_APP_LOTTERY_OWNER:"0xB232D899b39Ee282EC26BBA385497b9FCD150ED3",REACT_APP_API_USERNAME:"leekdao",REACT_APP_NODE_1:"https://rpc-mumbai.maticvigil.com/",REACT_APP_NODE_3:"https://rpc-mumbai.matic.today/",REACT_APP_NODE_2:"https://polygon-mumbai.infura.io/v3/cddf815255c54292a6d96f68893e8034",REACT_APP_CHAIN_ID:"80001",REACT_APP_API_PASSWORD:"LuckyDraw!123"}).DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(1343)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,r(21))},function(e,t,r){var n=r(317);e.exports=function(e){function t(e){var r,n=null;function a(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(a.enabled){var o=a,s=Number(new Date),u=s-(r||s);o.diff=u,o.prev=r,o.curr=s,r=s,n[0]=t.coerce(n[0]),"string"!==typeof n[0]&&n.unshift("%O");var l=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";l++;var i=t.formatters[r];if("function"===typeof i){var a=n[l];e=i.call(o,a),n.splice(l,1),l--}return e})),t.formatArgs.call(o,n);var c=o.log||t.log;c.apply(o,n)}}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=i,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:function(){return null===n?t.enabled(e):n},set:function(e){n=e}}),"function"===typeof t.init&&t.init(a),a}function i(e,r){var n=t(this.namespace+("undefined"===typeof r?":":r)+e);return n.log=this.log,n}function a(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(a)),n(t.skips.map(a).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.names=[],t.skips=[];var n=("string"===typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(1344),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var r=1e3,n=60*r,i=60*n,a=24*i,o=7*a,s=365.25*a;function u(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,t){t=t||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var u=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*a;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*n;case"seconds":case"second":case"secs":case"sec":case"s":return u*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===l&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=a)return u(e,t,a,"day");if(t>=i)return u(e,t,i,"hour");if(t>=n)return u(e,t,n,"minute");if(t>=r)return u(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=a)return Math.round(e/a)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"use strict";var n=r(664),i=r(672),a=r(679),o=r(681);function s(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"unknown"}}e.exports=function(e){var t=n(e);return function(e,r,n){"function"===typeof r&&(n=r,r={});try{e=o(e)}catch(l){if(!a.ipfsPath(e))return n(l)}var u=new i.PassThrough({objectMode:!0});return t({path:"ls",args:e,qs:r},(function(t,r){if(t)return n(t);var i=r.Objects;return i?(i=i[0])?(i=i.Links,Array.isArray(i)?((i=i.map((function(t){return{depth:1,name:t.Name,path:e+"/"+t.Name,size:t.Size,hash:t.Hash,type:s(t)}}))).forEach((function(e){return u.write(e)})),void u.end()):n(new Error("expected one array in results.Objects[0].Links"))):n(new Error("expected one array in results.Objects")):n(new Error("expected .Objects in results"))})),u}}},function(e,t,r){"use strict";var n=r(664),i=r(768),a=r(689),o=r(679),s=r(681);function u(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"unknown"}}e.exports=function(e){var t=n(e);return function(e,r,n){"function"===typeof r&&(n=r,r={});try{e=s(e)}catch(c){if(!o.ipfsPath(e))return n(c)}var l=a.source();return t({path:"ls",args:e,qs:r},(function(t,r){if(t)return n(t);var a=r.Objects;return a?(a=a[0])?(a=a.Links,Array.isArray(a)?(a=a.map((function(t){return{depth:1,name:t.Name,path:e+"/"+t.Name,size:t.Size,hash:t.Hash,type:u(t)}})),void l.resolve(i(a))):n(new Error("expected one array in results.Objects[0].Links"))):n(new Error("expected one array in results.Objects")):n(new Error("expected .Objects in results"))})),l}}},function(e,t,r){"use strict";var n=r(662),i=r(722),a=r(664);e.exports=function(e){var t=a(e);return n((function(e,r){"function"===typeof e&&(r=e,e={});var n=function(e,t){t(null,e.map((function(e){return{ref:e.Ref,err:e.Err}})))};t({path:"refs/local",qs:e},(function(e,t){if(e)return r(e);i(t,n,r)}))}))}},function(e,t,r){"use strict";var n=r(672),i=r(675),a=r(819);e.exports=function(e){return function(t){t=t||{};var r=new n.PassThrough({objectMode:!0});return e({path:"refs/local",qs:t},(function(e,t){if(e)return r.destroy(e);t.once("error",(function(e){return r.destroy(e)})),i(t,a.obj((function(e,t,r){r(null,{ref:e.Ref,err:e.Err})})),r)})),r}}},function(e,t,r){"use strict";var n=r(966),i=r(683),a=r(689),o=r(664);e.exports=function(e){return e=o(e),function(t){t=t||{};var r=a.source();return e({path:"refs/local",qs:t},(function(e,t){if(e)return r.resolve(n.error(e));r.resolve(n(i.source(t),n.map((function(e){return{ref:e.Ref,err:e.Err}}))))})),r}}},function(e,t,r){"use strict";e.exports={keys:r(1351),once:r(967),values:r(768),count:r(1352),infinite:r(1353),empty:r(1354),error:r(1355)}},function(e,t,r){"use strict";var n=r(768);e.exports=function(e){return n(Object.keys(e))}},function(e,t,r){"use strict";e.exports=function(e){var t=0;return e=e||1/0,function(r,n){return r?n&&n(r):t>e?n(!0):void n(null,t++)}}},function(e,t,r){"use strict";e.exports=function(e){return e=e||Math.random,function(t,r){return t?r&&r(t):r(null,e())}}},function(e,t,r){"use strict";e.exports=function(){return function(e,t){t(!0)}}},function(e,t,r){"use strict";e.exports=function(e){return function(t,r){r(e)}}},function(e,t,r){"use strict";e.exports={drain:r(749),onEnd:r(1357),log:r(1358),find:r(1359),reduce:r(829),collect:r(1360),concat:r(1361)}},function(e,t,r){"use strict";var n=r(749);e.exports=function(e){return n(null,e)}},function(e,t,r){"use strict";var n=r(749);e.exports=function(e){return n((function(e){console.log(e)}),e)}},function(e,t,r){"use strict";function n(e){return e}var i=r(748),a=r(749);e.exports=function(e,t){var r=!1;return t?e=i(e)||n:(t=e,e=n),a((function(n){if(e(n))return r=!0,t(null,n),!1}),(function(e){r||t(!0===e?null:e,null)}))}},function(e,t,r){"use strict";var n=r(829);e.exports=function(e){return n((function(e,t){return e.push(t),e}),[],e)}},function(e,t,r){"use strict";var n=r(829);e.exports=function(e){return n((function(e,t){return e+t}),"",e)}},function(e,t,r){"use strict";e.exports={map:r(820),asyncMap:r(1363),filter:r(830),filterNot:r(1364),through:r(1365),take:r(1366),unique:r(969),nonUnique:r(1367),flatten:r(1368)}},function(e,t,r){"use strict";function n(e){return e}var i=r(748);e.exports=function(e){if(!e)return n;e=i(e);var t,r,a=!1;return function(n){return function i(o,s){if(r)return s(r);o?(r=o,n(o,a?function(e){a?t=s:s(o)}:function(e){s(o)})):n(null,(function(n,o){n?s(n):r?s(r):(a=!0,e(o,(function(e,n){a=!1,r?(s(r),t&&t(r)):e?i(e,s):s(null,n)})))}))}}}},function(e,t,r){"use strict";var n=r(968),i=r(830);e.exports=function(e){return e=n(e),i((function(t){return!e(t)}))}},function(e,t,r){"use strict";e.exports=function(e,t){var r=!1;function n(e){!r&&t&&(r=!0,t(!0===e?null:e))}return function(t){return function(r,i){return r&&n(r),t(r,(function(t,r){t?n(t):e&&e(r),i(t,r)}))}}}},function(e,t,r){"use strict";e.exports=function(e,t){var r=(t=t||{}).last||!1,n=!1;if("number"===typeof e){r=!0;var i=e;e=function(){return--i}}return function(t){function i(e){t(!0,(function(t){r=!1,e(t||!0)}))}return function(a,o){n&&!a?r?i(o):o(n):(n=a)?t(n,o):t(null,(function(t,a){(n=n||t)?o(n):e(a)?o(null,a):(n=!0,r?o(null,a):i(o))}))}}}},function(e,t,r){"use strict";var n=r(969);e.exports=function(e){return n(e,!0)}},function(e,t,r){"use strict";var n=r(768),i=r(967);e.exports=function(){return function(e){var t;return function(r,a){function o(){t(null,(function(t,r){!0===t?s():t?e(!0,(function(e){a(t)})):a(null,r)}))}function s(){t=null,e(null,(function(e,r){if(e)return a(e);Array.isArray(r)||r&&"object"===typeof r?r=n(r):"function"!=typeof r&&(r=i(r)),t=r,o()}))}r?t?t(r,(function(t){e(t||r,a)})):e(r,a):t?o():s()}}}},function(e,t,r){"use strict";var n=r(672),i=r(675),a=r(819),o=r(828),s=o.checkArgs,u=o.normalizeOpts;e.exports=function(e){return function(t,r){r=u(r);var o=new n.PassThrough({objectMode:!0});try{t=s(t)}catch(l){return o.destroy(l)}return e({path:"refs",args:t,qs:r},(function(e,t){if(e)return o.destroy(e);t.once("error",(function(e){return o.destroy(e)})),i(t,a.obj((function(e,t,r){r(null,{ref:e.Ref,err:e.Err})})),o)})),o}}},function(e,t,r){"use strict";var n=r(966),i=r(683),a=r(689),o=r(664),s=r(828),u=s.checkArgs,l=s.normalizeOpts;e.exports=function(e){return e=o(e),function(t,r){r=l(r);var o=a.source();try{t=u(t)}catch(s){return o.end(s)}return e({path:"refs",args:t,qs:r},(function(e,t){if(e)return o.resolve(n.error(e));o.resolve(n(i.source(t),n.map((function(e){return{ref:e.Ref,err:e.Err}}))))})),o}}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{cp:r(1372)(t),mkdir:r(1373)(t),flush:r(1374)(t),stat:r(1375)(t),rm:r(1378)(t),ls:r(1379)(t),lsReadableStream:r(971)(t),lsPullStream:r(1380)(t),read:r(1381)(t),readReadableStream:r(1382)(t),readPullStream:r(1383)(t),write:r(1384)(t),mv:r(1385)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(970);e.exports=function(e){return n((function(){var t=i(Array.prototype.slice.call(arguments)),r=t.callback,n=t.sources,a=t.opts;e({path:"files/cp",args:n,qs:a},(function(e){return r(e)}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e({path:"files/mkdir",args:t,qs:r},(function(e){return n(e)}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r){return"function"===typeof t&&(r=t,t="/"),e({path:"files/flush",args:t},(function(e){return r(e)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(1376),a=r(1377),o=function(e,t){t(null,{type:e.Type,blocks:e.Blocks,size:e.Size,hash:e.Hash,cumulativeSize:e.CumulativeSize,withLocality:e.WithLocality||!1,local:e.Local||void 0,sizeLocal:e.SizeLocal||void 0})};e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),r=i(r,(function(e,t){return a(t)})),e.andTransform({path:"files/stat",args:t,qs:r},o,n)}))}},function(e,t){e.exports=function(e,t){for(var r={},n=Object.keys(e),i=n.length,a=0;a<i;a++){var o=n[a],s=e[o],u=t(s,o,e);r[u]=s}return r}},function(e,t){e.exports=function(e){return(e=e.replace(n,(function(e){return" "+(e.toLowerCase()||e)}))).trim().split(r).join("-")};var r=/[\s\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~]+/,n=/[A-Z\u00C0-\u00D6\u00D9-\u00DD]/g},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),e({path:"files/rm",args:t,qs:r},(function(e){return n(e)}))}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,(e.Entries||[]).map((function(e){return{name:e.Name,type:e.Type,size:e.Size,hash:e.Hash}})))};e.exports=function(e){return n((function(t,r,n){return"function"===typeof r&&(n=r,r={}),"function"===typeof t&&(n=t,r={},t=null),e.andTransform({path:"files/ls",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";var n=r(683),i=r(971);e.exports=function(e){return function(t,r){return r=r||{},n.source(i(e)(t,r))}}},function(e,t,r){"use strict";var n=r(662),i=r(698);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e.andTransform({path:"files/read",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";var n=r(672),i=r(675);e.exports=function(e){return function(t,r){r=r||{};var a=new n.PassThrough;return e({path:"files/read",args:t,qs:r},(function(e,t){if(e)return a.destroy(e);i(t,a)})),a}}},function(e,t,r){"use strict";var n=r(683),i=r(689);e.exports=function(e){return function(t,r){r=r||{};var a=i.source();return e({path:"files/read",args:t,qs:r},(function(e,t){if(e)return a.abort(e);a.resolve(n(t))})),a}}},function(e,t,r){"use strict";var n=r(662),i=r(744),a=r(680),o=r(707),s=r(745);e.exports=function(e){var t=s(e,"files/write");return n((function(e,r,n,s){"function"!==typeof n||s||(s=n,n={}),"function"===typeof n&&"function"===typeof s&&(s=n,n={});var u=[].concat(r),l=a(s),c=t({qs:{args:e,qs:n,converter:o}}),h=i((function(e){return l(null,e)}));c.once("error",l),c.pipe(h),u.forEach((function(e){return c.write(e)})),c.end()}))}},function(e,t,r){"use strict";var n=r(662),i=r(970);e.exports=function(e){return n((function(){var t=i(Array.prototype.slice.call(arguments)),r=t.callback,n=t.sources,a=t.opts;e({path:"files/mv",args:n,qs:a},(function(e){return r(e)}))}))}},function(e,t,r){"use strict";(function(t){var n=r(662),i=r(973),a=r(168),o=r(698);e.exports=function(e){return n((function(r,n,s){var u;"function"===typeof n&&(s=n,n={});try{if(a.isCID(r))r=(u=r).toBaseEncodedString();else if(t.isBuffer(r))r=(u=new a(r)).toBaseEncodedString();else{if("string"!==typeof r)return s(new Error("invalid argument"));u=new a(r)}}catch(c){return s(c)}var l={path:"block/get",args:r,qs:n};e.andTransform(l,(function(e,r){t.isBuffer(e)?r(null,new i(e,u)):Array.isArray(e)&&0===e.length?r(null,new i(t.alloc(0),u)):o(e,(function(e,n){if(e)return r(e);n.length||(n=t.alloc(0)),r(null,new i(n,u))}))}),s)}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(662),i=r(168),a=r(127);e.exports=function(e){return n((function(t,r,n){t&&i.isCID(t)&&(t=a.toB58String(t.multihash)),"function"===typeof r&&(n=r,r={});var o={path:"block/stat",args:t,qs:r};e.andTransform(o,(function(e,t){t(null,{key:e.Key,size:e.Size})}),n)}))}},function(e,t,r){"use strict";(function(t){var n=r(662),i=r(973),a=r(168),o=r(127),s=r(723);e.exports=function(e){var r=s(e,"block/put");return n((function(e,n,s){if("function"===typeof n&&(s=n,n={}),n=n||{},Array.isArray(e))return s(new Error("block.put accepts only one block"));if(t.isBuffer(e)&&(e={data:e}),!e||!e.data)return s(new Error("invalid block arg"));var u={};if(e.cid||n.cid){var l;try{l=new a(e.cid||n.cid)}catch(d){return s(d)}var c=o.decode(l.multihash),h=c.name,f=c.length;u.format=l.codec,u.mhtype=h,u.mhlen=f,u.version=l.version}else n.format&&(u.format=n.format),n.mhtype&&(u.mhtype=n.mhtype),n.mhlen&&(u.mhlen=n.mhlen),null!=n.version&&(u.version=n.version);r(e.data,{qs:u},(function(t,n){if(t)return"dag-pb"===u.format||"dag-cbor"===u.format?(u.format="dag-pb"===u.format?"protobuf":"cbor",r(e.data,{qs:u},(function(t,r){if(t)return s(t);s(null,new i(e.data,new a(r.Key)))}))):s(t);s(null,new i(e.data,new a(n.Key)))}))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{wantlist:r(1390)(t),stat:r(1391)(t),unwant:r(1392)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n){if("function"===typeof t?(n=t,r={},t=null):"function"===typeof r&&(n=r,r={}),t)try{r.peer=new i(t).toBaseEncodedString()}catch(a){return n(a)}e({path:"bitswap/wantlist",qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662),i=r(12),a=function(e,t){t(null,{provideBufLen:e.ProvideBufLen,wantlist:e.Wantlist||[],peers:e.Peers||[],blocksReceived:new i(e.BlocksReceived),dataReceived:new i(e.DataReceived),blocksSent:new i(e.BlocksSent),dataSent:new i(e.DataSent),dupBlksReceived:new i(e.DupBlksReceived),dupDataReceived:new i(e.DupDataReceived)})};e.exports=function(e){return n((function(t){e.andTransform({path:"bitswap/stat"},a,t)}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={});try{t=new i(t)}catch(a){return n(a)}e({path:"bitswap/unwant",args:t.toBaseEncodedString(),qs:r},n)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{get:r(1394)(t),put:r(1437)(t)}}},function(e,t,r){"use strict";var n=r(750),i=r(978),a=r(1436),o=r(662),s=r(168),u=r(901),l=r(972),c={"dag-cbor":i.resolver,"dag-pb":n.resolver,raw:a.resolver};e.exports=function(e){return o((function(t,r,n,i){"function"===typeof r&&(i=r,r=void 0),"function"===typeof n&&(i=n,n={}),n=n||{},r=r||"",s.isCID(t)&&(t=t.toBaseEncodedString()),u([function(i){e({path:"dag/resolve",args:t+"/"+r,qs:n},i)},function(t,r){l(e).get(new s(t.Cid["/"]),(function(e,n){r(e,n,t.RemPath)}))},function(e,t,r){var n,i=c[e.cid.codec];if(!i){var a=new Error('Missing IPLD format "'.concat(e.cid.codec,'"'));return a.missingMulticodec=e.cid.codec,r(a)}try{n=i.resolve(e.data,t)}catch(o){return r(o)}r(null,n)}],i)}))}},function(e,t,r){"use strict";var n=r(317);e.exports=function(e,t,r){[""].concat(n(Object.keys(e))).includes(t)||Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){return e._links[r].Hash}})}},function(e,t,r){e.exports=function(){"use strict";var e=function(e,r){return t(e.slice(),r)};function t(e,t){"function"!==typeof t&&(t=function(e,t){return String(e).localeCompare(t)});var n=e.length;if(n<=1)return e;for(var i=new Array(n),a=1;a<n;a*=2){r(e,t,a,i);var o=e;e=i,i=o}return e}e.inplace=function(e,n){var i=t(e,n);return i!==e&&r(i,null,e.length,e),e};var r=function(e,t,r,n){var i,a,o,s,u,l=e.length,c=0,h=2*r;for(i=0;i<l;i+=h)for(o=(a=i+r)+r,a>l&&(a=l),o>l&&(o=l),s=i,u=a;;)if(s<a&&u<o)t(e[s],e[u])<=0?n[c++]=e[s++]:n[c++]=e[u++];else if(s<a)n[c++]=e[s++];else{if(!(u<o))break;n[c++]=e[u++]}};return e}()},function(e,t,r){"use strict";e.exports="// An IPFS MerkleDAG Link\nmessage PBLink {\n\n  // multihash of the target object\n  optional bytes Hash = 1;\n\n  // utf string name. should be unique per object\n  optional string Name = 2;\n\n  // cumulative size of target object\n  optional uint64 Tsize = 3;\n}\n\n// An IPFS MerkleDAG Node\nmessage PBNode {\n\n  // refs to other objects\n  repeated PBLink Links = 2;\n\n  // opaque user data\n  optional bytes Data = 1;\n}"},function(e,t,r){"use strict";var n=r(724);e.exports.createDagLinkFromB58EncodedHash=function(e){return new n(e.Name||e.name||"",e.Tsize||e.Size||e.size||0,e.Hash||e.hash||e.multihash||e.cid)}},function(e,t,r){"use strict";(function(n){var i=r(91),a=r(1400),o=r(1401),s=r(975);(t=e.exports).addPrefix=function(e,t){var r;if(n.isBuffer(e))r=s.varintBufferEncode(e);else{if(!o[e])throw new Error("multicodec not recognized");r=o[e]}return n.concat([r,t])},t.rmPrefix=function(e){return i.decode(e),e.slice(i.decode.bytes)},t.getCodec=function(e){var t=i.decode(e),r=a.get(t);if(void 0===r)throw new Error("Code ".concat(t," not found"));return r},t.getName=function(e){return a.get(e)},t.getNumber=function(e){var t=o[e];if(void 0===t)throw new Error("Codec `"+e+"` not found");return s.varintBufferDecode(t)[0]},t.getCode=function(e){return i.decode(e)},t.getCodeVarint=function(e){var t=o[e];if(void 0===t)throw new Error("Codec `"+e+"` not found");return t},t.getVarint=function(e){return i.encode(e)};var u=r(1402);Object.assign(t,u),t.print=r(1403)}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(772),i=new Map;for(var a in n){var o=n[a];i.set(o,a)}e.exports=Object.freeze(i)},function(e,t,r){"use strict";var n=r(772),i=r(975).varintEncode,a={};for(var o in n){var s=n[o];a[o]=i(s)}e.exports=Object.freeze(a)},function(e,t,r){"use strict";for(var n=r(92),i=r(772),a={},o=0,s=Object.entries(i);o<s.length;o++){var u=n(s[o],2),l=u[0],c=u[1];a[l.toUpperCase().replace(/-/g,"_")]=c}e.exports=Object.freeze(a)},function(e,t,r){"use strict";for(var n=r(92),i=r(772),a={},o=0,s=Object.entries(i);o<s.length;o++){var u=n(s[o],2),l=u[0],c=u[1];void 0===a[c]&&(a[c]=l)}e.exports=Object.freeze(a)},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(976),s=r(127),u=r(1405);function l(e,t,r){return c.apply(this,arguments)}function c(){return(c=i(n.mark((function e(t,r,i){var a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.digest(t,r,i);case 2:return a=e.sent,e.abrupt("return",s.encode(a,r,i));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l.Buffer=a,l.multihash=s,l.digest=function(){var e=i(n.mark((function e(t,r,i){var a,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.createHash(r),e.next=3,a(t);case 3:return o=e.sent,e.abrupt("return",i?o.slice(0,i):o);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),l.createHash=function(e){if(!e)throw o("hash algorithm must be specified","ERR_HASH_ALGORITHM_NOT_SPECIFIED");if(e=s.coerceCode(e),!l.functions[e])throw o("multihash function '".concat(e,"' not yet supported"),"ERR_HASH_ALGORITHM_NOT_SUPPORTED");return l.functions[e]},l.functions={17:u.sha1,18:u.sha2256,19:u.sha2512,20:u.sha3512,21:u.sha3384,22:u.sha3256,23:u.sha3224,24:u.shake128,25:u.shake256,26:u.keccak224,27:u.keccak256,28:u.keccak384,29:u.keccak512,34:u.murmur3128,35:u.murmur332,86:u.dblSha2256},u.addBlake(l.functions),l.validate=function(){var e=i(n.mark((function e(t,r){var i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t,s.decode(r).name);case 2:return i=e.sent,e.abrupt("return",0===a.compare(r,i));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),e.exports=l},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(315),s=r(977),u=r(1407),l=r(1408).fromNumberTo32BitBuf,c=function(e){return function(){var t=i(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="sha3-224"===t.t0?3:"sha3-256"===t.t0?4:"sha3-384"===t.t0?5:"sha3-512"===t.t0?6:"shake-128"===t.t0?7:"shake-256"===t.t0?8:"keccak-224"===t.t0?9:"keccak-256"===t.t0?10:"keccak-384"===t.t0?11:"keccak-512"===t.t0?12:"murmur3-128"===t.t0?13:"murmur3-32"===t.t0?14:15;break;case 3:return t.abrupt("return",a.from(o.sha3_224.arrayBuffer(r)));case 4:return t.abrupt("return",a.from(o.sha3_256.arrayBuffer(r)));case 5:return t.abrupt("return",a.from(o.sha3_384.arrayBuffer(r)));case 6:return t.abrupt("return",a.from(o.sha3_512.arrayBuffer(r)));case 7:return t.abrupt("return",a.from(o.shake128.create(128).update(r).arrayBuffer()));case 8:return t.abrupt("return",a.from(o.shake256.create(256).update(r).arrayBuffer()));case 9:return t.abrupt("return",a.from(o.keccak224.arrayBuffer(r)));case 10:return t.abrupt("return",a.from(o.keccak256.arrayBuffer(r)));case 11:return t.abrupt("return",a.from(o.keccak384.arrayBuffer(r)));case 12:return t.abrupt("return",a.from(o.keccak512.arrayBuffer(r)));case 13:return t.abrupt("return",a.from(s.x64.hash128(r),"hex"));case 14:return t.abrupt("return",l(s.x86.hash32(r)));case 15:throw new TypeError("".concat(e," is not a supported algorithm"));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};e.exports={sha1:u("sha1"),sha2256:u("sha2-256"),sha2512:u("sha2-512"),dblSha2256:u("dbl-sha2-256"),sha3224:c("sha3-224"),sha3256:c("sha3-256"),sha3384:c("sha3-384"),sha3512:c("sha3-512"),shake128:c("shake-128"),shake256:c("shake-256"),keccak224:c("keccak-224"),keccak256:c("keccak-256"),keccak384:c("keccak-384"),keccak512:c("keccak-512"),murmur3128:c("murmur3-128"),murmur332:c("murmur3-32"),addBlake:r(1409)}},function(e,t,r){!function(r,n){"use strict";var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function a(e){if(!Array.isArray(e)&&!ArrayBuffer.isView(e))return!1;for(var t=0;t<e.length;t++)if(!Number.isInteger(e[t])||e[t]<0||e[t]>255)return!1;return!0}function o(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function s(e,t){return e<<t|e>>>32-t}function u(e){return e=o(e^=e>>>16,2246822507),e=o(e^=e>>>13,3266489909),e^=e>>>16}function l(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function c(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]}function h(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function f(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function p(e){return e=d(e,[0,e[0]>>>1]),e=d(e=c(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=d(e=c(e,[3301882366,444984403]),[0,e[0]>>>1])}i.x86.hash32=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%4,l=e.length-r,c=t,h=0,f=3432918353,d=461845907,p=0;p<l;p+=4)h=o(h=e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]<<24,f),h=o(h=s(h,15),d),c=o(c=s(c^=h,13),5)+3864292196;switch(h=0,r){case 3:h^=e[p+2]<<16;case 2:h^=e[p+1]<<8;case 1:h=o(h^=e[p],f),c^=h=o(h=s(h,15),d)}return(c=u(c^=e.length))>>>0},i.x86.hash128=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%16,l=e.length-r,c=t,h=t,f=t,d=t,p=0,y=0,v=0,m=0,g=597399067,_=2869860233,b=951274213,w=2716044179,x=0;x<l;x+=16)p=e[x]|e[x+1]<<8|e[x+2]<<16|e[x+3]<<24,y=e[x+4]|e[x+5]<<8|e[x+6]<<16|e[x+7]<<24,v=e[x+8]|e[x+9]<<8|e[x+10]<<16|e[x+11]<<24,m=e[x+12]|e[x+13]<<8|e[x+14]<<16|e[x+15]<<24,p=s(p=o(p,g),15),c=s(c^=p=o(p,_),19),c=o(c+=h,5)+1444728091,y=s(y=o(y,_),16),h=s(h^=y=o(y,b),17),h=o(h+=f,5)+197830471,v=s(v=o(v,b),17),f=s(f^=v=o(v,w),15),f=o(f+=d,5)+2530024501,m=s(m=o(m,w),18),d=s(d^=m=o(m,g),13),d=o(d+=c,5)+850148119;switch(p=0,y=0,v=0,m=0,r){case 15:m^=e[x+14]<<16;case 14:m^=e[x+13]<<8;case 13:m=o(m^=e[x+12],w),d^=m=o(m=s(m,18),g);case 12:v^=e[x+11]<<24;case 11:v^=e[x+10]<<16;case 10:v^=e[x+9]<<8;case 9:v=o(v^=e[x+8],b),f^=v=o(v=s(v,17),w);case 8:y^=e[x+7]<<24;case 7:y^=e[x+6]<<16;case 6:y^=e[x+5]<<8;case 5:y=o(y^=e[x+4],_),h^=y=o(y=s(y,16),b);case 4:p^=e[x+3]<<24;case 3:p^=e[x+2]<<16;case 2:p^=e[x+1]<<8;case 1:p=o(p^=e[x],g),c^=p=o(p=s(p,15),_)}return c^=e.length,c+=h^=e.length,c+=f^=e.length,h+=c+=d^=e.length,f+=c,d+=c,c=u(c),c+=h=u(h),c+=f=u(f),h+=c+=d=u(d),f+=c,d+=c,("00000000"+(c>>>0).toString(16)).slice(-8)+("00000000"+(h>>>0).toString(16)).slice(-8)+("00000000"+(f>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)},i.x64.hash128=function(e,t){if(i.inputValidation&&!a(e))return n;t=t||0;for(var r=e.length%16,o=e.length-r,s=[0,t],u=[0,t],y=[0,0],v=[0,0],m=[2277735313,289559509],g=[1291169091,658871167],_=0;_<o;_+=16)y=[e[_+4]|e[_+5]<<8|e[_+6]<<16|e[_+7]<<24,e[_]|e[_+1]<<8|e[_+2]<<16|e[_+3]<<24],v=[e[_+12]|e[_+13]<<8|e[_+14]<<16|e[_+15]<<24,e[_+8]|e[_+9]<<8|e[_+10]<<16|e[_+11]<<24],y=h(y=c(y,m),31),s=l(s=h(s=d(s,y=c(y,g)),27),u),s=l(c(s,[0,5]),[0,1390208809]),v=h(v=c(v,g),33),u=l(u=h(u=d(u,v=c(v,m)),31),s),u=l(c(u,[0,5]),[0,944331445]);switch(y=[0,0],v=[0,0],r){case 15:v=d(v,f([0,e[_+14]],48));case 14:v=d(v,f([0,e[_+13]],40));case 13:v=d(v,f([0,e[_+12]],32));case 12:v=d(v,f([0,e[_+11]],24));case 11:v=d(v,f([0,e[_+10]],16));case 10:v=d(v,f([0,e[_+9]],8));case 9:v=c(v=d(v,[0,e[_+8]]),g),u=d(u,v=c(v=h(v,33),m));case 8:y=d(y,f([0,e[_+7]],56));case 7:y=d(y,f([0,e[_+6]],48));case 6:y=d(y,f([0,e[_+5]],40));case 5:y=d(y,f([0,e[_+4]],32));case 4:y=d(y,f([0,e[_+3]],24));case 3:y=d(y,f([0,e[_+2]],16));case 2:y=d(y,f([0,e[_+1]],8));case 1:y=c(y=d(y,[0,e[_]]),m),s=d(s,y=c(y=h(y,31),g))}return s=l(s=d(s,[0,e.length]),u=d(u,[0,e.length])),u=l(u,s),s=l(s=p(s),u=p(u)),u=l(u,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(u[0]>>>0).toString(16)).slice(-8)+("00000000"+(u[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i}()},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=self.crypto||self.msCrypto;e.exports=function(e){if("undefined"===typeof self||!self.crypto&&!self.msCrypto)throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");return function(){var t=i(n.mark((function t(r){var i;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="sha1"===t.t0?3:"sha2-256"===t.t0?8:"sha2-512"===t.t0?13:"dbl-sha2-256"===t.t0?18:26;break;case 3:return t.t1=a,t.next=6,o.subtle.digest({name:"SHA-1"},r);case 6:return t.t2=t.sent,t.abrupt("return",t.t1.from.call(t.t1,t.t2));case 8:return t.t3=a,t.next=11,o.subtle.digest({name:"SHA-256"},r);case 11:return t.t4=t.sent,t.abrupt("return",t.t3.from.call(t.t3,t.t4));case 13:return t.t5=a,t.next=16,o.subtle.digest({name:"SHA-512"},r);case 16:return t.t6=t.sent,t.abrupt("return",t.t5.from.call(t.t5,t.t6));case 18:return t.next=20,o.subtle.digest({name:"SHA-256"},r);case 20:return i=t.sent,t.t7=a,t.next=24,o.subtle.digest({name:"SHA-256"},i);case 24:return t.t8=t.sent,t.abrupt("return",t.t7.from.call(t.t7,t.t8));case 26:throw new Error("".concat(e," is not a supported algorithm"));case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},function(e,t,r){"use strict";var n=r(10).Buffer;e.exports={fromNumberTo32BitBuf:function(e){for(var t=new Array(4),r=0;r<4;r++)t[r]=255&e,e>>=8;return n.from(t)}}},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(763),s={init:o.blake2bInit,update:o.blake2bUpdate,digest:o.blake2bFinal},u={init:o.blake2sInit,update:o.blake2sUpdate,digest:o.blake2sFinal},l=function(e,t){return function(){var r=i(n.mark((function r(i){var o;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.init(e,null),t.update(o,i),r.abrupt("return",a.from(t.digest(o)));case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()};e.exports=function(e){for(var t=0;t<64;t++)e[45569+t]=l(t+1,s);for(var r=0;r<32;r++)e[45633+r]=l(r+1,u)}},function(e,t,r){"use strict";var n=r(773),i=n.cloneLinks,a=n.cloneData,o=r(770);e.exports=function(e){var t=a(e),r=i(e);return o(t,r)}},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(773),o=a.cloneLinks,s=a.cloneData,u=a.toDAGLink,l=r(724),c=r(769),h=r(770),f=function(){var e=i(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.isDAGLink(t)){e.next=2;break}return e.abrupt("return",t);case 2:if(!c.isDAGNode(t)){e.next=4;break}return e.abrupt("return",u(t,{}));case 4:return e.abrupt("return",new l(t.Name||t.name,t.Tsize||t.size,t.Hash||t.multihash||t.hash||t.cid));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=i(n.mark((function e(t,r){var i,a,u;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o(t),a=s(t),e.next=4,f(r);case 4:return u=e.sent,i.push(u),e.abrupt("return",h(a,i));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();e.exports=d},function(e,t,r){"use strict";(function(t){var n=r(773),i=n.cloneLinks,a=n.cloneData,o=r(770),s=r(168);e.exports=function(e,r){var n=a(e),u=i(e);if("string"===typeof r)u=u.filter((function(e){return e.Name!==r}));else{if(!t.isBuffer(r)&&!s.isCID(r))throw new Error("second arg needs to be a name or CID");u=u.filter((function(e){return!e.Hash.equals(r)}))}return o(n,u)}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(e){var n=r(4),i=r(168),a=r(771);t.resolve=function(e,t){for(var r=a.deserialize(e),n=t.split("/").filter(Boolean);n.length;){var o=n.shift();if(void 0===r[o])throw new Error("Object has no property '".concat(o,"'"));if(r=r[o],i.isCID(r))return{value:r,remainderPath:n.join("/")}}return{value:r,remainderPath:""}};var o=n.mark((function t(r,a){var o,s,u,l;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isBuffer(r)&&!i.isCID(r)&&"string"!==typeof r&&null!==r){n.next=2;break}return n.abrupt("return");case 2:o=0,s=Object.keys(r);case 3:if(!(o<s.length)){n.next=12;break}return u=s[o],l=void 0===a?u:a+"/"+u,n.next=8,l;case 8:return n.delegateYield(t(r[u],l),"t0",9);case 9:o++,n.next=3;break;case 12:case"end":return n.stop()}}),t)}));t.tree=n.mark((function e(t){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.deserialize(t),e.delegateYield(o(r),"t0",2);case 2:case"end":return e.stop()}}),e)}))}).call(this,r(10).Buffer)},function(e,t,r){"use strict";t.Diagnose=r(1415),t.Decoder=r(980),t.Encoder=r(1417),t.Simple=r(981),t.Tagged=r(982),t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(759),o=r(314),s=r(23),u=r(24),l=r(10).Buffer,c=r(980),h=r(831),f=function(e){s(r,e);var t=u(r);function r(){return n(this,r),t.apply(this,arguments)}return i(r,[{key:"createTag",value:function(e,t){return"".concat(e,"(").concat(t,")")}},{key:"createInt",value:function(e){return a(o(r.prototype),"createInt",this).call(this,e).toString()}},{key:"createInt32",value:function(e,t){return a(o(r.prototype),"createInt32",this).call(this,e,t).toString()}},{key:"createInt64",value:function(e,t,n,i){return a(o(r.prototype),"createInt64",this).call(this,e,t,n,i).toString()}},{key:"createInt32Neg",value:function(e,t){return a(o(r.prototype),"createInt32Neg",this).call(this,e,t).toString()}},{key:"createInt64Neg",value:function(e,t,n,i){return a(o(r.prototype),"createInt64Neg",this).call(this,e,t,n,i).toString()}},{key:"createTrue",value:function(){return"true"}},{key:"createFalse",value:function(){return"false"}},{key:"createFloat",value:function(e){var t=a(o(r.prototype),"createFloat",this).call(this,e);return h.isNegativeZero(e)?"-0_1":"".concat(t,"_1")}},{key:"createFloatSingle",value:function(e,t,n,i){var s=a(o(r.prototype),"createFloatSingle",this).call(this,e,t,n,i);return"".concat(s,"_2")}},{key:"createFloatDouble",value:function(e,t,n,i,s,u,l,c){var h=a(o(r.prototype),"createFloatDouble",this).call(this,e,t,n,i,s,u,l,c);return"".concat(h,"_3")}},{key:"createByteString",value:function(e,t){var r=e.join(", ");return-1===t?"(_ ".concat(r,")"):"h'".concat(r)}},{key:"createByteStringFromHeap",value:function(e,t){var n=l.from(a(o(r.prototype),"createByteStringFromHeap",this).call(this,e,t)).toString("hex");return"h'".concat(n,"'")}},{key:"createInfinity",value:function(){return"Infinity_1"}},{key:"createInfinityNeg",value:function(){return"-Infinity_1"}},{key:"createNaN",value:function(){return"NaN_1"}},{key:"createNaNNeg",value:function(){return"-NaN_1"}},{key:"createNull",value:function(){return"null"}},{key:"createUndefined",value:function(){return"undefined"}},{key:"createSimpleUnassigned",value:function(e){return"simple(".concat(e,")")}},{key:"createArray",value:function(e,t){var n=a(o(r.prototype),"createArray",this).call(this,e,t);return-1===t?"[_ ".concat(n.join(", "),"]"):"[".concat(n.join(", "),"]")}},{key:"createMap",value:function(e,t){var n=a(o(r.prototype),"createMap",this).call(this,e),i=Array.from(n.keys()).reduce(d(n),"");return-1===t?"{_ ".concat(i,"}"):"{".concat(i,"}")}},{key:"createObject",value:function(e,t){var n=a(o(r.prototype),"createObject",this).call(this,e),i=Object.keys(n).reduce(d(n),"");return-1===t?"{_ ".concat(i,"}"):"{".concat(i,"}")}},{key:"createUtf8String",value:function(e,t){var r=e.join(", ");return-1===t?"(_ ".concat(r,")"):'"'.concat(r,'"')}},{key:"createUtf8StringFromHeap",value:function(e,t){var n=l.from(a(o(r.prototype),"createUtf8StringFromHeap",this).call(this,e,t)).toString("utf8");return'"'.concat(n,'"')}}],[{key:"diagnose",value:function(e,t){return"string"===typeof e&&(e=l.from(e,t||"hex")),(new r).decodeFirst(e)}}]),r}(c);function d(e){return function(t,r){return t?"".concat(t,", ").concat(r,": ").concat(e[r]):"".concat(r,": ").concat(e[r])}}e.exports=f},function(e,t){e.exports=function(e,t,r){"use asm";var n=new e.Uint8Array(r);var i=t.pushInt;var a=t.pushInt32;var o=t.pushInt32Neg;var s=t.pushInt64;var u=t.pushInt64Neg;var l=t.pushFloat;var c=t.pushFloatSingle;var h=t.pushFloatDouble;var f=t.pushTrue;var d=t.pushFalse;var p=t.pushUndefined;var y=t.pushNull;var v=t.pushInfinity;var m=t.pushInfinityNeg;var g=t.pushNaN;var _=t.pushNaNNeg;var b=t.pushArrayStart;var w=t.pushArrayStartFixed;var x=t.pushArrayStartFixed32;var k=t.pushArrayStartFixed64;var E=t.pushObjectStart;var S=t.pushObjectStartFixed;var T=t.pushObjectStartFixed32;var A=t.pushObjectStartFixed64;var C=t.pushByteString;var I=t.pushByteStringStart;var R=t.pushUtf8String;var M=t.pushUtf8StringStart;var P=t.pushSimpleUnassigned;var O=t.pushTagStart;var L=t.pushTagStart4;var D=t.pushTagStart8;var B=t.pushTagUnassigned;var N=t.pushBreak;var z=e.Math.pow;var F=0;var j=0;var U=0;function V(e){e=e|0;F=0;j=e;while((F|0)<(j|0)){U=Xe[n[F]&255](n[F]|0)|0;if((U|0)>0){break}}return U|0}function q(e){e=e|0;if(((F|0)+(e|0)|0)<(j|0)){return 0}return 1}function G(e){e=e|0;return n[e|0]<<8|n[e+1|0]|0}function K(e){e=e|0;return n[e|0]<<24|n[e+1|0]<<16|n[e+2|0]<<8|n[e+3|0]|0}function H(e){e=e|0;i(e|0);F=F+1|0;return 0}function W(e){e=e|0;if(q(1)|0){return 1}i(n[F+1|0]|0);F=F+2|0;return 0}function Z(e){e=e|0;if(q(2)|0){return 1}i(G(F+1|0)|0);F=F+3|0;return 0}function Y(e){e=e|0;if(q(4)|0){return 1}a(G(F+1|0)|0,G(F+3|0)|0);F=F+5|0;return 0}function X(e){e=e|0;if(q(8)|0){return 1}s(G(F+1|0)|0,G(F+3|0)|0,G(F+5|0)|0,G(F+7|0)|0);F=F+9|0;return 0}function Q(e){e=e|0;i(-1-(e-32|0)|0);F=F+1|0;return 0}function J(e){e=e|0;if(q(1)|0){return 1}i(-1-(n[F+1|0]|0)|0);F=F+2|0;return 0}function $(e){e=e|0;var t=0;if(q(2)|0){return 1}t=G(F+1|0)|0;i(-1-(t|0)|0);F=F+3|0;return 0}function ee(e){e=e|0;if(q(4)|0){return 1}o(G(F+1|0)|0,G(F+3|0)|0);F=F+5|0;return 0}function te(e){e=e|0;if(q(8)|0){return 1}u(G(F+1|0)|0,G(F+3|0)|0,G(F+5|0)|0,G(F+7|0)|0);F=F+9|0;return 0}function re(e){e=e|0;var t=0;var r=0;var n=0;n=e-64|0;if(q(n|0)|0){return 1}t=F+1|0;r=(F+1|0)+(n|0)|0;C(t|0,r|0);F=r|0;return 0}function ne(e){e=e|0;var t=0;var r=0;var i=0;if(q(1)|0){return 1}i=n[F+1|0]|0;t=F+2|0;r=(F+2|0)+(i|0)|0;if(q(i+1|0)|0){return 1}C(t|0,r|0);F=r|0;return 0}function ie(e){e=e|0;var t=0;var r=0;var n=0;if(q(2)|0){return 1}n=G(F+1|0)|0;t=F+3|0;r=(F+3|0)+(n|0)|0;if(q(n+2|0)|0){return 1}C(t|0,r|0);F=r|0;return 0}function ae(e){e=e|0;var t=0;var r=0;var n=0;if(q(4)|0){return 1}n=K(F+1|0)|0;t=F+5|0;r=(F+5|0)+(n|0)|0;if(q(n+4|0)|0){return 1}C(t|0,r|0);F=r|0;return 0}function oe(e){e=e|0;return 1}function se(e){e=e|0;I();F=F+1|0;return 0}function ue(e){e=e|0;var t=0;var r=0;var n=0;n=e-96|0;if(q(n|0)|0){return 1}t=F+1|0;r=(F+1|0)+(n|0)|0;R(t|0,r|0);F=r|0;return 0}function le(e){e=e|0;var t=0;var r=0;var i=0;if(q(1)|0){return 1}i=n[F+1|0]|0;t=F+2|0;r=(F+2|0)+(i|0)|0;if(q(i+1|0)|0){return 1}R(t|0,r|0);F=r|0;return 0}function ce(e){e=e|0;var t=0;var r=0;var n=0;if(q(2)|0){return 1}n=G(F+1|0)|0;t=F+3|0;r=(F+3|0)+(n|0)|0;if(q(n+2|0)|0){return 1}R(t|0,r|0);F=r|0;return 0}function he(e){e=e|0;var t=0;var r=0;var n=0;if(q(4)|0){return 1}n=K(F+1|0)|0;t=F+5|0;r=(F+5|0)+(n|0)|0;if(q(n+4|0)|0){return 1}R(t|0,r|0);F=r|0;return 0}function fe(e){e=e|0;return 1}function de(e){e=e|0;M();F=F+1|0;return 0}function pe(e){e=e|0;w(e-128|0);F=F+1|0;return 0}function ye(e){e=e|0;if(q(1)|0){return 1}w(n[F+1|0]|0);F=F+2|0;return 0}function ve(e){e=e|0;if(q(2)|0){return 1}w(G(F+1|0)|0);F=F+3|0;return 0}function me(e){e=e|0;if(q(4)|0){return 1}x(G(F+1|0)|0,G(F+3|0)|0);F=F+5|0;return 0}function ge(e){e=e|0;if(q(8)|0){return 1}k(G(F+1|0)|0,G(F+3|0)|0,G(F+5|0)|0,G(F+7|0)|0);F=F+9|0;return 0}function _e(e){e=e|0;b();F=F+1|0;return 0}function be(e){e=e|0;var t=0;t=e-160|0;if(q(t|0)|0){return 1}S(t|0);F=F+1|0;return 0}function we(e){e=e|0;if(q(1)|0){return 1}S(n[F+1|0]|0);F=F+2|0;return 0}function xe(e){e=e|0;if(q(2)|0){return 1}S(G(F+1|0)|0);F=F+3|0;return 0}function ke(e){e=e|0;if(q(4)|0){return 1}T(G(F+1|0)|0,G(F+3|0)|0);F=F+5|0;return 0}function Ee(e){e=e|0;if(q(8)|0){return 1}A(G(F+1|0)|0,G(F+3|0)|0,G(F+5|0)|0,G(F+7|0)|0);F=F+9|0;return 0}function Se(e){e=e|0;E();F=F+1|0;return 0}function Te(e){e=e|0;O(e-192|0|0);F=F+1|0;return 0}function Ae(e){e|0;O(e|0);F=F+1|0;return 0}function Ce(e){e|0;O(e|0);F=F+1|0;return 0}function Ie(e){e|0;O(e|0);F=F+1|0;return 0}function Re(e){e|0;O(e|0);F=F+1|0;return 0}function Me(e){e=e|0;O(e-192|0|0);F=F+1|0;return 0}function Pe(e){e|0;O(e|0);F=F+1|0;return 0}function Oe(e){e|0;O(e|0);F=F+1|0;return 0}function Le(e){e|0;O(e|0);F=F+1|0;return 0}function De(e){e=e|0;if(q(1)|0){return 1}O(n[F+1|0]|0);F=F+2|0;return 0}function Be(e){e=e|0;if(q(2)|0){return 1}O(G(F+1|0)|0);F=F+3|0;return 0}function Ne(e){e=e|0;if(q(4)|0){return 1}L(G(F+1|0)|0,G(F+3|0)|0);F=F+5|0;return 0}function ze(e){e=e|0;if(q(8)|0){return 1}D(G(F+1|0)|0,G(F+3|0)|0,G(F+5|0)|0,G(F+7|0)|0);F=F+9|0;return 0}function Fe(e){e=e|0;P((e|0)-224|0);F=F+1|0;return 0}function je(e){e=e|0;d();F=F+1|0;return 0}function Ue(e){e=e|0;f();F=F+1|0;return 0}function Ve(e){e=e|0;y();F=F+1|0;return 0}function qe(e){e=e|0;p();F=F+1|0;return 0}function Ge(e){e=e|0;if(q(1)|0){return 1}P(n[F+1|0]|0);F=F+2|0;return 0}function Ke(e){e=e|0;var t=0;var r=0;var i=1.0;var a=0.0;var o=0.0;var s=0.0;if(q(2)|0){return 1}t=n[F+1|0]|0;r=n[F+2|0]|0;if((t|0)&0x80){i=-1.0}a=+(((t|0)&0x7C)>>2);o=+(((t|0)&0x03)<<8|r);if(+a==0.0){l(+(+i*+5.9604644775390625e-8*+o))}else if(+a==31.0){if(+i==1.0){if(+o>0.0){g()}else{v()}}else{if(+o>0.0){_()}else{m()}}}else{l(+(+i*z(+2,+(+a-25.0))*+(1024.0+o)))}F=F+3|0;return 0}function He(e){e=e|0;if(q(4)|0){return 1}c(n[F+1|0]|0,n[F+2|0]|0,n[F+3|0]|0,n[F+4|0]|0);F=F+5|0;return 0}function We(e){e=e|0;if(q(8)|0){return 1}h(n[F+1|0]|0,n[F+2|0]|0,n[F+3|0]|0,n[F+4|0]|0,n[F+5|0]|0,n[F+6|0]|0,n[F+7|0]|0,n[F+8|0]|0);F=F+9|0;return 0}function Ze(e){e=e|0;return 1}function Ye(e){e=e|0;N();F=F+1|0;return 0}var Xe=[H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,H,W,Z,Y,X,Ze,Ze,Ze,Ze,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,Q,J,$,ee,te,Ze,Ze,Ze,Ze,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,re,ne,ie,ae,oe,Ze,Ze,Ze,se,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,ue,le,ce,he,fe,Ze,Ze,Ze,de,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,pe,ye,ve,me,ge,Ze,Ze,Ze,_e,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,be,we,xe,ke,Ee,Ze,Ze,Ze,Se,Te,Te,Te,Te,Te,Te,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,Me,De,Be,Ne,ze,Ze,Ze,Ze,Ze,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,Fe,je,Ue,Ve,qe,Ge,Ke,He,We,Ze,Ze,Ze,Ye];return{parse:V}}},function(e,t,r){"use strict";var n=r(67),i=r(18),a=r(19),o=r(10).Buffer,s=r(813).URL,u=r(12).BigNumber,l=r(831),c=r(774),h=c.MT,f=c.NUMBYTES,d=c.SHIFT32,p=c.SYMS,y=c.TAG,v=c.MT.SIMPLE_FLOAT<<5|c.NUMBYTES.TWO,m=c.MT.SIMPLE_FLOAT<<5|c.NUMBYTES.FOUR,g=c.MT.SIMPLE_FLOAT<<5|c.NUMBYTES.EIGHT,_=c.MT.SIMPLE_FLOAT<<5|c.SIMPLE.TRUE,b=c.MT.SIMPLE_FLOAT<<5|c.SIMPLE.FALSE,w=c.MT.SIMPLE_FLOAT<<5|c.SIMPLE.UNDEFINED,x=c.MT.SIMPLE_FLOAT<<5|c.SIMPLE.NULL,k=new u("0x20000000000000"),E=o.from("f97e00","hex"),S=o.from("f9fc00","hex"),T=o.from("f97c00","hex");var A=function(){function e(t){i(this,e),t=t||{},this.streaming="function"===typeof t.stream,this.onData=t.stream,this.semanticTypes=[[s,this._pushUrl],[u,this._pushBigNumber]];for(var r=t.genTypes||[],n=r.length,a=0;a<n;a++)this.addSemanticType(r[a][0],r[a][1]);this._reset()}return a(e,[{key:"addSemanticType",value:function(e,t){for(var r=this.semanticTypes.length,n=0;n<r;n++){if(this.semanticTypes[n][0]===e){var i=this.semanticTypes[n][1];return this.semanticTypes[n][1]=t,i}}return this.semanticTypes.push([e,t]),null}},{key:"push",value:function(e){return!e||(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}},{key:"pushWrite",value:function(e,t,r){return this.result[this.offset]=e,this.resultMethod[this.offset]=t,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}},{key:"_pushUInt8",value:function(e){return this.pushWrite(e,1,1)}},{key:"_pushUInt16BE",value:function(e){return this.pushWrite(e,2,2)}},{key:"_pushUInt32BE",value:function(e){return this.pushWrite(e,3,4)}},{key:"_pushDoubleBE",value:function(e){return this.pushWrite(e,4,8)}},{key:"_pushNaN",value:function(){return this.push(E)}},{key:"_pushInfinity",value:function(e){var t=e<0?S:T;return this.push(t)}},{key:"_pushFloat",value:function(e){var t=o.allocUnsafe(2);if(l.writeHalf(t,e)&&l.parseHalf(t)===e)return this._pushUInt8(v)&&this.push(t);var r=o.allocUnsafe(4);return r.writeFloatBE(e,0),r.readFloatBE(0)===e?this._pushUInt8(m)&&this.push(r):this._pushUInt8(g)&&this._pushDoubleBE(e)}},{key:"_pushInt",value:function(e,t,r){var n=t<<5;return e<24?this._pushUInt8(n|e):e<=255?this._pushUInt8(n|f.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(n|f.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(n|f.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|f.EIGHT)&&this._pushUInt32BE(Math.floor(e/d))&&this._pushUInt32BE(e%d):t===h.NEG_INT?this._pushFloat(r):this._pushFloat(e)}},{key:"_pushIntNum",value:function(e){return e<0?this._pushInt(-e-1,h.NEG_INT,e):this._pushInt(e,h.POS_INT)}},{key:"_pushNumber",value:function(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}},{key:"_pushString",value:function(e){var t=o.byteLength(e,"utf8");return this._pushInt(t,h.UTF8_STRING)&&this.pushWrite(e,5,t)}},{key:"_pushBoolean",value:function(e){return this._pushUInt8(e?_:b)}},{key:"_pushUndefined",value:function(e){return this._pushUInt8(w)}},{key:"_pushArray",value:function(e,t){var r=t.length;if(!e._pushInt(r,h.ARRAY))return!1;for(var n=0;n<r;n++)if(!e.pushAny(t[n]))return!1;return!0}},{key:"_pushTag",value:function(e){return this._pushInt(e,h.TAG)}},{key:"_pushDate",value:function(e,t){return e._pushTag(y.DATE_EPOCH)&&e.pushAny(Math.round(t/1e3))}},{key:"_pushBuffer",value:function(e,t){return e._pushInt(t.length,h.BYTE_STRING)&&e.push(t)}},{key:"_pushNoFilter",value:function(e,t){return e._pushBuffer(e,t.slice())}},{key:"_pushRegexp",value:function(e,t){return e._pushTag(y.REGEXP)&&e.pushAny(t.source)}},{key:"_pushSet",value:function(e,t){if(!e._pushInt(t.size,h.ARRAY))return!1;var r,i=n(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!e.pushAny(a))return!1}}catch(o){i.e(o)}finally{i.f()}return!0}},{key:"_pushUrl",value:function(e,t){return e._pushTag(y.URI)&&e.pushAny(t.format())}},{key:"_pushBigint",value:function(e){var t=y.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),t=y.NEG_BIGINT);var r=e.toString(16);r.length%2&&(r="0"+r);var n=o.from(r,"hex");return this._pushTag(t)&&this._pushBuffer(this,n)}},{key:"_pushBigNumber",value:function(e,t){if(t.isNaN())return e._pushNaN();if(!t.isFinite())return e._pushInfinity(t.isNegative()?-1/0:1/0);if(t.isInteger())return e._pushBigint(t);if(!e._pushTag(y.DECIMAL_FRAC)||!e._pushInt(2,h.ARRAY))return!1;var r=t.decimalPlaces(),n=t.multipliedBy(new u(10).pow(r));return!!e._pushIntNum(-r)&&(n.abs().isLessThan(k)?e._pushIntNum(n.toNumber()):e._pushBigint(n))}},{key:"_pushMap",value:function(e,t){return!!e._pushInt(t.size,h.MAP)&&this._pushRawMap(t.size,Array.from(t))}},{key:"_pushObject",value:function(e){if(!e)return this._pushUInt8(x);for(var t=this.semanticTypes.length,r=0;r<t;r++)if(e instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(e,this,e);var n=e.encodeCBOR;if("function"===typeof n)return n.call(e,this);var i=Object.keys(e),a=i.length;return!!this._pushInt(a,h.MAP)&&this._pushRawMap(a,i.map((function(t){return[t,e[t]]})))}},{key:"_pushRawMap",value:function(t,r){r=r.map((function(t){return t[0]=e.encode(t[0]),t})).sort(l.keySorter);for(var n=0;n<t;n++){if(!this.push(r[n][0]))return!1;if(!this.pushAny(r[n][1]))return!1}return!0}},{key:"write",value:function(e){return this.pushAny(e)}},{key:"pushAny",value:function(e){switch(function(e){return{}.toString.call(e).slice(8,-1)}(e)){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,o.isBuffer(e)?e:o.from(e));case"Null":return this._pushUInt8(x);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case p.NULL:return this._pushObject(null);case p.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}},{key:"finalize",value:function(){if(0===this.offset)return null;for(var e=this.result,t=this.resultLength,r=this.resultMethod,n=this.offset,i=0,a=0;a<n;a++)i+=t[a];var s=o.allocUnsafe(i),u=0,l=0;for(a=0;a<n;a++){switch(l=t[a],r[a]){case 0:e[a].copy(s,u);break;case 1:s.writeUInt8(e[a],u,!0);break;case 2:s.writeUInt16BE(e[a],u,!0);break;case 3:s.writeUInt32BE(e[a],u,!0);break;case 4:s.writeDoubleBE(e[a],u,!0);break;case 5:s.write(e[a],u,l,"utf8");break;default:throw new Error("unkown method")}u+=l}var c=s;return this._reset(),c}},{key:"_reset",value:function(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}}],[{key:"encode",value:function(t){var r=new e;if(!r.pushAny(t))throw new Error("Failed to encode input");return r.finalize()}}]),e}();e.exports=A},function(e,t,r){"use strict";function n(e,t){for(var r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}e.exports=function(e,t,r){if(!e||"string"===typeof e)throw new TypeError("Please pass an Error to err-code");r||(r={}),"object"===typeof t&&(r=t,t=void 0),null!=t&&(r.code=t);try{return n(e,r)}catch(a){r.message=e.message,r.stack=e.stack;var i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),n(new i,r)}}},function(e,t,r){"use strict";var n=r(10).Buffer,i=r(1420);function a(e){if(i.names[e])return i.names[e];if(i.codes[e])return i.codes[e];throw new Error("Unsupported encoding: ".concat(e))}(t=e.exports=function(e,t){if(!t)throw new Error("requires an encoded buffer");var r=a(e);return function(e,t){a(e).decode(t.toString())}(r.name,t),n.concat([r.codeBuf,t])}).encode=function(e,t){var r=a(e);return n.concat([r.codeBuf,n.from(r.encode(t))])},t.decode=function(e){n.isBuffer(e)&&(e=e.toString());var t=e[0];["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(t)&&(e=e.toLowerCase());var r=a(e[0]);return n.from(r.decode(e.substring(1)))},t.isEncoded=function(e){if(n.isBuffer(e)&&(e=e.toString()),"[object String]"!==Object.prototype.toString.call(e))return!1;try{return a(e[0]).name}catch(t){return!1}},t.encoding=a,t.encodingFromData=function(e){return n.isBuffer(e)&&(e=e.toString()),a(e[0])},t.names=Object.freeze(i.names),t.codes=Object.freeze(i.codes)},function(e,t,r){"use strict";var n=r(174),i=r(10).Buffer,a=r(1421),o=r(1422),s=[["identity","\0",function(){return{encode:function(e){return i.from(e).toString()},decode:function(e){return i.from(e)}}},""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=s.reduce((function(e,t){return e[t[0]]=new a(t[0],t[1],t[2],t[3]),e}),{}),l=s.reduce((function(e,t){return e[t[1]]=u[t[0]],e}),{});e.exports={names:u,codes:l}},function(e,t,r){"use strict";var n=r(67),i=r(18),a=r(19),o=r(10).Buffer,s=function(){function e(t,r,n,a){i(this,e),this.name=t,this.code=r,this.codeBuf=o.from(this.code),this.alphabet=a,this.engine=n(a)}return a(e,[{key:"encode",value:function(e){return this.engine.encode(e)}},{key:"decode",value:function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.alphabet&&this.alphabet.indexOf(i)<0)throw new Error("invalid character '".concat(i,"' in '").concat(e,"'"))}}catch(a){r.e(a)}finally{r.f()}return this.engine.decode(e)}}]),e}();e.exports=s},function(e,t,r){"use strict";e.exports=function(e){return function(t){return{encode:function(r){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",o=0,s=0,u=0;u<e.length;++u)for(s=s<<8|e[u],o+=8;o>r;)a+=t[i&s>>(o-=r)];if(o&&(a+=t[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a}(r,t,e)},decode:function(r){return function(e,t,r){for(var n={},i=0;i<t.length;++i)n[t[i]]=i;for(var a=e.length;"="===e[a-1];)--a;for(var o=new Uint8Array(a*r/8|0),s=0,u=0,l=0,c=0;c<a;++c){var h=n[e[c]];if(void 0===h)throw new SyntaxError("Invalid character "+e[c]);u=u<<r|h,(s+=r)>=8&&(s-=8,o[l++]=255&u>>s)}if(s>=r||255&u<<8-s)throw new SyntaxError("Unexpected end of data");return o}(r,t,e)}}}}},function(e,t,r){"use strict";var n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:n}},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(315),s=r(977),u=r(1425).factory,l=r(1426).fromNumberTo32BitBuf,c=function(e){return function(){var t=i(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="sha3-224"===t.t0?3:"sha3-256"===t.t0?4:"sha3-384"===t.t0?5:"sha3-512"===t.t0?6:"shake-128"===t.t0?7:"shake-256"===t.t0?8:"keccak-224"===t.t0?9:"keccak-256"===t.t0?10:"keccak-384"===t.t0?11:"keccak-512"===t.t0?12:"murmur3-128"===t.t0?13:"murmur3-32"===t.t0?14:15;break;case 3:return t.abrupt("return",a.from(o.sha3_224.arrayBuffer(r)));case 4:return t.abrupt("return",a.from(o.sha3_256.arrayBuffer(r)));case 5:return t.abrupt("return",a.from(o.sha3_384.arrayBuffer(r)));case 6:return t.abrupt("return",a.from(o.sha3_512.arrayBuffer(r)));case 7:return t.abrupt("return",a.from(o.shake128.create(128).update(r).arrayBuffer()));case 8:return t.abrupt("return",a.from(o.shake256.create(256).update(r).arrayBuffer()));case 9:return t.abrupt("return",a.from(o.keccak224.arrayBuffer(r)));case 10:return t.abrupt("return",a.from(o.keccak256.arrayBuffer(r)));case 11:return t.abrupt("return",a.from(o.keccak384.arrayBuffer(r)));case 12:return t.abrupt("return",a.from(o.keccak512.arrayBuffer(r)));case 13:return t.abrupt("return",a.from(s.x64.hash128(r),"hex"));case 14:return t.abrupt("return",l(s.x86.hash32(r)));case 15:throw new TypeError("".concat(e," is not a supported algorithm"));case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};e.exports={identity:function(e){return a.from(e)},sha1:u("sha1"),sha2256:u("sha2-256"),sha2512:u("sha2-512"),dblSha2256:u("dbl-sha2-256"),sha3224:c("sha3-224"),sha3256:c("sha3-256"),sha3384:c("sha3-384"),sha3512:c("sha3-512"),shake128:c("shake-128"),shake256:c("shake-256"),keccak224:c("keccak-224"),keccak256:c("keccak-256"),keccak384:c("keccak-384"),keccak512:c("keccak-512"),murmur3128:c("murmur3-128"),murmur332:c("murmur3-32"),addBlake:r(1427)}},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(984),s=self.crypto||self.msCrypto,u=function(){var e=i(n.mark((function e(t,r){var i;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof self&&(self.crypto||self.msCrypto)){e.next=2;break}throw new Error("Please use a browser with webcrypto support and ensure the code has been delivered securely via HTTPS/TLS and run within a Secure Context");case 2:e.t0=r,e.next="sha1"===e.t0?5:"sha2-256"===e.t0?10:"sha2-512"===e.t0?15:"dbl-sha2-256"===e.t0?20:28;break;case 5:return e.t1=a,e.next=8,s.subtle.digest({name:"SHA-1"},t);case 8:return e.t2=e.sent,e.abrupt("return",e.t1.from.call(e.t1,e.t2));case 10:return e.t3=a,e.next=13,s.subtle.digest({name:"SHA-256"},t);case 13:return e.t4=e.sent,e.abrupt("return",e.t3.from.call(e.t3,e.t4));case 15:return e.t5=a,e.next=18,s.subtle.digest({name:"SHA-512"},t);case 18:return e.t6=e.sent,e.abrupt("return",e.t5.from.call(e.t5,e.t6));case 20:return e.next=22,s.subtle.digest({name:"SHA-256"},t);case 22:return i=e.sent,e.t7=a,e.next=26,s.subtle.digest({name:"SHA-256"},i);case 26:return e.t8=e.sent,e.abrupt("return",e.t7.from.call(e.t7,e.t8));case 28:throw new Error("".concat(r," is not a supported algorithm"));case 29:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();e.exports={factory:function(e){return function(){var t=i(n.mark((function t(r){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",u(r,e));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},digest:u,multihashing:function(){var e=i(n.mark((function e(t,r,i){var a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t,r,i);case 2:return a=e.sent,e.abrupt("return",o.encode(a,r,i));case 4:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}},function(e,t,r){"use strict";var n=r(10).Buffer;e.exports={fromNumberTo32BitBuf:function(e){for(var t=new Array(4),r=0;r<4;r++)t[r]=255&e,e>>=8;return n.from(t)}}},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(10).Buffer,o=r(763),s={init:o.blake2bInit,update:o.blake2bUpdate,digest:o.blake2bFinal},u={init:o.blake2sInit,update:o.blake2sUpdate,digest:o.blake2sFinal},l=function(e,t){return function(){var r=i(n.mark((function r(i){var o;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.init(e,null),t.update(o,i),r.abrupt("return",a.from(t.digest(o)));case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()};e.exports=function(e){for(var t=0;t<64;t++)e[45569+t]=l(t+1,s);for(var r=0;r<32;r++)e[45633+r]=l(r+1,u)}},function(e,t,r){"use strict";var n=r(174),i=r(10).Buffer,a=r(1429),o=r(1430),s=[["identity","\0",function(){return{encode:function(e){return i.from(e).toString()},decode:function(e){return i.from(e)}}},""],["base2","0",o(1),"01"],["base8","7",o(3),"01234567"],["base10","9",n,"0123456789"],["base16","f",o(4),"0123456789abcdef"],["base16upper","F",o(4),"0123456789ABCDEF"],["base32hex","v",o(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",o(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",o(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",o(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",o(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",o(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",o(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",n,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",n,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",n,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",n,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",o(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],u=s.reduce((function(e,t){return e[t[0]]=new a(t[0],t[1],t[2],t[3]),e}),{}),l=s.reduce((function(e,t){return e[t[1]]=u[t[0]],e}),{});e.exports={names:u,codes:l}},function(e,t,r){"use strict";var n=r(67),i=r(18),a=r(19),o=r(10).Buffer,s=function(){function e(t,r,n,a){i(this,e),this.name=t,this.code=r,this.codeBuf=o.from(this.code),this.alphabet=a,this.engine=n(a)}return a(e,[{key:"encode",value:function(e){return this.engine.encode(e)}},{key:"decode",value:function(e){var t,r=n(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(this.alphabet&&this.alphabet.indexOf(i)<0)throw new Error("invalid character '".concat(i,"' in '").concat(e,"'"))}}catch(a){r.e(a)}finally{r.f()}return this.engine.decode(e)}}]),e}();e.exports=s},function(e,t,r){"use strict";e.exports=function(e){return function(t){return{encode:function(r){return function(e,t,r){for(var n="="===t[t.length-1],i=(1<<r)-1,a="",o=0,s=0,u=0;u<e.length;++u)for(s=s<<8|e[u],o+=8;o>r;)a+=t[i&s>>(o-=r)];if(o&&(a+=t[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a}(r,t,e)},decode:function(r){return function(e,t,r){for(var n={},i=0;i<t.length;++i)n[t[i]]=i;for(var a=e.length;"="===e[a-1];)--a;for(var o=new Uint8Array(a*r/8|0),s=0,u=0,l=0,c=0;c<a;++c){var h=n[e[c]];if(void 0===h)throw new SyntaxError("Invalid character "+e[c]);u=u<<r|h,(s+=r)>=8&&(s-=8,o[l++]=255&u>>s)}if(s>=r||255&u<<8-s)throw new SyntaxError("Unexpected end of data");return o}(r,t,e)}}}}},function(e,t,r){"use strict";var n=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});e.exports={names:n}},function(e,t,r){"use strict";var n=r(986),i=r(10).Buffer,a={checkCIDComponents:function(e){if(null==e)return"null values are not valid CIDs";if(0!==e.version&&1!==e.version)return"Invalid version, must be a number equal to 1 or 0";if("string"!==typeof e.codec)return"codec must be string";if(0===e.version){if("dag-pb"!==e.codec)return"codec must be 'dag-pb' for CIDv0";if("base58btc"!==e.multibaseName)return"multibaseName must be 'base58btc' for CIDv0"}if(!i.isBuffer(e.multihash))return"multihash must be a Buffer";try{n.validate(e.multihash)}catch(r){var t=r.message;return t||(t="Multihash validation failed"),t}}};e.exports=a},function(e,t,r){var n=r(1434);function i(e,t){for(var r in t=new n(e,t),e){var a=e[r];if(a instanceof Object&&(t.contains(a)||i(a,t)))return!0}return!1}e.exports=function(e){if(!(e instanceof Object))throw new TypeError('"obj" must be an object (or inherit from it)');return i(e)}},function(e,t){function r(e,t){this.value=e,this.next=t}e.exports=r,r.prototype.contains=function(e){for(var t=this;t;){if(t.value===e)return!0;t=t.next}return!1}},function(e,t,r){"use strict";var n=r(4),i=r(985),a=r(10).Buffer,o=r(979);t.resolve=function(e,t){for(var r=o.deserialize(e),n=t.split("/").filter(Boolean);n.length;){var a=n.shift();if(void 0===r[a])throw new Error("Object has no property '".concat(a,"'"));if(r=r[a],i.isCID(r))return{value:r,remainderPath:n.join("/")}}return{value:r,remainderPath:""}};var s=n.mark((function e(t,r){var o,s,u,l;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!a.isBuffer(t)&&!i.isCID(t)&&"string"!==typeof t&&null!==t){n.next=2;break}return n.abrupt("return");case 2:o=0,s=Object.keys(t);case 3:if(!(o<s.length)){n.next=12;break}return u=s[o],l=void 0===r?u:r+"/"+u,n.next=8,l;case 8:return n.delegateYield(e(t[u],l),"t0",9);case 9:o++,n.next=3;break;case 12:case"end":return n.stop()}}),e)}));t.tree=n.mark((function e(t){var r;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.deserialize(t),e.delegateYield(s(r),"t0",2);case 2:case"end":return e.stop()}}),e)}))},function(e,t,r){"use strict";var n=r(4),i=r(125),a=r(168),o=r(983),s=r(316);e.exports={codec:s.RAW,defaultHashAlg:s.SHA2_256,resolver:{resolve:function(e,t){return{value:e,remainderPath:""}},tree:function(e){return{done:!0}}},util:{deserialize:function(e){return e},serialize:function(e){return e},cid:function(){var t=i(n.mark((function t(r,i){var u,l,c,h,f;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u={cidVersion:1,hashAlg:e.exports.defaultHashAlg},l=Object.assign(u,i),t.next=4,o(r,l.hashAlg);case 4:return c=t.sent,h=s.print[e.exports.codec],f=new a(l.cidVersion,h,c),t.abrupt("return",f);case 8:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()}}},function(e,t,r){"use strict";var n=r(750),i=r(978),a=r(662),o=r(168),s=r(127),u=r(723);e.exports=function(e){var t=u(e,"dag/put");return a((function(e,r,a){if("function"===typeof r&&(a=r),(r=r||{}).hash&&(r.hashAlg=r.hash,delete r.hash),r.cid&&(r.format||r.hashAlg))return a(new Error("Can't put dag node. Please provide either `cid` OR `format` and `hash` options."));if(r.format&&!r.hashAlg||!r.format&&r.hashAlg)return a(new Error("Can't put dag node. Please provide `format` AND `hash` options."));if(r.cid){var u;try{u=new o(r.cid)}catch(h){return a(h)}r.format=u.codec,r.hashAlg=s.decode(u.multihash).name,delete r.cid}var l;r=Object.assign({format:"dag-cbor",hashAlg:"sha2-256",inputEnc:"raw"},r);try{l="dag-cbor"===r.format?i.util.serialize(e):"dag-pb"===r.format?n.util.serialize(e):e}catch(h){return a(h)}var c={qs:{hash:r.hashAlg,format:r.format,"input-enc":r.inputEnc}};t(l,c,(function(e,t){return e?a(e):t.Cid?a(null,new o(t.Cid["/"])):a(t)}))}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{get:r(1439)(t),put:r(1442)(t),data:r(1443)(t),links:r(1444)(t),stat:r(1445)(t),new:r(1446)(t),patch:{addLink:r(1447)(t),rmLink:r(1448)(t),setData:r(1449)(t),appendData:r(1450)(t)}}}},function(e,t,r){"use strict";(function(t){var n=r(662),i=r(750),a=i.DAGNode,o=i.DAGLink,s=r(168),u=new(r(832))({max:128});e.exports=function(e){return n((function(r,n,i){var l;"function"===typeof n&&(i=n,n={}),n||(n={});try{r=new s(r),l=r.toBaseEncodedString()}catch(h){return i(h)}var c=u.get(l);if(c)return i(null,c);e({path:"object/get",args:l,qs:{"data-encoding":"base64"}},(function(e,r){if(e)return i(e);var n=r.Links.map((function(e){return new o(e.Name,e.Size,e.Hash)})),s=a.create(t.from(r.Data,"base64"),n);u.set(l,s),i(null,s)}))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function a(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=s,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,a=this.head;null!==a&&i<e;i++)a=a.next;for(;null!==a&&i<t;i++,a=a.next)r.push(a.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,a=this.tail;null!==a&&i>t;i--)a=a.prev;for(;null!==a&&i>e;i--,a=a.prev)r.push(a.value);return r},n.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,n=this.head;null!==n&&r<e;r++)n=n.next;var a=[];for(r=0;n&&r<t;r++)a.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(r=2;r<arguments.length;r++)n=i(this,n,arguments[r]);return a},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(1441)(n)}catch(u){}},function(e,t,r){"use strict";var n=r(4);e.exports=function(e){e.prototype[Symbol.iterator]=n.mark((function e(){var t;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}},function(e,t,r){"use strict";(function(t){var n=r(662),i=r(168),a=r(750).DAGNode,o=r(723),s=r(680);e.exports=function(e){var r=o(e,"object/put");return n((function(e,n,o){"function"===typeof n&&(o=n,n={});var u=s(o);n||(n={});var l,c={Data:null,Links:[]};if(t.isBuffer(e))n.enc||(c={Data:e.toString(),Links:[]});else if(a.isDAGNode(e))c={Data:e.Data.toString(),Links:e.Links.map((function(e){return{Name:e.Name,Hash:e.Hash.toString(),Size:e.Tsize}}))};else{if("object"!==typeof e)return u(new Error("obj not recognized"));c.Data=e.Data.toString(),c.Links=e.Links}l=t.isBuffer(e)&&n.enc?e:t.from(JSON.stringify(c));var h=n.enc||"json";r(l,{qs:{inputenc:h}},(function(e,t){if(e)return u(e);u(null,new i(t.Hash))}))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(662),i=r(698),a=r(168),o=new(r(832))({max:128});e.exports=function(e){return n((function(t,r,n){var s;"function"===typeof r&&(n=r,r={}),r||(r={});try{s=(t=new a(t)).toBaseEncodedString()}catch(l){return n(l)}var u=o.get(s);if(u)return n(null,u.data);e({path:"object/data",args:s},(function(e,t){if(e)return n(e);"function"===typeof t.pipe?i(t,n):n(null,t)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(750).DAGLink,a=r(168),o=new(r(832))({max:128});e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),r||(r={});try{t=new a(t)}catch(u){return n(u)}var s=o.get(t.toString());if(s)return n(null,s.links);e({path:"object/links",args:t.toString()},(function(e,t){if(e)return n(e);var r=[];t.Links&&(r=t.Links.map((function(e){return new i(e.Name,e.Size,e.Hash)}))),n(null,r)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),r||(r={});try{t=new i(t)}catch(a){return n(a)}e({path:"object/stat",args:t.toString(),qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t=void 0),e({path:"object/new",args:t},(function(e,t){if(e)return r(e);r(null,new i(t.Hash))}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n,a){"function"===typeof n&&(a=n,n={}),n||(n={});try{t=new i(t)}catch(s){return a(s)}var o=[t.toString(),r.Name||r.name||null,(r.Hash||r.cid||"").toString()||null];e({path:"object/patch/add-link",args:o},(function(e,t){if(e)return a(e);a(null,new i(t.Hash))}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n,a){"function"===typeof n&&(a=n,n={}),n||(n={});try{t=new i(t)}catch(o){return a(o)}e({path:"object/patch/rm-link",args:[t.toString(),r.Name||r.name||null]},(function(e,t){if(e)return a(e);a(null,new i(t.Hash))}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(680),a=r(168),o=r(723);e.exports=function(e){var t=o(e,"object/patch/set-data");return n((function(e,r,n,o){"function"===typeof n&&(o=n,n={});var s=i(o);n||(n={});try{e=new a(e)}catch(u){return s(u)}t(r,{args:[e.toString()]},(function(e,t){if(e)return s(e);s(null,new a(t.Hash))}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(680),a=r(168),o=r(723);e.exports=function(e){var t=o(e,"object/patch/append-data");return n((function(e,r,n,o){"function"===typeof n&&(o=n,n={});var s=i(o);n||(n={});try{e=new a(e)}catch(u){return s(u)}t(r,{args:[e.toString()]},(function(e,t){if(e)return s(e);s(null,new a(t.Hash))}))}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{add:r(1452)(t),rm:r(1453)(t),ls:r(1454)(t)}}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r=null),e({path:"pin/add",args:t,qs:r},(function(e,t){if(e)return n(e);n(null,t.Pins.map((function(e){return{hash:e}})))}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r=null),e({path:"pin/rm",args:t,qs:r},(function(e,t){if(e)return n(e);n(null,t.Pins.map((function(e){return{hash:e}})))}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof t&&(n=t,r=null,t=null),"function"===typeof r&&(n=r,r=null),t&&t.type&&(r=t,t=null),e({path:"pin/ls",args:t,qs:r},(function(e,t){if(e)return n(e);n(null,Object.keys(t.Keys).map((function(e){return{hash:e,type:t.Keys[e].Type}})))}))}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{add:r(1456)(t),rm:r(1457)(t),list:r(1458)(t)}}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),t&&"object"===typeof t&&(r=t,t=void 0),e({path:"bootstrap/add",args:t,qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),t&&"object"===typeof t&&(r=t,t=void 0),e({path:"bootstrap/rm",args:t,qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"bootstrap/list",qs:t},r)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{get:r(1460)(t),put:r(1461)(t),findProvs:r(1462)(t),findPeer:r(1463)(t),provide:r(1464)(t),query:r(1465)(t)}}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),e({path:"dht/get",args:t,qs:r},function(e,t,r){if(t)return e(t);if(!r)return e(new Error("empty response"));if(0===r.length)return e(new Error("no value returned for key"));Array.isArray(r)&&(r=r[0]),5===r.Type?e(null,r.Extra):e(new Error("key was not found (type 6)"))}.bind(null,n))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n,i){"function"!==typeof n||i||(i=n,n={}),"function"===typeof n&&"function"===typeof i&&(i=n,n={}),e({path:"dht/put",args:[t,r],qs:n},i)}))}},function(e,t,r){"use strict";var n=r(662),i=r(722),a=r(688),o=r(695),s=r(743);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={});var u=function(e,t){Array.isArray(e)||(e=[e]);var r=[];e.forEach((function(e){4===e.Type&&e.Responses.forEach((function(e){var t=new s(o.createFromB58String(e.ID));e.Addrs&&e.Addrs.forEach((function(e){var r=a(e);t.multiaddrs.add(r)})),r.push(t)}))})),t(null,r)};e({path:"dht/findprovs",args:t.toString(),qs:r},(function(e,t){if(e)return n(e);i(t,u,n)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(722),a=r(688),o=r(695),s=r(743),u=r(976);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={});var l=function(e,t){if(Array.isArray(e)&&(e=e.find((function(e){return 2===e.Type}))),!e||2!==e.Type){return t(u(new Error("key was not found (type 4)"),"ERR_KEY_TYPE_4_NOT_FOUND"))}var r=e.Responses[0],n=new s(o.createFromB58String(r.ID));r.Addrs.forEach((function(e){var t=a(e);n.multiaddrs.add(t)})),t(null,n)};e({path:"dht/findpeer",args:t.toString(),qs:r},(function(e,t){if(e)return n(e);i(t,l,n)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(168);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={}),Array.isArray(t)||(t=[t]);try{t=t.map((function(e){return new i(e).toBaseEncodedString("base58btc")}))}catch(a){return n(a)}e({path:"dht/provide",args:t,qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662),i=r(722),a=r(695),o=r(743);e.exports=function(e){return n((function(t,r,n){"function"!==typeof r||n||(n=r,r={}),"function"===typeof r&&"function"===typeof n&&(n=r,r={});var s=function(e,t){t(null,e.map((function(e){return new o(a.createFromB58String(e.ID))})))};e({path:"dht/query",args:t,qs:r},(function(e,t){if(e)return n(e);i(t,s,n)}))}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{publish:r(1467)(t),resolve:r(1468)(t),pubsub:r(1469)(t)}}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{name:e.Name,value:e.Value})};e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e.andTransform({path:"name/publish",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,e.Path)};e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e.andTransform({path:"name/resolve",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";e.exports=function(e){return{cancel:r(1470)(e),state:r(1471)(e),subs:r(1472)(e)}}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{canceled:void 0===e.Canceled||!0===e.Canceled})};e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e.andTransform({path:"name/pubsub/cancel",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{enabled:e.Enabled})};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"name/pubsub/state",qs:t},i,r)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,e.Strings||[])};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"name/pubsub/subs",qs:t},i,r)}))}},function(e,t,r){"use strict";var n=r(662),i=r(675),a=r(672).Writable,o=r(664),s=r(833);e.exports=function(e){var t=o(e);return n((function(e,r,n){if("function"===typeof r&&(n=r,r={}),r.n&&r.count)return n(new Error("Use either n or count, not both"));r.n||r.count||(r.n=1);var o={path:"ping",args:e,qs:r};t.andTransform(o,(function(e,t){var r=new s,n=[];i(e,r,new a({objectMode:!0,write:function(e,t,r){n.push(e),r()}}),(function(e){if(e)return t(e);t(null,n)}))}),n)}))}},function(e,t,r){"use strict";e.exports=function(e){if(!function(e){return e&&"boolean"===typeof e.Success}(e))throw new Error("Invalid ping message received");return{success:e.Success,time:e.Time,text:e.Text}}},function(e,t,r){"use strict";var n=r(675),i=r(664),a=r(833);e.exports=function(e){var t=i(e);return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.n||r.count||(r.n=1);var i={path:"ping",args:e,qs:r},o=new a;return t(i,(function(e,t){if(e)return o.emit("error",e);n(t,o)})),o}}},function(e,t,r){"use strict";var n=r(683),i=r(689),a=r(675),o=r(664),s=r(833);e.exports=function(e){var t=o(e);return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.n||r.count||(r.n=1);var o={path:"ping",args:e,qs:r},u=i.source(),l=new s;return t(o,(function(e,t){if(e)return u.abort(e);a(t,l),u.resolve(n.source(l))})),u}}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{peers:r(1478)(t),connect:r(1479)(t),disconnect:r(1480)(t),addrs:r(1481)(t),localAddrs:r(1482)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(688),a=r(695);function o(e,t){var r={};try{if(e){var n=t.split(" ");r.addr=i(n[0]),r.latency=n[1]}else r.addr=i(t);r.peer=a.createFromB58String(r.addr.getPeerId())}catch(o){r.error=o,r.rawPeerInfo=t}return r}function s(e,t){var r={};try{r.addr=i(t.Addr),r.peer=a.createFromB58String(t.Peer),r.muxer=t.Muxer}catch(n){r.error=n,r.rawPeerInfo=t}return t.Latency&&(r.latency=t.Latency),t.Streams&&(r.streams=t.Streams),r}e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={});var n=t.v||t.verbose;e({path:"swarm/peers",qs:t},(function(e,t){if(e)return r(e);var i=function(e,t){if(Array.isArray(t.Strings))return t.Strings.map(o.bind(null,e));if(Array.isArray(t.Peers))return t.Peers.map(s.bind(null,e));return[]}(n,t);r(null,i)}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e({path:"swarm/connect",args:t,qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e({path:"swarm/disconnect",args:t,qs:r},n)}))}},function(e,t,r){"use strict";var n=r(662),i=r(743),a=r(695),o=r(688);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"swarm/addrs",qs:t},(function(e,t){if(e)return r(e);var n=Object.keys(t.Addrs).map((function(e){var r=new i(a.createFromB58String(e));return t.Addrs[e].forEach((function(e){r.multiaddrs.add(o(e))})),r}));r(null,n)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(688);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"swarm/addrs/local",qs:t},(function(e,t){if(e)return r(e);r(null,t.Strings.map((function(e){return i(e)})))}))}))}},function(e,t,r){"use strict";(function(t){var n=r(662),i=r(29),a=r(816),o=r(746),s=r(900),u=r(1484),l=r(1486),c=r(664),h=function(){return new Error("pubsub is currently not supported when run in the browser")};e.exports=function(e){var r=c(e),f=new i,d={};return f.id=Math.random(),{subscribe:function(e,t,r,n){var i={discover:!1};return"function"===typeof r&&(n=r,r=i),r||(r=i),o?n?void p(e,t,r,n):new Promise((function(n,i){p(e,t,r,(function(e){if(e)return i(e);n()}))})):n?s((function(){return n(h())})):Promise.reject(h())},unsubscribe:function(e,t,r){if(!o)return r?s((function(){return r(h())})):Promise.reject(h());if(0===f.listenerCount(e)||!d[e]){var n=new Error("Not subscribed to '".concat(e,"'"));return r?s((function(){return r(n)})):Promise.reject(n)}return t||r?f.removeListener(e,t):f.removeAllListeners(e),0===f.listenerCount(e)?r?(a(d[e].res,(function(e){setTimeout((function(){return r(e)}))})),d[e].req.abort(),void(d[e]=null)):new Promise((function(t,r){a(d[e].res,(function(e){setTimeout((function(){if(e)return r(e);t()}))})),d[e].req.abort(),d[e]=null})):r?void s((function(){return r()})):Promise.resolve()},publish:n((function(e,n,i){return o?t.isBuffer(n)?void r({path:"pubsub/pub",args:[e,n]},i):i(new Error("data must be a Buffer")):i(h())})),ls:n((function(e){if(!o)return e(h());r.andTransform({path:"pubsub/ls"},l,e)})),peers:n((function(e,t){if(!o)return t(h());var n={path:"pubsub/peers",args:[e]};r.andTransform(n,l,t)})),setMaxListeners:function(e){return f.setMaxListeners(e)}};function p(e,t,n,i){if(f.on(e,t),d[e])return i();var o={path:"pubsub/sub",args:[e],qs:{discover:n.discover}};d[e]={},d[e].req=r.andTransform(o,u.from,(function(r,n){if(r)return d[e]=null,f.removeListener(e,t),i(r);d[e].res=n,n.on("data",(function(t){f.emit(e,t)})),n.on("error",(function(e){f.emit("error",e)})),a(n,(function(r){r&&f.emit("error",r),d[e]=null,f.removeListener(e,t)})),i()}))}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(18),i=r(19),a=r(23),o=r(24),s=r(672).Transform,u=r(1485),l=function(e){a(r,e);var t=o(r);function r(e){n(this,r);var i=Object.assign(e||{},{objectMode:!0});return t.call(this,i)}return i(r,[{key:"_transform",value:function(e,t,r){if(0===Object.keys(e).length)return r();try{var n=u.deserialize(e,"base64");this.push(n),r()}catch(i){return r(i)}}}],[{key:"from",value:function(e,t){var n=e.pipe(new r);e.on("end",(function(){return n.emit("end")})),t(null,n)}}]),r}(s);e.exports=l},function(e,t,r){"use strict";(function(t){var n=r(694);function i(e){if(!function(e){return e&&e.from&&e.seqno&&e.data&&(e.topicIDs||e.topicCIDs)}(e))throw new Error("Not a pubsub message");return{from:n.encode(t.from(e.from,"base64")).toString(),seqno:t.from(e.seqno,"base64"),data:t.from(e.data,"base64"),topicIDs:e.topicIDs||e.topicCIDs}}e.exports={deserialize:function(e,t){if("json"===(t=t?t.toLowerCase():"json"))return function(e){return i(JSON.parse(e))}(e);if("base64"===t)return i(e);throw new Error("Unsupported encoding: '".concat(t,"'"))}}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";e.exports=function(e,t){t(null,e.Strings||[])}},function(e,t,r){"use strict";var n=r(662),i=r(664),a=function(e,t){t(null,e.Path)};e.exports=function(e){var t=i(e);return n((function(e,r,n){"function"===typeof r&&(n=r,r={}),t.andTransform({path:"dns",args:e,qs:r},a,n)}))}},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return n((function(e){t({path:"commands"},e)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{get:r(1490)(t),set:r(1491)(t),replace:r(1492)(t)}}},function(e,t,r){"use strict";(function(t){var n=r(662),i=function(e,r){t.isBuffer(e)?r(null,JSON.parse(e.toString())):r(null,e)};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t=void 0),t?e.andTransform({path:"config",args:t,buffer:!0},i,(function(e,t){if(e)return r(e);r(null,t.Value)})):e.andTransform({path:"config/show",buffer:!0},i,r)}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(662);e.exports=function(e){return n((function(r,n,i,a){return"function"===typeof i&&(a=i,i={}),"string"!==typeof r?a(new Error("Invalid key type")):void 0===n||t.isBuffer(n)?a(new Error("Invalid value type")):("boolean"===typeof n?(n=n.toString(),i={bool:!0}):"string"!==typeof n&&(n=JSON.stringify(n),i={json:!0}),void e({path:"config",args:[r,n],qs:i,files:void 0,buffer:!0},a))}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";(function(t){var n=r(672).Readable,i=r(662),a=r(723);e.exports=function(e){var r=a(e,"config/replace");return i((function(e,i){var a;"object"===typeof e&&(a=t.from(JSON.stringify(e)),e=new n({read:function(){this.push(a),this.push(null)}})),r(e,{},i)}))}}).call(this,r(10).Buffer)},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{net:r(1494)(t),sys:r(1495)(t),cmds:r(1496)(t)}}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"diag/net",qs:t},r)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"diag/sys",qs:t},r)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"diag/cmds",qs:t},r)}))}},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return n((function(e,r){"function"===typeof e&&(r=e,e=void 0),t({path:"id",args:e},(function(e,t){if(e)return r(e);var n={id:t.ID,publicKey:t.PublicKey,addresses:t.Addresses,agentVersion:t.AgentVersion,protocolVersion:t.ProtocolVersion};r(null,n)}))}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{gen:r(1499)(t),list:r(1500)(t),rename:r(1501)(t),rm:r(1502)(t),export:r(1503)(t),import:r(1504)(t)}}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{id:e.Id,name:e.Name})};e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),e.andTransform({path:"key/gen",args:t,qs:r},i,n)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,e.Keys.map((function(e){return{id:e.Id,name:e.Name}})))};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"key/list",qs:t},i,r)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{id:e.Id,was:e.Was,now:e.Now,overwrite:e.Overwrite})};e.exports=function(e){return n((function(t,r,n){e.andTransform({path:"key/rename",args:[t,r]},i,n)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{id:e.Keys[0].Id,name:e.Keys[0].Name})};e.exports=function(e){return n((function(t,r){e.andTransform({path:"key/rm",args:t},i,r)}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n){e({path:"key/export",args:t,qs:{password:r}},(function(e,t){if(e)return n(e);n(null,t.toString())}))}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,{id:e.Id,name:e.Name})};e.exports=function(e){return n((function(t,r,n,a){e.andTransform({path:"key/import",args:t,qs:{pem:r,password:n}},i,a)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{tail:r(1506)(t),ls:r(1507)(t),level:r(1508)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(675),a=r(825);e.exports=function(e){return n((function(t){return e({path:"log/tail"},(function(e,r){if(e)return t(e);var n=a.parse();i(r,n),t(null,n)}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t){e({path:"log/ls"},(function(e,r){if(e)return t(e);t(null,r.Strings)}))}))}},function(e,t,r){"use strict";var n=r(662);e.exports=function(e){return n((function(t,r,n,i){return"function"===typeof n&&(i=n,n={}),"string"!==typeof t?i(new Error("Invalid subsystem type")):"string"!==typeof r?i(new Error("Invalid level type")):void e({path:"log/level",args:[t,r],qs:n,files:void 0,buffer:!0},i)}))}},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return n((function(e,r,n){"function"===typeof e?(n=e,e=null):"function"===typeof r&&(n=r,r=null);var i={};e&&(i.f=e),r&&(i.n=r),t({path:"mount",qs:i},n)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{gc:r(1511)(t),stat:r(1512)(t),version:r(1513)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(722),a=r(168),o=function(e,t){t(null,e.map((function(e){return{err:e.Err?new Error(e.Err):null,cid:(e.Key||{})["/"]?new a(e.Key["/"]):null}})))};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e({path:"repo/gc",qs:t},(function(e,t){if(e)return r(e);i(t,o,r)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(12),a=function(e,t){t(null,{numObjects:new i(e.NumObjects),repoSize:new i(e.RepoSize),repoPath:e.RepoPath,version:e.Version,storageMax:new i(e.StorageMax)})};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"repo/stat",qs:t},a,r)}))}},function(e,t,r){"use strict";var n=r(662),i=function(e,t){t(null,e.Version)};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"repo/version",qs:t},i,r)}))}},function(e,t,r){"use strict";var n=r(664);e.exports=function(e){var t=n(e);return{bitswap:r(1515)(t),bw:r(1516)(t),bwReadableStream:r(1517)(t),bwPullStream:r(1518)(t),repo:r(1519)(t)}}},function(e,t,r){"use strict";var n=r(662),i=r(12),a=function(e,t){t(null,{provideBufLen:e.ProvideBufLen,wantlist:e.Wantlist||[],peers:e.Peers||[],blocksReceived:new i(e.BlocksReceived),dataReceived:new i(e.DataReceived),blocksSent:new i(e.BlocksSent),dataSent:new i(e.DataSent),dupBlksReceived:new i(e.DupBlksReceived),dupDataReceived:new i(e.DupDataReceived)})};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"stats/bitswap",qs:t},a,r)}))}},function(e,t,r){"use strict";var n=r(662),i=r(698),a=r(834),o=function(e,t){return i(e,(function(e,r){if(e)return t(e);t(null,a(r[0]))}))};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"stats/bw",qs:t},o,r)}))}},function(e,t,r){"use strict";var n=r(672),i=r(675),a=r(834);e.exports=function(e){return function(t){t=t||{};var r=new n.Transform({objectMode:!0,transform:function(e,t,r){r(null,a(e))}});return e({path:"stats/bw",qs:t},(function(e,t){if(e)return r.destroy(e);i(t,r)})),r}}},function(e,t,r){"use strict";var n=r(683),i=r(820),a=r(767),o=r(834),s=r(689);e.exports=function(e){return function(t){t=t||{};var r=s.source();return e({path:"stats/bw",qs:t},(function(e,t){if(e)return r.end(e);r.resolve(a(n.source(t),i(o)))})),r}}},function(e,t,r){"use strict";var n=r(662),i=r(12),a=function(e,t){t(null,{numObjects:new i(e.NumObjects),repoSize:new i(e.RepoSize),repoPath:e.RepoPath,version:e.Version,storageMax:new i(e.StorageMax)})};e.exports=function(e){return n((function(t,r){"function"===typeof t&&(r=t,t={}),e.andTransform({path:"stats/repo",qs:t},a,r)}))}},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return{apply:n((function(e,r){"function"===typeof e&&(r=e,e={}),t({path:"update",qs:e},r)})),check:n((function(e,r){"function"===typeof e&&(r=e,e={}),t({path:"update/check",qs:e},r)})),log:n((function(e,r){"function"===typeof e&&(r=e,e={}),t({path:"update/log",qs:e},r)}))}}},function(e,t,r){"use strict";var n=r(662),i=r(664);e.exports=function(e){var t=i(e);return n((function(e,r){"function"===typeof e&&(r=e,e={}),t({path:"version",qs:e},(function(e,t){if(e)return r(e);var n={version:t.Version,commit:t.Commit,repo:t.Repo};r(null,n)}))}))}},function(e,t,r){"use strict";var n=r(662),i=r(320),a=r(168);e.exports=function(e){return n((function(t,r,n){"function"===typeof r&&(n=r,r={}),(r=r||{}).cidBase&&(r["cid-base"]=r.cidBase,delete r.cidBase);e.andTransform({path:"resolve",args:t,qs:r},(function(e,t){if(!r["cid-base"])return t(null,e.Path);var n=e.Path.split("/");if(i.isEncoded(n[2])!==r["cid-base"])try{var o=new a(n[2]);0===o.version&&"base58btc"!==r["cid-base"]&&(o=o.toV1()),n[2]=o.toBaseEncodedString(r["cid-base"]),e.Path=n.join("/")}catch(s){return t(s)}t(null,e.Path)}),n)}))}},function(e,t,r){"use strict";e.exports=function(e){return function(){return{host:e.host,port:e.port,protocol:e.protocol,"api-path":e["api-path"]}}}}])]);
//# sourceMappingURL=9.59a51b81.chunk.js.map